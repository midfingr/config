function ScribeTransport(e){this.SESSION_BUFFER_KEY="ScribeTransport",this.SCRIBE_API_ENDPOINT="/i/jot",this.options={},e&&(this.updateOptions(e),this.registerEventHandlers(e))}function ClientEvent(e){this.scribeContext={},this.scribeData={},this.scribe=function(t,i){var n=e||window.scribeTransport;if(!n)throw new Error("You must create a global scribeTransport variable or pass one into this constructor.");if(!t||"object"!=typeof t||i&&"object"!=typeof i)throw new Error("Invalid terms or data hash argument when calling ClientEvent.scribe().");if(this.scribeContext){var s="function"==typeof this.scribeContext?this.scribeContext():this.scribeContext;t=$.extend({},s,t)}for(var r in t)t[r]=t[r]&&(""+t[r]).toLowerCase().replace(/_?[^a-z0-9_]+_?/g,"_");n.options.debug&&$.each(["client","action"],function(e,i){if(!t[i])throw new Error("You must specify a "+i+" term in your client_event.")});var i=$.extend({},i);if(this.scribeData){var a="function"==typeof this.scribeData?this.scribeData():this.scribeData;i=$.extend({},a,i)}i.event_namespace=t,i.triggered_on=i.triggered_on||+new Date,i.format_version=i.format_version||2,n.send(i,"client_event")}}function FastClick(e){"use strict";var t,i=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=e,!e||!e.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(i,arguments)},this.onMouse=function(){return FastClick.prototype.onMouse.apply(i,arguments)},this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(i,arguments)},this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(i,arguments)},this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(i,arguments)},FastClick.notNeeded(e)||(this.deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,i,n){var s=Node.prototype.removeEventListener;"click"===t?s.call(e,t,i.hijacked||i,n):s.call(e,t,i,n)},e.addEventListener=function(t,i,n){var s=Node.prototype.addEventListener;"click"===t?s.call(e,t,i.hijacked||(i.hijacked=function(e){e.propagationStopped||i(e)}),n):s.call(e,t,i,n)}),"function"==typeof e.onclick&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null))}this.TD_mustaches=this.TD_mustaches||{},this.TD_mustaches["account_settings_account_summary.mustache"]='<div class="account-summary cf"> <div class="obj-left item-img"> <img class="tweet-avatar avatar pull-right" src="{{profileImageURL}}" width="48" height="48" alt="{{screenName}}\'s avatar"> </div>  <div class="account-summary-text nbfc padding-t--7 account-link"> <div class="{{#isBadged}}fullname-badged-container{{/isBadged}}"> <b class="fullname txt-ellipsis inline-block link-complex-target txt-base-medium {{#isBadged}}fullname-badged{{/isBadged}} {{#isTranslator}}badge-translator{{/isTranslator}} {{#isVerified}}badge-verified{{/isVerified}} position-rel"> {{name}} </b> </div> <div> <span class="username txt-r-dark-gray txt-base-small">@{{screenName}} {{#isProtected}}<i class="icon icon-protected icon-match-context icon-tt"></i>{{/isProtected}}</span> </div> </div> </div>',this.TD_mustaches["account_shared_warning.mustache"]='{{< modal}} {{$modal_class}}mdl-account-shared-warning{{/modal_class}} {{$content}}  <p> {{_i}}Before you add another account, remember that anyone with the password for @{{signinAccount}} will have <strong>full access</strong> to any Twitter accounts you connect here, even if you keep the passwords for those connected accounts secret.{{/i}} </p> <br> <p> {{_i}}Take <strong>extra care</strong> not to share your password for @{{signinAccount}}. If you think you&rsquo;ve shared it already, please <a href="https://twitter.com/settings/password">change it now</a>.{{/i}} </p> {{/content}}  {{$footer_content}} <div class="pull-right"> <button class="js-account-shared-abort-btn btn btn-negative"></i>{{_i}}Cancel{{/i}}</button> <button class="js-account-shared-continue-btn btn btn-positive"></i>{{_i}}I understand &mdash; add a Twitter account{{/i}}</button> </div> {{/footer_content}} {{/modal}}',this.TD_mustaches["account_summary.mustache"]='<div class="account-summary cf"> <a class="obj-left item-img" href="{{getProfileURL}}" data-user-name="{{screenName}}" rel="user" target="_blank" tabindex="-1"> {{^withoutAvatar}} <img class="tweet-avatar avatar pull-right" src="{{profileImageURL}}" width="48" height="48" alt="{{screenName}}\'s avatar"> {{/withoutAvatar}} </a>  {{#withUserMenu}} <div class="obj-right with-dropdown position-rel"> <button class="js-user-actions-menu btn btn-alt btn-square" rel="actionsMenu" data-user-id="{{id}}"> <i class="icon icon-user-dd"></i> </button> </div> {{/withUserMenu}}  <div class="account-summary-text nbfc {{^withUserBio}}padding-t--7{{/withUserBio}}"> <a class="account-link link-complex block" href="{{getProfileURL}}" data-user-name="{{screenName}}" rel="user" target="_blank"> <div class="{{#isBadged}}fullname-badged-container{{/isBadged}}"> <a href="{{getProfileURL}}" class="account-link link-complex" target="_blank" data-user-name="{{screenName}}" rel="user"> <b class="fullname txt-ellipsis inline-block link-complex-target {{#isBadged}}fullname-badged{{/isBadged}} {{#isTranslator}}badge-translator{{/isTranslator}} {{#isVerified}}badge-verified{{/isVerified}} position-rel"> {{name}} </b></a> </div> <div> <a href="{{getProfileURL}}" class="account-link link-complex" target="_blank" data-user-name="{{screenName}}" rel="user"> <span class="username txt-r-deep-gray">@{{screenName}} {{#isProtected}}<i class="icon icon-protected icon-match-context icon-tt"></i>{{/isProtected}}</span> </a> </div> </a> {{#withUserBio}} <p class="account-bio txt-sub-antialiased txt-r-dark-gray">{{{bio}}}</p> {{/withUserBio}} </div> </div>',this.TD_mustaches["account_summary_inline.mustache"]='<img class="avatar size16 avatar-inline neg-margin-bxs" src="{{profileImageURL}}" alt="{{screenName}}\'s avatar"> @{{screenName}}',this.TD_mustaches["actions/action_dialog.mustache"]='<div class="mdl-inner"> <div class="cf"> <div class="pull-right"> {{^isProtected}} {{#canQuoteTweet}} <button data-action="quote" class="js-action-button btn">{{_i}}Quote Tweet{{/i}}</button> {{/canQuoteTweet}} {{^canQuoteTweet}} <button data-action="editquote" class="js-action-button btn">{{_i}}Edit &amp; RT{{/i}}</button> {{/canQuoteTweet}} <button data-action="retweet" class="js-action-button js-retweet-button btn btn-positive">{{_i}}Retweet{{/i}}</button> {{/isProtected}} </div> </div> </div> <div class="js-inreply cmp-replyto item-box is-inverted-dark"></div>',this.TD_mustaches["actions/action_header.mustache"]='<div class="accs-header"> <h3>&nbsp;</h3> </div>',this.TD_mustaches["actions/add_to_customtimeline_dialog.mustache"]='<section> <form class="frm"> <fieldset> <ul class="control-group padding-bn"> {{#myCustomTimelines}} <li> <label class="checkbox"> <input type="checkbox" name="{{name}}" data-id="{{id}}" data-account="{{#account}}{{getKey}}{{/account}}"/> <span>{{>text/strong}}</span> </label> </li> {{/myCustomTimelines}} </ul> </fieldset> </form> </section>',this.TD_mustaches["actions/add_to_list_dialog.mustache"]='<section> <form class="frm"> <fieldset> <ul class="control-group padding-bs"> {{#myLists}} <li> <label class="checkbox"> <input type="checkbox" name="{{name}}" id="{{id}}" data-account="{{#account}}{{getKey}}{{/account}}"/> <span>{{_i}}{{>text/strong}}{{#isPrivate}}<i class="icon icon-protected icon-small  txt-base-medium"></i>{{/isPrivate}} by {{#user}}{{screenName}}{{/user}}{{/i}}</span> </label> </li> {{/myLists}} </ul> </fieldset> <a href="#" class="js-create-list">+ {{_i}}Create new list{{/i}}</a> </form> </section>',this.TD_mustaches["actions/add_to_list_footer.mustache"]='<button class="btn js-create-list">{{_i}}Create list{{/i}}</button>',this.TD_mustaches["actions/follow_from.mustache"]='<div class="js-follow-from l-table padding-al"> <div class="l-cell follow-from-accounts-button"> {{>follow_button}} </div> {{^hideFromAccountName}} <div class="js-from-username l-cell padding-lm txt-left follow-from-accounts-username"> {{#account}} <span>{{_i}}from{{/i}}</span> @{{getUsername}} {{/account}} </div> {{/hideFromAccountName}} </div>',this.TD_mustaches["add_column_search_input.mustache"]='<form action="#" class="search-input-list padding-as"> {{> search_input}} </form>',this.TD_mustaches["app_container.mustache"]='<div class="js-progress-indicator"></div> <div class="js-app-content app-content"> {{>drawer}} <div class="js-app-columns-container app-columns-container scroll-h needs-scroll-bottom-offset {{#styledScrollbar}}scroll-styled-h{{/styledScrollbar}}" id="container"> <div class="js-app-columns app-columns horizontal-flow-container"></div> </div> </div>  <div id="compose-modal" class="js-modal ovl scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"></div> <div id="open-modal" class="js-modal open-modal ovl scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"></div> <div id="actions-modal" class="js-modal ovl scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"></div> <div id="lists-modal" class="js-modal lists-modal ovl scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"></div> <div id="splash-modal" class="js-modal ovl scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"></div> <div id="settings-modal" class="js-modal settings-modal ovl scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"></div>',this.TD_mustaches["app_links.mustache"]='<a href="https://www.twitter.com/tos" target="_blank">{{_i}}Terms of Service{{/i}}</a> &middot; <a href="https://twitter.com/privacy" target="_blank">{{_i}}Privacy Policy{{/i}}</a> &middot; <a href="https://support.twitter.com/articles/20170514" target="_blank">{{_i}}Cookies{{/i}}</a> &middot; <span class="inline-block"> {{version}} </span>',this.TD_mustaches["buttons/favorite.mustache"]='<button class="js-btn-fav js-show-tip btn btn-fav"> <div class="btn-loader"> <span> <img src="{{#asset}}/web/assets/global/backgrounds/spinner_small_trans.gif{{/asset}}" alt="{{_i}}Loading…{{/i}}"> </span> </div> <div class="btn-fav-fav-text"> <i class="icon icon-favorite txt-r-deep-yellow"></i> <span class="label">{{_i}}Favorite{{/i}}</span> </div> <div class="btn-fav-faved-text"> <span class="label">{{_i}}Favorited{{/i}}</span> </div> <div class="btn-fav-unfav-text"> <span class="label">{{_i}}Unfavorite{{/i}}</span> </div> <div class="btn-fav-protected-text"> <i class="icon icon-protected"></i> <span class="label">{{_i}}Protected{{/i}}</span> </div> </button>',this.TD_mustaches["buttons/load_more.mustache"]='<input type="button" name="remove-account" value="Load more" class="js-load-more small btn btn-alt margin-vl obj-center">',this.TD_mustaches["cards/card_attribution.mustache"]='{{#site}} <p> <a class="account-link link-complex {{#isProtected}}is-protected{{/isProtected}}" href="{{getProfileURL}}" target="_blank" rel="user"> <img class="avatar size16 card-site-avatar" src="{{miniProfileImageURL}}" alt="{{screenName}}\'s avatar"> <b class="fullname link-complex-target">{{name}}</b> {{#isVerified}}<i class="sprite sprite-verified-mini"></i>{{/isVerified}} <span class="username txt-mute">@{{screenName}}</span> {{#isProtected}}<i class="icon icon-protected txt-mute txt-base-medium"></i>{{/isProtected}} </a> </p> {{/site}}',this.TD_mustaches["cards/card_layouts.mustache"]="{{> cards/card_summary}} {{> cards/card_photo}} {{> cards/card_player}}",this.TD_mustaches["cards/card_photo.mustache"]='{{#photos}} <div class="{{#isPossiblySensitive}}js-media-preview-container media-sensitive-detail {{/isPossiblySensitive}} card-holder cf position-rel"> {{> cards/large_image}} {{> cards/header_text}} {{> cards/paragraph_text}} {{> cards/card_attribution}} {{> status/media_sensitive}} </div> {{/photos}}',this.TD_mustaches["cards/card_player.mustache"]='{{#players}} <div class="{{#isPossiblySensitive}}js-media-preview-container media-sensitive-detail{{/isPossiblySensitive}} card-holder cf position-rel"> {{> cards/media_player}} {{> cards/header_text}} {{> cards/paragraph_text}} {{> cards/card_attribution}} {{> status/media_sensitive}} </div> {{/players}}',this.TD_mustaches["cards/card_summary.mustache"]='{{#summaries}} <div class="card-holder cf"> {{> cards/header_text}} {{> cards/paragraph_text_with_image}} {{> cards/card_attribution}} </div> {{/summaries}}',this.TD_mustaches["cards/header_text.mustache"]='<h3 class="h3 margin-bs"> <a href="{{url}}" target="_blank" data-action="url-ext" rel="url">{{title}}</a> </h3> {{#author}} <p class="txt-small txt-mute"> By <a class="account-link link-complex {{#isProtected}}is-protected{{/isProtected}}" href="{{getProfileURL}}" target="_blank" rel="user"> <b class="link-complex-target">{{name}}</b> <span class="username txt-mute">@{{screenName}}</span> {{#isProtected}}<i class="icon icon-protected txt-mute txt-base-medium"></i>{{/isProtected}} </a> </p> {{/author}}',this.TD_mustaches["cards/large_image.mustache"]='{{#images}} {{#mobile}} <a href="{{url}}" target="_blank" rel="mediaPreview"> <img class="card-image margin-bm is-zoomable" src="{{image_url}}" width="{{width}}" alt="Story image" title="{{title}}"> </a> {{/mobile}} {{/images}}',this.TD_mustaches["cards/media_player.mustache"]='{{#players}} <div class="fluid-width-video-wrapper" style="padding-top: {{aspectRatio}}%"> <iframe class="card-player" src="{{source_url}}"/> </div> <div class="nbfc"> <p class="margin-ts margin-bm txt-small pull-right"> <a href="{{source_url}}" target="_blank" rel="mediaPreview"> {{_i}}View Larger{{/i}} </a> </p> </div> {{/players}}',this.TD_mustaches["cards/media_player_gallery.mustache"]='{{#players}} <iframe class="card-player" src="{{source_url}}" width="{{width}}px" height="{{height}}px"/> {{/players}}',this.TD_mustaches["cards/paragraph_text.mustache"]='<p class="margin-vl"> <a class="block link-clean" href="{{url}}" target="_blank" data-action="url-ext" rel="url"> <span class="txt-normal"> {{description}} </span> </a> </p>',this.TD_mustaches["cards/paragraph_text_with_image.mustache"]='<p class="margin-vl"> {{#images}} {{#mobile}} <a class="obj-right" href="{{url}}" target="_blank" data-action="url-ext" rel="url"> <img src="{{image_url}}" width="{{width}}" height= "{{height}}" alt="Story thumbnail"> </a> {{/mobile}} {{/images}} <a class="block link-clean" href="{{url}}" target="_blank" data-action="url-ext" rel="url"> <span class="txt-normal"> {{description}} </span> </a> </p>',this.TD_mustaches["column.mustache"]='<section class="js-column {{^isTemporary}}column{{/isTemporary}} {{#isTemporary}}column-temp is-inverted-dark{{/isTemporary}} {{columnclass}}" data-column="{{columnkey}}"> <div class="js-column-holder column-holder"> <div class="column-panel"> {{> column/column_header}} <div class="js-column-content column-content"> <div class="js-column-options-container column-options"> <div class="js-column-options {{#isTouchColumnOptions}}with-touch-txt-base{{/isTouchColumnOptions}}"></div> {{^isTemporary}} <div class="js-column-message scroll-none"></div> {{/isTemporary}} <div class="js-customtimeline-description scroll-none with-column-divider-bottom"></div> </div> {{> column/chirp_container}} <i class="js-column-update-glow sprite sprite-column-update column-updates"></i> <div class="js-column-drag-drop-overlay column-drag-drop-overlay pin-all"> <div class="l-table column-drag-drop-overlay-inner"> <div class=" l-cell"> {{_i}}Add Tweet to collection{{/i}} </div> </div> </div> </div> <div class="js-add-to-customtimeline add-by-url pin-bottom padding-hm is-hidden"></div> </div> <div class="js-column-detail column-detail column-panel"></div> <div class="js-column-social-proof column-detail-level-2 column-panel"></div> </div> </section>',this.TD_mustaches["column/add_to_customtimeline.mustache"]='<div class="input-group-button margin-tm"> <button class="js-add-to-customtimeline-button js-spinner-button pull-right btn no-radius btn-square"> <i class="icon icon-arrow-r"></i> <i class="js-spinner-button-active icon spinner-small-trans icon-center-16 is-hidden"></i> </button> <div class="nbfc"> <input class="js-add-to-customtimeline-input js-submittable-input input-group-input no-radius" type="text" placeholder="{{_i}}Enter Tweet URL{{/i}}" value="" data-account-key="{{accountKey}}" data-customtimeline-id="{{customTimelineId}}" > </div> </div>',this.TD_mustaches["column/alerts_form.mustache"]='<div class="js-accordion-item facet-type facet-type-alerts"> {{>menus/accordion_header}} <div class="js-alerts js-accordion-panel accordion-panel"> <div class="padding-hl control-s"> <div class="control-group"> {{#options}} <div class="controls"> <label class="txt-mute"> <input type="checkbox" {{#on}}checked{{/on}} data-action="{{action}}"> {{option}} </label> </div> {{/options}} </div> </div> </div> </div>',this.TD_mustaches["column/chirp_container.mustache"]='<div class="js-column-scroller js-dropdown-container column-scroller scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} {{#isTemporary}}column-background-fill scroll-alt{{/isTemporary}}"> <div class="js-chirp-container" data-column="{{columnkey}}"> {{>column_loading_placeholder}} </div> </div>',this.TD_mustaches["column/column_dm_participants.mustache"]='{{> column/column_header_detail}}  {{#showAddUser}} <div class="js-conversation-adder add-participant padding-a--10"></div> {{/showAddUser}}  <div class="column-content {{#showAddUser}}column-dm-participants{{/showAddUser}}">  <div class="column-scroller scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}">  {{#users}} {{<stream_item}} {{$content}} {{>account_summary}} {{/content}} {{/stream_item}} {{/users}} {{^users}} {{>column_loading_placeholder}} {{/users}} </div> </div>',this.TD_mustaches["column/column_filter_error.mustache"]='<p class="is-actionable txt-uppercase txt-center padding-as" data-action="action-filter"> {{_i}}Filter error{{/i}} </p>',this.TD_mustaches["column/column_header.mustache"]='<header class="js-column-header js-action-header {{^isTemporary}}column-header{{/isTemporary}} {{#isTemporary}}column-header-temp{{/isTemporary}}" data-action="resetToTopColumn">  {{^isTemporary}} <i class="js-column-drag-handle is-movable column-drag-handle pull-left sprite sprite-drag-vertical"></i> {{/isTemporary}}  <i class="pull-left margin-hs column-type-icon icon {{columniconclass}}"> {{#withMarkAllRead}} <span class="js-unread-count msg-unread-count txt-base-small numbered-badge numbered-badge-onheader anim anim-slower {{#unreadCount}}is-visible{{/unreadCount}}">{{unreadCount}}</span> {{/withMarkAllRead}} </i>  {{#isTemporary}} <button class="js-action-header-button pull-right btn list-edit-button is-hidden" data-action="editList"></button> {{/isTemporary}}  {{^isTemporary}} <span class="column-number"></span> {{/isTemporary}}  {{^withEditableTitle}} <h1 class="column-title {{#withMarkAllRead}}column-title-messages{{/withMarkAllRead}} txt-ellipsis">{{{columntitle}}}</h1> {{/withEditableTitle}} {{#withEditableTitle}} <div class="column-title txt-ellipsis column-title-editable with-image-attribution {{#withMarkAllRead}}column-title-messages{{/withMarkAllRead}} "> {{{columntitle}}} </div> {{/withEditableTitle}}  {{#withDMComposeButton}} <a class="js-action-header-button column-header-link open-compose-dm-link" href="#" data-action="compose-dm"> <i class="js-show-tip icon icon-compose-dm" data-placement="bottom" title="{{_i}}Compose new message{{/i}}"></i> </a> {{/withDMComposeButton}}  {{#withMarkAllRead}} <a class="js-action-header-button column-header-link mark-all-read-link" href="#" data-action="mark-all-read"> <i class="js-show-tip icon icon-mark-read" data-placement="bottom" title="{{_i}}Mark all as read{{/i}}"></i> </a> {{/withMarkAllRead}}  {{^isTemporary}} <a class="js-action-header-button column-header-link column-settings-link" href="#" data-action="options"> <i class="icon icon-sliders"></i> </a> {{/isTemporary}} </header>',this.TD_mustaches["column/column_header_detail.mustache"]='<header class="{{headerClass}} column-header" data-action="{{headerAction}}"> <a class="{{headerLinkClass}} link-complex{{#getConversationTitleInformation}} l-table{{/getConversationTitleInformation}}" href="#"> {{^getConversationTitleInformation}} <div class="column-title-back txt-ellipsis"> <i class="icon icon-arrow-l"></i> <span class="js-tooltip-target link-complex-target">{{_i}}Back to {{{columntitle}}}{{/i}}</span> </div> {{/getConversationTitleInformation}} {{#getConversationTitleInformation}} <div class="column-title-back conversation-title txt-center l-cell"> <i class="icon icon-arrow-l"></i> {{! if there is a conversation name, show it as it is }} {{#name}} <span class="js-tooltip-target title-content">{{{name}}}</span> {{/name}} {{^name}} {{! currently showing name and screenName for one to one }} {{#isOneToOne}} {{#participants.0}} <span class="js-tooltip-target title-content"> <b>{{name}}</b> {{^isDeleted}} <span class="username txt-mute txt-small">@{{screenName}}</span> {{/isDeleted}} </span> {{/participants.0}} {{/isOneToOne}} {{! other two participants, need to wrap around names }} {{#isThreeway}} <span class="js-tooltip-target title-content"> {{#participants.0}} <span class="no-wrap">{{name}}</span>, {{/participants.0}} {{#participants.1}} <span class="no-wrap">{{name}}</span> {{/participants.1}} </span> {{/isThreeway}} {{! first participant name + the amount of participants }} {{#isOneToMany}} <span class="js-tooltip-target title-content"> {{#participants.0}}{{name}}{{/participants.0}} +{{numberOfOtherParticipants}} </span> {{/isOneToMany}} {{/name}} </div> {{/getConversationTitleInformation}} </a> {{#withConversationMenu}} {{^isTemporary}} <a class="js-action-header-button column-header-link column-settings-link link-no-focus" href="#" data-action="message-menu" data-conversation-id="{{conversationId}}" data-account-key="{{accountKey}}"> <i class="js-menu-target icon icon-more"></i> </a> {{/isTemporary}} {{> column/dm_rename_conversation }} {{/withConversationMenu}} </header>',this.TD_mustaches["column/column_message.mustache"]='<div class="is-actionable column-message cf padding-ll padding-rxs padding-vxs" data-action="options"> <p class="obj-left txt-base-smallest padding-axs">{{_i}}Filtered by:{{/i}}</p> <div class="obj-right"> {{#action}} <span data-action="action-filter" class="txt-base-largest padding-axs facet-action inline-block"> <i class="icon icon-tt icon-check icon-small"></i> </span> {{/action}} {{#content}} <span data-action="content-filter" class="txt-base-largest padding-axs facet-content inline-block"> <i class="icon icon-tt icon-content icon-small"></i> </span> {{/content}} {{#user}} <span data-action="user-filter" class="txt-base-largest padding-axs facet-user inline-block"> <i class="icon icon-tt icon-user icon-small"></i> </span> {{/user}} {{#engagement}} <span data-action="engagement-filter" class="txt-base-largest padding-axs facet-engagement inline-block"> <i class="icon icon-tt icon-retweet icon-small"></i> </span> {{/engagement}} </div> </div>',this.TD_mustaches["column/column_options.mustache"]='<form>  <fieldset class="js-search-filter"> <div class="js-accordion accordion"></div> </fieldset>  <fieldset class="js-thumb-size"></fieldset>  {{#isOwnList}} <button class="btn btn-neutral-positive full-width btn-bg-positive btn-options-tray-space" type="button" data-action="edit-list"> <i class="icon icon-edit txt-base-medium"></i> <span class="label margin-ln">{{_i}}Edit list{{/i}}</span> </button> {{/isOwnList}}  {{#isOwnCustomTimeline}} <button class="btn btn-neutral-negative full-width btn-bg-negative btn-options-tray-space" type="button" data-action="delete-customtimeline"> <i class="icon icon-trash icon-small-valigned"></i> <span class="label margin-ln">{{_i}}Delete collection{{/i}}</span> </button> {{/isOwnCustomTimeline}}  {{#isDataminr}} <a class="btn btn-neutral-positive full-width btn-bg-positive btn-options-tray-space url-ext" type="button" href="https://news.dataminr.com/app/core/news/settings.html" rel="url" data-scribe-element="dataminr_settings"> <i class="icon icon-dataminr icon-small-valigned"></i> <span class="label margin-ln">{{_i}}Dataminr settings{{/i}}</span> </a> {{/isDataminr}}  <fieldset class="accordion-divider-t button-tray padding-hs"> <div class="button-group"> <button type="button" class="btn btn-alt btn-square-narrow btn-neutral btn-options-tray pull-left padding-hn" data-action="left"> <i class="icon icon-arrow-l icon-small-valigned"></i> <span class="is-vishidden">{{_i}}Left{{/i}}</span> </button> <button type="button" class="btn btn-alt btn-square-narrow btn-neutral btn-options-tray pull-left padding-hn" data-action="right"> <i class="icon icon-arrow-r icon-small-valigned"></i> <span class="is-vishidden">{{_i}}Right{{/i}}</span> </button> </div>  <span class="position-rel"> <button type="button" class="js-share-column btn btn-alt btn-neutral btn-options-tray padding-hn {{^isShareableOrEmbeddable}}is-invisible{{/isShareableOrEmbeddable}}"> <i class="icon icon-share"></i> <span class="label">{{_i}}Share{{/i}}</span> </button> </span>  <button type="button" class="btn btn-alt btn-neutral btn-options-tray padding-hn {{^isClearable}}is-invisible{{/isClearable}}" data-action="clear"> <i class="icon icon-clear-timeline"></i> <span class="label">{{_i}}Clear{{/i}}</span> </button>  <button type="button" class="btn btn-alt btn-neutral btn-options-tray padding-hn padding-rs" data-action="remove"> <i class="icon icon-close"></i> <span class="label">Remove</span> </button> </fieldset>  <!-- Revisit IF needed for touch --> <!-- {{#isTouchColumnOptions}} <fieldset class="margin-hs padding-tm padding-bm column-options-divider"> <div class="button-group"> <a class="column-action-link is-actionable pull-left" data-action="left"> <i class="icon icon-chevron-left"></i> <span class="is-vishidden">{{_i}}Left{{/i}}</span> </a> <a class="column-action-link is-actionable pull-left" data-action="right"> <i class="icon icon-chevron-left"></i> <span class="is-vishidden">{{_i}}Right{{/i}}</span> </a> </div> <div class="pull-right"> {{#isEmbeddable}} <a class="column-action-link is-actionable" data-action="embed"><i class="icon icon-share"></i></a> {{/isEmbeddable}} {{#isClearable}} <a class="column-action-link is-actionable" data-action="clear">{{_i}}Clear column{{/i}}</a> {{/isClearable}} {{#isOwnCustomTimeline}} <a class="column-action-link is-actionable" data-action="delete-customtimeline">{{_i}}Delete collection{{/i}}</a> {{/isOwnCustomTimeline}} <button type="button" class="btn btn-negative btn-square" data-action="remove"><i class="icon icon-trash"></i></button> </div> </fieldset> {{/isTouchColumnOptions}} -->  </form>',this.TD_mustaches["column/column_options_header.mustache"]="",this.TD_mustaches["column/custom_timeline_description.mustache"]='{{#description}} {{#editable}} <button class="js-edit pull-right btn btn-neutral btn-square btn-alt margin-txs "> <i class="icon icon-edit txt-mute txt-base-medium padding-txs"></i> </button> {{/editable}} <div class="nbfc"> <p class="padding-al txt-mute txt-base-small">{{description}}</p> </div> {{/description}} {{^description}} {{#editable}} <button class="js-edit btn btn-neutral-positive full-width reset-height"> <i class="icon icon-plus icon-small"></i> <span class="label margin-ln">{{_i}}Add description{{/i}}</span> </button> {{/editable}} {{/description}}',this.TD_mustaches["column/custom_timeline_edit_description.mustache"]='<div class="padding-al"> <div class="pull-right margin-lm"> <input class="js-character-count character-count txt-center txt-bold padding-ts" disabled> <button class="js-cancel btn btn-neutral btn-square block reset-height padding-vxs"> <i class="icon icon-close icon-remove-color"></i> </button> <button class="js-save btn btn-neutral btn-square block reset-height padding-vn"> <i class="icon icon-check icon-submit-color"></i> </button> </div> <div class="nbfc"> <textarea class="js-input js-submittable-input js-compose-text scroll-v scroll-styled-v padding-tm" autofocus placeholder="{{_i}}Add description{{/i}}" style="height:80px">{{description}}</textarea> </div> </div>',this.TD_mustaches["column/dm_rename_conversation.mustache"]='<div class="js-edit-conversation-name edit-conversation-name bg-r-faded-yellow cf" data-conversation-id="{{conversationId}}" data-account-key="{{accountKey}}" > <div class="obj-right"> <button class="btn btn-neutral btn-square btn-square-narrow" data-action="confirm-edit-conversation"> <i class="icon icon-check txt-r-deep-green"></i> </button> <button class="btn btn-neutral btn-square btn-square-narrow" data-action="close-edit-conversation"> <i class="icon icon-close txt-r-deep-red"></i> </button> </div> <div class="nbfc"> <input class="js-conversation-name js-submittable-input js-escapable-input conversation-name" maxlength="20"> </div> </div>',this.TD_mustaches["column/edit_customtimeline.mustache"]='{{#withTitle}} <input class="js-customtimeline-title js-submittable-input" type="text" placeholder="{{_i}}Title{{/i}}" value="{{customTimelineName}}" style="margin-bottom: 5px"> {{/withTitle}} {{#withDescription}} <input class="js-customtimeline-desc js-submittable-input" type="text" placeholder="{{_i}}Description{{/i}}" value="{{customTimelineDescription}}"> {{/withDescription}}',this.TD_mustaches["column/thumb_size_select.mustache"]='<div class="facet-type facet-type-thumb-size"> <div class="accordion-header not-actionable link-clean block cf txt-base-medium"> <div class="obj-left facet-title"> <i class="icon icon-image facet-type-icon icon-small"></i> <span class="txt-base-smallest">{{_i}}Previews{{/i}}</span> </div> <div class="facet-subtitle nbfc"> <a href="#" class="js-toggle-item toggle-item" data-value="off">{{_i}}Off{{/i}}</a> &middot; <a href="#" class="js-toggle-item toggle-item" data-value="small"> <span class="toggle-item-text">{{_i}}Small{{/i}}</span> <span class="toggle-item-text-truncated">{{_i}}S{{/i}}</span> </a> &middot; <a href="#" class="js-toggle-item toggle-item" data-value="medium"> <span class="toggle-item-text">{{_i}}Medium{{/i}}</span> <span class="toggle-item-text-truncated">{{_i}}M{{/i}}</span> </a> &middot; <a href="#" class="js-toggle-item toggle-item" data-value="large"> <span class="toggle-item-text">{{_i}}Large{{/i}}</span> <span class="toggle-item-text-truncated">{{_i}}L{{/i}}</span> </a> </div> </div> </div>',this.TD_mustaches["column_loading_placeholder.mustache"]='<div class="js-column-loading-placeholder list-placeholder column-loading-placeholder"> <p><span class="spinner-small"></span> {{^isUpdating}}Loading&#8230;{{/isUpdating}}{{#isUpdating}}Updating&#8230;{{/isUpdating}}</p> </div>',this.TD_mustaches["column_nav_flyout.mustache"]='<div class="js-column-nav-menu-flyover column-nav-flyout"> <div class="column-nav-item padding-lm padding-rl txt-ellipsis">{{{content}}}</div> </div>',this.TD_mustaches["column_title.mustache"]='<span class="column-head-title">{{title}}</span> {{#needsUserAttribution}}<span class="attribution txt-mute txt-sub-antialiased">{{screenName}}</span>{{/needsUserAttribution}}',this.TD_mustaches["column_title_editable.mustache"]='<input type="text" class="js-submittable-input column-title-edit-box {{editableFieldClass}}" maxlength="{{maxLength}}" value="{{title}}"> <img class="js-show-tip avatar size24 image-attribution" title="{{screenName}}" data-placement="bottom" width="24" height="24" src="{{profileImageURL}}">',this.TD_mustaches["compose/account_selector.mustache"]='<div class="js-account-list margin-b--11 compose-accounts cf {{gridModeClass}}"> {{#accounts}} <a class="js-account-item {{^isList}}js-show-tip{{/isList}} compose-account is-actionable {{#isSelected}}is-selected{{/isSelected}} {{#isList}}cf{{/isList}} link-clean" tabindex="0" title="@{{screenName}}" data-account-key="{{accountKey}}"> {{#isList}} <div class="position-rel obj-left"> <img src="{{profileImageURL}}" alt="" width="{{avatarSize}}" height="{{avatarSize}}" class="avatar compose-account-img {{avatarSizeClass}}" /> <div class="compose-account-selected"><i class="icon icon-check icon-small"></i></div> </div> <div class="nbfc compose-account-names link-clean"> <b class="txt-base-medium txt-ellipsis inline-block">{{name}}</b> <p class="txt-base-small txt-ellipsis">@{{screenName}}</p> </div>  {{/isList}} {{^isList}} <img src="{{profileImageURL}}" alt="" width="{{avatarSize}}" height="{{avatarSize}}" class="avatar compose-account-img {{avatarSizeClass}}" /> <div class="compose-account-selected"><i class="icon icon-check icon-small"></i></div> {{/isList}} </a> {{/accounts}} </div>',
this.TD_mustaches["compose/account_selector_grid_toggle.mustache"]='<a class="pull-left margin-r--6 is-actionable account-selector-grid-mode {{#grid}}is-selected{{/grid}}" data-grid-mode="grid"><i class="txt-r-white icon icon-compose-grid"></i><span class="is-vishidden">grid</span></a> <a class="pull-left margin-r--6 is-actionable account-selector-grid-mode {{#minigrid}}is-selected{{/minigrid}}" data-grid-mode="minigrid"><i class="txt-r-white icon icon-compose-minigrid"></i><span class="is-vishidden">grid</span></a> <a class="pull-left is-actionable account-selector-grid-mode {{#list}}is-selected{{/list}}" data-grid-mode="list"><i class="txt-r-white icon icon-compose-list"></i><span class="is-vishidden">grid</span></a>',this.TD_mustaches["compose/accounts.mustache"]='{{#accounts}} <li data-id="{{uid}}" title="{{username}}" data-service="{{service}}" class="acc-{{service}} js-account-item js-show-tip" data-placement="bottom"> <img src="{{picture}}" alt="account" class="acc-avatar"/> <i class="icon icon-twitter-bird"></i> </li> {{/accounts}}',this.TD_mustaches["compose/autocomplete_hashtag.mustache"]='{{#results}} <li class="typeahead-item padding-am cf is-actionable"> <p class="js-hashtag txt-ellipsis">{{{value}}}</p> </li> {{/results}}',this.TD_mustaches["compose/autocomplete_twitter_user.mustache"]='{{#results}} <li class="typeahead-item padding-am cf is-actionable" data-id="{{id}}"> <img src="{{pic}}" class="avatar obj-left size24"> <div class="nbfc txt-ellipsis padding-ts"> <strong class="fullname">{{{name}}}</strong> {{#isVerified}}<i class="js-show-tip sprite sprite-verified-mini" title="{{_i}}Verified account{{/i}}"></i>{{/isVerified}} <span class="username"><span>@</span><span class="js-screenname">{{{screenName}}}</span></span> </div> </li> {{/results}}',this.TD_mustaches["compose/compose_inline_reply.mustache"]='<div class="js-inline-reply inline-reply item-box-full-bleed is-inline-inactive is-inline-active"> <div class="padding-axl"> <div class="position-rel compose-text-container margin-bl"> <textarea class="js-compose-text compose-text scroll-v scroll-styled-v scroll-styled-h scroll-alt" placeholder="{{_i}}What\'s happening?{{/i}}" tabindex="100"></textarea> </div> <div class="cf"> <div class="pull-right"> <input class="js-character-count character-count-compose margin-rl margin-txs pull-left" disabled="" value="140" /> <a class="js-account-item js-show-tip compose-account is-actionable is-selected margin-an margin-rl" tabindex="101" data-account-key="{{account.accountKey}}" title="@{{account.screenName}}"> <img src="{{account.profileImageURL}}" alt="" width="30" height="30" class="avatar compose-account-img size30" /> </a> <div class="js-send-button-container spinner-button-container"> <button class="js-send-button js-spinner-button js-show-tip btn btn-positive" tabindex="100"> {{_i}}Tweet{{/i}} </button> <i class="js-compose-sending-success icon-center-16 compose-send-button-success icon icon-check is-hidden"></i> <i class="js-spinner-button-active icon-center-16 spinner-button-icon-spinner is-hidden"></i> </div> </div> <div class="pull-left neg-margin-lm"> <button class="js-inline-compose-close btn btn-square btn-neutral" tabindex="103"> <i class="icon icon-close icon-medium"></i> </button> <button class="js-inline-compose-pop js-show-tip btn btn-square btn-neutral" tabindex="102" title="{{_i}}Popout{{/i}}"> <i class="icon icon-popout icon-medium"></i> </button>  {{! Needs revisiting. Camera button does not fit in narrow columns }} <button class="js-inline-compose-add-image btn btn-square btn-neutral is-hidden"> <i class="icon icon-camera icon-medium"></i> </button> </div> </div> </div> </div>',this.TD_mustaches["compose/docked_compose.mustache"]='<div class="js-docked-compose compose">  <div class="js-compose-scroller compose-content antiscroll-wrap pin-all"> <div class="antiscroll-inner scroll-v scroll-styled-v padding-h--15">  <header class="js-compose-header compose-header"> <div class="position-rel compose-title inline-block"> <h1 class="js-compose-title compose-title-text txt-ellipsis inline-block">{{_i}}New Tweet{{/i}}</h1> </div> <i class="js-drawer-close is-actionable icon icon-close margin-vm pull-right"></i> </header>  <div class="margin-v--14 cf"> <div class="pull-left compose-text-title"> {{_i}}From{{/i}} </div> <div class="js-account-selector-grid-toggle pull-right account-selector-grid-toggle"> </div> </div>  <!-- Accounts --> {{>compose/account_selector}} <!-- end Accounts -->  <!-- Direct Message --> <div class="js-compose-message-recipient-container compose-message-recipient-container margin-bxl position-rel cf"> <p class="padding-b--9 compose-text-title">{{_i}}To{{/i}}</p>  <div class="js-compose-message-recipient-input-container compose-message-recipient-input-container scroll-v position-rel bg-r-white"> <div class="js-compose-message-recipient-list compose-message-recipient-list position-rel is-hidden cf border-box padding-r--4 padding-b--4"> </div> <!-- message recipient input --> <input type="text" class="js-compose-message-account js-non-escapable-input compose-message-account"> <a href="#" class="js-clear-input txt-base-medium input-clear-control" tabindex="-1"> <i class="icon icon-close icon-small"></i> </a>  </div>  <div class="js-typeahead-dropdown border-box typeahead-dropdown dropdown-menu is-hidden scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} padding-t--0 padding-b--0"> <ul class="js-typeahead-conversation-list is-hidden"></ul> <ul class="js-typeahead-user-list is-hidden"></ul> </div> </div> <!-- end Direct Message -->  <div class="js-compose-message-header margin-b--9 compose-text-title"></div>  <!-- reply to tweet --> <div class="js-in-reply-to compose-reply-tweet padding-al is-hidden"></div> <!-- end reply to tweet -->  <!-- Compose box --> <div class="position-rel compose-text-container"> <textarea class="js-compose-text compose-text scroll-v scroll-styled-v scroll-styled-h scroll-alt padding-al" placeholder="{{_i}}What\'s happening?{{/i}}"></textarea> </div>  <!-- Media bar --> <div class="js-media-added is-hidden"></div>  <!-- Quote Tweet --> <div class="js-quote-tweet-holder padding-a--10 bg-r-white"></div> <!-- End compose box -->  <!-- Hint bar --> <div class="js-compose-hint margin-vl is-hidden"> </div>  <!-- Send tweet button  & character count --> <div class="cf margin-t--12 margin-b--30"> <div class="pull-right"> <input class="js-character-count character-count-compose margin-rl" disabled="" value="140"> <div class="js-send-button-container spinner-button-container"> <button class="js-send-button js-spinner-button js-show-tip is-disabled btn btn-positive btn-extra-height" {{_i}}Tweet{{/i}}> </button> <i class="js-compose-sending-success icon-center-16 compose-send-button-success icon icon-check is-hidden"></i> <i class="js-spinner-button-active icon-center-16 spinner-button-icon-spinner is-hidden"></i> </div> </div> </div>  <!-- Option buttons --> <button class="js-add-image-button js-show-tip needsclick btn btn-on-blue full-width txt-left margin-b--12 padding-v--9 is-disabled"> <i class="icon icon-camera"></i> <span class="js-add-image-button-label label padding-ls">{{_i}}Add image{{/i}}</span> </button>  <button class="js-schedule-button js-show-tip btn btn-on-blue full-width txt-left margin-b--12 padding-v--9 is-disabled"> <i class="icon icon-schedule"></i> <span class="js-schedule-button-label label padding-ls">{{_i}}Schedule Tweet{{/i}}</span> </button> <span class="js-schedule-datepicker-holder"/>  <button class="js-tweet-button btn btn-on-blue full-width txt-left margin-b--12 padding-v--9 is-hidden"> <i class="icon icon-twitter-bird"></i> <span class="label padding-ls">{{_i}}New Tweet{{/i}}</span> </button>  <button class="js-dm-button js-show-tip btn btn-on-blue full-width txt-left margin-b--12 padding-v--9"> <i class="icon icon-message"></i> <span class="label padding-ls">{{_i}}Direct message{{/i}}</span> </button> <!-- end option buttons --> </div> </div>  <footer class="pin-bottom margin-a--15"> <label class="checkbox checkbox-reversed compose-remember-state pull-right"> {{_i}}Stay open{{/i}} <input class="js-compose-stay-open" type="checkbox"/> </label> </footer>  </div>',this.TD_mustaches["compose/in_reply_to.mustache"]='{{#user}} <header class="tweet-header padding-bm"> <a href="#" class="js-in-reply-to-remove pull-right compose-reply-tweet-remove margin-axs"><i class="icon icon-close"></i></a> <a class="account-link link-complex block txt-ellipsis" href="https://twitter.com/{{screenName}}" rel="user" target="_blank"> <img class="compose-reply-avatar avatar size24" src="{{profileImageURL}}" width="24" height="24"> <span class="txt-ellipsis"> <b class="fullname link-complex-target">{{name}}</b> {{#isVerified}}<i class="js-show-tip sprite sprite-verified-mini" title="{{_i}}Verified account{{/i}}"></i>{{/isVerified}} <span class="username txt-mute margin-rm {{#isVerified}}block{{/isVerified}}">@{{screenName}}</span> </span> </a> </header> {{/user}} <div class="tweet-body"> <p class="js-tweet-text tweet-text with-linebreaks ">{{{htmlText}}}</p> </div>',this.TD_mustaches["compose/media_bar_image.mustache"]='{{#isMediaGridContent}} <div class="compose-media-grid-holder bg-r-white padding-am"> <div class="media-grid-container"> <div class="media-grid-{{mediaLength}}"> {{#mediaInfo}} <div class="media-image-container block position-rel"> <div class="pin-all media-image" style="background-image: url({{src}});" > <a class="js-media-bar-remove compose-media-grid-remove is-actionable" data-file-index="{{fileIndex}}"> <i class="sprite sprite-close"></i> </a> </div> </div> {{/mediaInfo}} </div> </div> </div> {{/isMediaGridContent}} {{^isMediaGridContent}} <div class="compose-media-bar-holder padding-al"> <div class="compose-media-bar"> <a class="js-media-bar-remove compose-media-bar-remove is-actionable"> <i class="sprite sprite-close"></i> </a> {{#mediaInfo}} <img class="js-media-bar-thumb compose-media-bar-thumb full-width" alt="" src="{{src}}"> {{/mediaInfo}} </div> </div> {{/isMediaGridContent}}',this.TD_mustaches["compose/media_bar_infobar.mustache"]='<div class="compose-media-info-bar-holder padding-al"> <div class="compose-media-info-bar cf padding-as"> <div class="obj-left"> <i class="icon icon-camera align-middle"></i> <span class="align-middle">{{_i}}Image added{{/i}}</span> </div> <div class="obj-right"> <a href="#" class="js-media-bar-remove align-middle">{{_i}}Remove{{/i}}</a> </div> </div> </div>',this.TD_mustaches["compose/message_conversation.mustache"]='{{#chirp}} <div class="js-compose-message-recipient pull-left border-box margin-t--4 padding-l--4 txt-r-dark-gray cf compose-message-recipient" data-conversation-id="{{conversationId}}"> {{^withMultipleAvatars}} {{#avatars.0}} <img class="pull-left" src="{{profileImageURL}}" width="24" height="24" alt="{{screenName}}\'s avatar"> {{/avatars.0}} {{/withMultipleAvatars}} {{#withMultipleAvatars}} <div class="pull-left media-grid-container multiple-avatar-grid-mini"> <div class="{{avatarsClass}}"> {{#avatars}} <div class="media-image-container media-image-container-mini"> <div class="media-image block position-rel" style="background-image: url({{profileImageURL}});" ></div> </div> {{/avatars}} </div> </div> {{/withMultipleAvatars}}  <a class="js-remove-conversation is-actionable remove-recipient txt-mute block pull-right"><i class="txt-r-light-grey icon icon-close txt-base-smallest padding-r--4 padding-l--4"></i></a>  <div class="nbfc padding-l--5 compose-message-recipient-name"> <span class="name txt-ellipsis inline-block position-rel"> {{#getConversationTitleInformation}} {{#name}} {{{name}}} {{/name}} {{^name}} {{#isOneToOne}} {{#participants.0}} {{name}} </a> {{/participants.0}} {{/isOneToOne}} {{#isThreeway}} {{#participants.0}} {{name}}, {{/participants.0}} {{#participants.1}} {{name}} {{/participants.1}} {{/isThreeway}} {{#isOneToMany}} {{#participants.0}} {{name}} + {{numberOfOtherParticipants}} {{/participants.0}} {{/isOneToMany}} {{/name}} {{/getConversationTitleInformation}} </span> </div> </div> {{/chirp}}',this.TD_mustaches["compose/message_recipients.mustache"]='{{#users}} <div class="js-compose-message-recipient pull-left border-box margin-t--4 padding-l--4 txt-r-dark-gray cf compose-message-recipient" data-user-id="{{id}}" data-screen-name="{{screenName}}"> <img class="pull-left" src="{{profileImageURL}}" width="24" height="24" /> <a class="js-remove-recipient is-actionable remove-recipient txt-mute block pull-right" data-user-id="{{id}}"><i class="txt-r-light-grey icon icon-close txt-base-smallest padding-r--4 padding-l--4"></i></a>  <div class="nbfc padding-l--5 compose-message-recipient-name"> <span class="name txt-ellipsis inline-block position-rel"> {{name}} </span> </div>  </div> {{/users}}',this.TD_mustaches["compose/schedule.mustache"]='<div class="popover popover-position-t margin-ll" style="display:block"> <div class="caret"> <span class="caret-outer"></span> <span class="caret-inner"></span> </div>  <div class="cal"> <header> <input id="scheduled-hour" type="text" pattern="\\d*" inputmode="numeric" tabindex="2"> <span>:</span> <input id="scheduled-minute" type="text" pattern="\\d*" inputmode="numeric" tabindex="3"> <a id="amPm" class="btn" data-value="{{isPM}}"> <span class="label">{{meridiemText}}</span> </a> </header>  <div id="calendar" class="form-calendar"> <div class="nav-group button-group"> <a id="prev-month" class="btn btn-square"><i class="icon icon-arrow-l icon-small"></i></a> <a id="next-month" class="btn btn-square"><i class="icon icon-arrow-r icon-small"></i></a> </div> <input type="date" name="datepicker" id="datepicker"> </div> </div>  <div class="padding-as"> <button class="js-remove btn btn-alt btn-negative full-width"><i class="icon icon-trash"></i><span class="label">{{_i}}Remove{{/i}}</span></button> </div> </div>',this.TD_mustaches["contributor_list_account_summary.mustache"]='<div class="account-summary cf"> <div class="obj-left item-img"> <img class="avatar size36 avatar pull-right" src="{{profileImageURL}}" width="36" height="36" alt="{{screenName}}\'s avatar"> </div>  <div class="account-summary-text nbfc account-link"> <div class="{{#isBadged}}fullname-badged-container{{/isBadged}}"> <b class="fullname txt-ellipsis inline-block link-complex-target txt-base-medium {{#isBadged}}fullname-badged{{/isBadged}} {{#isTranslator}}badge-translator{{/isTranslator}} {{#isVerified}}badge-verified{{/isVerified}} position-rel"> {{name}} </b> </div> <div> <span class="username txt-r-deep-gray txt-base-smallest"> @{{screenName}} {{#isProtected}}<i class="icon icon-protected icon-match-context icon-tt"></i>{{/isProtected}} </span> </div> </div> </div>',this.TD_mustaches["contributors/contributor_list.mustache"]="{{#contributors}} {{>contributors/contributor_list_row}} {{/contributors}}",this.TD_mustaches["contributors/contributor_list_error.mustache"]='<div class="padding-axl margin-tl txt-r-medium-red"> {{_i}}Could not retrieve team members.{{/i}} </div>',this.TD_mustaches["contributors/contributor_list_row.mustache"]='{{#contributor}} <div class="js-contributor-row contributor-row position-rel padding-axl" data-state="{{initialState}}" data-state-error data-user-id="{{user.id}}" data-name="{{user.name}}" data-contributor-role="{{#isAdmin}}admin{{/isAdmin}}{{^isAdmin}}contributor{{/isAdmin}}"> {{#user}} {{>contributor_list_account_summary}} {{/user}}  <div class="contributor-detail cf txt-base-small txt-r-deep-gray" data-show-when-state="closed"> <span data-show-when-contributor-role="admin"> {{_i}}Admin{{/i}} </span> <span data-show-when-contributor-role="contributor"> {{_i}}Contributor{{/i}} </span> &middot; <a href="#" class="js-contributor-open-settings" data-user-id="{{user.id}}"> {{_i}}Change role{{/i}} </a> </div>  <div class="contributor-settings control-s margin-txl cf" data-show-when-state="settings confirmRemove"> <div class="contributor-settings-role margin-bxl padding-bxl margin-" data-hide-when-state="confirmRemove"> <div class="radio"> <label class="contributor-option cf block"> <input type="radio" name="contributor-role-{{user.id}}" class="js-contributor-role margin-tm block obj-left" data-user-id="{{user.id}}" data-contributor-role="contributor" {{^isAdmin}}checked="checked"{{/isAdmin}}> <div class="nbfc"> <strong class="block">{{_i}}Contributor{{/i}}</strong> <span class="txt-r-deep-gray">{{_i}}Can Tweet as @{{contributee.getUsername}}{{/i}}</span> </div> </label> <label class="contributor-option cf block"> <input type="radio" name="contributor-role-{{user.id}}" class="js-contributor-role margin-tm block obj-left" data-user-id="{{user.id}}" data-contributor-role="admin" {{#isAdmin}}checked="checked"{{/isAdmin}}> <div class="nbfc"> <strong class="block">{{_i}}Admin{{/i}}</strong> <span class="txt-r-deep-gray">{{_i}}Can Tweet and manage team{{/i}}</span> </div> </label> </div>  <div class="contributor-confirm-change cf margin-txl txt-center"> <button class="js-contributor-action-confirm btn btn-positive btn-extra-height padding-h--20 pull-left" data-user-id="{{user.id}}"> <i class="icon icon-check"></i> <span class="label">{{_i}}Confirm{{/i}}</span> </button> <button class="js-contributor-action-cancel cf btn btn-light-gray btn-extra-height padding-h--20 pull-right" data-user-id="{{user.id}}"> {{_i}}Cancel{{/i}} </button> </div> </div>  <div class="contributor-remove txt-center" data-hide-when-state="confirmRemove"> <button class="js-contributor-remove btn btn-negative full-width btn-extra-height" data-user-id="{{user.id}}"> <i class="icon icon-close"></i> <span class="label">{{_i}}Remove from team{{/i}}</span> </button> </div>  <div class="contributor-confirm-remove padding-bl txt-r-dark-gray txt-center" data-show-when-state="confirmRemove"> {{^isSigninAccount}} {{_i}}Remove @{{user.screenName}} from the team?{{/i}} {{/isSigninAccount}} {{#isSigninAccount}} {{_i}}You are signed in as @{{user.screenName}}, so this will remove @{{contributee.getUsername}} from your TweetDeck and you will no longer be able to manage the team.{{/i}} {{/isSigninAccount}} </div>  <div class="contributor-confirm-remove cf txt-center" data-show-when-state="confirmRemove"> <button class="js-contributor-action-confirm btn btn-negative btn-extra-height padding-h--20 pull-left" data-user-id="{{user.id}}"> <i class="icon icon-close"></i> <span class="label">{{_i}}Remove{{/i}}</span> </button> <button class="js-contributor-action-cancel cf btn btn-light-gray btn-extra-height padding-h--20 pull-right" data-user-id="{{user.id}}"> {{_i}}Cancel{{/i}} </button> </div> </div>  <div class="contributor-confirm-add padding-vxl txt-r-dark-gray" data-show-when-state="confirmAdd confirmAdd-added"> {{_i}}This user will be able to {{>text/open_strong}}use Twitter as @{{contributee.getUsername}}{{>text/close_strong}}, including:{{/i}} <ul class="padding-tl ul"> <li>{{_i}}Posting Tweets{{/i}}</li> <li>{{_i}}Accessing direct messages{{/i}}</li> <li>{{_i}}Favoriting and retweeting{{/i}}</li> </ul> </div>  <div class="contributor-confirm-add txt-center" data-show-when-state="confirmAdd confirmAdd-added"> <div class="cf"> <button class="js-contributor-action-confirm btn btn-positive btn-extra-height padding-h--20 pull-left" data-user-id="{{user.id}}"> <i class="icon icon-check"></i> <span class="label">{{_i}}Authorize{{/i}}</span> </button> <button class="js-contributor-action-cancel cf btn btn-light-gray btn-extra-height padding-h--20 pull-right" data-user-id="{{user.id}}"> {{_i}}Cancel{{/i}} </button> </div> </div>  <div class="contributor-confirm-deadmin padding-hs padding-vm txt-r-dark-gray" data-show-when-state="confirmDeadmin"> {{_i}}Warning: You will no longer be able to manage the team from this TweetDeck{{/i}} </div>  <div class="contributor-confirm-deadmin txt-center" data-show-when-state="confirmDeadmin"> <button class="js-contributor-action-confirm btn btn-positive btn-extra-height padding-h--20 pull-left" data-user-id="{{user.id}}"> <i class="icon icon-check"></i> <span class="label">{{_i}}Continue{{/i}}</span> </button> <button class="js-contributor-action-cancel cf btn btn-light-gray btn-extra-height padding-h--20 pull-right" data-user-id="{{user.id}}"> {{_i}}Cancel{{/i}} </button> </div>  <div class="js-contributor-error-message margin-txl txt-r-deep-red txt-center" data-show-when-state-error></div> </div> {{/contributor}}',this.TD_mustaches["contributors/contributor_manager.mustache"]='<div class="padding-txl padding-lxl padding-rxl padding-bn"> {{! Account summary }} {{#account}} <a class="account-link link-complex block" href="{{getProfileURL}}" data-user-name="{{screenName}}" rel="user" target="_blank"> <div class="margin-bxxl padding-al bg-r-faded-gray"> {{> account_settings_account_summary }} </div> </a> {{/account}}  {{! User search box }} <h1 class="txt-base-extra-large txt-weight-normal"> {{_i}}Team members{{/i}} </h1>  <p class="padding-tl txt-r-dark-gray"> {{_i}}Team members can use Twitter as @{{account.screenName}} without knowing the password.{{/i}} <a href="https://support.twitter.com/articles/20171753-using-team-accounts-on-tweetdeck" target="_blank" rel="url">{{_i}}Learn more{{/i}}</a>. </p> </div>  <div class="js-position-sticky position-sticky contributor-adder-block bg-r-light-gray"> <div class="js-contributor-adder contributor-adder padding-lxl padding-rxl margin-vxl"></div> </div>  <div class="js-contributor-list js-position-sticky-scroll-container contributor-list margin-bxl"></div>',this.TD_mustaches["contributors/contributors_loading.mustache"]='<div class="padding-hxl"> {{_i}}Loading team...{{/i}} </div>',this.TD_mustaches["drawer.mustache"]='<div class="js-drawer drawer" data-drawer="compose"> {{>compose/docked_compose}} </div> <div class="js-drawer drawer" data-drawer="accountSettings"> </div>',this.TD_mustaches["emails/fileabug.mustache"]="## Add bug details above this line ## 1. Subject: What problem did you encounter? 2. Body: Describe the steps to reproduce.  ## Please do not delete below ## Device Details Build ID: {{buildID}} Version: {{version}} Browser: {{userAgent}} TweetDeck Account: {{tdAccount}}",this.TD_mustaches["embed_tweet.mustache"]='{{< modal}} {{$modal_class}}s-nonav embed-modal{{/modal_class}} {{$content}}  <div class="margin-al"> <span class="block margin-bl txt-small">{{_i}}Add this Tweet to your website by copying the code below. If your CMS supports it, you can just paste in the link.{{/i}} <a class="url" target="_blank" href="https://dev.twitter.com/docs/embedded-tweets">{{_i}}Learn more{{/i}}</a></span>  <textarea class="js-embed-textarea block margin-bl" rows="2" readonly>{{html}}</textarea>  {{#isReply}} <label class="checkbox is-actionable block">{{_i}}Include parent Tweet{{/i}} <input type="checkbox" {{#includeParentTweet}}checked{{/includeParentTweet}} class="js-embed-include-parent"> </label> {{/isReply}} {{#hasMedia}} <label class="checkbox is-actionable block">{{_i}}Include media{{/i}} <input type="checkbox" {{#includeMedia}}checked{{/includeMedia}} class="js-embed-include-media"> </label> {{/hasMedia}}  </div>  <b class="block margin-ll">{{_i}}Preview{{/i}}</b>  <div class="js-embed-loading-container embed-loading-container margin-al"> <img src="{{#asset}}/web/assets/global/backgrounds/spinner_large_white.gif{{/asset}}" class="embed-loading" alt="Loading…" /> </div>  <div class="js-embed-iframe-container embed-iframe-container"> <iframe class="js-embed-iframe embed-iframe"> </iframe> </div>  {{/content}} {{/modal}}',this.TD_mustaches["favorite_from_options.mustache"]='{{< modal}} {{$modal_class}}mdl-favorite-from-options s-fluid s-wide{{/modal_class}} {{$content}} {{#accounts}} <div class="l-table padding-al"> <div class="l-cell"> <div class="l-cell" rel="favorite-button" data-tweet-id="{{tweet.id}}" data-account-key="{{getKey}}"></div> <div class="l-cell padding-lm">from @{{getUsername}}</div> </div> </div> {{/accounts}} {{/content}}  {{$footer_content}} <button class="js-dismiss btn btn-positive"> <i class="icon icon-check icon-small padding-rs"></i> <span class="label">Done</span> </button> {{/footer_content}} {{/modal}}',this.TD_mustaches["follow_button.mustache"]='<div class="js-action-follow btn-relation-group"> {{#showAccountMenu}} {{> user_actions_btn_inv}} {{/showAccountMenu}}  <button class="js-follow-button {{^isSingleAccount}}js-show-tip{{/isSingleAccount}} follow-btn btn btn-alt" disabled="disabled" {{^isSingleAccount}}title="{{_i}}From {{#account}}@{{getUsername}}{{/account}}{{/i}}"{{/isSingleAccount}}> <div class="btn-loader"> <span> <img src="{{#asset}}/web/assets/global/backgrounds/spinner_small_trans.gif{{/asset}}" alt="{{_i}}Loading…{{/i}}"> </span> </div>  <div class="action-text follow-text"> <i class="icon icon-twitter-bird"></i> <span class="label">{{_i}}Follow{{/i}}</span> </div> <div class="label action-text following-text"> {{_i}}Following{{/i}} </div> <div class="label js-action-unfollow action-text unfollow-text"> {{_i}}Unfollow{{/i}} </div> <div class="label action-text block-text"> {{_i}}Blocked{{/i}} </div> <div class="label js-action-unblock action-text unblock-text action-text"> {{_i}}Unblock{{/i}} </div> <div class="label pending-text action-text"> {{_i}}Pending{{/i}} </div> <div class="label js-action-unfollow action-text cancel-req-text "> {{_i}}Cancel{{/i}} </div> <div class="label js-action-profile action-text thats-you-text"> {{_i}}Edit your profile{{/i}} </div> </button>  </div>',this.TD_mustaches["follow_from_options.mustache"]='{{< modal}} {{$modal_class}}mdl-favorite-from-options s-fluid s-wide{{/modal_class}} {{$content}} <!-- Populated by component code --> {{/content}}  {{$footer_content}} <button class="js-dismiss btn btn-positive"> <i class="icon icon-check icon-small padding-rs"></i> <span class="label">Done</span> </button> {{/footer_content}} {{/modal}}',this.TD_mustaches["item_box.mustache"]='<div class="item-box {{$item_box_classes}}{{/item_box_classes}}" {{$item_box_data}}{{/item_box_data}}>  {{$content}}{{/content}} </div>',this.TD_mustaches["keyboard_shortcut_list.mustache"]='{{< modal}} {{$modal_class}}s-nonav keyboard-shortcut-list-modal{{/modal_class}} {{$content}}  <dl class="keyboard-shortcut-list mdl-column"> <dt class="keyboard-shortcut-title"><b>Actions</b></dt> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">R</span>  Reply</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">T</span>  Retweet</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">F</span>  Favorite</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">N</span>  New Tweet</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">D</span>  Direct message</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">P</span>  View user profile</dd>  <dd class="keyboard-shortcut-definition"> <span class="text-like-keyboard-key">{{#isMac}}Return{{/isMac}}{{^isMac}}Enter{{/isMac}}</span> View Tweet Details </dd> <dd class="keyboard-shortcut-definition"> <span class="text-like-keyboard-key">Backspace</span> Close Tweet Details </dd>  <dd class="keyboard-shortcut-definition"> <span class="text-like-keyboard-key">{{#isMac}}Cmd &#8984;{{/isMac}}{{^isMac}}Ctrl{{/isMac}}</span> + <span class="text-like-keyboard-key">{{#isMac}}Return{{/isMac}}{{^isMac}}Enter{{/isMac}}</span> Send Tweet </dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">A</span>  Add Column</dd> </dl>  <dl class="keyboard-shortcut-list mdl-column"> <dt class="keyboard-shortcut-title"><b>Navigation</b></dt> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">?</span>  This menu</dd>  <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">&#8594;</span>  Right</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">&#8592;</span>  Left</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">&#8595;</span>  Down</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">&#8593;</span>  Up</dd>  <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">1</span> … <span class="text-like-keyboard-key">9</span>  Column 1－9</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">0</span>  Final column</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">X</span>  Expand/Collapse navigation</dd> <dd class="keyboard-shortcut-definition"><span class="text-like-keyboard-key">S</span>  Search</dd> </dl>  {{/content}} {{/modal}}',this.TD_mustaches["large_modal.mustache"]='<div class="js-modal-panel mdl s-tall-fixed is-inverted-dark"> {{> modal_header}} <div class="mdl-inner"> <div class="mdl-content js-mdl-content horizontal-flow-container"> </div> <footer class="mdl-buttonbar"></footer> </div> </div>',this.TD_mustaches["list_module_account_item.mustache"]='<li> <a href="#" class="list-account s-justify cf"> <img src="{{profileImageURL}}" alt="@{{username}}" class="avatar obj-left"> <div class="nbfc"> <strong class="fullname">{{fullname}}</strong> <span class="username">@{{username}}</span> </div> </a> </li>',this.TD_mustaches["list_module_dataminr_watchlist.mustache"]='<li> <a href="#" class="list-twitter-list" data-id="{{id}}"> <div class="inner" > <strong>{{name}}</strong> </div> <p>{{description}}</p> </a> </li>',this.TD_mustaches["list_module_list_item.mustache"]='<li class="{{#selected}}selected{{/selected}} {{classes}}"><a href="#" class="list-link" data-action="{{action}}"><strong>{{title}}</strong><i class="chev-right"></i></a></li>',this.TD_mustaches["list_module_subtitle_item.mustache"]='<li><a href="#" class="list-subtitle">{{title}}<span>{{subtitle}}</span><i class="chev-right"></i></a></li>',this.TD_mustaches["list_module_trend_header.mustache"]='<header class="margin-am"> <div class="js-trends control-group is-hidden"> <label class="padding-ts pull-left txt-mute cont">{{_i}}Trends{{/i}}</label> <div class="controls-space-58"> <select class="js-trends-select"></select> </div> </div> <div class="js-cities control-group is-hidden margin-ts"> <label class="padding-ts pull-left txt-mute cont">{{_i}}City{{/i}}</label> <div class="controls-space-58"> <select class="js-cities-select"></select> </div> </div> </header>',this.TD_mustaches["list_module_trends.mustache"]='<div class="lst-group"> {{^withLocationSelector}} <h3>{{_i}}Worldwide{{/i}}</h3> {{/withLocationSelector}} {{> list_module_trend_header}} <ul class="js-trend-list"></ul> </div>',this.TD_mustaches["list_module_twitter_customtimeline_item.mustache"]='<li> <a href="#" class="list-twitter-list"> <div class="inner" > <strong>{{title}}</strong> </div> <p>{{description}}</p> </a> </li>',this.TD_mustaches["list_module_twitter_list_item.mustache"]='<li> <a href="#" class="list-twitter-list"> <div class="inner" > {{#isPrivate}}<i class="icon icon-protected icon-small"></i>{{/isPrivate}} <strong>{{title}}</strong> <span class="bytext">{{by}}</span> </div> <p>{{description}}</p> <span class="subtitle">{{subtitle}}</span> <img src="{{miniProfileURL}}" alt="avatar" class="avatar size24"> </a> </li>',this.TD_mustaches["list_option_dropdown.mustache"]='<span class="btn-dropdown-group"> <a href="#" class="btn-dropdown"> <span class="js-menu-selected-item">{{choice}}</span> <i class="carrot-down"></i> </a> <ul class="options-dropdown dropdown-menu" style="display:block"> <li><a href="#">{{_i}}Ping{{/i}}</a></li> <li><a href="#">{{_i}}Ping 2{{/i}}</a></li> <li><a href="#">{{_i}}Ping 3{{/i}}</a></li> <li><a href="#">{{_i}}Ping 4{{/i}}</a></li> </ul> </span>',this.TD_mustaches["list_trend_item.mustache"]='<li><a href="#" data-action="search" data-query="{{name}}">{{name}}</a></li>',this.TD_mustaches["list_trend_promoted_item.mustache"]='<li><a class="promoted" href="#" data-action="search" data-query="{{name}}">{{name}}<i class="badge-promoted"></i><span>promoted</span></a></li>',
this.TD_mustaches["lists/edit_footer.mustache"]='<span class="pull-right"> <button class="js-save btn btn-positive"><i class="add"></i>{{_i}}Save{{/i}}</button> </span>',this.TD_mustaches["lists/edit_form.mustache"]='<form action="#" id="list_details" accept-charset="utf-8" class="list-details frm s-fullform"> <fieldset> <legend class="frm-legend">{{_i}}List Details{{/i}}</legend>  <div id="list-edit-form" class="control-group"> <label for="list-account" class="control-label">{{_i}}Account{{/i}}</label> <div class="controls"> <select name="list-account" id="list-account"> {{#accounts}}<option value="{{getKey}}">{{getUsername}}</option>{{/accounts}} </select> </div> </div>  <div class="control-group"> <label for="list-name"  class="control-label">{{_i}}Name{{/i}}</label> <div class="controls"> <input class="xlarge" id="list-name" name="list-name" maxlength="25" required="required" type="text"> </div> </div>  <div class="control-group"> <label for="list-description"  class="control-label">{{_i}}Description{{/i}}</label> <div class="controls"> <input class="xlarge" id="list-description" name="list-description" maxlength="100" type="text"> </div> </div>  <div class="control-group"> <label for="list-mode"  class="control-label">{{_i}}Privacy{{/i}}</label> <div class="controls frm-inputs-list"> <label class="radio"> <input type="radio" value="public" id="list-mode-public" name="list-mode" checked="checked"> <span>{{_i}}Public{{/i}}</span> </label> <label class="radio"> <input type="radio" value="private" id="list-mode-private" name="list-mode"> <span>{{_i}}Private{{/i}}</span> </label> </div> </div> </fieldset></form>',this.TD_mustaches["lists/edit_members_footer.mustache"]='<button class="js-edit btn">{{_i}}Edit Details{{/i}}</button> <button class="js-delete btn btn-negative"><i class="icon icon-trash padding-rs"></i><span class="label">{{_i}}Delete list{{/i}}</span></button> <span class="pull-right"> <label class="js-add-column-option is-hidden pull-left checkbox frm-add-col"> <input type="checkbox" class="js-add-column-checkbox" name="add-column-checkbox"/> <span>{{_i}}Add column{{/i}}</span> </label> <button class="js-done btn btn-positive"></i>{{_i}}Done{{/i}}</button> </span>',this.TD_mustaches["lists/member.mustache"]='<li class="list-listmember cf"> <img src="{{profileImageURL}}" alt="@{{username}}" class="avatar"> <button class="js-add-remove btn btn-square"> <div class="working action-btn"> <span> <img src="{{#asset}}/web/assets/global/backgrounds/spinner_small_trans.gif{{/asset}}" alt="Loading…"> </span> </div> <div class="member action-btn"><i class="icon icon-trash"></i></div> <div class="checked action-btn"><i class="icon icon-check icon-small"></i></div> <div class="nonmember action-btn"><i class="icon icon-plus icon-small"></i></div> </button> <div class="content"> <strong class="fullname">{{fullname}}</strong> <span class="username">@{{username}} {{#isProtected}}<i class="icon icon-protected"></i>{{/isProtected}}{{#isVerified}}<i title="{{_i}}Verified account{{/i}}" class="sprite sprite-verified js-show-tip"></i>{{/isVerified}}</span> </span> <p class="bio">{{description}}</p> </div> </li>',this.TD_mustaches["lists/member_list.mustache"]='<section id="{{columnkey}}" data-column="{{columnkey}}"> <header class="column-header column-header-temp"> <h1><strong>{{_i}}Members{{/i}}</strong> (<span class="js-member-count"></span>)</h1> </header> <div class="l-column-scrollv scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt column-content"> <ul class="js-member-list"></ul> </div> </section>',this.TD_mustaches["login/2fa_verification.mustache"]='<div class="startflow-message-wrap"> <div class="startflow-panel"> <div class="position-rel padding-axl padding-hxxl txt-center txt-extra-large-fixed bg-r-dark-blue txt-on-r-dark-blue"> <h1>{{_i}}Check your Twitter mobile app{{/i}}</h1> <div class="pin-top-only pin-right padding-axl"> <a href="#" class="js-dismiss txt-r-on-dark-blue"><i class="icon icon-close"></i></a> </div> </div>  <div class="js-login-error-message startflow-msg-error txt-center margin-vxl is-hidden"> {{_i}}Something has gone wrong. Please try logging in again.{{/i}} </div>  <div class="padding-axl padding-hxxl"> <p class="txt-large">{{_i}}When you receive a login verification request, accept it by tapping the checkmark button on your phone.{{/i}}</p> <p class="txt-large">{{_i}}<b>Didn&rsquo;t receive a notification?</b><br /> You can check your login requests manually in the Twitter mobile app, under Me &rarr; Settings &rarr; Choose Account &rarr; Security &rarr; Login requests{{/i}}</p> <p class="txt-center">Need help? Please contact <a href="https://support.twitter.com/articles/20170388-using-login-verification" target="_blank">Twitter Support</a>.</p> </div> </div> </div>',this.TD_mustaches["login/2fa_verification_code.mustache"]='<div class="startflow-message-wrap"> <div class="startflow-panel"> <div class="padding-axl padding-hxxl txt-center txt-extra-large-fixed bg-r-dark-blue txt-on-r-dark-blue"> <div class="margin-rxl"> <h1>{{_i}}We&rsquo;ve texted a verification code to your phone{{/i}}</b> </div> <div class="pin-top-only pin-right padding-axl"> <a href="#" class="js-dismiss txt-r-on-dark-blue"><i class="icon icon-close"></i></a> </div> </div>   <div class="padding-axl padding-hxxl padding-txxl"> <div class="js-login-error is-hidden padding-bm"> <div class="js-login-error-message form-message form-error-message startflow-msg-error padding-vl txt-center"> {{_i}}That&rsquo;s not the correct code. Check your phone and try again.{{/i}} </div> </div> <p class="txt-large padding-tn">{{_i}}Enter the verification code in the box below.{{/i}}</p> <form class="js-twogin-2fa-code-form padding-vl"> <input class="js-twogin-2fa-code form-verification margin-bl txt-base-medium" type="text" name="verificationcode" placeholder="Verification code" required autofocus> <div class="spinner-button-container"> <button type="submit" class="js-spinner-button btn btn-positive align-top" tabindex="4"> {{_i}}Continue{{/i}} </button> <i class="js-spinner-button-active icon-center-16 spinner-button-icon-spinner is-hidden"></i> </div> <a href="#" class="js-dismiss inline-block margin-ts margin-ll">{{_i}}Cancel{{/i}}</a> </form> <p class="txt-center">Need help? Please contact <a href="https://support.twitter.com/articles/20170388-using-login-verification" target="_blank">Twitter Support</a>.</p> </div> </div> </div>',this.TD_mustaches["login/locked_account_warning.mustache"]='<div class="startflow-panel startflow-panel-rounded padding-am"> <i class="icon icon-small icon-info txt-r-medium-red pull-left margin-rl"></i> <p class="nbfc"> {{_i}}You can no longer log in to TweetDeck with {{email}}. Please log in with {{#screenName}}the @{{>text/open_strong}}{{screenName}}{{>text/close_strong}}{{/screenName}}{{^screenName}}a{{/screenName}} Twitter username instead.{{/i}} <a href="https://support.twitter.com/articles/20171367#locked-transfer" class="startflow-link" target="_blank" rel="url">{{_i}}Why the change?{{/i}}</a> </p> </div>',this.TD_mustaches["login/login_form.mustache"]='<div class="js-header-container is-hidden app-signin-wrap padding-bxxl"></div> <div class="app-signin-wrap"> <div class="js-signin-ui app-signin-form pin-top-only pin-right txt-weight-normal"></div> {{> login/promo_for_login_form}} </div>',this.TD_mustaches["login/login_form_footer.mustache"]='<div class="spinner-button-container"> <button type="submit" class="js-spinner-button btn-login btn btn-positive align-top" tabindex="3"> {{loginFormButtonContent}} {{^loginFormButtonContent}} {{_i}}Log in{{/i}} {{/loginFormButtonContent}} {{#loginFormButtonIcon}} <i class="icon {{loginFormButtonIcon}} icon-small-valigned"></i> {{/loginFormButtonIcon}} </button> <i class="js-spinner-button-active icon-center-16 spinner-button-icon-spinner is-hidden"></i> </div> <div class="cf margin-txs"> {{#withRememberMe}} <label class="checkbox txt-regular inline-block align-middle margin-bn"> <input class="js-login-stay-signed-in" type="checkbox" tabindex="4">{{_i}}Remember me{{/i}} </label> &nbsp;&middot;&nbsp; {{/withRememberMe}} {{#withForgotPassword}} <a href="#" class="js-login-forgot-password align-middle txt-regular startflow-link" tabindex="5">{{_i}}Forgot password?{{/i}}</a> {{/withForgotPassword}} </div>',this.TD_mustaches["login/login_form_message.mustache"]='<div class="js-login-success form-message form-success-message error txt-center padding-al margin-bxl is-hidden"> <p class="js-login-success-message">{{message}}</p> </div> <div class="js-login-error form-message form-error-message error txt-center padding-al margin-bxl is-hidden"> <p class="js-login-error-message">{{message}}</p> </div>',this.TD_mustaches["login/migrate_account_login.mustache"]='<div class="js-migrate-account-login migrate-account-login"> <div class="migrate-acount-login-title padding-bxl padding-al txt-r-white txt-center txt-bold"> {{_i}}Switch to Twitter login{{/i}} </div>  <div class="migrate-account-login-forms padding-hxl position-rel padding-txl nbfc"> {{#tweetdeck}} <div class="migrate-account-login-tweetdeck-form pull-left"> <div class="migrate-account-login-step-title migrate-account-login-step-1-title txt-bold txt-r-white"> {{_i}}Step 1 of 3{{/i}} </div> <div class="js-migrate-tweetdeck-form txt-weight-normal"> {{> login/tweetdeck_account_login_form}} </div> <div class="js-migrate-tweetdeck-account-preview startflow-panel-rounded margin-vl txt-medium txt-weight-normal is-hidden"> <div class="js-migrate-tweetdeck-account-preview-legend form-legend txt-bold padding-axl"> {{_i}}Your TweetDeck setup{{/i}} </div> <div class="js-migrate-tweetdeck-account-preview-content padding-axl nbfc"> <div class="txt-center"> <img src="{{#asset}}/web/assets/global/backgrounds/spinner_large_white.gif{{/asset}}" alt="Loading…" /> <p class="margin-tl">{{_i}}Getting account information&hellip;{{/i}}</p> </div> </div> </div> {{> login/migrate_account_login_forms_cancel}} </div> {{/tweetdeck}}  <div class="migrate-account-login-arrow pin-top-only"></div>  {{#twitter}} <div class="js-migrate-twitter-form migrate-account-login-twitter-form pull-right txt-weight-normal"> <div class="migrate-account-login-step-title txt-bold txt-r-white"> {{_i}}Step 2 of 3{{/i}} </div> {{> login/twitter_account_login_form}} {{> login/migrate_account_login_forms_cancel}} </div> {{/twitter}} </div>  <div class="migrate-tweetdeck-account-warning-wrapper padding-hxl padding-txl nbfc"> <div class="migrate-account-login-step-title txt-bold txt-r-white"> {{_i}}Step 3 of 3{{/i}} </div> <div class="js-migrate-tweetdeck-account-warning migrate-tweetdeck-account-warning padding-axl margin-vl bg-r-white txt-on-r-white"></div> <div class="txt-center padding-al"> {{> login/migrate_account_login_forms_cancel}} </div> </div> </div>',this.TD_mustaches["login/migrate_account_login_forms_cancel.mustache"]='<div class="migrate-account-login-forms-cancel padding-hxl padding-ts cf"> {{^withForcedMigration}} <a href="#" class="js-migrate-account-login-forms-cancel txt-r-light-gray">{{_i}}Cancel{{/i}}</a> {{/withForcedMigration}}  <div class="margin-tl"> <a href="https://support.twitter.com/articles/20171367" rel="url" target="_blank">{{_i}}Learn more about switching to Twitter login{{/i}}</a> </div> </div>',this.TD_mustaches["login/migrate_education.mustache"]='<div class="migrate-confirm-start bg-r-white txt-medium txt-on-r-white padding-axl"> <div class="padding-axxl"> <h1 class="txt-xxl txt-center padding-bxl">{{_i}}Start using Twitter login{{/i}}</h1> <div class="cf margin-bxl"> <i class="icon icon-arrow-r migrate-educate-arrow txt-r-deep-yellow"></i> <div class="half-width pull-right txt-center padding-hxl border-box"> <h2 class="txt-large">{{_i}}After this change{{/i}}</h2> <p class="padding-vxl">{{_i}}You\'ll log in with your {{>text/br}}Twitter account{{/i}}</p> <i class="icon icon-twitter-bird txt-r-twitter-blue" style="font-size:70px; margin-top:-17px"></i> </div> <div class="half-width txt-center padding-hxl border-box"> <h2 class="txt-large">{{_i}}Now{{/i}}</h2> <p class="padding-vxl">{{_i}}You log in with {{>text/br}}an email &amp; password{{/i}}</p> <input type="text" class="margin-bs migrate-educate-input" disabled=\'disabled\' data-title="matching" placeholder="{{tweetDeckAccount}}" value=""><input type="password" class="migrate-educate-input" disabled=\'disabled\' data-title="matching" placeholder="********" value=""> </div> </div>  <ul class="padding-axl margin-lxl"> <li class="margin-bl cf"> <i class="obj-left icon icon-check txt-r-deep-green"></i> <span class="migrate-data-group block nbfc"> {{_i}}Fewer passwords to remember{{/i}} </span> </li> <li class="margin-bl cf"> <i class="obj-left icon icon-check txt-r-deep-green"></i> <span class="migrate-data-group block nbfc"> {{_i}}Stronger account security{{/i}} </span> </li> <li class="margin-bl cf"> <i class="obj-left icon icon-check txt-r-deep-green"></i> <span class="migrate-data-group block nbfc"> {{_i}}Same experience you know and love: <br>setup remains unchanged (same columns, accounts, scheduled Tweets){{/i}} </span> </li> </ul>  <div class="margin-hxl margin-vxxl txt-center"> <button class="js-migrate-continue js-migrate-continue-step-1 btn btn-positive txt-medium padding-al padding-hxl bg-r-twitter-blue txt-on-r-twitter-blue align-top" tabindex="1"> {{_i}}Do it now{{/i}} <i class="icon icon-arrow-r icon-small-valigned"></i> </button> </div> </div>  {{^withForcedMigration}} <div class="bg-r-white txt-on-r-white"> <a href="#" class="js-migrate-cancel inline-block margin-tl margin-rxxl" tabindex="2">{{_i}}Do it later{{/i}}</a> </div> {{/withForcedMigration}} </div>',this.TD_mustaches["login/migrate_organise_team.mustache"]='<div class="migration-v2 bg-r-white txt-medium txt-on-r-white padding-axl"> <div class="js-migrate-organise-team-type padding-axxl">  <div class="padding-b--20"> <div class="obj-right position-rel"> <i class="icon icon-user-team-mgr txt-r-twitter-blue migrate-teams-icon"></i> </div> <div class="nbfc"> <h1 class="txt-size--24 txt-r-dark-red">{{_i}}Switch to TweetDeck Teams{{/i}}</h1> </div> </div>  <p class="padding-b--20">{{_i}}You will be able to share Twitter accounts with your team, without sharing passwords. If you are the organizer of the team, you can add team members and adjust permissions.{{/i}} <a href="https://support.twitter.com/articles/20171753-using-team-accounts-on-tweetdeck">{{_i}}Learn more{{/i}}</a>.</p>  <div class="margin-hxl margin-vl txt-center"> <button class="js-migrate-team-type-organiser btn btn-positive migrate-action-button txt-medium padding-al margin-b--10 txt-on-r-twitter-blue obj-center" tabindex="1">{{_i}}I organize this team{{/i}}</button> <button class="js-migrate-team-type-member btn btn-positive migrate-action-button txt-medium padding-al txt-on-r-twitter-blue obj-center" tabindex="2">{{_i}}I\'m on this team{{/i}}</button> </div> </div> {{^withForcedMigration}} <div class="bg-r-white txt-on-r-white"> <a href="#" class="js-migrate-cancel inline-block margin-tl margin-rxxl" tabindex="2">{{_i}}Do this later{{/i}}</a> </div> {{/withForcedMigration}} </div>',this.TD_mustaches["login/migrate_progress.mustache"]='<div class="bg-r-dark-blue txt-on-r-dark-blue padding-axxl"> <div class="padding-bxxl txt-center"> <h1>{{_i}}Working&hellip;{{/i}}</h1> </div>  <img src="{{#asset}}/web/assets/global/backgrounds/spinner_blue.gif{{/asset}}" alt="{{_i}}Working&hellip;{{/i}}" class="obj-center padding-bm">  </div>',this.TD_mustaches["login/migrate_progress_merge_error.mustache"]='<div class="migrate-progress bg-r-white txt-on-r-white"> <div class="padding-axl txt-center bg-r-dark-red txt-on-r-dark-red"> <h1>{{_i}}Error{{/i}}</h1> </div>  <div class="padding-axl"> <p class="margin-bl"> {{_i}}Sorry, but something went wrong while transferring your TweetDeck account.{{/i}} </p> <div class="txt-center"> <a href="#" class="js-migrate-progress-error-exit">{{_i}}Return to login{{/i}}</a> </div> </div> </div>',this.TD_mustaches["login/migrate_progress_success.mustache"]='<div class="bg-r-white txt-on-r-white"> <div class="padding-axl txt-center bg-r-medium-green txt-on-r-medium-green"> <h1>{{_i}}Success!{{/i}}</h1> </div>  <div class="padding-axxl bg-r-white"> <div class="txt-center"> {{_i}}From now on, remember to log in to TweetDeck as:{{/i}} </div> {{#twitterProfile}} <div class="migrate-account-warning-twitter-account padding-axxl"> <div class="txt-center"> <div class="margin-bs"> <img src="{{profileImageURL}}" class="avatar size73"> </div>  <strong class="fullname">{{name}}</strong> <p class="username">@{{screenName}}</span></p> </div> </div> {{/twitterProfile}}  {{#isTeamOrganiser}} <div class="txt-center"> {{_i}}Next, set up your team{{/i}} </div> <div class="padding-txxl txt-center"> <button class="js-team-setup btn btn-positive align-top txt-large padding-al padding-hxl" tabindex="4">{{_i}}Go{{/i}}</button> </div> {{/isTeamOrganiser}}  {{^isTeamOrganiser}} <div class="padding-txxl txt-center"> <button class="js-dismiss btn btn-positive align-top txt-large padding-al padding-hxl" tabindex="4">{{_i}}Done{{/i}}</button> </div> {{/isTeamOrganiser}}   </div>   </div>',this.TD_mustaches["login/migrate_progress_transient_error.mustache"]='<div class="migrate-progress bg-r-white txt-on-r-white"> <div class="padding-axl txt-center bg-r-medium-yellow txt-on-r-medium-yellow"> <h1>{{_i}}Something is wrong{{/i}}</h1> </div>  <div class="padding-axl"> <p class="margin-bl"> {{_i}}Sorry about this, but something went wrong while transferring your TweetDeck account.{{/i}} </p> <p class="margin-bl"> {{_i}}This problem may only be temporary, so please try again later.{{/i}} </p> <div class="txt-center"> <a href="#" class="js-migrate-progress-error-exit">{{_i}}Return to login{{/i}}</a> </div> </div> </div>',this.TD_mustaches["login/migrate_risk.mustache"]='<div class="migrate-confirm-start bg-r-white txt-medium txt-on-r-white padding-axl"> <div class="js-migrate-account-type padding-axxl">  <div class="margin-hxl margin-vl txt-center"> <i class="icon icon-user-switch migrate-risk-icon"></i> </div>  <div class="padding-axl txt-center"> <h1 class="txt-xxl txt-r-dark-red">{{_i}}Are you the only person who uses this TweetDeck account?{{/i}}</h1> </div>  <div class="margin-hxl margin-vl txt-center"> <button class="js-migrate-account-type-multiple btn btn-positive txt-medium padding-al padding-hxl margin-rl bg-r-twitter-blue txt-on-r-twitter-blue align-top" tabindex="1">{{_i}}No{{/i}}</button> <button class="js-migrate-account-type-single btn btn-positive txt-medium padding-al padding-hxl bg-r-twitter-blue txt-on-r-twitter-blue align-top" tabindex="1">{{_i}}Yes{{/i}}</button> </div> </div>  {{^withForcedMigration}} <div class="bg-r-white txt-on-r-white"> <a href="#" class="js-migrate-cancel inline-block margin-tl margin-rxxl" tabindex="2">{{_i}}Do this later{{/i}}</a> </div> {{/withForcedMigration}} </div>',this.TD_mustaches["login/migrate_risk_agreement.mustache"]='<div class="migrate-confirm-start bg-r-white txt-medium txt-on-r-white padding-axl"> <div class="js-migrate-multi-user-auth padding-axxl"> <div class="padding-axl cf"> <h1 class="txt-xxl txt-r-dark-red">{{_i}}Very important information if you share a TweetDeck account:{{/i}}</h1> </div> <p class="cf padding-axl"> {{_i}}Be aware that anyone else currently using this TweetDeck account will be {{>text/open_strong}}locked out{{>text/close_strong}} immediately. They will need to log in again using the same username and password {{>text/em}}you{{>text/close_em}} choose on the next screen.{{/i}} <a href="https://support.twitter.com/articles/20171367" rel="url" target="_blank">{{_i}}Read more about this process{{/i}}</a>. </p> <p class="cf padding-hxl padding-bxxl"> {{_i}}Have you prepared your team for this change?{{/i}} </p>  <div class="margin-hxl margin-vl txt-center"> <button class="js-migrate-cancel btn btn-positive txt-medium padding-al padding-hxl margin-rl bg-r-twitter-blue txt-on-r-twitter-blue align-top" tabindex="1">{{_i}}No{{/i}}</button> <button class="js-migrate-continue btn btn-positive txt-medium padding-al padding-hxl bg-r-twitter-blue txt-on-r-twitter-blue align-top" tabindex="1">{{_i}}Yes{{/i}}</button> </div> </div>  {{^withForcedMigration}} <div class="bg-r-white txt-on-r-white"> <a href="#" class="js-migrate-cancel inline-block margin-tl margin-rxxl" tabindex="2">{{_i}}Do it later{{/i}}</a> </div> {{/withForcedMigration}}  </div>',this.TD_mustaches["login/migrate_team_instructions.mustache"]='<div class="migration-v2 bg-r-white txt-medium txt-on-r-white padding-axl"> <div class="js-migrate-team-instruction padding-axxl">  <div class="padding-b--20"> <div class="obj-right position-rel"> <i class="icon icon-user-team-mgr txt-r-twitter-blue migrate-teams-icon"></i> </div> <div class="nbfc"> <h1 class="txt-size--24 txt-r-dark-red">{{_i}}Time to set up Teams.{{/i}}</h1> </div> </div>  <p class="padding-b--20">{{_i}}In order to use Teams, we’ll need to reconfigure your TweetDeck so you can log in with your own Twitter username and password. Any team members you have will also need to log in with their own Twitter username and password. Your team will temporarily lose access to the shared account, but only for a few minutes.{{/i}}</p>  <div class="margin-hxl margin-vl txt-center"> <button class="js-migrate-team-continue btn btn-positive migrate-action-button txt-medium padding-al margin-b--10 txt-on-r-twitter-blue obj-center" tabindex="1">{{_i}}Let\'s do this{{/i}}</button> </div> </div> {{^withForcedMigration}} <div class="bg-r-white txt-on-r-white"> <a href="#" class="js-migrate-cancel inline-block margin-tl margin-rxxl" tabindex="2">{{_i}}Do this later{{/i}}</a> </div> {{/withForcedMigration}} </div>',this.TD_mustaches["login/migrate_team_member.mustache"]='<div class="migration-v2 bg-r-white txt-medium txt-on-r-white padding-axl"> <div class="js-migrate-team-member padding-axxl">  <div class="padding-b--20"> <div class="obj-right position-rel"> <i class="icon icon-user-team-mgr pos-ab txt-r-twitter-blue migrate-teams-icon"></i> </div> <div class="nbfc"> <h1 class="txt-size--24 txt-r-dark-red"> {{^withForcedMigration}}{{_i}}Sit tight{{/i}}{{/withForcedMigration}} {{#withForcedMigration}}{{_i}}Log in with your {{>text/br}}Twitter account{{/i}} {{/withForcedMigration}}</h1> </div> </div>  {{^withForcedMigration}} <p class="padding-b--10">{{_i}}Before you can use TweetDeck Teams, your manager will need to log in and set it up. Then you\'ll be able to access the shared Twitter account(s) with your own Twitter username and password.{{/i}}</p> <p class="padding-b--20">{{_i}}We’ll send you an email when the team organizer gives you access.{{/i}}</p> {{/withForcedMigration}} {{#withForcedMigration}} <p class="padding-b--20">{{_i}}Before you can use TweetDeck Teams, you must log out of TweetDeck and log back in with your own Twitter username and password. Keep in mind that your team organizer needs to add you to their TweetDeck team before you’ll be able to use the shared Twitter account(s).{{/i}}</p> {{/withForcedMigration}}  <div class="margin-hxl margin-vl txt-center"> {{^withForcedMigration}} <button class="js-migrate-team-member-ok btn btn-positive migrate-action-button txt-medium padding-al margin-b--10 txt-on-r-twitter-blue obj-center" tabindex="1">{{_i}}Ok{{/i}}</button> {{/withForcedMigration}} {{#withForcedMigration}} <button class="js-migrate-team-member-logout btn btn-positive migrate-action-button txt-medium padding-al txt-on-r-twitter-blue obj-center" tabindex="1">{{_i}}Log out{{/i}}</button> {{/withForcedMigration}} </div> </div> </div>',this.TD_mustaches["login/migrate_tweetdeck_account_preview.mustache"]='{{#withNumericData}} <table> <tr> <td class="padding-rxl">{{_i}}TweetDeck columns{{/i}}</td><td class="padding-lxl"><strong>{{numColumns}}</strong></td> </tr> <tr> <td class="padding-rxl">{{_i}}Scheduled Tweets{{/i}}</td><td class="padding-lxl"><strong>{{numScheduled}}</strong></td> </tr> <tr> <td class="padding-rxl">{{_i}}Twitter accounts{{/i}}</td><td class="padding-lxl"><strong>{{numAccounts}}</strong></td> </tr> </table> {{/withNumericData}} <div class="migrate-tweetdeck-account-preview-twitter-accounts padding-tm nbfc"> {{#accounts}} <div class="migrate-tweetdeck-account-preview-twitter-account txt-regular"> <div class="item-box"> <div class="account-summary cf"> <img class="tweet-avatar avatar obj-left" src="{{avatar}}" width="48" height="48" alt="{{screenName}}\'s avatar"> <div class="nbfc-alt padding-tl"> <div class="nbfc"> <span class="block"> <b class="fullname link-complex-target txt-ellipsis">{{name}}</b> {{#isVerified}}<i class="js-show-tip sprite sprite-verified-mini" title="{{_i}}Verified account{{/i}}"></i>{{/isVerified}} </span> <span class="username block txt-ellipsis txt-mute"> @{{screenName}} </span> </div> </div> </div> </div> </div> {{/accounts}} </div>',this.TD_mustaches["login/migrate_tweetdeck_account_preview_bad_password.mustache"]='<div class="form-message form-error-message error txt-center padding-axl txt-medium"> {{_i}}We could not sign you in with this password.{{/i}} </div> <div class="txt-center margin-txl"> <a href="#" class="js-migrate-account-login-forms-restart">{{_i}}Try again{{/i}}</a> </div>',this.TD_mustaches["login/migrate_tweetdeck_account_preview_error.mustache"]='<div class="form-message form-error-message error txt-center padding-axl txt-medium"> {{_i}}Sorry, something went wrong.{{/i}} <br> {{_i}}Please try again later.{{/i}} </div> <div class="txt-center margin-txl"> <a href="#" class="js-migrate-account-login-forms-cancel">{{_i}}Return to login{{/i}}</a> </div>',this.TD_mustaches["login/migrate_tweetdeck_account_warning.mustache"]='{{#showNewProfiles}} <div class="migrate-warning-highlight"></div> {{^isMultiUser}} <p class="migrate-account-warning-user migrate-account-warning-single-user txt-center">{{_i}}This should be a Twitter account that nobody else can log in to (probably your personal Twitter account){{/i}}</p> {{/isMultiUser}} {{#isMultiUser}} <p class="migrate-account-warning-user migrate-account-warning-multi-user txt-center">{{_i}}Your team (and only your team) should have the password for this account{{/i}}</p> {{/isMultiUser}} {{/showNewProfiles}}   <div class="migrate-account-warning-preview"> {{#twitterProfile}} {{#showNewProfiles}} <p class="txt-center txt-large txt-weight-normal"> {{#isTeamOrganiser}} {{_i}}When you log in to TweetDeck as{{/i}} {{/isTeamOrganiser}} {{^isTeamOrganiser}} {{_i}}Anyone who logs in to TweetDeck as{{/i}} {{/isTeamOrganiser}} </p> {{/showNewProfiles}} {{^showNewProfiles}} <h1 class="txt-center padding-vl">{{_i}}After this, you will use this account to log in to TweetDeck{{/i}}</h1> {{/showNewProfiles}} <div class="migrate-account-warning-twitter-account item-box margin-vl"> <div class="account-summary cf"> <img class="tweet-avatar avatar obj-left" src="{{profileImageURL}}" width="48" height="48" alt="{{screenName}}\'s avatar"> <div class="nbfc-alt padding-tl"> <div class="nbfc"> <span class="block"> <b class="fullname link-complex-target txt-ellipsis">{{name}}</b> </span> <span class="username block txt-ellipsis txt-mute"> @{{screenName}} </span> </div> </div> </div> </div> {{/twitterProfile}}   {{#showNewProfiles}} <p class="txt-center txt-large txt-weight-normal"> {{#isTeamOrganiser}} {{_i}}You will be able to Tweet from and view Twitter as{{/i}} {{/isTeamOrganiser}} {{^isTeamOrganiser}} {{_i}}Will be able to Tweet from and view Twitter as{{/i}} {{/isTeamOrganiser}} </p> <div class="padding-bxl nbfc"> <div class="migrate-tweetdeck-account-preview-twitter-accounts padding-vm"> {{#newProfiles}} <div class="migrate-tweetdeck-account-preview-twitter-account txt-regular"> <div class="item-box"> <div class="account-summary cf"> <img class="tweet-avatar avatar obj-left" src="{{profileImageURL}}" width="48" height="48" alt="{{screenName}}\'s avatar"> <div class="nbfc-alt padding-tl"> <div class="nbfc"> <span class="block"> <b class="fullname link-complex-target txt-ellipsis">{{name}}</b> {{#isVerified}}<i class="js-show-tip sprite sprite-verified-mini" title="{{_i}}Verified account{{/i}}"></i>{{/isVerified}} </span> <span class="username block txt-ellipsis txt-mute"> @{{screenName}} </span> </div> </div> </div> </div> </div> {{/newProfiles}} </div> </div> {{/showNewProfiles}}  {{#showExistingProfiles}}{{! placeholder for if we bring existing accounts back }}{{/showExistingProfiles}} </div>  <div class="padding-vxl txt-center migrate-account-warning-preview"> <button class="js-migrate-cancel btn align-top txt-medium padding-al">{{_i}}Go back{{/i}}</button> <button class="js-migrate-continue btn btn-positive align-top txt-medium padding-al" tabindex="4">{{_i}}Make the switch{{/i}} <i class="icon icon-arrow-r icon-small-valigned"></i></button> </div>',this.TD_mustaches["login/migrate_tweetdeck_account_warning_error.mustache"]='<div class="migrate-account-warning-preview"> {{>login/migrate_tweetdeck_account_preview_error}} </div>',this.TD_mustaches["login/promo_for_login_form.mustache"]='<div class="app-info txt-large margin-txxl"> <div class="startflow-panel-rounded app-info-panel cf"> <img class="app-image pull-right" src="{{screenshot}}" alt="TweetDeck" width="402" height="248"> <div class="app-info-text pull-left"> <h1 class="app-info-title">TweetDeck</h1> <h2 class="app-info-byline txt-large margin-bl">by Twitter</h2> <p>{{_i}}The most powerful Twitter tool for real-time tracking, organizing, and engagement.{{/i}}</p> <p>{{_i}}Start Tweeting like a pro.{{/i}} <a href="https://about.twitter.com/products/tweetdeck" class="startflow-link" rel="url" target="_blank">{{_i}}Learn more{{/i}}</a>.</p> </div> <p class="app-info-signup">New to Twitter? <a href="https://twitter.com/signup" class="js-twitter-signup" rel="url" target="_blank">Sign up</a></p> </div> </div>',this.TD_mustaches["login/sole_user_question.mustache"]='{{< startflow_wrapper}} {{$content}} <div class="startflow-message-wrap"> <div class="startflow-panel"> <header class="startflow-msg-header txt-center padding-axl"> <b>{{_i}}Does anyone else use the @{{username}} Twitter account?{{/i}}</b> </header> <div class="padding-axl"> <div class="txt-center"> <button class="js-twogin-question-no-btn btn btn-positive btn-extra-padding align-top btn-txt-large margin-hl" tabindex="1">{{_i}}No, only me{{/i}}</button> <button class="js-twogin-question-yes-btn btn btn-positive btn btn-extra-padding align-top btn-txt-large" tabindex="2">{{_i}}Yes, me and others on my team{{/i}}</button> </div> </div> </div> </div> {{/content}} {{/startflow_wrapper}}',this.TD_mustaches["login/sole_user_signup_prompt.mustache"]='{{< startflow_wrapper}} {{$content}} <div class="startflow-message-wrap"> <div class="startflow-panel"> <header class="startflow-msg-warning txt-center padding-axl"> <b>{{_i}}You need your own account, but it&rsquo;s okay&hellip;{{/i}}</b> </header> <div class="padding-axl margin-hl padding-bs txt-weight-normal"> <p class="txt-large">{{_i}}You don&rsquo;t need to use your name.{{/i}}</p> <p class="txt-large">{{_i}}You don&rsquo;t need to use a photo of you.{{/i}}</p> <p class="txt-large">{{_i}}You don&rsquo;t even need to tweet.{{/i}}</p> <p class="txt-large">{{_i}}<strong>In fact, you&rsquo;ll only ever use it to log in to TweetDeck.</strong>{{/i}}</p> <div class="txt-center margin-vl"> <a href="https://twitter.com/signup" class="js-twogin-warning-logout-btn btn btn-positive btn-extra-padding align-top btn-txt-large" tabindex="1" target="_blank">{{_i}}Okay, I&rsquo;ll sign up{{/i}}</a> </div> </div> <p class="txt-center"><a class="js-twogin-warning-logout-btn startflow-link" href="#">{{_i}}Log in with your own Twitter account instead{{/i}}</a></p> </div> </div> {{/content}} {{/startflow_wrapper}}',this.TD_mustaches["login/sole_user_warning.mustache"]='{{< startflow_wrapper}} {{$content}} <div class="startflow-message-wrap"> <div class="startflow-panel"> <header class="startflow-msg-warning txt-center padding-axl"> <b>{{_i}}Account security{{/i}}</b> </header> <div class="padding-axl margin-hl txt-weight-normal"> <p class="txt-large">{{_i}}For your security, it is essential that you log in to TweetDeck using a Twitter account that <strong>only you</strong> have the password for.{{/i}}</p> <p class="txt-large">{{_i}}Once you&rsquo;ve logged in with your own Twitter account, you&rsquo;ll be able to connect other accounts (including @{{username}}) using TweetDeck&rsquo;s multi-account support.{{/i}}</p> <div class="txt-center margin-vl"> <button class="js-twogin-warning-logout-btn btn btn-positive btn-extra-padding align-top btn-txt-large" tabindex="1">{{_i}}Thanks, I&rsquo;ll log in with my own Twitter account{{/i}}</button> </div> <p class="txt-center">{{_i}}Don&rsquo;t have your own Twitter account? &nbsp; <a class="js-twogin-warning-logout-btn startflow-link" href="https://twitter.com/signup" target="_blank">Sign up</a> &middot; <a href="#" class="js-twogin-show-signup-prompt startflow-link">Don&rsquo;t want one?</a>{{/i}}</p> </div> <button class="js-twogin-warning-login-anyway-btn padding-al btn full-width">{{_i}}Disregard this security warning and log in with @{{username}} anyway (not recommended){{/i}}</button> </div> </div> {{/content}} {{/startflow_wrapper}}',
this.TD_mustaches["login/tweetdeck_account_login_form.mustache"]='{{#withToggleLoginType}} <p class="toggle-login-type txt-right padding-vxl">{{_i}}Don\'t have a TweetDeck account?{{/i}}<br /><a class="js-toggle-login-type startflow-link-on-background link-underline" href="#" tabindex="7">{{_i}}Log in with your Twitter account{{/i}}</a></p> {{/withToggleLoginType}}  <form class="js-login-form form-login startflow-panel-rounded margin-vl" data-auth-type="tweetdeck"> <legend class="form-legend padding-axl {{tweetdeckLoginLegendClasses}}"> {{tweetdeckLoginLegend}} {{^tweetdeckLoginLegend}} {{_i}}Log in with your TweetDeck account{{/i}} {{/tweetdeckLoginLegend}} </legend> <fieldset class="padding-axl"> {{> login/login_form_message}} <input class="js-login-username with-emphasis margin-bl form-login-email {{#withFixedTweetdeckLoginUsername}}is-disabled{{/withFixedTweetdeckLoginUsername}}" {{#withFixedTweetdeckLoginUsername}}disabled{{/withFixedTweetdeckLoginUsername}} type="text" name="username" value="{{username}}{{tweetdeckLoginUsername}}" placeholder="Email address" autofocus required tabindex="1" /> <input class="js-login-password form-login-pwd with-emphasis margin-bl margin-txs" type="password" name="password" placeholder="TweetDeck password" required tabindex="2" /> {{> login/login_form_footer}} </fieldset> </form>',this.TD_mustaches["login/tweetdeck_signin.mustache"]='<p class="txt-right">{{_i}}New to TweetDeck?{{/i}}<br /><a class="js-return-tweeteck-login" href="#" tabindex="6">{{_i}}Create an account xxxx{{/i}}</a></p>  <form class="js-tweetdeck-login-form form-login startflow-panel margin-vl"> <legend class="form-legend padding-vl" ><b>{{_i}}Log in with your TweetDeck account{{/i}}</b></legend> <fieldset class="padding-axl"> <div class="js-tweetdeck-error-message form-error-message error txt-center padding-al margin-bxl is-hidden"> <p>Wrong username and password combination</p> <p></p> </div> <input class="js-tweetdeck-username margin-bl form-login-email" type="text" name="email" placeholder="example@domain.com" autofocus required tabindex="1"> <input class="js-tweetdeck-password form-login-pwd margin-bl" type="password" name="password" placeholder="TweetDeck password" required tabindex="2"> <button type="submit" class="btn btn-positive align-top" tabindex="4">{{_i}}Log in{{/i}}</button> <div class="cf"> <label class="checkbox inline-block align-middle margin-bn"> <input type="checkbox" tabindex="3">{{_i}}Remember me{{/i}} </label> &nbsp;&middot;&nbsp; <a href="#" class="align-middle txt-small">{{_i}}Forgot password?{{/i}}</a> </div> </fieldset> </form>',this.TD_mustaches["login/twitter_account_login_form.mustache"]='{{#withToggleLoginType}} <p class="toggle-login-type txt-right padding-vxl">{{_i}}TweetDeck old timer?{{/i}}<br /><a class="js-toggle-login-type startflow-link-on-background link-underline" href="#" tabindex="7">{{_i}}Log in with your TweetDeck account{{/i}}</a></p> {{/withToggleLoginType}}  <form class="js-login-form form-login startflow-panel-rounded margin-vl" data-auth-type="twitter"> <legend class="form-legend padding-axl {{twitterLoginLegendClasses}}"> {{twitterLoginLegend}} {{^twitterLoginLegend}} {{_i}}Log in with your Twitter account{{/i}} {{/twitterLoginLegend}} </legend> {{#withToggleLoginType}} <div class="padding-hxl padding-tl yellow-highlight"> <div class="padding-tm padding-ll padding-bl"> <h2 class="margin-bs">Used TweetDeck before December 2013?</h2> <p><a href="#" class="js-toggle-login-type">Click here</a> to log in with your TweetDeck account for your existing columns and setup.</p> </div> </div> {{/withToggleLoginType}} {{#withWarning}} <div class="margin-hxl margin-txl padding-al"> <div class="nbfc txt-r-dark-red"> {{#withMultiUserWarning}} <ol> <li class="margin-bm">{{_i}}1. Choose a Twitter account that everyone on your team can log in to. You should avoid using your personal account.{{/i}}</li> <li>{{_i}}2. You may wish to set up a Twitter account solely to be used for logging in to TweetDeck.{{/i}} <a class="startflow-link" rel="url" target="_blank" href="https://twitter.com/signup">{{_i}}Go set one up now.{{/i}}</a> </li> </ol> {{/withMultiUserWarning}} {{#withSingleUserWarning}} {{_i}}Choose a Twitter account only you know the password for (for example your personal account).{{/i}} {{/withSingleUserWarning}} {{#withTeamOrganiserWarning}} <p class="margin-bm">{{_i}}Choose a Twitter account only you know the password for (for example your personal account).{{/i}}</p> <p>{{_i}}You\'ll set your team up in a minute.{{/i}}</p> {{/withTeamOrganiserWarning}} </div> </div> {{/withWarning}} <fieldset class="padding-axl"> {{> login/login_form_message}} <div class="input-prepend"> <span class="add-on with-emphasis"><i class="icon icon-mention form-login-mention"></i></span> <input class="js-login-username with-emphasis margin-bl form-login-username" type="text" name="username" value="{{username}}{{twitterLoginUsername}}" placeholder="Twitter username" required tabindex="1" /> </div> <input class="js-login-password with-emphasis form-login-pwd margin-bl margin-txs" type="password" name="password" placeholder="Twitter password" required tabindex="2" /> {{> login/login_form_footer}} </fieldset> </form>',this.TD_mustaches["media/animated_gif.mustache"]='<video class="js-media-gif full-width {{#isPossiblySensitive}}is-invisible{{/isPossiblySensitive}}" autoplay loop src="{{src}}"> <source video-src="{{src}}" type="{{contentType}}" src="{{src}}"> </video>',this.TD_mustaches["media/media_gallery.mustache"]='<div class="js-mediatable ovl-block is-inverted-light"> <div class="s-padded"> <div class="js-modal-panel mdl s-full med-fullpanel"> <a href="#" class="mdl-dismiss js-dismiss mdl-dismiss-media" rel="dismiss"><i class="icon icon-close"></i></a> <div class="js-embeditem med-embeditem"> <a href="#" id="media-gallery-prev" class="btn-media prev is-hidden"> <i class="icn-button-prev"></i> </a> <a href="#" id="media-gallery-next" class="btn-media next is-hidden"> <i class="icn-button-next"></i> </a> <div class="l-table"> <div class="l-cell"> <div class="med-tray js-mediaembed"></div> </div> </div> </div> <div id="media-gallery-tray"></div> <div class="js-med-tweet med-tweet"></div> </div> </div> </div>',this.TD_mustaches["media/native_video.mustache"]='<div class="position-rel"> <iframe src="https://amp.twimg.com/amplify-web-player/prod/source.html?image_src={{imageSrc}}&amp;media_id={{mediaId}}&amp;video_url={{videoUrl}}&amp;content_type={{contentType}}&amp;owner_id={{ownerId}}&amp;auto_buffer=1&amp;autoplay={{autoplay}}" class="js-media-native-video {{#isPossiblySensitive}}is-invisible{{/isPossiblySensitive}}" height="{{height}}" width="{{width}}" frameborder="0" scrolling="no" allowfullscreen style="margin: 0px; padding: 0px; border: 0px;"> </iframe> {{> status/media_sensitive}} </div>',this.TD_mustaches["media/vine.mustache"]='<iframe class="vine-player" width="{{width}}" height="{{height}}" src="https://vine.co/v/{{id}}/card" frameborder="0"> </iframe>',this.TD_mustaches["media/youtube.mustache"]='<iframe class="youtube-player" type="text/html" width="{{width}}" height="{{height}}" src="https://www.youtube.com/embed/{{id}}?autoplay={{autoplay}}{{#startTime}}&start={{startTime}}{{/startTime}}" allowfullscreen frameborder="0"> </iframe>',this.TD_mustaches["menus/accordion_header.mustache"]='<div class="js-accordion-toggle-view accordion-header is-actionable link-clean block cf txt-base-medium"> <div class="obj-left facet-title"> <i class="icon {{iconClass}} facet-type-icon"></i> <span class="txt-base-small">{{title}}</span> </div> <i class="icon icon-arrow-d pull-right txt-base-smallest"></i> <i class="icon icon-arrow-u pull-right txt-base-smallest"></i> <div class="{{jsClass}} facet-subtitle nbfc"> {{summaryText}} </div> </div>',this.TD_mustaches["menus/actions.mustache"]='<ul> {{#user}} <li class="is-selectable"><a href="#" data-action="mention">{{_i}}Tweet to @{{screenName}}{{/i}}</a></li> {{> menus/follow_menuitem }} {{#showFavorite}} <li class="is-selectable"><a href="#" data-action="favoriteOrUnfavorite">{{_i}}Favorite from accounts…{{/i}}</a></li> {{/showFavorite}}  <li class="is-selectable"><a href="#" data-action="message">{{_i}}Send a Direct Message{{/i}}</a></li> <li class="is-selectable"><a href="#" data-action="lists">{{_i}}Add or remove from lists…{{/i}}</a></li> {{#chirp}}{{#user}}{{^isProtected}} <li class="feature-customtimelines is-selectable"><a href="#" data-action="customtimelines">{{_i}}Add to collection…{{/i}}</a></li> {{/isProtected}}{{/user}}{{/chirp}} {{^isMe}} <li class="drp-h-divider"></li> {{#chirp}} {{#hasMedia}} <li class="is-selectable"> <a class="js-flag-media-link {{#isFlagged}}is-hidden{{/isFlagged}}" href="#" data-action="flag-media">{{_i}}Flag media{{/i}}</a> <a class="js-flag-more-info-link {{^isFlagged}}is-hidden{{/isFlagged}}" href="https://support.twitter.com/articles/20069937" data-action target="_blank" rel="url">{{_i}}Flagged (learn more){{/i}}</a> </li> {{/hasMedia}} {{/chirp}} {{^userIsMuted}} <li class="is-selectable"><a href="#" data-action="mute">{{_i}}Mute @{{screenName}} in TweetDeck{{/i}}</a></li> {{/userIsMuted}} <li class="is-selectable"><a href="#" data-action="block">{{_i}}Block @{{screenName}}{{/i}}</a></li> {{#chirp}} <li class="is-selectable"><a href="#" data-action="report-tweet">{{_i}}Report Tweet{{/i}}</a></li> {{/chirp}} {{^chirp}} <li class="is-selectable"><a href="#" class="txt-ellipsis" data-action="report-spam">{{_i}}Report @{{screenName}} for spam{{/i}}</a></li> {{/chirp}} {{/isMe}} {{/user}}   {{#chirp}} {{#user}}{{^isProtected}} <li class="drp-h-divider"></li> <li class="is-selectable"><a href="#" data-action="message-to">{{_i}}Share via Direct Message{{/i}}</a></li> <li class="is-selectable"><a href="#" data-action="email">{{_i}}Share via Email{{/i}}</a></li> <li class="is-selectable"><a href="#" data-action="embed">{{_i}}Embed this Tweet{{/i}}</a></li> <li class="is-selectable"><a href="#" data-action="reference-to">{{_i}}Link to this Tweet{{/i}}</a></li> {{/isProtected}}{{/user}} {{#isTranslatable}} <li class="is-selectable"><a href="#" data-action="translate">{{_i}}Translate this Tweet{{/i}}</a></li> {{/isTranslatable}} {{#isRetweeted}} <li class="drp-h-divider"></li> <li class="is-selectable"><a href="#" data-action="undo-retweet">{{_i}}Undo Retweet{{/i}}</a></li> {{/isRetweeted}} {{#isOwnChirp}} {{^isRetweeted}} <li class="drp-h-divider"></li> <li class="is-selectable"><a href="#" data-action="destroy">{{_i}}Delete{{/i}}</a></li> {{/isRetweeted}} {{/isOwnChirp}} {{/chirp}} </ul>',this.TD_mustaches["menus/actions_directmessage.mustache"]='<ul> {{#user}} {{> menus/follow_menuitem }} <li class="is-selectable"><a href="#" data-action="lists">{{_i}}Add or remove from lists…{{/i}}</a></li> {{^isMe}} <li class="drp-h-divider"></li> {{^userIsMuted}} <li class="is-selectable"><a href="#" data-action="mute">{{_i}}Mute @{{screenName}} in TweetDeck{{/i}}</a></li> {{/userIsMuted}} <li class="is-selectable"><a href="#" data-action="block">{{_i}}Block @{{screenName}}{{/i}}</a></li> <li class="is-selectable"><a href="#" data-action="report-tweet">{{_i}}Mark + delete message{{/i}}</a></li> {{/isMe}} {{/user}}  {{#chirp}} <li class="drp-h-divider"></li> <li class="is-selectable"><a href="#" data-action="destroy">{{_i}}Delete{{/i}}</a></li> {{/chirp}} </ul>',this.TD_mustaches["menus/column_nav_menu.mustache"]='<div class="js-column-nav-list"> <ul class="js-int-scroller"> {{#columns}} <li class="js-column-nav-menu-item column-nav-item {{#isNew}}is-new{{/isNew}} {{#customTimelineId}}js-droptarget{{/customTimelineId}}" data-column="{{key}}" data-customtimeline-id="{{customTimelineId}}" data-customtimeline-account="{{customTimelineAccount}}" > <i class="icon icon-xsmall icon-dot column-nav-updates"></i> <a class="js-header-action js-drag-handle drag-handle link-clean cf padding-hl column-nav-link" data-action="jumpto" data-column="{{key}}"> <div class="obj-left"> <i class="icon {{iconclass}} icon-large position-rel" data-action="drag"> {{#isMessageColumn}} <span class="js-unread-count msg-unread-count txt-base-small numbered-badge numbered-badge-onnav anim anim-slower {{#unreadCount}}is-visible{{/unreadCount}}">{{unreadCount}}</span> {{/isMessageColumn}} </i> </div> <div class="js-column-title nbfc hide-condensed">{{{title}}}</div> </a> </li> {{/columns}} </ul> <a class="js-header-action js-header-add-column link-clean cf app-nav-link padding-hl margin-tm with-nav-border-t" data-action="add-column" data-title="{{_i}}Add column{{/i}}"> <div class="obj-left"> <i class="icon icon-plus icon-large"></i> </div> <div class="nbfc padding-ts hide-condensed">{{_i}}Add column{{/i}}</div> </a> </div>',this.TD_mustaches["menus/column_share.mustache"]='<ul class="dropdown-text-large"> {{#isEmbeddable}} <li class="is-selectable"> <a href="#" data-action="embed"> <i class="icon icon-dropdown-context icon-share margin-rs"></i> {{_i}}{{>text/open_strong}}Embed{{>text/close_strong}} timeline{{/i}} </a> </li> {{/isEmbeddable}} {{#isViewable}} <li class="is-selectable"> <a href="#" data-action="view-on-web"> <i class="icon icon-dropdown-context icon-twitter-bird margin-rs"></i> {{_i}}{{>text/open_strong}}View{{>text/close_strong}} on twitter.com{{/i}} </a> </li> {{/isViewable}} {{#isShareable}} <li class="is-selectable"> <a href="#" data-action="reference-to"> <i class="icon icon-dropdown-context icon-compose margin-rs"></i> {{_i}}{{>text/open_strong}}Tweet{{>text/close_strong}} about this timeline{{/i}} </a> </li> {{/isShareable}} </ul>',this.TD_mustaches["menus/dm_conversations_menu.mustache"]='<ul> {{#showAddUser}} <li class="is-selectable"><a href="#" data-action="view-people">{{_i}}Add / view people{{/i}}</a></li> {{/showAddUser}} {{^showAddUser}} <li class="is-selectable"><a href="#" data-action="view-people">{{_i}}View people{{/i}}</a></li> {{/showAddUser}} <li class="is-selectable"><a href="#" data-action="rename-conversation">{{_i}}Edit group name{{/i}}</a></li> <li class="is-selectable"><a href="#" data-action="notify-conversation"> {{^notificationsDisabled}}{{_i}}Turn off notifications{{/i}}{{/notificationsDisabled}} {{#notificationsDisabled}}{{_i}}Turn on notifications{{/i}}{{/notificationsDisabled}} </a></li> <li class="is-selectable"><a href="#" data-action="leave-conversation">{{_i}}Leave{{/i}}</a></li> </ul>',this.TD_mustaches["menus/dropdown.mustache"]='<div class="js-dropdown dropdown-menu {{position}}"> <div class="caret"> <span class="caret-outer"></span> <span class="caret-inner"></span> </div> <div class="js-dropdown-content"> </div> </div>',this.TD_mustaches["menus/flagged_media.mustache"]="",this.TD_mustaches["menus/follow_menuitem.mustache"]='{{#isSingleAccount}} {{^isMe}} {{#following}} <li class="is-selectable"><a href="#" data-action="unfollow">{{_i}}Unfollow @{{screenName}}{{/i}}</a></li> {{/following}} {{^following}} <li class="is-selectable"><a href="#" data-action="follow">{{_i}}Follow @{{screenName}}{{/i}}</a></li> {{/following}} {{/isMe}} {{/isSingleAccount}} {{^isSingleAccount}} <li class="is-selectable"><a href="#" data-action="followOrUnfollow">{{_i}}Follow from accounts…{{/i}}</a></li> {{/isSingleAccount}}',this.TD_mustaches["menus/search_accordion.mustache"]='{{#action}} <div class="js-accordion-item facet-type facet-type-action {{#isExpanded}}is-expanded is-active{{/isExpanded}}"> {{>menus/accordion_header}} <div class="js-action-filter js-accordion-panel accordion-panel"> </div> </div> {{/action}} {{#content}} <div class="js-accordion-item facet-type facet-type-content {{#isExpanded}}is-expanded is-active{{/isExpanded}}"> {{>menus/accordion_header}} <div class="js-content-filter js-accordion-panel accordion-panel"> </div> </div> {{/content}} {{#user}} <div class="js-accordion-item facet-type facet-type-user {{#isExpanded}}is-expanded is-active{{/isExpanded}}"> {{>menus/accordion_header}} <div class="js-user-filter js-accordion-panel accordion-panel"> </div> </div> {{/user}} {{#engagement}} <div class="js-accordion-item facet-type facet-type-engagement {{#isExpanded}}is-expanded is-active{{/isExpanded}}"> {{>menus/accordion_header}} <div class="js-engagement-filter js-accordion-panel accordion-panel"> </div> </div> {{/engagement}}',this.TD_mustaches["menus/search_action_form.mustache"]='<div class="padding-hl control-s"> <div class="control-group"> {{^isInActivityColumn}} <div class="controls"> <label class="txt-mute"> <input class="js-show-mentions" type="checkbox" value="mentions" {{#showMentions}}checked="checked"{{/showMentions}} /> <i class="icon icon-small-valigned icon-mention icon-mention-color"></i> {{_i}}Mentions{{/i}} </label> </div> <div class="controls"> <label class="txt-mute"> <input class="js-show-retweets" type="checkbox" value="retweets" {{#showRetweets}}checked="checked"{{/showRetweets}} /> <i class="icon icon-small-valigned icon-retweet txt-r-medium-green"></i> {{_i}}Retweets{{/i}} </label> </div> {{/isInActivityColumn}} <div class="controls"> <label class="txt-mute"> <input class="js-show-favorites" type="checkbox" value="favorites" {{#showFavorites}}checked="checked"{{/showFavorites}} /> <i class="icon icon-small-valigned icon-favorite txt-r-deep-yellow"></i> {{_i}}Favorites{{/i}} </label> </div> <div class="controls"> <label class="txt-mute"> <input class="js-show-followers" type="checkbox" value="followers" {{#showFollowers}}checked="checked"{{/showFollowers}} /> <i class="icon icon-small-valigned icon-follow icon-follow-color"></i> {{_i}}Followers{{/i}} </label> </div> <div class="controls"> <label class="txt-mute"> <input class="js-show-lists" type="checkbox" value="lists" {{#showLists}}checked="checked"{{/showLists}} /> <i class="icon icon-small-valigned icon-list icon-list-color"></i> {{_i}}Lists{{/i}} </label> </div> </div> <div class="js-action-filter-error txt-center srt-error-msg margin-bm {{^showError}}is-hidden{{/showError}}"> {{_i}}Please select at least one interaction type{{/i}} </div> </div>',this.TD_mustaches["menus/search_content_form.mustache"]='<div class="padding-hl control-s"> {{#withContentType}} <div class="control-group"> <label class="control-label txt-mute">{{_i}}Showing{{/i}}</label> <div class="controls"> <select class="js-containing" data-title="containing"> {{#containingOptions}} {{^hidden}} <option value="{{value}}">{{title}}</option> {{/hidden}} {{/containingOptions}} </select> </div> </div> {{/withContentType}} {{#withMatching}} <div class="control-group"> <label class="control-label txt-mute">{{_i}}matching{{/i}}</label> {{>search_input}} </div> {{/withMatching}} {{#withExcluding}} <div class="control-group"> <label class="control-label txt-mute">{{_i}}excluding{{/i}}</label> {{>search_input}} </div> {{/withExcluding}} {{#withLanguage}} <div class="control-group"> <label class="control-label txt-mute">{{_i}}written in{{/i}}</label> <div class="controls"> <select class="js-written-in" data-title="written_in"> <option value="any" >{{_i}}any language{{/i}}</option> <option value="0" disabled="disabled">---</option>  {{#userLanguage}} <option value="{{code}}">{{name}}</option> <option value="0" disabled="disabled">---</option> {{/userLanguage}}  {{#allLanguages}} <option value="{{code}}">{{localized_name}} ({{name}})</option> {{/allLanguages}} </select> </div> </div> {{/withLanguage}} {{#withRetweetsToggle}} <div class="control-group"> <label class="control-label txt-mute">{{_i}}retweets{{/i}}</label> <div class="controls"> <select class="js-retweets" data-title="retweets"> {{#retweetOptions}} <option value="{{value}}">{{title}}</option> {{/retweetOptions}} </select> </div> </div> {{/withRetweetsToggle}} </div>',this.TD_mustaches["menus/search_engagement_form.mustache"]='<div class="padding-hl control-m"> <div class="control-group"> <label> <div class="control-label">{{_i}}At least{{/i}}</div> <div class="controls"> <input type="text" data-title="retweets" class="js-min-retweets frm-input-3-digit" value="{{minRetweets}}" inputmode="numeric" /> <i class="icon icon-small-valigned icon-retweet"></i> {{_i}}retweets{{/i}} </div> </label> <label> <div class="control-label">{{_i}}at least{{/i}}</div> <div class="controls"> <input type="text" data-title="favorites" class="js-min-favorites frm-input-3-digit" value="{{minFavorites}}" inputmode="numeric" /> <i class="icon icon-small-valigned icon-favorite"></i> {{_i}}favorites{{/i}} </div> </label> <label> <div class="control-label">{{_i}}and at least{{/i}}</div> <div class="controls"> <input type="text" data-title="replies" class="js-min-replies frm-input-3-digit" value="{{minReplies}}" inputmode="numeric" /> <i class="icon icon-small-valigned icon-mention"></i> {{_i}}replies{{/i}} </div> </label> </div> </div>',this.TD_mustaches["menus/search_user_form.mustache"]='<div class="padding-hl control-s"> <div class="control-group"> <label class="control-label txt-mute">{{_i}}By{{/i}}</label> <div class="controls"> <select class="js-tweets-from" data-title="tweets_from"> {{#tweetsFromOptions}} <option value="{{value}}">{{title}}</option> {{/tweetsFromOptions}} </select> </div> <div class="controls"> {{#tweetsFromUser}} {{>search_input}} {{/tweetsFromUser}} {{#tweetsFromList}} {{>search_input}} {{/tweetsFromList}} <select class="js-tweets-from-me margin-txs" data-title="from_me"> {{#myAccounts}} <option value="{{value}}" {{#isDefault}}selected="selected"{{/isDefault}}>{{title}}</option> {{/myAccounts}} </select> </div> </div> <div class="control-group"> <label class="control-label txt-mute">{{_i}}mentioning{{/i}}</label> <div class="controls"> <select class="js-mentioning" data-title="mentioning"> {{#mentioningOptions}} <option value="{{value}}">{{title}}</option> {{/mentioningOptions}} </select> </div> <div class="controls"> {{#mentioningUser}} {{>search_input}} {{/mentioningUser}} <select class="js-mentioning-me margin-txs" data-title="mentioning_me"> {{#myAccounts}} <option value="{{value}}" {{#isDefault}}selected="selected"{{/isDefault}}>{{title}}</option> {{/myAccounts}} </select> </div> </div> </div>',this.TD_mustaches["menus/toggle_button.mustache"]='<div class="button-group button-group-toggle"> {{#buttons}} <button class="js-toggle-button btn {{class}} {{#selected}}is-selected{{/selected}}" data-clickevent="{{clickEvent}}"><span>{{label}}</span></button> {{/buttons}} </div>',this.TD_mustaches["menus/topbar_menu.mustache"]='<ul> <li><b class="non-selectable-item txt-ellipsis"> {{#isTwoginUser}}@{{/isTwoginUser}}{{account}} </b></li> <li class="drp-h-divider"></li> {{#debug}} <li class="is-selectable"> <a href="#" data-action="fileabug">Report a bug</a> </li> <li class="drp-h-divider"></li> <li class="is-selectable"> <a href="#" data-action="do_debug" data-type="ueberpull">&Uuml;berpull</a> </li> <li class="is-selectable"> <a href="#" data-action="do_debug" data-type="flushreload">Reset + Reload</a> </li> <li class="is-selectable"> <a href="#" data-action="do_debug" data-type="dumptrace">Dump Trace Info</a> </li> <li class="is-selectable"> <a href="#" data-action="do_debug" data-type="cleartrace">Flush Trace Info</a> </li> <li class="drp-h-divider"></li> {{/debug}} {{^isTouchDevice}} <li class="is-selectable"> <a href="#" data-action="keyboardShortcutList">{{_i}}Keyboard shortcuts{{/i}}</a> </li> {{/isTouchDevice}} <li class="is-selectable"> <a href="#" data-action="globalSettings">{{_i}}Settings{{/i}}</a> </li> <li class="drp-h-divider"></li> {{#withStartMigrate}} <li class="is-selectable"> <a href="#" data-action="migrate">{{_i}}Start using Twitter login{{/i}}</a> </li> <li class="drp-h-divider"></li> {{/withStartMigrate}} <li class="is-selectable"> <a href="#" data-action="signOut">{{_i}}Sign Out{{/i}}</a> </li> </ul>',this.TD_mustaches["menus/user_results.mustache"]='<div class="js-dropdown-container scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt column-scroller column-background-fill margin-bs"> {{#users}} {{<stream_item}} {{$content}} {{> account_summary }} {{/content}} {{/stream_item}} {{/users}} </div>',this.TD_mustaches["modal.mustache"]='<div class="js-modal-panel mdl s-tall-fixed is-inverted-dark {{$modal_class}}{{/modal_class}} {{#loading}}is-loading{{/loading}}"> {{#loading}} <img src="{{#asset}}/web/assets/global/backgrounds/spinner_large_white.gif{{/asset}}" alt="{{_i}}Loading…{{/i}}" /> {{/loading}}  {{^loading}} {{> modal_header}} <div class="mdl-inner"> <div class="mdl-content js-mdl-content {{^no_horiz_flow_container}}horizontal-flow-container{{/no_horiz_flow_container}}"> {{$content}}default content{{/content}} </div> <footer class="mdl-buttonbar"> {{$footer_content}}{{/footer_content}} </footer> </div> {{/loading}} </div>',this.TD_mustaches["modal/modal_context.mustache"]='<div class="js-modal-context {{#withClickTrap}}js-click-trap{{/withClickTrap}} overlay overlay-super scroll-v"> <div class="js-modal-inner mdl s-fluid"> {{#withHeader}} {{> modal/modal_context_header}} {{/withHeader}}  {{#withDragHandle}} <a href="#" class="js-drag-handle mdl-drag-handle"><i class="sprite sprite-drag"></i></a> {{/withDragHandle}}  {{#withDismissButton}} <a href="#" class="js-dismiss mdl-dismiss link-normal-dark"><i class="icon icon-close"></i></a> {{/withDismissButton}}  <div class="js-modal-content modal-content {{#withBorder}}modal-content-with-border{{/withBorder}} position-rel {{#withChrome}}padding-hxl{{/withChrome}}"></div>  {{#withFooter}} {{> modal/modal_context_footer}} {{/withFooter}} </div> </div>',this.TD_mustaches["modal/modal_context_footer.mustache"]='<footer class="padding-axl no-collapse {{#withCenteredFooter}}txt-center{{/withCenteredFooter}}"> {{#withDoneButton}} <button class="js-dismiss btn btn-positive"> <i class="icon icon-check icon-small padding-rs"></i> <span class="label">{{_i}}Done{{/i}}</span> </button> {{/withDoneButton}} </footer>',this.TD_mustaches["modal/modal_context_header.mustache"]='<header class="padding-axl no-collapse"> {{#title}} <h3 class="mdl-header-title">{{title}}</h3> {{/title}} </header>',this.TD_mustaches["modal_header.mustache"]='<header class="js-mdl-header mdl-header"> <h3 class="mdl-header-title js-header-title"></h3> <a href="#" class="mdl-drag-handle js-drag-handle"><i class="sprite sprite-drag"></i></a> <a href="#" class="mdl-dismiss js-dismiss link-normal-dark"><i class="{{$close_class}}icon icon-close{{/close_class}}"></i></a> </header>',this.TD_mustaches["open_column_footer.mustache"]='<button class="js-back btn btn-back">&larr; {{_i}}Back{{/i}}</button> <span class="pull-right"> <button class="js-add-column btn btn-positive"><i class="add"></i>{{_i}}Add Column{{/i}}</button> </span>',this.TD_mustaches["open_column_home.mustache"]='<ul class="lst-launcher cf"> {{#options}} <li class="js-item-launch {{class}} {{#isDisabled}}is-disabled{{/isDisabled}} {{#isHidden}}is-hidden{{/isHidden}}" data-type="{{type}}"> <a href="#" class="btn" {{#isDisabled}}disabled="disabled"{{/isDisabled}}> <i class="pull-left margin-rs column-type-icon icon {{columnIconClass}}"></i> <span>{{title}}</span> {{#attribution}} <span class="attribution">{{attribution}}</span> {{/attribution}} </a> </li> {{/options}} </ul>',this.TD_mustaches["open_column_list_group.mustache"]='{{#title}}<h3 class="js-title">{{title}}</h3>{{/title}} <ul class="js-list-container {{className}}"></ul>',this.TD_mustaches["open_column_list_multi_group.mustache"]='<div class="lst-group"> {{#groups}} {{>open_column_list_group}} {{/groups}} </div>',this.TD_mustaches["open_column_list_with_header.mustache"]='<div class="lst-group"> {{>open_column_list_group}} </div>',this.TD_mustaches["open_column_modal.mustache"]='<div class="js-modal-panel mdl s-tall-fixed "> {{> modal_header}} <div class="mdl-inner"> <div class="mdl-content js-mdl-content"> </div> <footer class="mdl-buttonbar"> </footer> </div> </div>',this.TD_mustaches["open_column_shared_help.mustache"]='<div class="l-table"> <div class="l-cell padding-axl font-size-largest"> Someone shared a column with you. You can add a copy of this column to your TweetDeck. </div> </div>',this.TD_mustaches["open_column_temp_help.mustache"]='<div class="l-table"> <div class="l-cell mdl-placeholder"> <p>{{helpText}}</p> </div> </div>',this.TD_mustaches["open_split_menu.mustache"]='<div class="l-column mdl-column mdl-column-med"> <div class="js-left-pinned pin-top"></div> <div class="l-column-scrollv scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt js-left-column"></div> </div> <div class="l-column mdl-column mdl-column-med mdl-column-rhs"> <div class="js-right-column scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt l-fullheight"></div> </div>',this.TD_mustaches["overlay.mustache"]='<div class="overlay is-hidden"></div>',this.TD_mustaches["participants_tooltip.mustache"]='<div class="js-tooltip margin-b--5 padding-h--5"> {{#title}}<b class="txt-base-medium block padding-v--10 conversation-tooltip-title">{{{title}}}</b>{{/title}} {{#participants}} <p class="txt-left txt-ellipsis padding-v--3"> <b class="txt-base-medium">{{name}}</b> <span class="txt-base-small">@{{screenName}}</span> </p> {{/participants}} </div>',this.TD_mustaches["popover.mustache"]='<div class="js-popover popover is-hidden is-inverted-dark"> <div class="caret"> <span class="caret-outer"></span> <span class="caret-inner"></span> </div> <div class="js-popover-content scroll-none"></div> </div>',this.TD_mustaches["profile/profile_full.mustache"]='<div class="media-item profile-bg-strip" style="background-image: url({{profileBannerURL}})"></div>  <div class="profile-full padding-hxl padding-bl"> <div class="profile-full-header cf pin-top-only"> <a class="prf-img profile-full-avatar obj-left link-clean" href="{{getProfileURL}}" target="_blank" data-user-name="{{screenName}}" rel="user"> <img src="{{biggerProfileImageURL}}" class="avatar size48"> </a> <div class="nbfc"> <div class="profile-follow-button"> {{>follow_button}} </div> </div> </div>  <div class="{{#isBadged}}fullname-badged-container{{/isBadged}}"> <a href="{{getProfileURL}}" class="account-link link-complex" target="_blank" data-user-name="{{screenName}}" rel="user"> <b class="fullname txt-ellipsis inline-block link-complex-target {{#isBadged}}fullname-badged{{/isBadged}} {{#isTranslator}}badge-translator{{/isTranslator}} {{#isVerified}}badge-verified{{/isVerified}} position-rel txt-large"> {{name}} </b></a> </div> <div class=" txt-r-dark-gray"> <a href="{{getProfileURL}}" class="account-link link-complex" target="_blank" data-user-name="{{screenName}}" rel="user"> <span class="username txt-mute">@{{screenName}} {{#isProtected}}<i class="icon icon-protected icon-match-context icon-tt"></i>{{/isProtected}}</span> </a> </div>  <p class="profile-bio padding-tm padding-bs">{{{bio}}}</p>  <div class="padding-vm"> <a href="{{getFriendURL}}" rel="url" target="_blank" class="link-hover-override txt-uppercase txt-small txt-mute inline-block margin-rm" data-scribe-element="show_following">{{_i}}Following{{/i}}&nbsp;<b class="link-hover-target profile-full-bio-count">{{prettyFriendsCount}}</b></a> <a href="{{getFollowerURL}}" rel="url" target="_blank" class="link-hover-override txt-uppercase txt-small txt-mute inline-block" data-scribe-element="show_followers">{{_i}}Followers{{/i}}&nbsp;<b class="link-hover-target profile-full-bio-count">{{prettyFollowersCount}}</b></a> </div>  {{#location}}<p class="profile-location txt-ellipsis padding-ts"><i class="profile-icon icon icon-small-valigned icon-geo icon-tt"></i>&nbsp;{{location}}</p>{{/location}} {{#getDisplayURL}}<p class="profile-url txt-ellipsis padding-ts"><i class="profile-icon icon icon-small-valigned icon-link icon-tt"></i>&nbsp;<a href="{{url}}" class="prf-siteurl js-action-url" target="_blank" data-scribe-element="website">{{getDisplayURL}}</a></p> <p class="js-show-tip profile-joined-date padding-ts inline-block" data-original-title="{{prettyTimeDateJoinedDate}}"><i class="profile-icon icon icon-small-valigned icon-schedule icon-tt" ></i>&nbsp;{{_i}}Joined{{/i}}&nbsp;{{prettyJoinedDate}}</p>{{/getDisplayURL}} <p class="profile-media padding-ts"><i class="profile-icon icon icon-small-valigned icon-camera icon-tt"></i>&nbsp;<a href="{{getMediaURL}}" rel="search" data-search-term="{{getMediaSearchQuery}}" data-scribe-element="user_media">{{_i}}Photos &amp; videos{{/i}}</a></p> </div>',
this.TD_mustaches["profile_card_bio.mustache"]='<div class="prf-bio"> <p class="bio">{{{bio}}}</p> </div>',this.TD_mustaches["profile_card_stats.mustache"]='<div class="prf-meta cf"> <div class="prf-follow-state padding-al"> {{> follow_button}} </div> {{#profile}} <ul class="prf-stats"> <li> <a href="https://twitter.com/{{screenName}}" data-action="open" data-type="tweets" class="js-action-url" target="_blank"> {{_i}}Tweets{{/i}} <strong>{{prettyStatusesCount}}</strong> </a> </li> <li> <a href="{{getFriendURL}}" class="js-action-url" target="_blank"> {{_i}}Following{{/i}} <strong>{{prettyFriendsCount}}</strong> </a> </li> <li> <a href="{{getFollowerURL}}" class="js-action-url" target="_blank"> {{_i}}Followers{{/i}} <strong>{{prettyFollowersCount}}</strong> </a> </li> <li> <a href="{{getListedURL}}" class="js-action-url" target="_blank"> {{_i}}Listed{{/i}} <strong>{{prettyListedCount}}</strong> </a> </li> </ul> {{/profile}} </div>',this.TD_mustaches["report_message_options.mustache"]='{{< modal}} {{$modal_class}}mdl-report-spam-options s-fluid{{/modal_class}} {{$content}}  <fieldset> <legend>{{_i}}Mark + delete message{{/i}}</legend>  {{^showResult}} <ul class="padding-al"> <li class="padding-bl"> <p>{{_i}}Taking action here will permanently delete this message from @{{screenName}}.{{/i}}</p> </li> <li class="txt-center padding-vxl"> <button class="js-report-spam half-width btn btn-positive"></i>{{_i}}Report spam{{/i}}</button> </li> <li class="txt-center padding-vxl"> <button class="js-mark-abusive half-width btn btn-positive"></i>{{_i}}Mark as abusive{{/i}}</button> </li> </ul> {{/showResult}}  {{#showResult}} <div class="padding-al"> <p class="padding-bl">{{_i}}This message has been deleted.{{/i}}</p> <a href="https://support.twitter.com/articles/15794-online-abuse" target="_blank" rel="url"> {{_i}}Read more information about how to handle abusive users.{{/i}} </a> </div> {{/showResult}}  </fieldset> {{/content}}  {{$footer_content}} <div class="full-width txt-center"> {{^showResult}} <button class="js-dismiss btn">{{_i}}Cancel{{/i}}</button> {{/showResult}} {{#showResult}} <button class="js-dismiss btn">{{_i}}Close{{/i}}</button> {{/showResult}} </div> {{/footer_content}} {{/modal}}',this.TD_mustaches["report_tweet_options.mustache"]='{{< modal}} {{$modal_class}}js-report-tweet mdl-report-spam-options s-static{{/modal_class}} {{$content}}  <fieldset> <legend>{{_i}}Report Tweet options{{/i}}</legend>  <div class="padding-hl padding-tl"> <label class="radio margin-bl"> <input checked type="radio" name="report-options" value="spam" class="js-report-option"> <b class="txt-base-medium">{{_i}}Spam{{/i}}</b> <p>{{_i}}This Tweet may be spam or from a spam account{{/i}}</p> </label>  <label class="radio margin-bl"> <input type="radio" name="report-options" value="compromised" class="js-report-option"> <b class="txt-base-medium">{{_i}}Compromised{{/i}}</b> <p>{{_i}}This user may not be in control of their account{{/i}}</p> </label>  <label class="radio margin-bl"> <input type="radio" name="report-options" value="abusive" class="js-report-option"> <b class="txt-base-medium">{{_i}}Abusive{{/i}}</b> <p>{{_i}}This Tweet may be in violation of the <a href="https://support.twitter.com/articles/18311-the-twitter-rules" target="_blank">Twitter Rules</a>. In order to file a report, you must still choose and complete a form. Select this option to continue.{{/i}}</p> </label> </div> <div class="divider-bar"></div> <div class="padding-hl"> <label class="checkbox"> <input type="checkbox" name="report-block" value="block" class="js-report-block"> <b class="txt-base-medium">{{_i}}Block and unfollow{{/i}} @{{screenName}}</b> <p>Blocking will hide @{{screenName}} Tweets. Learn more about what <a href="https://support.twitter.com/articles/117063-blocking-people-on-twitter" target="_blank">blocking</a> means.</p> </label> </div>  </fieldset> {{/content}}  {{$footer_content}} <span class="pull-right"> <button class="js-report-submit btn btn-positive" disabled></i>{{_i}}Submit{{/i}}</button> </span> {{/footer_content}} {{/modal}}',this.TD_mustaches["report_tweet_options_abusive.mustache"]='{{< modal}} {{$modal_class}}mdl-report-spam-abusive s-nonav s-static{{/modal_class}} {{$content}}  <div class="padding-al"> <p>{{_i}}Please choose the topic that best defines your issue. Once you complete and the submit the form your report will be filed with Twitter.{{/i}}</p> <ul class="margin-tl padding-tl"> <li class="margin-bm"> <a href="https://support.twitter.com/forms/impersonation?reported_username={{screenName}}&amp;reported_tweet_id={{tweetId}}" target="_blank" data-scribe="impersonation" class="abuse-link">Impersonation</a> </li> <li class="margin-bm"> <a href="https://support.twitter.com/forms/trademark?reported_username={{screenName}}&amp;reported_tweet_id={{tweetId}}" target="_blank" data-scribe="trademarks" class="abuse-link">Trademarks</a> </li> <li class="margin-bm"> <a href="https://support.twitter.com/forms/abusiveuser?reported_username={{screenName}}&amp;reported_tweet_id={{tweetId}}" target="_blank" data-scribe="harassment" class="abuse-link">Harassment</a> </li> <li class="margin-bm"> <a href="https://support.twitter.com/forms/general?subtopic=self_harm&amp;reported_username={{screenName}}&amp;reported_tweet_id={{tweetId}}" target="_blank" data-scribe="report_self_harm" class="abuse-link">Report self harm</a> </li> <li class="margin-bm"> <a href="https://support.twitter.com/forms/ad?reported_username={{screenName}}&amp;reported_tweet_id={{tweetId}}" target="_blank" data-scribe="report_an_ad" class="abuse-link">Report an ad</a> </li> </ul> </div>  {{/content}} {{/modal}}',this.TD_mustaches["search/search_in_popover.mustache"]='<!-- app search --> <form class="js-search-form app-search app-search-in-popover margin-al"> <label class="is-vishidden">{{_i}}Search{{/i}}</label> {{>search_input}} </form> <!-- typeahead --> {{>typeahead/typeahead_dropdown}} <!-- search results --> {{>search/search_results}}',this.TD_mustaches["search/search_results.mustache"]='<div class="js-search-results-container is-hidden"> {{<with_fixed_header_and_footer}}  {{$header}} {{>search/search_results_header}} {{/header}}  {{$body}} <div class="js-tweet-results app-search-tweet-results"></div> <div class="js-user-results is-hidden"></div> {{/body}}  {{$footer}} {{>search/search_results_footer}} {{/footer}}  {{/with_fixed_header_and_footer}} </div>',this.TD_mustaches["search/search_results_footer.mustache"]='<div class="js-search-results-footer"> <button class="js-add-column btn btn-positive obj-center padding-vl">{{_i}}Add Column{{/i}}</button> </div>',this.TD_mustaches["search/search_results_header.mustache"]='<div class="js-search-results-header search-results {{#isTouchColumnOptions}}with-touch-txt-base{{/isTouchColumnOptions}}"> <div class="js-toggle padding-al"></div> <div class="js-search-filter js-accordion accordion accordion-divider-t"></div> </div>',this.TD_mustaches["search_input.mustache"]='<div class="js-search-input-control search-input-control {{searchInputControlClass}} {{#isControl}}controls{{/isControl}}"> <input type="text" class="{{searchInputClassName}} search-input" data-title="{{searchInputTitle}}" placeholder="{{searchInputPlaceholder}}" value="{{searchInputValue}}"> <a href="#" class="js-perform-search txt-base-medium search-input-perform-search" tabindex="-1"> <i class="icon icon-search icon-small"></i> </a> <a href="#" class="js-clear-search txt-base-medium search-input-clear-search" tabindex="-1"> <i class="icon icon-close icon-small"></i> </a> <span class="js-spinner txt-base-medium spinner-small spinner-small-trans search-input-spinner"></span> </div>',this.TD_mustaches["search_no_tweets_placeholder.mustache"]='<div class="list-placeholder l-table pin-all"> <div class="l-cell"> {{#isDropTarget}} <p><i class="icon icon-move icon-tb"></i> <span>{{_i}}Drag Tweets into this collection{{/i}}</span></p> {{/isDropTarget}} {{^isDropTarget}} <p>{{_i}}No recent Tweets.{{/i}}<br />{{_i}}New Tweets will appear here.{{/i}}</p> {{/isDropTarget}} </div>  {{#withAddByUrl}} <p class="pin-bottom txt-center">{{_i}}Or add by URL{{/i}}</p> {{/withAddByUrl}} </div>',this.TD_mustaches["search_no_users_placeholder.mustache"]='<div class="list-placeholder"> <p>{{_i}}No users found.{{/i}}</p> </div>',this.TD_mustaches["settings/account_settings.mustache"]='<div class="js-accounts-column-holder is-inverted-dark column-holder txt-base-medium"> <div class="js-account-manager-container column-panel border-box bg-r-light-gray">  <header class="drawer-header padding-lxl"> <h1 class="column-title"> <span class="drawer-header-title block drawer-column-header-title">{{_i}}Twitter accounts{{/i}}</span> </h1> <a class="js-drawer-close column-close-link txt-r-dark-gray" href="#" data-action="options"> <i class="icon icon-close icon-center-24"></i> </a> </header>  <div class="drawer-content pin-all scroll-v"> <div class="js-account-settings-accounts accordion"></div>  <div class="js-account-invited-accounts"></div>  <div class="padding-lxl padding-rxl padding-bxl padding-tn margin-txl position-rel"> <button class="js-account-action btn padding-vm btn-positive full-width btn-extra-height" data-action="add" data-service="twitter">{{_i}}Add another Twitter account{{/i}}</button> </div>  {{#withPasswordReset}} <p class="txt-center txt-small"> <a href="#" class="js-password-reset-link startflow-link">{{_i}}Reset TweetDeck password{{/i}}</a> </p> {{/withPasswordReset}} </div> </div>  <div class="js-contributor-manager-container column-panel border-box bg-r-light-gray"> <div class="drawer-header padding-lxl"> <h1 class="js-contributor-manager-back is-actionable txt-base-extra-large pull-left txt-weight-normal"> <span class="drawer-header-title block drawer-column-header-title"> <i class="icon icon-arrow-l icon-tt"></i> {{_i}}Manage team{{/i}} </span> </h1> <a class="js-drawer-close column-close-link txt-r-dark-gray" href="#"> <i class="icon icon-close icon-center-24"></i> </a> </div> <div class="js-contributor-manager contributor-manager drawer-content pin-all scroll-v"></div> </div> </div>',this.TD_mustaches["settings/account_settings_detail.mustache"]='<div class="padding-tm padding-hxl"> <div class="cf margin-bxl"> <ul class="account-stats"> <li class="pull-left margin-rxl"> <a class="js-account-profile-url txt-r-dark-gray" href="#" data-screen-name="{{screenName}}" rel="tweets"> <span class="txt-uppercase txt-base-smallest">{{_i}}Tweets{{/i}}</span> <span class="js-account-tweets-count block txt-base-largest txt-r-text-link" data-max-digits="4">0</span> </a> </li> <li class="pull-left margin-rxl"> <a class="js-account-friend-url txt-r-dark-gray" href="#" target="_blank"> <span class="txt-uppercase txt-base-smallest">{{_i}}Following{{/i}}</span> <span class="js-account-following-count block txt-base-largest txt-r-text-link" data-max-digits="4">0</span> </a> </li> <li class="pull-left"> <a class="js-account-follower-url txt-r-dark-gray" href="#" target="_blank"> <span class="txt-uppercase txt-base-smallest">{{_i}}Followers{{/i}}</span> <span class="js-account-followers-count block txt-base-largest txt-r-text-link" data-max-digits="4">0</span> </a> </li> </ul> </div>  {{^withoutLinks}} <a class="link-complex txt-medium block cf" data-user-name="{{screenName}}" href="#" rel="user"> <div class="obj-left"> <i class="icon icon-medium icon-user pull-right"></i> </div> <div class="link-complex-target txt-base-largest nbfcm padding-ts">{{_i}}Profile{{/i}}</div> </a>  <a class="js-account-action link-complex txt-medium margin-vm block cf" data-action="showLists" data-user-name="{{screenName}}" href="#"> <div class="obj-left"> <i class="icon icon-medium icon-list pull-right"></i> </div> <div class="link-complex-target txt-base-largest nbfcm padding-ts">{{_i}}Lists{{/i}}</div> </a>  <a class="js-account-action link-complex txt-medium margin-vm block cf" data-action="showCustomTimelines" data-user-name="{{screenName}}" href="#"> <div class="obj-left"> <i class="icon icon-medium icon-custom-timeline pull-right"></i> </div> <div class="link-complex-target txt-base-largest nbfcm padding-ts">{{_i}}Collections{{/i}}</div> </a> {{/withoutLinks}}  <a class="js-account-action link-complex txt-medium margin-vm cf is-hidden" href="#" data-action="manageContributors" data-account-key="{{accountKey}}"> <div class="obj-left"> <i class="icon icon-medium icon-user-team-mgr pull-right"></i> </div> <div class="nbfc"> <p class="nbfc link-complex-target txt-base-largest padding-txs link-complex-target">{{_i}}Team @{{screenName}}{{/i}}</p> <p class="nbfc txt-r-dark-gray txt-base-small padding-ts">{{_i}}Let colleagues use Twitter as @{{screenName}} without sharing your password{{/i}}</p> </div> </a>  {{^isInvited}} {{#isDefault}} <div class="margin-bs padding-txxl txt-center txt-bold is-active"> <i class="icon icon-check icon-tb"></i> {{_i}}Default account{{/i}} </div> {{/isDefault}} {{^isDefault}} <button class="js-account-action btn btn-light-gray full-width margin-tl btn-extra-height" data-action="setDefault" data-account-key="{{accountKey}}"> {{_i}}Set as default account{{/i}} </button> {{/isDefault}} {{/isInvited}} </div>  {{^isInvited}} <div class="account-remove padding-hxl"> <button {{#notRemovable}}title="{{notRemovableMessage}}"{{/notRemovable}} class="js-account-action js-show-tip btn btn-negative full-width margin-tm btn-extra-height {{#notRemovable}}is-disabled{{/notRemovable}}" data-action="removeCheck" data-account-key="{{accountKey}}"> <i class="icon icon-close"></i> <span class="label">{{_i}}Remove account{{/i}}</span> </button> </div>  <div class="js-account-remove-check account-remove-check cf margin-tm padding-axl bg-r-faded-gray txt-center"> <div class="account-remove-check-message padding-bxl"> Remove @{{screenName}}? </div> <button class="js-account-action btn btn-negative btn-extra-height padding-hxxl pull-left" data-action="remove" data-account-key="{{accountKey}}"> <i class="icon icon-close"></i> <span class="label">{{_i}}Remove{{/i}}</span> </button> <button class="js-account-action cf btn btn-light-gray btn-extra-height padding-hxxl pull-right" data-action="removeCancel" data-account-key="{{accountKey}}"> {{_i}}Cancel{{/i}} </button> </div> {{/isInvited}} {{#isInvited}} <div class="account-invited cf margin-tm padding-hxl bg-r-faded-gray txt-center"> <div class="account-invited-message padding-bl"> <div class="padding-bl"> {{_i}}You have been invited to contribute to the @{{screenName}} team.{{/i}} </div> </div> <div class="cf"> <button class="js-account-action btn btn-positive btn-extra-height padding-hxxl pull-left" data-action="inviteAccept" data-account-key="{{accountKey}}"> <i class="icon icon-check"></i> {{_i}}Accept{{/i}} </button> <button class="js-account-action btn btn-negative btn-extra-height padding-hxl pull-right" data-action="inviteCancel" data-account-key="{{accountKey}}"> <i class="icon icon-close"></i> <span class="label">{{_i}}Decline{{/i}}</span> </button> </div> <div class="margin-txl"> <a href="https://support.twitter.com/articles/20171753-share-your-twitter-account-without-sharing-passwords" target="_blank"> {{_i}}Read more about teams.{{/i}} </a> </div> </div> {{/isInvited}}',this.TD_mustaches["settings/account_settings_invited_row.mustache"]='<div class="js-account-settings-invited-row padding-vxl cf is-highlighted account-settings-row position-rel" data-account-key="{{accountKey}}" {{#isAdmin}}data-user-is-admin{{/isAdmin}} data-user-id="{{userId}}"> <div class="position-rel cf padding-hxl"> <div class="js-account-settings-summary nbfc"> {{>account_settings_account_summary}} </div> </div>  <div class="padding-an"> {{>settings/account_settings_detail}} </div> </div>',this.TD_mustaches["settings/account_settings_row.mustache"]='<div class="js-accordion-item js-account-settings-row margin-txl padding-bxl cf account-row-separator-b {{#isExpanded}}is-expanded{{/isExpanded}} {{#isActive}}is-active{{/isActive}} account-settings-row position-rel" data-account-key="{{accountKey}}" data-user-id="{{userId}}"> <div class="js-accordion-toggle-view position-rel cf padding-hxl is-actionable"> <div class="obj-right padding-tm"> <i class="icon icon-arrow-u txt-r-dark-gray"></i> <i class="icon icon-arrow-d txt-r-dark-gray"></i> </div> <div class="js-account-settings-summary nbfc"> {{>account_settings_account_summary}} </div> </div>  <div class="js-accordion-panel js-account-settings-detail accordion-panel padding-an"> {{>settings/account_settings_detail}} </div> </div>',this.TD_mustaches["settings/global_setting_filter.mustache"]='<fieldset id="global_filter_settings"> <legend class="frm-legend">{{_i}}Mute Settings{{/i}}</legend>  <div class="control-group"> <label for="filter-types" class="control-label">{{_i}}Mute{{/i}}</label> <div class="controls"> <select name="filter" id="filter-types"> <option value="phrase">{{_i}}Text content{{/i}}</option> <option value="sender">{{_i}}User{{/i}}</option> <option value="source">{{_i}}Source{{/i}}</option> </select> </div> </div>  <div class="control-group"> <label for="filter-input" class="control-label">{{_i}}Using{{/i}}</label> <div class="controls"> <input id="filter-input" name="filter-input" size="30" type="text"> </div> </div>  <div class="control-group"> <div class="controls"> <input type="button" name="add-filter" value="{{_i}}Mute{{/i}}"  id="add-filter" class="btn" /> </div> </div>  <ul id="filter-results"></ul>  </fieldset>',this.TD_mustaches["settings/global_setting_filter_row.mustache"]='<li class="list-filter cf"> {{_i}}Muting {{getDisplayType}} {{>text/global_filter_value}}{{/i}} <input type="button" name="remove-filter" value="{{_i}}Remove{{/i}}" data-id="{{id}}" class="js-remove-filter small btn btn-negative"> </li>',this.TD_mustaches["settings/global_setting_general.mustache"]='<fieldset id="general_settings"> <legend>{{_i}}General Settings{{/i}}</legend>  <div class="control-group"> <label for="streaming-updates" class="js-streaming-form checkbox">{{_i}}Stream Tweets in realtime{{/i}} <input type="checkbox" name="streaming-updates" checked="checked" id="streaming-updates"> </label>  <label for="check-for-updates" class="js-check-updates-form checkbox">{{_i}}Check for application updates{{/i}} <input type="checkbox" name="check-for-updates" id="check-for-updates"> </label>  <label for="show-startup-notifications" class="js-show-startup-notifications checkbox">{{_i}}Show notifications on startup{{/i}} <input type="checkbox" name="show-startup-notifications" id="show-startup-notifications"> </label>  <label for="display-sensitive-media" class="js-display-sensitive-media checkbox">{{_i}}Display media that may contain sensitive content{{/i}} <input type="checkbox" name="display-sensitive-media" id="display-sensitive-media"> </label>  <label for="minimize-to-tray" class="js-minimize-to-tray checkbox">{{_i}}Minimize to tray on close{{/i}} <input type="checkbox" name="minimize-to-tray" id="minimize-to-tray"> </label>  <div class="divider-bar"></div>  <div class="cf"> <div class="obj-left"> <label class="fixed-width-label txt-uppercase touch-larger-label"><b>{{_i}}Theme{{/i}}</b></label> <label class="fixed-width-label radio"> <input type="radio" class="js-theme-radio touch-larger-label" name="theme" value="dark"> {{_i}}Dark{{/i}} </label> <label class="fixed-width-label radio"> <input type="radio" class="js-theme-radio touch-larger-label" name="theme" value="light"> {{_i}}Light{{/i}} </label> </div> <div class="obj-left"> <label class="fixed-width-label txt-uppercase touch-larger-label"><b>{{_i}}Columns{{/i}}</b></label> <label class="fixed-width-label radio"> <input type="radio" class="js-column-size-radio touch-larger-label" name="column-size" value="narrow"> {{_i}}Narrow{{/i}} </label> <label class="fixed-width-label radio"> <input type="radio" class="js-column-size-radio touch-larger-label" name="column-size" value="medium"> {{_i}}Medium{{/i}} </label> <label class="fixed-width-label radio"> <input type="radio" class="js-column-size-radio touch-larger-label" name="column-size" value="wide"> {{_i}}Wide{{/i}} </label> </div> <div class="obj-left"> <label class="fixed-width-label txt-uppercase touch-larger-label"><b>{{_i}}Font size{{/i}}</b></label> <label class="txt-base-smallest fixed-width-label radio"> <input type="radio" class="js-font-size-radio" name="font-size" value="smallest"> {{_i}}Smallest{{/i}} </label> <label class="txt-base-small fixed-width-label radio"> <input type="radio" class="js-font-size-radio" name="font-size" value="small"> {{_i}}Small{{/i}} </label> <label class="txt-base-medium fixed-width-label radio"> <input type="radio" class="js-font-size-radio" name="font-size" value="medium"> {{_i}}Medium{{/i}} </label> <label class="txt-base-large fixed-width-label radio"> <input type="radio" class="js-font-size-radio" name="font-size" value="large"> {{_i}}Large{{/i}} </label> <label class="txt-base-largest fixed-width-label radio"> <input type="radio" class="js-font-size-radio" name="font-size" value="largest"> {{_i}}Largest{{/i}} </label> </div> </div> </div>  <div class="mdl-links"> {{> app_links}} </div> </fieldset>',this.TD_mustaches["settings/global_setting_services.mustache"]='<!-- Services --> <fieldset id="services_settings" > <legend>{{_i}}Services Settings{{/i}}</legend>  <div id="streaming-form" class="control-group"> <label for="link-shortening" class="control-label">{{_i}}Link Shortening{{/i}}</label> <div class="controls"> <select name="link-shortening" id="link-shortening"> <option value="link-twitter">Twitter</option> <option value="link-bitly">Bit.ly</option> </select> </div> </div>  <div id="bitly-form"> <div class="control-group"> <label for="bitly-email" class="control-label">{{_i}}Bit.ly Username{{/i}}</label> <div class="controls"> <input id="bitly-email" name="bitly-email" size="30" type="text"> </div> </div> <div class="control-group"> <label for="bitly-key" class="control-label">{{_i}}Bit.ly API Key{{/i}}</label> <div class="controls"> <input id="bitly-key" name="bitly-key" size="40" type="text"> </div> </div> </div>  </fieldset>',this.TD_mustaches["settings/global_settings_modal.mustache"]='<div class="l-column mdl-column mdl-column-sml"> <div class="l-column-scrollv scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt "> <ul class="lst-group js-setting-list"> {{#tabs}} {{> list_module_list_item}} {{/tabs}} </ul> </div> </div> <div class="l-column mdl-column mdl-column-lrg"> <div class="l-column-scrollv scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt mdl-col-settings"> <form action="#" id="global-settings" accept-charset="utf-8" class="frm"></form> </div> </div>',this.TD_mustaches["short_modal.mustache"]='<div class="js-modal-panel mdl s-short is-inverted-dark"> {{> modal_header}} <div class="mdl-inner"> <div class="mdl-content js-mdl-content horizontal-flow-container"> {{{content}}} </div> <footer class="{{^centeredFooter}}mdl-buttonbar{{/centeredFooter}}{{#centeredFooter}}padding-vxl txt-center{{/centeredFooter}}"> {{#hasDoneButton}} <button class="js-dismiss btn btn-positive"> <i class="icon icon-check icon-small padding-rs"></i> <span class="label">{{_i}}Done{{/i}}</span> </button> {{/hasDoneButton}} </footer> </div> </div>',this.TD_mustaches["spinner.mustache"]='<div class="disp-table"> <div class="disp-cell"> <div class="spinner"></div> </div> </div>',this.TD_mustaches["spinner_large.mustache"]='<div class="js-infinitespinner spinner-large"></div>',this.TD_mustaches["splash/whats_new.mustache"]='<div class="release-notes-header nbfc"> <img class="release-notes-image pull-left" src="{{#asset}}/web/assets/logos/64.png{{/asset}}" alt="{{_i}}TweetDeck logo{{/i}}"> <h1 class="release-notes-header-title">{{_i}}Welcome to TweetDeck{{/i}}</h1> <p class="release-notes-header-subtitle">{{_i}} <strong>TweetDeck old timer?</strong> You&rsquo;ve logged in with your Twitter account, but if you want access to your normal columns and setup, you should continue to <a href="#" data-action="signOut">log in</a> with your TweetDeck email address and password for the time being. {{/i}}</p> </div>  <div class="release-notes"> <div class="release-notes-section nbfc"> <img class="release-notes-image-bullet pull-left" src="{{#asset}}/web/assets/global/backgrounds/td_whatsnew_01.png{{/asset}}" alt="{{_i}}Create collections{{/i}}"> <h2>{{_i}}Create a custom Twitter experience{{/i}}</h2> <p>{{_i}}Organize and build collections, keep track of lists, searches, activity and more. Click the + in the sidebar.{{/i}}</p> </div>  <div class="release-notes-section nbfc"> <img class="release-notes-image-bullet pull-left" src="{{#asset}}/web/assets/global/backgrounds/td_whatsnew_02.png{{/asset}}" alt="{{_i}}Create filters{{/i}}"> <h2>{{_i}}Find exactly what you&rsquo;re looking for{{/i}}</h2> <p>{{_i}}Create searches to track topics, events and hashtags. Refine the results with filters at the top of each timeline.{{/i}}</p> </div>  <div class="release-notes-section margin-bn nbfc"> <img class="release-notes-image-bullet pull-left" src="{{#asset}}/web/assets/global/backgrounds/td_whatsnew_03.png{{/asset}}" alt="{{_i}}Multiple accounts{{/i}}"> <h2>{{_i}}Manage multiple accounts{{/i}}</h2> <p>{{_i}}Tweet, monitor and follow new accounts from all &mdash; or just one of your accounts. Add another account in <a href="#" data-action="openSettings"><i class="icon icon-settings icon-bot"></i>Settings</a>.{{/i}}</p> </div> </div>  <button class="js-done btn btn-positive btn-extra-padding obj-center margin-tl"><i class="add"></i>{{_i}}Get started{{/i}}</button>',this.TD_mustaches["startflow_wrapper.mustache"]='<div class="js-startflow-chrome app-masthead {{#withLoading}}is-hidden{{/withLoading}}"> <div class="app-signin-wrap"> <i class="sprite sprite-logo-badge sprite-logo-badge-large"></i> </div> </div>  <div class="js-startflow-content startflow"> {{$content}}{{/content}} {{#withLoading}} <img src="{{#asset}}/web/assets/global/backgrounds/spinner_blue.gif{{/asset}}" alt="{{_i}}Loading&hellip;{{/i}}" class="spinner-centered"> {{/withLoading}} </div>  <div class="js-startflow-chrome txt-center privacy-info {{#withLoading}}is-hidden{{/withLoading}}"> <p> {{> app_links}} </p> </div>',this.TD_mustaches["status/conversation.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}is-actionable {{#unread}}is-unread {{/unread}} {{/stream_item_classes}}  {{$stream_item_content_classes}}js-show-detail {{/stream_item_content_classes}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}}  <div class="tweet tweet-message js-chirp">  <header class="tweet-header"> {{>status/conversation_timestamp}} {{#hasValidParticipant}} <div class="js-conversation-header"> {{> status/conversation_header }} </div> {{/hasValidParticipant}} </header>  <div class="l-table">  <div class="l-cell"> <div class="l-table"> <p class="l-cell tweet-body align-top" style="width:100%;"> {{#showSenderName}} {{#sender}} <span class="tweet-text txt-mute">{{sender.name}}: </span> {{/sender}} {{/showSenderName}} {{#htmlText}} <span class="js-tweet-text tweet-text with-linebreaks">{{{htmlText}}}</span> {{/htmlText}} {{#previewText}} <span class="js-tweet-text tweet-text">{{{previewText}}}</span> {{/previewText}} {{#attachmentOnly}} <em>Attachment: image</em> {{/attachmentOnly}} </p> {{#hasMedia}} <div class="l-cell align-top padding-t--3 padding-r--8"> {{#getMedia}} <div class="tweet-message-attachment position-rel"> <div class="js-media-image-link media-item {{#isPossiblySensitive}}is-invisible{{/isPossiblySensitive}} {{#needsSecureUrl}}js-needs-secure-url{{/needsSecureUrl}} is-zoomable" {{#needsSecureUrl}}data-original-url="{{mediaPreviewSrc}}{{imageSrc}}"{{/needsSecureUrl}} {{^needsSecureUrl}}{{^imageSrc}}style="background-image:url({{mediaPreviewSrc}})"{{/imageSrc}}{{/needsSecureUrl}}> </div> </div> {{/getMedia}} </div> {{/hasMedia}} </div> </div> <div class="pull-right txt-right"> <i class="icon {{#replied}}icon-reply{{/replied}} txt-mute txt-base-medium"></i> </div> </div>  </div>  {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/conversation_failed_participants.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}conversation-event txt-mute padding-h--10{{/stream_item_classes}} {{$content}} {{#failedParticipants}} {{#participant}} <a href="{{profileURL}}" rel="user" target="_blank">{{name}}</a> {{/participant}} {{^isLastItem}}and{{/isLastItem}} {{/failedParticipants}} {{_i}}could not be added{{/i}} {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/conversation_failed_participants_preview.mustache"]='<span class="txt-mute"> {{_i}}Some users could not be added.{{/i}} </span>',this.TD_mustaches["status/conversation_header.mustache"]='<div class="account-link"> <div class="obj-left item-img tweet-img"> {{^withMultipleAvatars}} {{#avatars.0}} <a class="account-inline account-link txt-ellipsis link-complex" rel="user" href="{{profileURL}}"> <img class="tweet-avatar avatar pull-right" src="{{profileImageURL}}" width="48" height="48" alt="{{screenName}}\'s avatar"> </a> {{/avatars.0}} {{/withMultipleAvatars}} {{#withMultipleAvatars}} <div class="tweet-avatar media-grid-container multiple-avatar-grid"> <div class="{{avatarsClass}}"> {{#avatars}} <div class="media-image-container media-image-container-compact"> <div class="media-image block position-rel" style="background-image: url({{profileImageURL}});" ></div> </div> {{/avatars}} </div> </div> {{/withMultipleAvatars}} </div> <div class="nbfc"> {{#getConversationTitleInformation}} {{#name}} <b class="inline-block txt-ellipsis">{{{name}}}</b> {{/name}} {{^name}} {{#isOneToOne}} {{#participants.0}} <a class="account-inline account-link txt-ellipsis link-complex" rel="user" href="{{profileURL}}"> <b class="link-complex-target">{{name}}</b> <span class="attribution username txt-mute txt-small">@{{screenName}}</span> </a> {{/participants.0}} {{/isOneToOne}} {{#isThreeway}} <span class="account-inline txt-ellipsis"> {{#participants.0}} <a class="account-link" rel="user" href="{{profileURL}}"><b>{{name}}</b></a><b>, </b> {{/participants.0}} {{#participants.1}} <a class="account-link" rel="user" href="{{profileURL}}"><b>{{name}}</b></a> {{/participants.1}} </span> {{/isThreeway}} {{#isOneToMany}} {{#participants.0}} <div class="conversation-title-container"> <span class="conversation-title txt-ellipsis inline-block position-rel"><a class="txt-ellipsis account-link" rel="user" href="{{profileURL}}"><b>{{name}}</b></a> <b>+ {{numberOfOtherParticipants}}</b> </span> </div>  {{/participants.0}} {{/isOneToMany}} {{/name}} {{/getConversationTitleInformation}} </div> </div>',this.TD_mustaches["status/conversation_join.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}conversation-event txt-mute padding-h--10{{/stream_item_classes}} {{$stream_item_data}} data-key="{{conversation.id}}" {{/stream_item_data}}  {{$content}} <p class="margin-b--5"> {{#getParticipants}} {{#participant}} <a href="{{profileURL}}" rel="user" target="_blank"><img class="avatar size24" src="{{miniProfileImageURL}}" width="24" height="24" alt="{{name}} {{screenName}}" /></a> {{/participant}} {{#isEndOfRow}}<br />{{/isEndOfRow}} {{/getParticipants}} </p> <p class="margin-b--5"> {{_i}}There are{{/i}} <a href="#" rel="viewConversationParticipants">{{numberOfParticipants}} {{_i}}other people{{/i}}</a> {{_i}}in this group{{/i}} </p>  {{#sender}} <a href="{{profileURL}}" rel="user" target="_blank">{{name}}</a> {{/sender}}  {{_i}}added you{{/i}} {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/conversation_join_preview.mustache"]='{{#chirp}} <span class="txt-mute"> {{sender.name}} {{_i}}added you{{/i}} </span> {{/chirp}}',this.TD_mustaches["status/conversation_name_update.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}conversation-event txt-mute padding-h--10{{/stream_item_classes}} {{$content}}  {{#isOwnChirp}} {{_i}}You{{/i}} {{/isOwnChirp}} {{^isOwnChirp}} <a class="txt-mute conversation-participants-name-list" href="{{sender.profileURL}}" rel="user" target="_blank">{{sender.name}}</a> {{/isOwnChirp}}  {{_i}}changed the group name to{{/i}} {{{sanitizedConversationName}}}  {{/content}}  {{/stream_item}} {{/chirp}}',
this.TD_mustaches["status/conversation_name_update_preview.mustache"]='{{#chirp}} <span class="txt-mute"> {{#isOwnChirp}} {{_i}}You{{/i}} {{/isOwnChirp}} {{^isOwnChirp}} {{sender.name}} {{/isOwnChirp}}  {{_i}}changed the group name to{{/i}} {{{sanitizedConversationName}}} </span> {{/chirp}}',this.TD_mustaches["status/conversation_participants_join.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}conversation-event txt-mute padding-h--10{{/stream_item_classes}} {{$content}} {{#isOwnChirp}} {{_i}}You{{/i}} {{/isOwnChirp}} {{^isOwnChirp}} {{#sender}} <a href="{{profileURL}}" rel="user" target="_blank">{{name}}</a> {{/sender}} {{/isOwnChirp}}  {{_i}}added{{/i}}  {{#addedParticipants}} <a class="txt-mute conversation-participants-name-list" href="{{profileURL}}" rel="user" target="_blank">{{name}}</a> {{/addedParticipants}} {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/conversation_participants_join_preview.mustache"]='{{#chirp}} <span class="txt-mute"> {{#isOwnChirp}} {{_i}}You added{{/i}} {{/isOwnChirp}} {{^isOwnChirp}} {{sender.name}} {{_i}}added{{/i}} {{/isOwnChirp}}  <!-- one new participant --> {{^addedParticipants.1}} {{addedParticipants.0.name}} {{/addedParticipants.1}}  {{#addedParticipants.1}}  <!-- two new participants --> {{^addedParticipants.2}} {{addedParticipants.0.name}} {{_i}}&amp;{{/i}} {{addedParticipants.1.name}} {{/addedParticipants.2}}  <!-- more than 2 new participants --> {{#addedParticipants.2}} {{addedParticipants.0.name}} {{_i}}+{{/i}} {{numberOfOtherParticipants}} {{/addedParticipants.2}} {{/addedParticipants.1}} </span>  {{/chirp}}',this.TD_mustaches["status/conversation_participants_leave.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}conversation-event txt-mute padding-h--10{{/stream_item_classes}} {{$content}} {{#leftParticipants}} <a class="txt-mute conversation-participants-name-list" href="{{profileURL}}" rel="user" target="_blank">{{name}}</a> {{/leftParticipants}} {{_i}}left{{/i}} {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/conversation_participants_leave_preview.mustache"]='{{#chirp}} <span class="txt-mute"> {{$content}} {{#leftParticipants}} {{name}} {{/leftParticipants}} {{_i}}left{{/i}} {{/content}} </span> {{/chirp}}',this.TD_mustaches["status/conversation_timestamp.mustache"]='{{#created}} <time class="tweet-timestamp js-timestamp pull-right" data-time="{{getTime}}"> {{/created}} <span class="txt-small txt-mute"> {{createdPretty}} </span> {{#created}} </time> {{/created}}',this.TD_mustaches["status/dataminr.mustache"]='{{#dataminr}} {{> status/dataminr_header}} {{/dataminr}} <div class="is-dataminr-tweet"> {{> status/tweet_single}} {{> status/media_large_preview }} </div> {{#dataminr}} {{> status/dataminr_single_footer}} {{/dataminr}}',this.TD_mustaches["status/dataminr_footer.mustache"]='<div class="padding-axl"> <a class="btn btn-light-gray btn-extra-padding full-width padding-hn url-ext hidden-in-dark" href="{{expandAlertURL}}" rel="external" data-scribe-element="dataminr"> <i class="icon icon-dataminr"></i> <span class="label">{{_i}}Open in Dataminr{{/i}}</span> </a> <a class="btn btn-dark-gray btn-extra-padding full-width padding-hn url-ext hidden-in-light" href="{{expandAlertURL}}" rel="external" data-scribe-element="dataminr"> <i class="icon icon-dataminr"></i> <span class="label">{{_i}}Open in Dataminr{{/i}}</span> </a> </div> {{#eventLocation}} <p class="dataminr-title padding-al padding-hxl txt-base-smallest txt-bold">{{_i}}Event Location{{/i}}{{#eventLocation.name}}: {{eventLocation.name}}{{/eventLocation.name}}</p> <div class="cf"> <a href="{{expandMapURL}}" target="_blank" rel="url" class="media-item block dataminr-map-img-full" style=\'background-image:url("{{eventMapLargeImageURL}}")\' data-scribe-element="map"></a> </div> {{/eventLocation}} <p class="dataminr-title padding-al padding-hxl txt-base-smallest txt-bold">{{_i}}Event Keywords{{/i}}</p> <ul class="padding-vl padding-hxl block dataminr-search-terms-detail"> {{#relatedTerms}} <li class="inline-block dataminr-term"><a href="{{twitterUrl}}" data-search-term="{{query}}" target="_blank" rel="search" data-scribe-element="search">{{text}}</a></li> {{/relatedTerms}} <li class="dataminr-search-terms txt-base-small padding-ts txt-bold"> <a href="{{anyRelatedTermsTwitterUrl}}" target="_blank" class="link-complex" rel="search" data-search-term="{{anyRelatedTermsQuery}}" data-scribe-element="search_any"> <i class="icon icon-search icon-match-context icon-tt"></i> <span class="link-complex-target">{{_i}}Search any{{/i}}</span> </a> or <a href="{{allRelatedTermsTwitterUrl}}" target="_blank" rel="search" data-search-term="{{allRelatedTermsQuery}}" data-scribe-element="search_all"> {{_i}}search all{{/i}} </a> </li> </ul>  <p class="dataminr-title padding-al padding-hxl txt-base-smallest txt-bold">{{_i}}Original Source{{/i}}</p> <div class="js-source-profile position-rel"></div> <div class="dataminr-user-profile padding-hxl padding-bl">  {{#userTopHashtags.length}} <p class="padding-tm"><i class="icon icon-small-valigned icon-hashtag profile-icon icon-tt"></i>&nbsp;{{_i}}Top Hashtags{{/i}}</p> <ul class="padding-vm"> {{#userTopHashtags}} <li class="padding-vs"> <a href="{{twitterUrl}}" class="txt-capitalize txt-base-small" target="_blank" rel="hashtag" data-scribe-element="hashtag">{{text}}</a> </li> {{/userTopHashtags}} </ul> {{/userTopHashtags.length}} </div> <p class="js-replies-header is-hidden dataminr-title padding-al padding-hxl txt-base-smallest txt-bold">{{_i}}Replies{{/i}}</p>',this.TD_mustaches["status/dataminr_header.mustache"]='<div class="dataminr-header cf txt-small padding-bm"> <div class="txt-ellipsis"> {{#publisherCategory.name}} <span class="dataminr-category-pill dataminr-category-{{publisherCategory.shortName}} inline-block txt-capitalize pull-left"> <span class="dataminr-category-full">{{publisherCategory.name}}</span><span class="dataminr-category-short txt-uppercase"><abbr title="{{publisherCategory.name}}">{{publisherCategory.shortName}}</abbr></span></span> {{/publisherCategory.name}} <span class="pull-right padding-txs txt-dataminr"> <span class="dataminr-volume margin-rs"><i class="icon icon-small icon-user icon-match-context icon-tt"></i> {{eventVolume}}</span> {{#alertType}} <span class="dataminr-label dataminr-label-{{id}} margin-rs txt-dataminr">{{name}}<i class="sprite {{alertTypeSprite}} margin-ls"></i></span> {{/alertType}} {{createdAt}} </span> </div> </div>',this.TD_mustaches["status/dataminr_in_stream.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}is-actionable dataminr dataminr-separator{{/stream_item_classes}}  {{$stream_item_content_classes}}js-show-detail{{/stream_item_content_classes}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}} {{> status/dataminr }} {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/dataminr_single_footer.mustache"]='<div class="margin-tm cf"> <div class="padding-bxxl"> {{#eventLocation}} <div class="obj-right txt-center dataminr-location"> <div class="cf"> {{#eventMapSmallImageURL}} <a href="{{expandMapURL}}" target="_blank" rel="url" class="media-item block dataminr-map-img pull-right" style=\'background-image:url("{{eventMapSmallImageURL}}")\' data-scribe-element="map"></a> {{/eventMapSmallImageURL}} </div> {{#name}} <div class="js-show-tip txt-ellipsis" data-original-title="{{name}}"> <a href="{{expandMapURL}}" target="_blank" rel="url" class="txt-small" data-scribe-element="map" >{{name}}</a> </div> {{/name}} </div> {{/eventLocation}}  <div class="nbfc"> <ul class="dataminr-related-terms"> {{#relatedTerms}} <li class="inline-block dataminr-term"><a href="{{twitterUrl}}" class="txt-base-small" data-search-term="{{query}}" target="_blank" rel="search"data-scribe-element="search">{{text}}</a></li> {{/relatedTerms}} </ul> {{#user}} <div class="margin-ts"> <span class="txt-base-smallest txt-dataminr inline-block margin-rm">{{_i}}Joined{{/i}}&nbsp;<b class="dataminr-bio-count">{{prettyJoinedDate}}</b></span> <a href="{{getFollowerURL}}" rel="url" target="_blank" class="txt-base-smallest inline-block" data-scribe-element="show_followers">{{_i}}Followers{{/i}}&nbsp;<b>{{prettyFollowersCount}}</b></a>&nbsp; </div> {{/user}} </div> </div> <a href="{{{expandAlertURL}}}" class="txt-base-small dataminr-openin-link txt-dataminr" target="_blank" rel="url" data-scribe-element="dataminr">{{_i}}Open in Dataminr{{/i}}<i class="icon icon-match-context icon-dataminr icon-tt link-clean padding-ls"></i></a> </div>',this.TD_mustaches["status/follow_activity.mustache"]="{{#withActivityHeader}} {{> status/tweet_activity_header }} {{/withActivityHeader}}  {{#getRelatedUser}} {{> account_summary }} {{/getRelatedUser}}",this.TD_mustaches["status/follow_activity_in_box.mustache"]='{{#data}} {{<item_box}}  {{$item_box_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/item_box_data}}  {{$content}} {{> status/follow_activity }} {{/content}}  {{/item_box}} {{/data}}',this.TD_mustaches["status/follow_activity_in_stream.mustache"]='{{#data}} {{<stream_item}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}} {{> status/follow_activity }} {{/content}}  {{/stream_item}} {{/data}}',this.TD_mustaches["status/list_activity.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}} <div class="obj-left item-img"> {{#sourceAvatar}}<img class="avatar pull-right size24 margin-lm" src="{{sourceAvatar}}" width="24" height="24">{{/sourceAvatar}} <i class="pull-right icon icon-list activity-indicator margin-ts"></i> </div> <div class="nbfc">{{{htmlText}}}</div> {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/media_image_container.mustache"]='<div class="media-image-container {{#isMediaPreviewCompact}}media-image-container-compact{{/isMediaPreviewCompact}} block position-rel"> <a class="js-media-image-link {{#needsSecureUrl}}js-needs-secure-url{{/needsSecureUrl}} pin-all media-image block {{#isPossiblySensitive}}is-invisible{{/isPossiblySensitive}}" {{#needsSecureUrl}}data-original-url="{{mediaPreviewSrc}}{{imageSrc}}"{{/needsSecureUrl}} {{^needsSecureUrl}}style="background-image:url({{mediaPreviewSrc}}{{imageSrc}})"{{/needsSecureUrl}} href="{{url}}" rel="mediaPreview" target="_blank" data-media-entity-id="{{mediaId}}" ></a> </div>',this.TD_mustaches["status/media_large_preview.mustache"]='{{#isMediaPreviewLarge}} {{#hasMedia}} <div class="js-media position-rel item-box-full-bleed margin-tm {{^isPossiblySensitive}}{{#isMediaGridContent}}media-size-large-height{{/isMediaGridContent}}{{/isPossiblySensitive}} {{#dataminr}}dataminr-large-preview{{/dataminr}}" data-key="{{id}}"> {{#withMediaPreview}} {{#isMediaGridContent}} {{^isPossiblySensitive}} <div class="media-grid-{{mediaLength}}"> {{#getMedia}} {{> status/media_image_container}} {{/getMedia}} </div> {{/isPossiblySensitive}} {{#isPossiblySensitive}} {{#getFirstMedia}} {{>status/media_thumb}} {{/getFirstMedia}} {{/isPossiblySensitive}} {{/isMediaGridContent}} {{^isMediaGridContent}} {{#getMedia}} {{>status/media_thumb}} {{/getMedia}} {{/isMediaGridContent}} {{/withMediaPreview}} </div> {{/hasMedia}} {{/isMediaPreviewLarge}}',this.TD_mustaches["status/media_preview.mustache"]='{{#isMediaGridContent}} {{#isPossiblySensitive}} {{> status/media_sensitive}} {{/isPossiblySensitive}} {{^isPossiblySensitive}} <div class="media-grid-{{mediaLength}}"> {{#getMedia}} {{> status/media_image_container}} {{/getMedia}} </div> {{/isPossiblySensitive}} {{/isMediaGridContent}} {{^isMediaGridContent}} {{#getMedia}} {{> status/media_thumb}} {{/getMedia}} {{/isMediaGridContent}}',this.TD_mustaches["status/media_sensitive.mustache"]='{{#isPossiblySensitive}} <div class="js-media-sensitive-overlay media-sensitive {{^isMediaPreviewSmall}}{{thumbSizeClass}}{{/isMediaPreviewSmall}} {{#isMediaPreviewSmall}}media-size-medium{{/isMediaPreviewSmall}} "> <div class="{{^isNarrowColumns}}media-sensitive-content{{/isNarrowColumns}} padding-am"> <b class="media-sensitive-title">{{_i}}The following media may contain sensitive material.{{/i}}</b> <p>{{_i}}Your <a href="#" rel="globalSettings">Tweet media display settings</a> are configured to inform you when media may be sensitive.{{/i}}</p> <a href="#" target="_blank" rel="showSensitiveMedia">{{_i}}View{{/i}}</a>&nbsp;&middot; <a href="#" target="_blank" rel="alwaysShowSensitiveMedia">{{_i}}Always show me sensitive media{{/i}}</a> </div> </div> {{/isPossiblySensitive}}',this.TD_mustaches["status/media_thumb.mustache"]='<div class="js-media-preview-container position-rel {{^isMediaPreviewLarge}}{{^isMediaPreviewCompact}}margin-vm{{/isMediaPreviewCompact}}{{/isMediaPreviewLarge}}  {{#isMediaPreviewSmall}}{{#isPossiblySensitive}}media-size-medium{{/isPossiblySensitive}}{{/isMediaPreviewSmall}} {{#isMediaPreviewCompact}}media-size-medium margin-t--8{{/isMediaPreviewCompact}}">   {{#isAnimatedGif}} {{#animatedGif}} {{> media/animated_gif}} {{/animatedGif}} {{/isAnimatedGif}}  {{^isAnimatedGif}}  {{#isMediaPreviewLarge}} <div class="media-caret"></div> {{/isMediaPreviewLarge}}  <a class="js-media-image-link block med-link media-item {{thumbSizeClass}} {{#isPossiblySensitive}}is-invisible{{/isPossiblySensitive}} {{#needsSecureUrl}}js-needs-secure-url{{/needsSecureUrl}} {{^isGalleryView}}is-zoomable{{/isGalleryView}}" {{#needsSecureUrl}}data-original-url="{{mediaPreviewSrc}}{{imageSrc}}"{{/needsSecureUrl}} href="{{url}}" rel="mediaPreview" target="_blank" {{^needsSecureUrl}}{{^imageSrc}}style="background-image:url({{mediaPreviewSrc}})"{{/imageSrc}}{{/needsSecureUrl}} data-media-entity-id="{{mediaId}}"> {{#isVideo}} <div class="video-overlay icon-with-bg-round"> <i class="icon icon-bg-dot icon-twitter-blue-color"></i> <i class="icon icon-play-video"></i> </div> {{/isVideo}}  {{#imageSrc}} <img class="{{thumbClass}}" src="{{^needsSecureUrl}}{{imageSrc}}{{/needsSecureUrl}}" alt="Media preview"> {{/imageSrc}} </a> {{/isAnimatedGif}} {{> status/media_sensitive}} </div>',this.TD_mustaches["status/media_unique_preview.mustache"]='<div class="media-grid-{{mediaLength}}"> {{#getUniqueMedia}} {{{renderGridView}}} {{/getUniqueMedia}} </div>',this.TD_mustaches["status/message.mustache"]='<div class="tweet js-chirp {{#quotedTweet}}is-quote-tweet{{/quotedTweet}}"> <header class="tweet-header"> {{> status/message_timestamp}}  {{#sender}} {{^isDeleted}} {{> status/tweet_single_header }} {{/isDeleted}} {{/sender}} </header>  <div class="tweet-body"> <p class="js-tweet-text tweet-text with-linebreaks">{{{htmlText}}}</p> {{#quotedTweet}} {{{ renderQuoted }}} {{/quotedTweet}} {{>status/tweet_media_wrapper}} {{#withFooter}} <footer class="tweet-footer cf"> <ul class="tweet-actions"> <li class="position-rel"> {{#getMainUser}} <a class="tweet-action" href="#" rel="actionsMenu" data-user-id="{{id}}" data-chirp-id="{{message.id}}" data-account-key="{{accountKey}}"> <i class="icon icon-more"></i> <span class="is-vishidden">{{_i}}More options{{/i}}</span> </a> {{/getMainUser}} </li> </ul> </footer> {{/withFooter}} </div> </div>',this.TD_mustaches["status/message_in_box.mustache"]='{{#message}} {{<item_box}}  {{$item_box_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/item_box_data}}  {{$content}}  {{> status/message}}  {{/content}}  {{/item_box}} {{/message}}',this.TD_mustaches["status/message_in_stream.mustache"]='{{#message}} {{<stream_item}}  {{$stream_item_content_classes}}message-stream-item{{/stream_item_content_classes}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}}  {{>status/message}}  {{/content}}  {{/stream_item}} {{/message}}',this.TD_mustaches["status/message_thread.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}is-actionable {{#unread}}is-unread {{/unread}}{{/stream_item_classes}}  {{$stream_item_content_classes}}js-show-detail {{/stream_item_content_classes}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}}  <div class="tweet tweet-message js-chirp">  <header class="tweet-header"> {{>status/message_timestamp}}  {{#getMainUser}} {{> status/tweet_single_header }} {{/getMainUser}} </header>  <div class="l-table">  <div class="tweet-body l-cell"> <div class="l-table"> <p class="l-cell align-top"> {{#replied}} <i class="txt-base-medium txt-mute icon icon-reply"></i> {{/replied}} <span class="js-tweet-text tweet-text with-linebreaks">{{{htmlText}}}</span> {{#attachmentOnly}} <em>Attachment: image</em> {{/attachmentOnly}} </p> {{#hasMedia}} <div class="l-cell"> {{#getMedia}} <div class="tweet-message-attachment obj-right position-rel"> <div class="js-media-image-link media-item {{#isPossiblySensitive}}is-invisible{{/isPossiblySensitive}} {{#needsSecureUrl}}js-needs-secure-url{{/needsSecureUrl}} is-zoomable" {{#needsSecureUrl}}data-original-url="{{mediaPreviewSrc}}{{imageSrc}}"{{/needsSecureUrl}} {{^needsSecureUrl}}{{^imageSrc}}style="background-image:url({{mediaPreviewSrc}})"{{/imageSrc}}{{/needsSecureUrl}}> </div> </div> {{/getMedia}} </div> {{/hasMedia}} </div> </div>  <div class="conversation-indicator l-cell"> <i class="icon icon-arrow-r"></i> </div>  </div>  </div>  {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/message_timestamp.mustache"]='{{#created}} <time class="tweet-timestamp pull-right" datetime="{{toISOString}}" data-time="{{getTime}}"> {{/created}} <span class="txt-small txt-mute"> {{createdPrettyTimeOrDate}} </span> {{#created}} </time> {{/created}}',this.TD_mustaches["status/message_wrapper.mustache"]='{{> column/column_header_detail}}  <div class="column-content"> <div class="js-detail-container js-dropdown-container column-scroller scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"> <div> <div class="js-message-box"></div> <div class="js-message-detail"> {{> spinner_large}} </div> </div> </div> </div>',this.TD_mustaches["status/quoted_tweet.mustache"]='{{#tweet}} <div class="js-quote-detail quoted-tweet nbfc padding-al position-rel {{^inCompose}}margin-tm is-actionable {{/inCompose}}" data-tweet-id="{{id}}" rel="viewDetails"> <div> <header class="tweet-header"> {{#user}} {{>status/tweet_single_header}} {{/user}} </header> <p class="js-quoted-tweet-text">{{{htmlText}}}</p> {{>status/tweet_media_wrapper}} </div> {{#inCompose}} <a class="js-quote-tweet-remove compose-media-grid-remove is-actionable"> <i class="sprite sprite-close"></i> </a> {{/inCompose}} </div> {{/tweet}}',this.TD_mustaches["status/scheduled_tweet.mustache"]='{{#inStream}} {{<stream_item}}  {{$stream_item_data}} data-key="{{chirp.key}}{{chirp.id}}" data-account-key="{{chirp.account.getKey}}" {{/stream_item_data}}  {{$content}}{{> status/scheduled_tweet_single }}{{/content}}  {{/stream_item}} {{/inStream}} {{#inBox}} {{<item_box}}  {{$item_box_classes}}js-tweet-box{{/item_box_classes}}  {{$item_box_data}} data-key="{{chirp.key}}{{chirp.id}}" data-account-key="{{chirp.account.getKey}}" {{/item_box_data}}  {{$content}}{{> status/scheduled_tweet_single }}{{/content}}  {{/item_box}} {{/inBox}}',this.TD_mustaches["status/scheduled_tweet_single.mustache"]='{{#chirp}}  {{#reasonText}} <div class="margin-bl padding-as srt-error-msg"> {{reasonText}} </div> {{/reasonText}}  <div class="obj-left item-img"> &nbsp; </div>  <div class="nbfc"> <div class="activity-header activity-header-wrapping"> {{_i}}Scheduled for:{{/i}} <b class="no-wrap">{{ prettyTime }}</b> </div>  <p class="with-linebreaks">{{{htmlText}}}</p>  {{#hasMedia}} <div class="js-media media-preview position-rel" data-key="{{id}}"> {{#getMedia}} {{>status/media_thumb}} {{/getMedia}} </div> {{/hasMedia}}   <div class="img-strip"> {{#updates}} <span class="img-strip-media"> <img class="avatar size24" src="{{user.avatar}}" width="24" height="24" alt="{{user.username}}\'s avatar"> </span> {{/updates}} </div>  <footer class="tweet-actions txt-mute txt-small {{#withTweetActionsVisible}}is-visible{{/withTweetActionsVisible}}"> {{#canEdit}} <a href="#" rel="edit">{{_i}}Edit{{/i}}</a> &middot; {{/canEdit}} <a href="#" rel="destroy">{{_i}}Delete{{/i}}</a> </footer> </div>  {{/chirp}}',this.TD_mustaches["status/social_proof_for_tweet.mustache"]='{{> column/column_header_detail}}  <div class="column-content"> <div class="column-scroller scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"> <div class="social-proof-for-tweet-title padding-vl txt-center txt-base-medium"> <b>{{title}}</b> </div> {{#users}} {{<stream_item}} {{$content}} {{>account_summary}} {{/content}} {{/stream_item}} {{/users}} {{^users}} {{>column_loading_placeholder}} {{/users}} </div> </div>',this.TD_mustaches["status/tweet_activity.mustache"]='{{#withActivityHeader}} {{> status/tweet_activity_header }} {{/withActivityHeader}}  {{#getRelatedTweet}} {{#withContentMute}}<span class="txt-mute">{{/withContentMute}} {{> status/tweet_single}} {{#withContentMute}}</span>{{/withContentMute}} {{/getRelatedTweet}}',this.TD_mustaches["status/tweet_activity_header.mustache"]='<div class="activity-header {{#sourceAvatar}}{{^withAlignAvatarToContent}}has-source-avatar{{/withAlignAvatarToContent}}{{/sourceAvatar}} cf"> <div class="obj-left item-img {{#withAlignAvatarToContent}}align-below-header{{/withAlignAvatarToContent}}"> {{#sourceAvatar}}<img class="avatar pull-right size24" src="{{sourceAvatar}}" width="24" height="24">{{/sourceAvatar}} <i class="pull-right icon {{iconClass}} activity-indicator {{^sourceAvatar}}activity-icon-aligned{{/sourceAvatar}}"></i> </div> <div class="nbfc txt-ellipsis {{#withSourceMute}}txt-mute txt-small{{/withSourceMute}}"> {{{htmlText}}} </div> </div>',this.TD_mustaches["status/tweet_activity_in_box.mustache"]='{{#chirp}} {{<item_box}}  {{$item_box_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/item_box_data}}  {{$content}} {{> status/tweet_activity }} {{/content}}  {{/item_box}} {{/chirp}}',this.TD_mustaches["status/tweet_activity_in_stream.mustache"]='{{#chirp}} {{<stream_item}}  {{$stream_item_classes}}is-actionable{{/stream_item_classes}}  {{$stream_item_content_classes}}js-show-detail {{/stream_item_content_classes}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}} {{> status/tweet_activity }} {{> status/media_large_preview }} {{/content}}  {{/stream_item}} {{/chirp}}',this.TD_mustaches["status/tweet_detail.mustache"]='{{<stream_item}}  {{$stream_item_data}} {{#chirp}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/chirp}} {{/stream_item_data}}  {{$content}}  {{#chirp}} <div class="js-tweet tweet-detail {{#isFavorite}}is-favorite{{/isFavorite}} {{#isRetweeted}}is-retweet{{/isRetweeted}} {{#quotedTweet}}is-quote-tweet{{/quotedTweet}}"> {{#getMainUser}} {{> account_summary }} {{/getMainUser}}  <p class="js-tweet-text txt-large margin-vl with-linebreaks {{#translation}}tweet-translation-original-text margin-bn{{/translation}}">{{{htmlText}}}</p> {{#translation}}{{>status/tweet_translation}}{{/translation}} {{#isTranslatable}}{{^translation}}<a class="js-translate-call-to-action txt-mute" href="#" rel="translateTweet">{{_i}}Translate Tweet{{/i}}</a>{{/translation}}{{/isTranslatable}}  {{#getMainTweet}}  <div class="js-tweet-media tweet-detail-media"></div>  {{#quotedTweet}} {{{ renderQuotedTweet }}} {{/quotedTweet}}  <div class="js-cards-container"></div>  <div class="margin-tl txt-mute txt-small"> <a href="{{getChirpURL}}" rel="url" target="_blank">{{createdPrettyFull}}</a> &middot; {{{source}}} </div>  {{#hasLocationData}} <div class="margin-bl txt-mute txt-small tweet-location"> <a href="{{getLocationURL}}" rel="url" target="_blank"><i class="icon icon-geo-valigned icon-geo"></i>{{getLocationFullName}}</a> </div> {{/hasLocationData}}  <footer> <div class="js-tweet-stats"></div>  {{> status/tweet_detail_actions}} </footer> {{/getMainTweet}}  <i class="sprite tweet-dogear"></i> </div> <div class="js-detail-view-inline detail-view-inline item-box-full-bleed padding-axl scroll-conversation"> <div rel="reply" class="js-detail-view-inline-text detail-view-inline-text padding-al inline-block full-width txt-ellipsis">{{_i}}Reply to{{/i}} {{mentions}}</div> </div> {{#dataminr}} <a class="js-skip-to-replies is-hidden is-actionable link-complex block item-box-full-bleed padding-hxl padding-bl scroll-conversation" rel="skipToReplies"> &#8595; <span class="link-complex-target align-middle">{{_i}}Skip to replies{{/i}}</span> </a> {{/dataminr}} {{/chirp}} {{/content}}  {{/stream_item}}',this.TD_mustaches["status/tweet_detail_actions.mustache"]='<ul class="tweet-detail-actions {{^withRemove}}{{^withDragHandle}}without-tweet-drag-handles{{/withDragHandle}}{{/withRemove}}"> <li class="tweet-detail-action-item margin-ln"> <a class="js-reply-action tweet-detail-action position-rel" href="#" rel="reply"> <i class="icon icon-reply"></i><span class="is-vishidden">{{_i}}Reply{{/i}}</span> <span class="reply-triangle"></span> </a> </li> <li class="tweet-detail-action-item"> <a class="tweet-detail-action" href="#" rel="retweet"> <i class="icon icon-retweet icon-retweet-toggle"></i><span class="is-vishidden">{{_i}}Retweet{{/i}}</span> </a> </li> <li class="tweet-detail-action-item"> {{#account}} <a class="js-show-tip tweet-detail-action" href="#" rel="favorite" title="{{>text/favorite_action}}"> <i class="icon icon-favorite icon-favorite-toggle"></i><span class="is-vishidden">{{_i}}Favorite{{/i}}</span> </a> {{/account}} </li> <li class="tweet-detail-action-item position-rel"> {{#getMainUser}} <a class="tweet-detail-action" href="#" rel="actionsMenu" data-user-id="{{id}}" data-chirp-id="{{chirp.id}}" data-account-key="{{chirp.account.getKey}}"> <i class="icon icon-more"></i><span class="is-vishidden">{{_i}}Options{{/i}}</span> </a> {{/getMainUser}} </li> {{#withDragHandle}} <li class="feature-customtimelines tweet-drag-handle tweet-detail-action-item"> <a class="tweet-detail-action" href="{{getChirpURL}}" data-drag-type="tweet" data-tweet-id="{{#getMainTweet}}{{id}}{{/getMainTweet}}"> <i class="icon icon-move"></i><span class="is-vishidden">{{_i}}Drag to collection{{/i}}</span> </a> </li> {{/withDragHandle}} {{#withRemove}} <li class="feature-customtimelines tweet-detail-action-item"> <a class="js-show-tip tweet-detail-action tweet-detail-action" href="{{getChirpURL}}" rel="removeFromCustomTimeline" data-tweet-id="{{#getMainTweet}}{{id}}{{/getMainTweet}}" title="{{_i}}Remove from collection{{/i}}" data-placement="bottom"> <i class="icon icon-close"></i> </a> </li> {{/withRemove}} </ul>',this.TD_mustaches["status/tweet_detail_inreplyto.mustache"]='<div class="js-replies-before tweet-detail-reply"></div>',this.TD_mustaches["status/tweet_detail_media.mustache"]='{{#hasMedia}} {{#isMediaGridContent}} {{^isPossiblySensitive}} <div class="js-media media-preview detail-preview media-size-large"> {{> status/media_unique_preview}} </div> {{/isPossiblySensitive}} {{#isPossiblySensitive}} <div class="js-media media-preview detail-preview"> {{#getFirstMedia}} {{{renderDetailView}}} {{/getFirstMedia}} </div> {{/isPossiblySensitive}} {{/isMediaGridContent}} {{^isMediaGridContent}} <div class="js-media media-preview detail-preview"> {{#getUniqueMedia}} {{{renderDetailView}}} {{/getUniqueMedia}} </div> {{/isMediaGridContent}} {{/hasMedia}}',this.TD_mustaches["status/tweet_detail_repliesto.mustache"]='<div class="js-replies-to replies-after"></div>',this.TD_mustaches["status/tweet_detail_replybar.mustache"]='<div class="rpl"> <textarea name="inreplyto" class="js-reply-tweetbox scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-alt"></textarea> <div class="rpl-actions cf"> <button class="js-reply-popout js-show-tip btn btn-square btn-neutral" title="{{_i}}Popout{{/i}}"> <i class="icon icon-popout icon-medium"></i> </button> <button class="js-reply-add-image js-show-tip btn btn-square btn-neutral" title="{{_i}}Add image{{/i}}"> <i class="icon icon-camera icon-medium"></i> </button> <div class="pull-right"> <input type="text" readonly="readonly" class="js-reply-charcount pull-left"/> {{#avatarURL}} <img src="{{avatarURL}}" class="js-show-tip avatar size30 neg-margin-bl obj-left"title="@{{from}}"/> {{/avatarURL}} <button class="btn btn-positive js-send">{{_i}}Reply{{/i}}</button> </div> </div> </div>',this.TD_mustaches["status/tweet_detail_socialstats.mustache"]='<ul class="tweet-stats"> {{#stats}} <li data-type="{{type}}" class="js-tweet-stat tweet-stat txt-small txt-mute"> <a href="#"><b>{{count}}</b> <span class="stat-word">{{label}}</span></a> </li> {{/stats}} </ul>',this.TD_mustaches["status/tweet_detail_wrapper.mustache"]='{{> column/column_header_detail}}  <div class="column-content"> <div class="js-detail-container js-dropdown-container column-scroller scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}} scroll-conversation"> <div class="js-detail-content"> <div class="js-inreplyto"></div> {{#withDataminr}}<div class="js-dataminr-header dataminr padding-tm padding-hl padding-bn">Dataminr header</div>{{/withDataminr}} <div class="js-tweet-detail tweet-detail-wrapper"> {{> spinner_large}} </div> {{#withDataminr}}<div class="js-dataminr-footer dataminr">Dataminr footer</div>{{/withDataminr}} <div class="js-tweet-replies tweet-detail-reply"></div> </div> </div> </div>',this.TD_mustaches["status/tweet_in_box.mustache"]='{{#tweet}} {{<item_box}}  {{$item_box_classes}}js-tweet-box{{/item_box_classes}}  {{$item_box_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/item_box_data}}  {{$content}} {{> status/tweet_single }} {{/content}}  {{/item_box}} {{/tweet}}',this.TD_mustaches["status/tweet_in_stream.mustache"]='{{#tweet}} {{<stream_item}}  {{$stream_item_classes}}is-actionable{{/stream_item_classes}}  {{$stream_item_content_classes}}js-show-detail {{/stream_item_content_classes}}  {{$stream_item_data}} data-key="{{key}}{{id}}" data-account-key="{{#account}}{{getKey}}{{/account}}" {{/stream_item_data}}  {{$content}} {{> status/tweet_single }} {{> status/media_large_preview }} {{/content}}  {{/stream_item}} {{/tweet}}',this.TD_mustaches["status/tweet_media_wrapper.mustache"]='{{#hasMedia}} {{^isMediaPreviewLarge}} {{#withMediaPreview}} {{#isMediaGridContent}} <div class="js-media media-preview media-grid-container {{^isMediaPreviewCompact}} media-size-medium  margin-vm{{/isMediaPreviewCompact}} {{#isMediaPreviewCompact}} media-size-medium no-radius margin-t--8{{/isMediaPreviewCompact}}{{^withMediaPreview}}}is-hidden{{/withMediaPreview}}" data-key="{{id}}"> {{> status/media_preview}} </div> {{/isMediaGridContent}} {{^isMediaGridContent}} <div class="js-media media-preview {{#showThumbs}}detail-preview{{/showThumbs}} {{^withMediaPreview}}is-hidden{{/withMediaPreview}} {{#isMediaPreviewCompact}} no-radius{{/isMediaPreviewCompact}} position-rel" data-key="{{id}}"> {{> status/media_preview}} </div> {{/isMediaGridContent}} {{/withMediaPreview}} {{/isMediaPreviewLarge}} {{/hasMedia}}',this.TD_mustaches["status/tweet_single.mustache"]='<div class="js-tweet tweet {{#isFavorite}}is-favorite{{/isFavorite}} {{#isRetweeted}}is-retweet{{/isRetweeted}} {{#isInConvo}}is-conversation{{/isInConvo}} {{#isMinimalist}}is-minimalist{{/isMinimalist}} {{#quotedTweet}}is-quote-tweet{{/quotedTweet}}"> {{#isRetweetedStatus}} <div class="tweet-context txt-small txt-mute padding-bs"> <div class="obj-left item-img"> <i class="pull-right icon icon-retweet icon-small-context txt-base-largest"></i> </div> <div class="nbfc"> {{#user}} <a href="{{getProfileURL}}" rel="user" target="_blank">{{name}}</a>{{_i}} retweeted{{/i}} {{/user}} </div> </div> {{/isRetweetedStatus}} <header class="tweet-header"> {{#getMainTweet}} {{>status/tweet_timestamp}} {{/getMainTweet}} {{#getMainUser}} {{>status/tweet_single_header}} {{/getMainUser}} </header> <div class="tweet-body"> <p class="js-tweet-text tweet-text {{#withLinebreaks}}with-linebreaks{{/withLinebreaks}} {{#translation}}tweet-translation-original-text margin-bn{{/translation}}">{{{htmlText}}}</p> {{#quotedTweet}} {{{ renderQuoted }}} {{/quotedTweet}} {{#translation}}{{>status/tweet_translation}}{{/translation}} {{>status/tweet_media_wrapper}} {{>status/tweet_single_footer}} </div> <i class="sprite tweet-dogear"></i> </div>',
this.TD_mustaches["status/tweet_single_actions.mustache"]='<ul class="js-tweet-actions tweet-actions {{#withTweetActionsVisible}}is-visible{{/withTweetActionsVisible}}"> <li class="tweet-action-item"> <a class="js-reply-action tweet-action position-rel" href="#" rel="reply"> <i class="icon icon-reply txt-right"></i> <span class="is-vishidden">{{_i}}Reply{{/i}}</span> <span class="reply-triangle"></span> </a> </li> <li class="tweet-action-item"> <a class="tweet-action" href="#" rel="retweet"> <i class="icon icon-retweet icon-retweet-toggle txt-right"></i> <span class="is-vishidden">{{_i}}Retweet{{/i}}</span> </a> </li> <li class="tweet-action-item"> <a class="js-show-tip tweet-action" href="#" rel="favorite" title="{{>text/favorite_action}}"> <i class="icon icon-favorite icon-favorite-toggle txt-right"></i> <span class="is-vishidden">{{_i}}Favorite{{/i}}</span> </a> </li> <li class="tweet-action-item position-rel"> <a class="tweet-action" href="#" rel="actionsMenu" data-user-id="{{getMainUser.id}}" data-chirp-id="{{id}}" data-account-key="{{account.getKey}}" data-actions-menu-position="{{actionsMenuPosition}}" data-parent-chirp-id="{{chirp.id}}"> <i class="icon icon-more txt-right"></i> <span class="is-vishidden">{{_i}}More options{{/i}}</span> </a> </li> {{#withDragHandle}} <li class="feature-customtimelines tweet-drag-handle tweet-action-item"> <a class="tweet-action is-draggable" href="{{getChirpURL}}" data-drag-type="tweet" data-tweet-id="{{#getMainTweet}}{{id}}{{/getMainTweet}}"> <i class="icon icon-move txt-right txt-right"></i> <span class="is-vishidden">{{_i}}Drag to collection{{/i}}</span> </a> </li> {{/withDragHandle}} {{#withRemove}} <li class="feature-customtimelines tweet-action-item"> <a class="js-show-tip tweet-action" href="{{getChirpURL}}" rel="removeFromCustomTimeline" data-tweet-id="{{#getMainTweet}}{{id}}{{/getMainTweet}}" title="{{_i}}Remove from collection{{/i}}" data-placement="bottom"> <i class="icon icon-close txt-right"></i> </a> </li> {{/withRemove}} </ul>',this.TD_mustaches["status/tweet_single_footer.mustache"]='{{#withFooter}} <footer class="tweet-footer cf"> {{#withTweetActions}} {{> status/tweet_single_actions}} {{/withTweetActions}}   {{#getMainTweet}} {{^inReplyToID}} <a class="pull-left margin-txs txt-mute txt-small is-vishidden-narrow" href="#" rel="viewDetails">{{_i}}Details{{/i}}</a> <a class="pull-left margin-txs txt-mute txt-small is-vishidden is-visshown-narrow" href="#" rel="viewDetails">{{_i}}Open{{/i}}</a> {{/inReplyToID}} {{#inReplyToID}} <a class="pull-left margin-txs txt-mute txt-small link-complex" href="#" rel="viewDetails"> <i class="icon icon-conversation icon-small-context"></i> <span class="link-complex-target"> <span class="is-vishidden-wide is-vishidden-narrow">{{_i}}View{{/i}}</span> <span class="is-vishidden is-visshown-wide">{{_i}}Conversation{{/i}}</span> </span> </a> {{/inReplyToID}} {{/getMainTweet}} </footer> {{/withFooter}}',this.TD_mustaches["status/tweet_single_header.mustache"]='<a class="account-link link-complex {{#withInlinedUsername}}inline{{/withInlinedUsername}}{{^withInlinedUsername}}block{{/withInlinedUsername}}" href="{{getProfileURL}}" rel="user" target="_blank"> <div class="obj-left item-img tweet-img"> {{#withAvatar}} <img class="tweet-avatar avatar pull-right" src="{{profileImageURL}}" width="48" height="48" alt="{{screenName}}\'s avatar"> {{/withAvatar}} </div> <div class="nbfc {{#withInlinedUsername}}inline{{/withInlinedUsername}}"> <span class="account-inline txt-ellipsis{{#isProtected}} is-protected{{/isProtected}}"> <b class="fullname link-complex-target">{{name}}</b> {{#isVerified}}{{#withShowVerified}}<i class="js-show-tip sprite sprite-verified-mini" title="{{_i}}Verified account{{/i}}"></i>{{/withShowVerified}}{{/isVerified}}  <span class="username txt-mute">@{{screenName}}</span> {{#isProtected}}<i class="icon icon-protected txt-mute txt-base-medium"></i>{{/isProtected}} </span> </div> </a>',this.TD_mustaches["status/tweet_timestamp.mustache"]='{{#created}} <time class="tweet-timestamp js-timestamp pull-right txt-mute" datetime="{{toISOString}}" data-time="{{getTime}}"> {{/created}} <a class="txt-small" href="{{getChirpURL}}" rel="url" target="_blank"> {{createdPretty}} </a> {{#created}} </time> {{/created}}',this.TD_mustaches["status/tweet_translation.mustache"]='<div class="js-tweet-translation in-tweet-divider"> <p class="tweet-translation-attribution-text block txt-uppercase padding-vl txt-mute"> {{#localizedLanguageName}}{{_i}}Translated from {{localizedLanguageName}} by {{>text/bing_translator_link}}{{/i}}{{/localizedLanguageName}} {{^localizedLanguageName}}{{_i}}Translated by {{>text/bing_translator_link}}{{/i}}{{/localizedLanguageName}} </p> <p class="js-tweet-translation-text tweet-translation-text">{{#translation}}{{{htmltext}}}{{/translation}}</p> </div>',this.TD_mustaches["stream_item.mustache"]='<article class="stream-item js-stream-item {{$stream_item_classes}}{{/stream_item_classes}}" {{$stream_item_data}}{{/stream_item_data}}> <div class="js-stream-item-content item-box {{$stream_item_content_classes}}{{/stream_item_content_classes}}">  {{$content}}{{/content}}  </div> </article>',this.TD_mustaches["teams_upsell.mustache"]='<div class="js-teams-upsell info-popover info-popover-teams anim bg-r-white txt-on-r-twitter-blue txt-size--14"> <div class="info-popover-content bg-r-twitter-blue padding-a--25"> <i class="info-popover-teams-icon icon icon-user-team-mgr txt-r-white block obj-center"></i> <p class="txt-center txt-size--16"><b>{{_i}}Set up your team{{/i}}</b></p> <ol class="ordered-list info-popover-list txt-r-light-blue"> <li class="ordered-list-item info-popover-list-item padding-b--10 txt-r-white">{{_i}}Select the account you want to share{{/i}}</li> <li class="ordered-list-item info-popover-list-item padding-b--10 txt-r-white">{{_i}}Select the "team" option for that account{{/i}}</li> <li class="ordered-list-item info-popover-list-item txt-r-white">{{_i}}Add team members{{/i}}</li> </ol> <p class="margin-b--10 txt-center">{{_i}}Team members will be able to use this shared Twitter account from their TweetDeck. You may revoke their access at any time.{{/i}}</p> <a href="https://support.twitter.com/articles/20171753-using-team-accounts-on-tweetdeck" class="block txt-center link-underline link-current-color">{{_i}}Learn more{{/i}}</a>  </div> <div class="info-caret"></div> <a href="#" class="js-teams-upsell-close info-popover-close"> <i class="icon icon-close icon-center-24"></i> </a> </div>',this.TD_mustaches["text/already_registered.mustache"]='{{_i}}There\'s already a TweetDeck account for that email address.{{/i}} <a href="#" data-action="forgotPassword">{{_i}}Want to recover your password?{{/i}}</a>',this.TD_mustaches["text/b.mustache"]="<b>{{{content}}}</b>",this.TD_mustaches["text/bing_translator_link.mustache"]='<a href="http://aka.ms/Twitter2BingTranslator" rel="url" target="_blank" class="inline-block align-middle sprite bing-logo"></a>',this.TD_mustaches["text/br.mustache"]="<br>",this.TD_mustaches["text/close_em.mustache"]="</em>",this.TD_mustaches["text/close_strong.mustache"]="</strong>",this.TD_mustaches["text/em.mustache"]="<em>",this.TD_mustaches["text/favorite_action.mustache"]="{{#account}} {{^isFavorite}} {{_i}}Favorite from {{getUsername}}{{/i}} {{/isFavorite}} {{#isFavorite}} {{_i}}Unfavorite from {{getUsername}}{{/i}} {{/isFavorite}} {{/account}}",this.TD_mustaches["text/followers_you_follow_link.mustache"]='<a href="https://www.twitter.com/{{screenName}}/followers_you_follow" target="_blank">{{_i}}more{{/i}}</a>',this.TD_mustaches["text/gallery_flag_media.mustache"]='<a class="js-media-flag-nsfw med-flaglink {{#flagged}}is-hidden{{/flagged}}" href="#">{{_i}}Flag media{{/i}}</a> <a class="js-media-flagged-nsfw med-flaglink {{^flagged}}is-hidden{{/flagged}}" href="https://support.twitter.com/articles/20069937" rel="url" target="_blank">{{_i}}Flagged (learn more){{/i}}</a>',this.TD_mustaches["text/gallery_original_link.mustache"]='<a href="{{url}}" class="med-origlink" rel="url" target="_blank">{{_i}}View original{{/i}}</a>',this.TD_mustaches["text/global_filter_value.mustache"]="&ldquo;<em>{{value}}</em>&rdquo;",this.TD_mustaches["text/list_link_real_name.mustache"]='<a href="https://twitter.com/{{#user}}{{screenName}}{{/user}}/lists/{{slug}}" rel="list" data-screen-name="{{#user}}{{screenName}}{{/user}}" data-slug="{{slug}}" target="_blank">{{name}}</a>',this.TD_mustaches["text/list_link_slug.mustache"]='<a href="https://twitter.com/{{#user}}{{screenName}}{{/user}}/lists/{{slug}}" rel="list" data-screen-name="{{#user}}{{screenName}}{{/user}}" data-slug="{{slug}}" target="_blank">{{fullName}}</a>',this.TD_mustaches["text/login_verification_link.mustache"]='<a href="http://support.twitter.com/articles/20170388-using-login-verification" rel="url" target="_blank" class="startflow-link">{{_i}}login verification{{/i}}</a>',this.TD_mustaches["text/open_strong.mustache"]="<strong>",this.TD_mustaches["text/profile_link.mustache"]='<a href="https://twitter.com/{{#user}}{{screenName}}{{/user}}/{{slug}}" rel="user" data-user-name="{{#user}}{{screenName}}{{/user}}" class="link-complex" target="_blank"><span>@</span><span class="link-complex-target">{{#user}}{{screenName}}{{/user}}</span></a>',this.TD_mustaches["text/retweet_by_link.mustache"]='<a href="{{getProfileURL}}" rel="user" target="_blank">{{name}}</a>',this.TD_mustaches["text/screenname_txt.mustache"]="@{{inReplyToScreenName}}",this.TD_mustaches["text/search_link.mustache"]='<a href="https://twitter.com/search?q={{escapedSymbol}}{{searchTerm}}" rel="hashtag" target="_blank" class="link-complex"><span class="hash">{{symbol}}</span><span class="link-complex-target">{{searchTerm}}</span></a>',this.TD_mustaches["text/social_proof_link.mustache"]='<a href="https://twitter.com/{{screen_name}}" rel="user" target="_blank">{{name}}</a>',this.TD_mustaches["text/strong.mustache"]="<strong> {{#text}} {{text}} {{/text}} {{^text}} {{#name}} {{name}} {{/name}} {{/text}} {{{html}}} </strong>",this.TD_mustaches["text/user_link_fullname.mustache"]='<a class="account-link {{#withBold}}txt-bold{{/withBold}}" href="{{profileUrl}}" rel="user">{{name}}</a>',this.TD_mustaches["text/user_link_screenname.mustache"]='<a href="{{getProfileURL}}" rel="user" class="pretty-link" target="_blank">@{{screenName}}</a>',this.TD_mustaches["topbar/alert_message.mustache"]='<div class="js-status-message status-message"> <p class="status-message-text padding-al with-linebreaks">{{#prefix}}{{prefix}}: {{/prefix}}{{message}}</p> <a href="#" class="js-dismiss status-dismiss"><i class="icon icon-close"></i></a> </div>',this.TD_mustaches["topbar/app_header.mustache"]='<header class="js-app-header pin-all app-header"> <div class="js-app-header-inner pin-v app-header-inner">  <button class="js-show-drawer js-show-tip btn btn-compose margin-bm tweet-button" title="{{_i}}New Tweet{{/i}}" data-tooltip-position="right" data-drawer="compose"> <i class="icon icon-compose"></i> <span class="label margin-an">{{_i}}New Tweet{{/i}}</span> </button>  <div class="attach-compose-buttons"><!-- wrap close button as it has different padding --> <button class="js-hide-drawer btn btn-compose margin-bm tweet-button is-hidden" data-drawer="compose"> <i class="icon icon-compose" data-tweet-type="tweet reply"></i> <i class="icon icon-compose-dm icon-large" data-tweet-type="message"></i> </button> </div>  <div class="js-search js-overlay app-search"> <button class="js-header-action js-show-tip app-search-fake padding-al margin-bm" data-action="show-search" title="{{_i}}Search{{/i}}" data-tooltip-position="right"> <i class="icon icon-search"></i> </button> <form class="js-search-form app-search-form"> <label class="is-vishidden">{{_i}}Search{{/i}}</label> {{>search_input}} </form> <div class="js-search-in-popover"></div> </div>  <div class="js-column-nav-scroller column-navigator antiscroll-wrap"> <nav id="column-navigator" class="js-column-nav scroll-v antiscroll-inner"></nav> </div>  <nav class="app-navigator margin-bm padding-ts"> <a class="js-header-action js-app-add-column link-clean cf app-nav-link padding-hl with-nav-border-t" data-action="add-column" data-title="{{_i}}Add column{{/i}}"> <div class="obj-left"> <i class="icon icon-plus icon-large"></i> </div> <div class="nbfc padding-ts hide-condensed">{{_i}}Add column{{/i}}</div> </a> <a class="js-header-action link-clean cf app-nav-link padding-hl" data-action="change-sidebar-width" data-title="{{_i}}Expand{{/i}}"> <div class="obj-left"> <i class="icon icon-arrow-l-double icon-large"></i> <i class="icon icon-arrow-r-double icon-large"></i> </div> <div class="nbfc padding-ts hide-condensed">{{_i}}Collapse{{/i}}</div> </a>  <a class="js-show-drawer js-header-action link-clean cf app-nav-tab"  data-title="{{_i}}Accounts{{/i}}" data-drawer="accountSettings"> <div class="obj-left"> <i class="icon icon-user-switch icon-large position-rel"> <span class="js-invite-count msg-unread-count txt-base-small numbered-badge numbered-badge-onnav"></span> </i> </div> <div class="nbfc padding-ts hide-condensed">{{_i}}Accounts{{/i}}</div> </a>  <a class="js-hide-drawer position-rel link-clean cf app-nav-tab bg-r-light-gray txt-r-text is-hidden is-selected"  data-title="{{_i}}Accounts{{/i}}" data-drawer="accountSettings"> <div class="obj-left"> <i class="icon icon-user-switch icon-large"></i> </div> <div class="nbfc padding-ts hide-condensed">{{_i}}Accounts{{/i}}</div> </a>  <a class="js-header-action js-app-settings link-clean cf app-nav-link padding-hl" data-action="settings-menu" data-title="{{_i}}Settings{{/i}}"> <div class="obj-left"> <i class="icon icon-settings icon-large"></i> </div> <div class="nbfc padding-ts hide-condensed">{{_i}}Settings{{/i}}</div> </a> </nav>  <h1 class="app-title"> <i class="sprite sprite-logo"></i> <i class="sprite sprite-logo-badge"></i> <span class="is-vishidden">TweetDeck</span> </h1> </div>  </header>',this.TD_mustaches["topbar/message_banner.mustache"]='<div class="message-content padding-hl padding-vm"> <span class="message-text padding-r--20"> {{text}} {{#actions}} <a class="btn {{buttonClass}} margin-l--10" data-action-id="{{actionId}}" {{#isExternalUrl}} href="{{url}}" rel="url" {{/isExternalUrl}}> {{label}} </a> {{/actions}} </span>  {{^isUndismissable}} <a href="#" class="js-dismiss dismiss"> <i class="icon icon-close"></i> </a> {{/isUndismissable}}  </div>',this.TD_mustaches["twitter_profile.mustache"]='<div class="{{#loading}}is-loading{{/loading}}"> {{#loading}} <img src="{{#asset}}/web/assets/global/backgrounds/spinner_large_white.gif{{/asset}}" alt="{{_i}}Loading…{{/i}}"> {{/loading}} {{^loading}} <a href="#" class="js-dismiss mdl-dismiss link-normal-dark"><i class="sprite sprite-close"></i></a> {{/loading}}  {{#twitterProfile}} <div class="s-profile prf"> {{#profile}} <div class="prf-header" style="background-image: url({{profileBannerURL}})"> <div class="prf-header-inner-overlay"></div> <div class="prf-card-inner"> <a class="js-action-url link-clean" href="{{getProfileURL}}" target="_blank"> <span class="prf-img"> <img src="{{biggerProfileImageURL}}" class="avatar size73"> </span>  <strong class="fullname">{{name}} {{#isVerified}}<i title="{{_i}}Verified account{{/i}}" class="js-show-tip sprite sprite-verified"></i>{{/isVerified}}{{#isTranslator}}<i title="{{_i}}Translator{{/i}}" class="js-show-tip sprite sprite-translator"></i>{{/isTranslator}}</strong> <p class="username">@{{screenName}}{{#isProtected}}<i class="icon icon-protected"></i>{{/isProtected}}<span class="prf-follow-status">{{_i}}Follows @{{preferredAccount}}{{/i}}</span></p> </a> <p class="prf-bio">{{{bio}}}</p> <p class="location txt-ellipsis"> {{location}}{{#getDisplayURL}}{{#location}}&nbsp;&nbsp;<strong>&middot;</strong>&nbsp;&nbsp;{{/location}}<a href="{{url}}" class="prf-siteurl js-action-url" target="_blank">{{getDisplayURL}}</a>{{/getDisplayURL}} </p> </div> </div> {{/profile}}  <div class="prf-actions"> {{> profile_card_stats}}  <div class="js-social-proof social-proof-container txt-base-small cf padding-al is-hidden"></div>  <div class="js-profile-columns"> <ul class="lst-profile cf"> {{#displayOrderProfile}} <li class="js-item-launch {{class}}" data-action="open" data-type="{{type}}"> <a href="#"> <i class="icon {{columnIconClass}}"></i> <span class="txt-ellipsis">{{title}}</span> </a> </li> {{/displayOrderProfile}} </ul> </div> </div> </div> {{/twitterProfile}} </div>',this.TD_mustaches["twitter_profile_social_proof.mustache"]='<p class="pull-left">{{_i}}Followed by{{/i}} </p><p class="social-proof-names pull-right">{{{followedByString}}}{{#others}} and {{{others}}}{{/others}}.</p>',this.TD_mustaches["typeahead/recent_searches_placeholder.mustache"]='<li class="list-placeholder"> {{_i}}Recent searches will appear here.{{/i}} </li>',this.TD_mustaches["typeahead/typeahead_conversations.mustache"]='{{#chirp}} <li class="js-typeahead-item js-typeahead-conversation-item is-actionable list-item item-box" data-search-type="conversation" data-search-query="{{title}}" data-conversation-id="{{conversationId}}" data-account-key="{{accountKey}}" data-profile-image-url="{{profile_image_url_https}} "> <div class="account-summary cf"> <div class="obj-left item-img-24"> {{^withMultipleAvatars}} {{#avatars.0}} <img class="pull-left" src="{{profileImageURL}}" width="24" height="24" alt="{{screenName}}\'s avatar"> {{/avatars.0}} {{/withMultipleAvatars}} {{#withMultipleAvatars}} <div class="pull-left media-grid-container multiple-avatar-grid-mini"> <div class="{{avatarsClass}}"> {{#avatars}} <div class="media-image-container media-image-container-mini"> <div class="media-image block position-rel" style="background-image: url({{profileImageURL}});" ></div> </div> {{/avatars}} </div> </div> {{/withMultipleAvatars}} </div> <div class="nbfc"> <div class="list-text link-complex inline-block"> {{#getConversationTitleInformation}} {{#name}} <b class="fullname block txt-ellipsis">{{{name}}}</b> {{/name}} {{^name}} {{#isOneToOne}} {{#participants.0}} <b class="fullname block txt-ellipsis">{{name}}</b> @{{screenName}} {{/participants.0}} {{/isOneToOne}} {{#isThreeway}} <b class="fullname block txt-ellipsis"> {{#participants.0}} {{name}}, {{/participants.0}} {{#participants.1}} {{name}} {{/participants.1}} </b> {{/isThreeway}} {{#isOneToMany}} {{#participants.0}} <b class="fullname block txt-ellipsis">{{name}}</b> + {{numberOfOtherParticipants}} {{/participants.0}} {{/isOneToMany}} {{/name}} {{/getConversationTitleInformation}} </div> </div> </div> </li> {{/chirp}}',this.TD_mustaches["typeahead/typeahead_dropdown.mustache"]='<div class="js-typeahead-dropdown scroll-v {{#styledScrollbar}}scroll-styled-v{{/styledScrollbar}}"> <ul class="js-typeahead-recent-search-list is-hidden"></ul> <ul class="js-typeahead-saved-search-list is-hidden"></ul> <ul class="js-typeahead-topic-list is-hidden"></ul> <ul class="js-typeahead-user-list is-hidden list-divider"></ul> <ul class="js-typeahead-conversation-list is-hidden list-divider"></ul> <ul class="js-typeahead-lists-list is-hidden list-divider"></ul> <div class="js-typeahead-recent-search-clear js-typeahead-item recent-search-clear list-item list-item-button is-actionable item-box" data-search-type="recent-search-clear" data-search-query="recent-search-clear"> <span href="#"> {{_i}}Clear history{{/i}} </span> </div> </div>',this.TD_mustaches["typeahead/typeahead_lists.mustache"]='{{#lists}} <li class="js-typeahead-item js-typeahead-list-item list-item is-actionable item-box" data-search-type="list" data-search-query="{{query}}"> <div class="list-summary cf"> <div class="obj-left item-img-24"> <i class="icon icon-list icon-medium list-icon"></i> </div> <div class="nbfc"> <div class="list-text link-complex inline-block"> <b class="fullname block txt-ellipsis">{{name}}</b> <span class="username block txt-ellipsis txt-mute">@{{screenName}}</span> </div> </div> </div> </li> {{/lists}}',this.TD_mustaches["typeahead/typeahead_recent_searches.mustache"]='{{#recentSearches}} <li class="js-typeahead-item js-typeahead-recent-search-item list-item is-actionable item-box" data-search-type="recent-search" data-search-query="{{query}}"> <div class="obj-left item-img-24"> <i class="icon icon-search icon-medium list-icon"></i> </div> <div class="nfbc list-text txt-ellipsis">{{{name}}}</div> </li> {{/recentSearches}}',this.TD_mustaches["typeahead/typeahead_saved_searches.mustache"]='{{#savedSearches}} <li class="js-typeahead-item js-typeahead-saved-search-item list-item is-actionable item-box" data-search-type="saved-search" data-search-query="{{query}}"> <div class="obj-left item-img-24"> <i class="icon icon-search icon-medium list-icon"></i> </div> <div class="nfbc list-text txt-ellipsis">{{{name}}}</div> </li> {{/savedSearches}}',this.TD_mustaches["typeahead/typeahead_topics.mustache"]='{{#topics}} <li class="js-typeahead-item js-typeahead-topic-item list-item is-actionable item-box" data-search-type="topic" data-search-query="{{topic}}"> <div class="obj-left item-img-24"> <i class="icon icon-search icon-medium list-icon"></i> </div> <div class="nfbc list-text txt-ellipsis">{{{name}}}</div> </li> {{/topics}}',this.TD_mustaches["typeahead/typeahead_users.mustache"]='{{! NB: this template assumes data is in format provided by typeahead, not standard user object}} {{#users}} <li class="js-typeahead-item js-typeahead-user-item is-actionable list-item item-box" data-search-type="user" data-search-query="{{screen_name}}" data-screen-name="{{screen_name}}" data-user-name="{{name}}" data-user-id="{{id}}" data-profile-image-url="{{profile_image_url_https}} "> <div class="account-summary cf"> <div class="obj-left item-img-24"> <img class="js-avatar tweet-avatar avatar size24 pull-right" src="{{profile_image_url_https}}" width="24" height="24" /> </div> <div class="nbfc"> <div class="list-text link-complex inline-block"> <b class="fullname block txt-ellipsis">{{name}} {{#verified}}<i class="sprite sprite-verified-mini"></i>{{/verified}} </b> <span class="username block txt-ellipsis txt-mute">@{{screen_name}}</span> </div> </div> </div> </li> {{/users}}',this.TD_mustaches["typeahead/typeahead_users_compose.mustache"]='{{#users}} <li class="js-typeahead-item js-typeahead-user-item typeahead-item padding-am cf is-actionable" data-search-type="user" data-search-query="{{screen_name}}" data-screen-name="{{screen_name}}" data-user-name="{{name}}" data-user-id="{{id}}" data-user-is-dm-able="{{is_dm_able}}" data-profile-image-url="{{profile_image_url_https}}" data-verified="{{verified}}"> <img src="{{profile_image_url_https}}" class="avatar obj-left size24"> <div class="nbfc txt-ellipsis padding-ts"> <strong class="fullname">{{name}}</strong> {{#verified}}<i class="js-show-tip sprite sprite-verified-mini txt-bot" title="{{_i}}Verified account{{/i}}"></i>{{/verified}} <span class="username"><span>@</span><span class="js-screenname">{{screen_name}}</span></span> </div> </li> {{/users}}',this.TD_mustaches["user_actions_btn_inv.mustache"]='<div class="follow-combo"> <span> <button class="js-user-actions-menu btn btn-alt btn-square" data-user-id="{{profile.id}}" data-menu-position="{{actionsMenuPosition}}"> <i class="icon icon-user-dd"></i> </button> </span> </div>',this.TD_mustaches["user_selector.mustache"]='<div class="js-search-input-control search-input-control"> <input class="js-username-input js-submittable-input" type="text" placeholder="{{placeholder}}" value="" > {{#withSelectButton}} <a href="#" class="js-select-button txt-base-medium search-input-perform-search" tabindex="-1"> <i class="icon icon-small {{selectButtonIconClass}}"></i> </a> {{/withSelectButton}} <a href="#" class="js-clear-search txt-base-medium search-input-clear-search" tabindex="-1"> <i class="icon icon-close icon-small"></i> </a> <span class="js-spinner txt-base-medium spinner-small spinner-small-trans search-input-spinner"></span> </div>',this.TD_mustaches["version.mustache"]="Version {{version}}{{#buildIDShort}}-{{buildIDShort}}{{/buildIDShort}} ({{#wrapperVersion}}{{wrapperVersion}}-{{/wrapperVersion}}{{appEnv}}{{#isTouchDevice}}-touch{{/isTouchDevice}})",this.TD_mustaches["with_fixed_header_and_footer.mustache"]='<div> <div class="js-fhf-header is-hidden position-rel"> {{$header}}{{/header}} </div> <div class="js-fhf-body pin-all is-inverted-dark"> {{$body}}{{/body}} </div> <div class="js-fhf-footer is-hidden pin-bottom padding-am list-divider"> {{$footer}}{{/footer}} </div> </div>',window.Modernizr=function(e,t,i){function n(e){b.cssText=e}function s(e,t){return n(D.join(e+";")+(t||""))}function r(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var s=e[n];if(!a(s,"-")&&b[s]!==i)return"pfx"==t?s:!0}return!1}function c(e,t,n){for(var s in e){var a=t[e[s]];if(a!==i)return n===!1?e[s]:r(a,"function")?a.bind(n||t):a}return!1}function l(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+S.join(n+" ")+n).split(" ");return r(t,"string")||r(t,"undefined")?o(s,t):(s=(e+" "+E.join(n+" ")+n).split(" "),c(s,t,i))}function u(){m.input=function(i){for(var n=0,s=i.length;s>n;n++)I[i[n]]=!!(i[n]in w);return I.list&&(I.list=!(!t.createElement("datalist")||!e.HTMLDataListElement)),I}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),m.inputtypes=function(e){for(var n,s,r,a=0,o=e.length;o>a;a++)w.setAttribute("type",s=e[a]),n="text"!==w.type,n&&(w.value=y,w.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&w.style.WebkitAppearance!==i?(g.appendChild(w),r=t.defaultView,n=r.getComputedStyle&&"textfield"!==r.getComputedStyle(w,null).WebkitAppearance&&0!==w.offsetHeight,g.removeChild(w)):/^(search|tel)$/.test(s)||(n=/^(url|email)$/.test(s)?w.checkValidity&&w.checkValidity()===!1:w.value!=y)),A[e[a]]=!!n;return A}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d,h,p="2.7.2",m={},f=!0,g=t.documentElement,v="modernizr",T=t.createElement(v),b=T.style,w=t.createElement("input"),y=":)",_={}.toString,D=" -webkit- -moz- -o- -ms- ".split(" "),C="Webkit Moz O ms",S=C.split(" "),E=C.toLowerCase().split(" "),x={svg:"http://www.w3.org/2000/svg"},k={},A={},I={},M=[],R=M.slice,L=function(e,i,n,s){var r,a,o,c,l=t.createElement("div"),u=t.body,d=u||t.createElement("body");if(parseInt(n,10))for(;n--;)o=t.createElement("div"),o.id=s?s[n]:v+(n+1),l.appendChild(o);return r=["&#173;",'<style id="s',v,'">',e,"</style>"].join(""),l.id=v,(u?l:d).innerHTML+=r,d.appendChild(l),u||(d.style.background="",d.style.overflow="hidden",c=g.style.overflow,g.style.overflow="hidden",g.appendChild(d)),a=i(l,e),u?l.parentNode.removeChild(l):(d.parentNode.removeChild(d),g.style.overflow=c),!!a},N=function(t){var i=e.matchMedia||e.msMatchMedia;if(i)return i(t).matches;var n;return L("@media "+t+" { #"+v+" { position: absolute; } }",function(t){n="absolute"==(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position}),n},O=function(){function e(e,s){s=s||t.createElement(n[e]||"div"),e="on"+e;var a=e in s;return a||(s.setAttribute||(s=t.createElement("div")),s.setAttribute&&s.removeAttribute&&(s.setAttribute(e,""),a=r(s[e],"function"),r(s[e],"undefined")||(s[e]=i),s.removeAttribute(e))),s=null,a}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),U={}.hasOwnProperty;h=r(U,"undefined")||r(U.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return U.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=R.call(arguments,1),n=function(){if(this instanceof n){var s=function(){};s.prototype=t.prototype;var r=new s,a=t.apply(r,i.concat(R.call(arguments)));return Object(a)===a?a:r}return t.apply(e,i.concat(R.call(arguments)))};return n}),k.flexbox=function(){return l("flexWrap")},k.flexboxlegacy=function(){return l("boxDirection")},k.canvas=function(){var e=t.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},k.canvastext=function(){return!(!m.canvas||!r(t.createElement("canvas").getContext("2d").fillText,"function"))},k.webgl=function(){return!!e.WebGLRenderingContext},k.touch=function(){var i;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?i=!0:L(["@media (",D.join("touch-enabled),("),v,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){i=9===e.offsetTop}),i},k.geolocation=function(){return"geolocation"in navigator},k.postmessage=function(){return!!e.postMessage},k.websqldatabase=function(){return!!e.openDatabase},k.indexedDB=function(){return!!l("indexedDB",e)},k.hashchange=function(){return O("hashchange",e)&&(t.documentMode===i||t.documentMode>7)},k.history=function(){return!(!e.history||!history.pushState)},k.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},k.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},k.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),a(b.backgroundColor,"rgba")},k.hsla=function(){return n("background-color:hsla(120,40%,100%,.5)"),a(b.backgroundColor,"rgba")||a(b.backgroundColor,"hsla")},k.multiplebgs=function(){return n("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(b.background)},k.backgroundsize=function(){return l("backgroundSize")},k.borderimage=function(){return l("borderImage")},k.borderradius=function(){return l("borderRadius")},k.boxshadow=function(){return l("boxShadow")},k.textshadow=function(){return""===t.createElement("div").style.textShadow},k.opacity=function(){return s("opacity:.55"),/^0.55$/.test(b.opacity)},k.cssanimations=function(){return l("animationName")},k.csscolumns=function(){return l("columnCount")},k.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",i="linear-gradient(left top,#9f9, white);";return n((e+"-webkit- ".split(" ").join(t+e)+D.join(i+e)).slice(0,-e.length)),a(b.backgroundImage,"gradient")},k.cssreflections=function(){return l("boxReflect")},k.csstransforms=function(){return!!l("transform")},k.csstransforms3d=function(){var e=!!l("perspective");return e&&"webkitPerspective"in g.style&&L("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t,i){e=9===t.offsetLeft&&3===t.offsetHeight}),e},k.csstransitions=function(){return l("transition")},k.fontface=function(){var e;return L('@font-face {font-family:"font";src:url("https://")}',function(i,n){var s=t.getElementById("smodernizr"),r=s.sheet||s.styleSheet,a=r?r.cssRules&&r.cssRules[0]?r.cssRules[0].cssText:r.cssText||"":"";e=/src/i.test(a)&&0===a.indexOf(n.split(" ")[0])}),e},k.generatedcontent=function(){var e;return L(["#",v,"{font:0/0 a}#",v,':after{content:"',y,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},k.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},k.audio=function(){var e=t.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i},k.localstorage=function(){try{return localStorage.setItem(v,v),localStorage.removeItem(v),!0}catch(e){return!1}},k.sessionstorage=function(){try{return sessionStorage.setItem(v,v),sessionStorage.removeItem(v),!0}catch(e){return!1}},k.webworkers=function(){return!!e.Worker},k.applicationcache=function(){
return!!e.applicationCache},k.svg=function(){return!!t.createElementNS&&!!t.createElementNS(x.svg,"svg").createSVGRect},k.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==x.svg},k.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(_.call(t.createElementNS(x.svg,"animate")))},k.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(_.call(t.createElementNS(x.svg,"clipPath")))};for(var F in k)h(k,F)&&(d=F.toLowerCase(),m[d]=k[F](),M.push((m[d]?"":"no-")+d));return m.input||u(),m.addTest=function(e,t){if("object"==typeof e)for(var n in e)h(e,n)&&m.addTest(n,e[n]);else{if(e=e.toLowerCase(),m[e]!==i)return m;t="function"==typeof t?t():t,"undefined"!=typeof f&&f&&(g.className+=" "+(t?"":"no-")+e),m[e]=t}return m},n(""),T=w=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=T.elements;return"string"==typeof e?e.split(" "):e}function s(e){var t=v[e[f]];return t||(t={},g++,e[f]=g,v[g]=t),t}function r(e,i,n){if(i||(i=t),u)return i.createElement(e);n||(n=s(i));var r;return r=n.cache[e]?n.cache[e].cloneNode():m.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),!r.canHaveChildren||p.test(e)||r.tagUrn?r:n.frag.appendChild(r)}function a(e,i){if(e||(e=t),u)return e.createDocumentFragment();i=i||s(e);for(var r=i.frag.cloneNode(),a=0,o=n(),c=o.length;c>a;a++)r.createElement(o[a]);return r}function o(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return T.shivMethods?r(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(T,t.frag)}function c(e){e||(e=t);var n=s(e);return!T.shivCSS||l||n.hasCSS||(n.hasCSS=!!i(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||o(e,n),e}var l,u,d="3.7.0",h=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,m=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",g=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){l=!0,u=!0}}();var T={elements:h.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:d,shivCSS:h.shivCSS!==!1,supportsUnknownElements:u,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:c,createElement:r,createDocumentFragment:a};e.html5=T,c(t)}(this,t),m._version=p,m._prefixes=D,m._domPrefixes=E,m._cssomPrefixes=S,m.mq=N,m.hasEvent=O,m.testProp=function(e){return o([e])},m.testAllProps=l,m.testStyles=L,m.prefixed=function(e,t,i){return t?l(e,t,i):l(e,"pfx")},g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+M.join(" "):""),m}(this,this.document),window.console||(window.console={log:function(){}});var TD={storage:{},core:{},net:{},mustaches:"undefined"==typeof TD_mustaches?{}:TD_mustaches,assetsOverlay:"undefined"==typeof TD_assetsOverlay?{}:TD_assetsOverlay,templates:{},components:{},services:{},controller:{auth:{}},vo:{},ui:{},sync:{},cache:{}};TD.buildID="3d7567fd6d8cdeff8fa923bcfb0655e921e23bbb",TD.buildIDShort="3d7567f",TD.buildTime=1428672557e3,TD.version="3.9.805",TD.config={web_root:"https://tweetdeck.twitter.com",api_root:"https://tweetdeck.twitter.com",twitter_api_base:"https://api.twitter.com",twitter_api_version:"1.1",td_create_key:"WRaMQNHU2Jy51bhFEL3C",td_create_secret:"MiLkmD1t1xlZqKoLLY8ScxX5gwpOQsjBopZcV4KLcuo=",client_name:"blackbird",debug_menu:!1,app_name:"TweetDeck by Twitter",app_icon:"web/assets/logos/128.png",touchdeck:!0,sync_name:"blackbird"};var Hogan={};!function(e){function t(e,t,i){var n;return t&&"object"==typeof t&&(void 0!==t[e]?n=t[e]:i&&t.get&&"function"==typeof t.get&&(n=t.get(e))),n}function i(e,t,i,n,s,r){function a(){}function o(){}a.prototype=e,o.prototype=e.subs;var c,l=new a;l.subs=new o,l.subsText={},l.buf="",n=n||{},l.stackSubs=n,l.subsText=r;for(c in t)n[c]||(n[c]=t[c]);for(c in n)l.subs[c]=n[c];s=s||{},l.stackPartials=s;for(c in i)s[c]||(s[c]=i[c]);for(c in s)l.partials[c]=s[c];return l}function n(e){return String(null===e||void 0===e?"":e)}function s(e){return e=n(e),u.test(e)?e.replace(r,"&amp;").replace(a,"&lt;").replace(o,"&gt;").replace(c,"&#39;").replace(l,"&quot;"):e}e.Template=function(e,t,i,n){e=e||{},this.r=e.code||this.r,this.c=i,this.options=n||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(e,t,i){return""},v:s,t:n,render:function(e,t,i){return this.ri([e],t||{},i)},ri:function(e,t,i){return this.r(e,t,i)},ep:function(e,t){var n=this.partials[e],s=t[n.name];if(n.instance&&n.base==s)return n.instance;if("string"==typeof s){if(!this.c)throw new Error("No compiler available.");s=this.c.compile(s,this.options)}if(!s)return null;if(this.partials[e].base=s,n.subs){t.stackText||(t.stackText={});for(key in n.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);s=i(s,n.subs,n.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=s,s},rp:function(e,t,i,n){var s=this.ep(e,i);return s?s.ri(t,i,n):""},rs:function(e,t,i){var n=e[e.length-1];if(!d(n))return void i(e,t,this);for(var s=0;s<n.length;s++)e.push(n[s]),i(e,t,this),e.pop()},s:function(e,t,i,n,s,r,a){var o;return d(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ms(e,t,i,n,s,r,a)),o=!!e,!n&&o&&t&&t.push("object"==typeof e?e:t[t.length-1]),o)},d:function(e,i,n,s){var r,a=e.split("."),o=this.f(a[0],i,n,s),c=this.options.modelGet,l=null;if("."===e&&d(i[i.length-2]))o=i[i.length-1];else for(var u=1;u<a.length;u++)r=t(a[u],o,c),void 0!==r?(l=o,o=r):o="";return s&&!o?!1:(s||"function"!=typeof o||(i.push(l),o=this.mv(o,i,n),i.pop()),o)},f:function(e,i,n,s){for(var r=!1,a=null,o=!1,c=this.options.modelGet,l=i.length-1;l>=0;l--)if(a=i[l],r=t(e,a,c),void 0!==r){o=!0;break}return o?(s||"function"!=typeof r||(r=this.mv(r,i,n)),r):s?!1:""},ls:function(e,t,i,s,r){var a=this.options.delimiters;return this.options.delimiters=r,this.b(this.ct(n(e.call(t,s)),t,i)),this.options.delimiters=a,!1},ct:function(e,t,i){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,i)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,i,n,s,r,a){var o,c=t[t.length-1],l=e.call(c);return"function"==typeof l?n?!0:(o=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(l,c,i,o.substring(s,r),a)):l},mv:function(e,t,i){var s=t[t.length-1],r=e.call(s);return"function"==typeof r?this.ct(n(r.call(s)),s,i):r},sub:function(e,t,i,n){var s=this.subs[e];s&&(this.activeSub=e,s(t,i,this,n),this.activeSub=!1)}};var r=/&/g,a=/</g,o=/>/g,c=/\'/g,l=/\"/g,u=/[&<>\"\']/,d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:Hogan),function(e){function t(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function i(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function n(e,t,i){if(t.charAt(i)!=e.charAt(0))return!1;for(var n=1,s=e.length;s>n;n++)if(t.charAt(i+n)!=e.charAt(n))return!1;return!0}function s(t,i,n,o){var c=[],l=null,u=null,d=null;for(u=n[n.length-1];t.length>0;){if(d=t.shift(),u&&"<"==u.tag&&!(d.tag in y))throw new Error("Illegal content in < super tag.");if(e.tags[d.tag]<=e.tags.$||r(d,o))n.push(d),d.nodes=s(t,d.tag,n,o);else{if("/"==d.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+d.n);if(l=n.pop(),d.n!=l.n&&!a(d.n,l.n,o))throw new Error("Nesting error: "+l.n+" vs. "+d.n);return l.end=d.i,c}"\n"==d.tag&&(d.last=0==t.length||"\n"==t[0].tag)}c.push(d)}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return c}function r(e,t){for(var i=0,n=t.length;n>i;i++)if(t[i].o==e.n)return e.tag="#",!0}function a(e,t,i){for(var n=0,s=i.length;s>n;n++)if(i[n].c==e&&i[n].o==t)return!0}function o(e){var t=[];for(var i in e)t.push('"'+l(i)+'": function(c,p,t,i) {'+e[i]+"}");return"{ "+t.join(",")+" }"}function c(e){var t=[];for(var i in e.partials)t.push('"'+l(i)+'":{name:"'+l(e.partials[i].name)+'", '+c(e.partials[i])+"}");return"partials: {"+t.join(",")+"}, subs: "+o(e.subs)}function l(e){return e.replace(T,"\\\\").replace(f,'\\"').replace(g,"\\n").replace(v,"\\r").replace(b,"\\u2028").replace(w,"\\u2029")}function u(e){return~e.indexOf(".")?"d":"f"}function d(e,t){var i="<"+(t.prefix||""),n=i+e.n+_++;return t.partials[n]={name:e.n,partials:{}},t.code+='t.b(t.rp("'+l(n)+'",c,p,"'+(e.indent||"")+'"));',n}function h(e,t){t.code+="t.b(t.t(t."+u(e.n)+'("'+l(e.n)+'",c,p,0)));'}function p(e){return"t.b("+e+");"}var m=/\S/,f=/\"/g,g=/\n/g,v=/\r/g,T=/\\/g,b=/\u2028/,w=/\u2029/;e.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},e.scan=function(s,r){function a(){T.length>0&&(b.push({tag:"_t",text:new String(T)}),T="")}function o(){for(var t=!0,i=_;i<b.length;i++)if(t=e.tags[b[i].tag]<e.tags._v||"_t"==b[i].tag&&null===b[i].text.match(m),!t)return!1;return t}function c(e,t){if(a(),e&&o())for(var i,n=_;n<b.length;n++)b[n].text&&((i=b[n+1])&&">"==i.tag&&(i.indent=b[n].text.toString()),b.splice(n,1));else t||b.push({tag:"\n"});w=!1,_=b.length}function l(e,t){var n="="+C,s=e.indexOf(n,t),r=i(e.substring(e.indexOf("=",t)+1,s)).split(" ");return D=r[0],C=r[r.length-1],s+n.length-1}var u=s.length,d=0,h=1,p=2,f=d,g=null,v=null,T="",b=[],w=!1,y=0,_=0,D="{{",C="}}";for(r&&(r=r.split(" "),D=r[0],C=r[1]),y=0;u>y;y++)f==d?n(D,s,y)?(--y,a(),f=h):"\n"==s.charAt(y)?c(w):T+=s.charAt(y):f==h?(y+=D.length-1,v=e.tags[s.charAt(y+1)],g=v?s.charAt(y+1):"_v","="==g?(y=l(s,y),f=d):(v&&y++,f=p),w=y):n(C,s,y)?(b.push({tag:g,n:i(T),otag:D,ctag:C,i:"/"==g?w-D.length:y+C.length}),T="",y+=C.length-1,f=d,"{"==g&&("}}"==C?y++:t(b[b.length-1]))):T+=s.charAt(y);return c(w,!0),b};var y={_t:!0,"\n":!0,$:!0,"/":!0};e.stringify=function(t,i,n){return"{code: function (c,p,i) { "+e.wrapMain(t.code)+" },"+c(t)+"}"};var _=0;e.generate=function(t,i,n){_=0;var s={code:"",subs:{},partials:{}};return e.walk(t,s),n.asString?this.stringify(s,i,n):this.makeTemplate(s,i,n)},e.wrapMain=function(e){return'var t=this;t.b(i=i||"");'+e+"return t.fl();"},e.template=e.Template,e.makeTemplate=function(e,t,i){var n=this.makePartials(e);return n.code=new Function("c","p","i",this.wrapMain(e.code)),new this.template(n,t,this,i)},e.makePartials=function(e){var t,i={subs:{},partials:e.partials,name:e.name};for(t in i.partials)i.partials[t]=this.makePartials(i.partials[t]);for(t in e.subs)i.subs[t]=new Function("c","p","t","i",e.subs[t]);return i},e.codegen={"#":function(t,i){i.code+="if(t.s(t."+u(t.n)+'("'+l(t.n)+'",c,p,1),c,p,0,'+t.i+","+t.end+',"'+t.otag+" "+t.ctag+'")){t.rs(c,p,function(c,p,t){',e.walk(t.nodes,i),i.code+="});c.pop();}"},"^":function(t,i){i.code+="if(!t.s(t."+u(t.n)+'("'+l(t.n)+'",c,p,1),c,p,1,0,0,"")){',e.walk(t.nodes,i),i.code+="};"},">":d,"<":function(t,i){var n={partials:{},code:"",subs:{},inPartial:!0};e.walk(t.nodes,n);var s=i.partials[d(t,i)];s.subs=n.subs,s.partials=n.partials},$:function(t,i){var n={subs:{},code:"",partials:i.partials,prefix:t.n};e.walk(t.nodes,n),i.subs[t.n]=n.code,i.inPartial||(i.code+='t.sub("'+l(t.n)+'",c,p,i);')},"\n":function(e,t){t.code+=p('"\\n"'+(e.last?"":" + i"))},_v:function(e,t){t.code+="t.b(t.v(t."+u(e.n)+'("'+l(e.n)+'",c,p,0)));'},_t:function(e,t){t.code+=p('"'+l(e.text)+'"')},"{":h,"&":h},e.walk=function(t,i){for(var n,s=0,r=t.length;r>s;s++)n=e.codegen[t[s].tag],n&&n(t[s],i);return i},e.parse=function(e,t,i){return i=i||{},s(e,"",[],i.sectionTags||[])},e.cache={},e.cacheKey=function(e,t){return[e,!!t.asString,!!t.disableLambda,t.delimiters,!!t.modelGet].join("||")},e.compile=function(t,i){i=i||{};var n=e.cacheKey(t,i),s=this.cache[n];if(s){var r=s.partials;for(var a in r)delete r[a].instance;return s}return s=this.generate(this.parse(this.scan(t,i.delimiters),t,i),t,i),this.cache[n]=s}}("undefined"!=typeof exports?exports:Hogan),ScribeTransport.prototype={flush:function(e,t){if(e&&e.length){if(void 0===t&&(t=!!this.options.sync),this.options.useAjax){var i={url:this.options.url,data:$.extend(this.ajaxParams(e),this.options.requestParameters),type:"POST",dataType:"json",async:!t,headers:{"X-Twitter-Polling":!0}};this.options.debug&&(this.options.debugHandler&&(i.success=this.options.debugHandler),i.data.debug="1"),$.ajax(i)}else{var n=this.options.debug?"&debug=1":"";(new Image).src=this.options.url+"?q="+(+new Date).toString().slice(-4)+n+"&"+this.imageParams(e)}this.reset()}},ajaxParams:function(e){if("string"==typeof e)return{log:"["+e+"]"};var t=this.options.encodeParameters;return t&&"function"==typeof t?t.apply(this,arguments):{log:JSON.stringify(e)}},imageParams:function(e){if("string"==typeof e)return"log=%5B"+e+"%5D";var t=this.options.encodeParameters;return t&&"function"==typeof t?t.apply(this,arguments):"log="+encodeURIComponent(JSON.stringify(e))},reset:function(){this.options.bufferEvents&&(this.skipUnloadFlush=!1,sessionStorage.removeItem(this.options.bufferKey))},getBuffer:function(){return sessionStorage.getItem(this.options.bufferKey)||""},send:function(e,t,i){if(t&&e&&!(this.options.bufferSize<0)){if(e._category_=t,!i&&this.options.bufferEvents&&this.options.bufferSize){var n=JSON.stringify(e);this.options.useAjax||(n=encodeURIComponent(n));var s=this.getBuffer(),r=s+(s?this.SEPARATOR+n:n);this.options.bufferSize&&this.fullBuffer(r)?this.options.useAjax?this.flush(r):(this.flush(s),sessionStorage.setItem(this.options.bufferKey,n)):sessionStorage.setItem(this.options.bufferKey,r)}else this.flush([e],i);this.options.debug&&$(document).trigger("scribedata."+this.options.bufferKey,e),this.options.metrics&&"debug"!=e.event_info&&$(document).trigger("debugscribe",e)}},fullBuffer:function(e){return e.length>=(this.options.useAjax?2083*this.options.bufferSize:2050-this.options.url.length)},updateOptions:function(e){if(this.options=$.extend({},this.options,e),this.options.requestParameters||(this.options.requestParameters={}),void 0===this.options.flushOnUnload&&(this.options.flushOnUnload=!0),this.options.bufferKey||(this.options.bufferKey=this.SESSION_BUFFER_KEY),0===this.options.bufferSize&&(this.options.bufferEvents=!1),void 0===this.options.useAjax&&(this.options.useAjax=!0),this.options.bufferEvents||void 0==this.options.bufferEvents)try{sessionStorage.setItem(this.SESSION_BUFFER_KEY+".init","test");var t="test"==sessionStorage.getItem(this.SESSION_BUFFER_KEY+".init");sessionStorage.removeItem(this.SESSION_BUFFER_KEY+".init"),this.options.bufferEvents=t}catch(i){this.options.bufferEvents=!1}if(this.options.debug&&!this.options.debugHandler){var n=this;this.options.debugHandler=e.debugHandler||function(e){$(document).trigger("handlescribe."+n.options.bufferKey,e)}}var s="https:"===window.location.protocol?"https:":"http:";this.options.url=void 0===this.options.url?this.options.useAjax?this.SCRIBE_API_ENDPOINT:"https://twitter.com"+this.SCRIBE_API_ENDPOINT:this.options.url.replace(/^[a-z]+:/g,s).replace(/\/$/,""),this.options.bufferEvents&&void 0===this.options.bufferSize&&(this.options.bufferSize=20)},appHost:function(){return window.location.host},registerEventHandlers:function(){var e=this,t=$(document);if(this.options.bufferEvents&&(t.on("flushscribe."+e.options.bufferKey,function(t){e.flush(e.getBuffer(),!0)}),this.options.flushOnUnload)){var i=function(t){e.skipUnloadFlush=!t||!t.match(/http/)||!!t.match(new RegExp("^https?://"+e.appHost(),"gi")),e.skipUnloadFlush&&window.setTimeout(function(){e.skipUnloadFlush=!1},3e3)};t.on("mouseup."+this.options.bufferKey,"a",function(e){this.getAttribute("target")||e.button||e.metaKey||e.shiftKey||e.altKey||e.ctrlKey||i(this.getAttribute("href"))}),t.on("submit."+this.options.bufferKey,"form",function(e){i(this.getAttribute("action"))}),t.on("uiNavigate."+this.options.bufferKey,function(e,t){i(t.url)}),$(window).on("unload."+this.options.bufferKey,function(){e.skipUnloadFlush||e.flush(e.getBuffer(),!0),e.skipUnloadFlush=!1})}this.SEPARATOR=this.options.useAjax?",":encodeURIComponent(",")},destroy:function(){this.flush(this.getBuffer()),$(document).off("flushscribe."+this.options.bufferKey),$(window).off("unload."+this.options.bufferKey),$(document).off("mouseup."+this.options.bufferKey),$(document).off("submit."+this.options.bufferKey),$(document).off("uiNavigate."+this.options.bufferKey)}},function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t=e.length,i=ee.type(e);return"function"===i||ee.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,i){if(ee.isFunction(t))return ee.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return ee.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(oe.test(t))return ee.filter(t,e,i);t=ee.filter(t,e)}return ee.grep(e,function(e){return K.call(t,e)>=0!==i})}function s(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function r(e){var t=me[e]={};return ee.each(e.match(pe)||[],function(e,i){t[i]=!0}),t}function a(){X.removeEventListener("DOMContentLoaded",a,!1),e.removeEventListener("load",a,!1),ee.ready()}function o(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ee.expando+Math.random()}function c(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(we,"-$1").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:be.test(i)?ee.parseJSON(i):i}catch(s){}Te.set(e,t,i)}else i=void 0;return i}function l(){return!0}function u(){return!1}function d(){try{return X.activeElement}catch(e){}}function h(e,t){return ee.nodeName(e,"table")&&ee.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function m(e){var t=Ue.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function f(e,t){for(var i=0,n=e.length;n>i;i++)ve.set(e[i],"globalEval",!t||ve.get(t[i],"globalEval"))}function g(e,t){var i,n,s,r,a,o,c,l;if(1===t.nodeType){if(ve.hasData(e)&&(r=ve.access(e),a=ve.set(t,r),l=r.events)){delete a.handle,a.events={};for(s in l)for(i=0,n=l[s].length;n>i;i++)ee.event.add(t,s,l[s][i])}Te.hasData(e)&&(o=Te.access(e),c=ee.extend({},o),Te.set(t,c))}}function v(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&ee.nodeName(e,t)?ee.merge([e],i):i}function T(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Ce.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function b(t,i){var n=ee(i.createElement(t)).appendTo(i.body),s=e.getDefaultComputedStyle?e.getDefaultComputedStyle(n[0]).display:ee.css(n[0],"display");return n.detach(),s}function w(e){var t=X,i=$e[e];return i||(i=b(e,t),"none"!==i&&i||(Pe=(Pe||ee("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Pe[0].contentDocument,t.write(),t.close(),i=b(e,t),Pe.detach()),$e[e]=i),i}function y(e,t,i){var n,s,r,a,o=e.style;return i=i||We(e),i&&(a=i.getPropertyValue(t)||i[t]),i&&(""!==a||ee.contains(e.ownerDocument,e)||(a=ee.style(e,t)),He.test(a)&&Be.test(t)&&(n=o.width,s=o.minWidth,r=o.maxWidth,o.minWidth=o.maxWidth=o.width=a,a=i.width,o.width=n,o.minWidth=s,o.maxWidth=r)),void 0!==a?a+"":a}function _(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function D(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),n=t,s=Ye.length;s--;)if(t=Ye[s]+i,t in e)return t;return n}function C(e,t,i){var n=qe.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function S(e,t,i,n,s){for(var r=i===(n?"border":"content")?4:"width"===t?1:0,a=0;4>r;r+=2)"margin"===i&&(a+=ee.css(e,i+_e[r],!0,s)),n?("content"===i&&(a-=ee.css(e,"padding"+_e[r],!0,s)),"margin"!==i&&(a-=ee.css(e,"border"+_e[r]+"Width",!0,s))):(a+=ee.css(e,"padding"+_e[r],!0,s),"padding"!==i&&(a+=ee.css(e,"border"+_e[r]+"Width",!0,s)));return a}function E(e,t,i){var n=!0,s="width"===t?e.offsetWidth:e.offsetHeight,r=We(e),a="border-box"===ee.css(e,"boxSizing",!1,r);if(0>=s||null==s){if(s=y(e,t,r),(0>s||null==s)&&(s=e.style[t]),He.test(s))return s;n=a&&(J.boxSizingReliable()||s===e.style[t]),s=parseFloat(s)||0}return s+S(e,t,i||(a?"border":"content"),n,r)+"px"}function x(e,t){for(var i,n,s,r=[],a=0,o=e.length;o>a;a++)n=e[a],n.style&&(r[a]=ve.get(n,"olddisplay"),i=n.style.display,t?(r[a]||"none"!==i||(n.style.display=""),""===n.style.display&&De(n)&&(r[a]=ve.access(n,"olddisplay",w(n.nodeName)))):r[a]||(s=De(n),(i&&"none"!==i||!s)&&ve.set(n,"olddisplay",s?i:ee.css(n,"display"))));for(a=0;o>a;a++)n=e[a],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?r[a]||"":"none"));return e}function k(e,t,i,n,s){return new k.prototype.init(e,t,i,n,s)}function A(){return setTimeout(function(){Qe=void 0}),Qe=ee.now()}function I(e,t){var i,n=0,s={height:e};for(t=t?1:0;4>n;n+=2-t)i=_e[n],s["margin"+i]=s["padding"+i]=e;return t&&(s.opacity=s.width=e),s}function M(e,t,i){for(var n,s=(it[t]||[]).concat(it["*"]),r=0,a=s.length;a>r;r++)if(n=s[r].call(i,t,e))return n}function R(e,t,i){var n,s,r,a,o,c,l,u=this,d={},h=e.style,p=e.nodeType&&De(e),m=ve.get(e,"fxshow");i.queue||(o=ee._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,c=o.empty.fire,o.empty.fire=function(){o.unqueued||c()}),o.unqueued++,u.always(function(){u.always(function(){o.unqueued--,ee.queue(e,"fx").length||o.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],l=ee.css(e,"display"),"none"===l&&(l=w(e.nodeName)),"inline"===l&&"none"===ee.css(e,"float")&&(h.display="inline-block")),i.overflow&&(h.overflow="hidden",u.always(function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}));for(n in t)if(s=t[n],Xe.exec(s)){if(delete t[n],r=r||"toggle"===s,s===(p?"hide":"show")){if("show"!==s||!m||void 0===m[n])continue;p=!0}d[n]=m&&m[n]||ee.style(e,n)}if(!ee.isEmptyObject(d)){m?"hidden"in m&&(p=m.hidden):m=ve.access(e,"fxshow",{}),r&&(m.hidden=!p),p?ee(e).show():u.done(function(){ee(e).hide()}),u.done(function(){var t;ve.remove(e,"fxshow");for(t in d)ee.style(e,t,d[t])});for(n in d)a=M(p?m[n]:0,n,u),n in m||(m[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function L(e,t){var i,n,s,r,a;for(i in e)if(n=ee.camelCase(i),s=t[n],r=e[i],ee.isArray(r)&&(s=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),a=ee.cssHooks[n],a&&"expand"in a){r=a.expand(r),delete e[n];for(i in r)i in e||(e[i]=r[i],t[i]=s)}else t[n]=s}function N(e,t,i){var n,s,r=0,a=tt.length,o=ee.Deferred().always(function(){delete c.elem}),c=function(){if(s)return!1;for(var t=Qe||A(),i=Math.max(0,l.startTime+l.duration-t),n=i/l.duration||0,r=1-n,a=0,c=l.tweens.length;c>a;a++)l.tweens[a].run(r);return o.notifyWith(e,[l,r,i]),1>r&&c?i:(o.resolveWith(e,[l]),!1)},l=o.promise({elem:e,props:ee.extend({},t),opts:ee.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Qe||A(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ee.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)l.tweens[i].run(1);return t?o.resolveWith(e,[l,t]):o.rejectWith(e,[l,t]),this}}),u=l.props;for(L(u,l.opts.specialEasing);a>r;r++)if(n=tt[r].call(l,e,u,l.opts))return n;return ee.map(u,M,l),ee.isFunction(l.opts.start)&&l.opts.start.call(e,l),ee.fx.timer(ee.extend(c,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function O(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,r=t.toLowerCase().match(pe)||[];if(ee.isFunction(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function U(e,t,i,n){function s(o){var c;return r[o]=!0,ee.each(e[o]||[],function(e,o){var l=o(t,i,n);return"string"!=typeof l||a||r[l]?a?!(c=l):void 0:(t.dataTypes.unshift(l),s(l),!1)}),c}var r={},a=e===yt;return s(t.dataTypes[0])||!r["*"]&&s("*")}function F(e,t){var i,n,s=ee.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&ee.extend(!0,e,n),e}function j(e,t,i){for(var n,s,r,a,o=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(s in o)if(o[s]&&o[s].test(n)){c.unshift(s);break}if(c[0]in i)r=c[0];else{for(s in i){if(!c[0]||e.converters[s+" "+c[0]]){r=s;break}a||(a=s)}r=r||a}return r?(r!==c[0]&&c.unshift(r),i[r]):void 0}function P(e,t,i,n){var s,r,a,o,c,l={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(r=u.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!c&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=r,r=u.shift())if("*"===r)r=c;else if("*"!==c&&c!==r){if(a=l[c+" "+r]||l["* "+r],!a)for(s in l)if(o=s.split(" "),o[1]===r&&(a=l[c+" "+o[0]]||l["* "+o[0]])){a===!0?a=l[s]:l[s]!==!0&&(r=o[0],u.unshift(o[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+c+" to "+r}}}return{state:"success",data:t}}function $(e,t,i,n){var s;if(ee.isArray(t))ee.each(t,function(t,s){i||St.test(e)?n(e,s):$(e+"["+("object"==typeof s?t:"")+"]",s,i,n)});else if(i||"object"!==ee.type(t))n(e,t);else for(s in t)$(e+"["+s+"]",t[s],i,n)}function B(e){return ee.isWindow(e)?e:9===e.nodeType&&e.defaultView}var H=[],W=H.slice,V=H.concat,q=H.push,K=H.indexOf,z={},G=z.toString,Y=z.hasOwnProperty,Q="".trim,J={},X=e.document,Z="2.1.0",ee=function(e,t){return new ee.fn.init(e,t)},te=/^-ms-/,ie=/-([\da-z])/gi,ne=function(e,t){return t.toUpperCase()};ee.fn=ee.prototype={jquery:Z,constructor:ee,selector:"",length:0,toArray:function(){return W.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:W.call(this)},pushStack:function(e){var t=ee.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ee.each(this,e,t)},map:function(e){return this.pushStack(ee.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(W.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:q,sort:H.sort,splice:H.splice},ee.extend=ee.fn.extend=function(){var e,t,i,n,s,r,a=arguments[0]||{},o=1,c=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[o]||{},o++),"object"==typeof a||ee.isFunction(a)||(a={}),o===c&&(a=this,o--);c>o;o++)if(null!=(e=arguments[o]))for(t in e)i=a[t],n=e[t],a!==n&&(l&&n&&(ee.isPlainObject(n)||(s=ee.isArray(n)))?(s?(s=!1,r=i&&ee.isArray(i)?i:[]):r=i&&ee.isPlainObject(i)?i:{},a[t]=ee.extend(l,r,n)):void 0!==n&&(a[t]=n));return a},ee.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ee.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isPlainObject:function(e){if("object"!==ee.type(e)||e.nodeType||ee.isWindow(e))return!1;try{if(e.constructor&&!Y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?z[G.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=ee.trim(e),e&&(1===e.indexOf("use strict")?(t=X.createElement("script"),t.text=e,X.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ie,ne)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var s,r=0,a=e.length,o=i(e);if(n){if(o)for(;a>r&&(s=t.apply(e[r],n),s!==!1);r++);else for(r in e)if(s=t.apply(e[r],n),s===!1)break}else if(o)for(;a>r&&(s=t.call(e[r],r,e[r]),s!==!1);r++);else for(r in e)if(s=t.call(e[r],r,e[r]),s===!1)break;return e},trim:function(e){return null==e?"":Q.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?ee.merge(n,"string"==typeof e?[e]:e):q.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:K.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,s=e.length;i>n;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,i){for(var n,s=[],r=0,a=e.length,o=!i;a>r;r++)n=!t(e[r],r),n!==o&&s.push(e[r]);return s},map:function(e,t,n){var s,r=0,a=e.length,o=i(e),c=[];if(o)for(;a>r;r++)s=t(e[r],r,n),null!=s&&c.push(s);else for(r in e)s=t(e[r],r,n),null!=s&&c.push(s);return V.apply([],c)},guid:1,proxy:function(e,t){var i,n,s;return"string"==typeof t&&(i=e[t],t=e,e=i),ee.isFunction(e)?(n=W.call(arguments,2),s=function(){return e.apply(t||this,n.concat(W.call(arguments)))},s.guid=e.guid=e.guid||ee.guid++,s):void 0},now:Date.now,support:J}),ee.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){z["[object "+t+"]"]=t.toLowerCase()});var se=function(e){function t(e,t,i,n){var s,r,a,o,c,l,d,m,f,g;if((t?t.ownerDocument||t:$)!==R&&M(t),t=t||R,i=i||[],!e||"string"!=typeof e)return i;if(1!==(o=t.nodeType)&&9!==o)return[];if(N&&!n){if(s=Te.exec(e))if(a=s[1]){if(9===o){if(r=t.getElementById(a),!r||!r.parentNode)return i;if(r.id===a)return i.push(r),i}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&j(t,r)&&r.id===a)return i.push(r),i}else{if(s[2])return Z.apply(i,t.getElementsByTagName(e)),i;if((a=s[3])&&D.getElementsByClassName&&t.getElementsByClassName)return Z.apply(i,t.getElementsByClassName(a)),i}if(D.qsa&&(!O||!O.test(e))){if(m=d=P,f=t,g=9===o&&e,1===o&&"object"!==t.nodeName.toLowerCase()){for(l=h(e),(d=t.getAttribute("id"))?m=d.replace(we,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",c=l.length;c--;)l[c]=m+p(l[c]);f=be.test(e)&&u(t.parentNode)||t,g=l.join(",")}if(g)try{return Z.apply(i,f.querySelectorAll(g)),i}catch(v){}finally{d||t.removeAttribute("id")}}}return y(e.replace(ce,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>C.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[P]=!0,e}function s(e){var t=R.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var i=e.split("|"),n=e.length;n--;)C.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function o(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e;

}}function c(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function l(e){return n(function(t){return t=+t,n(function(i,n){for(var s,r=e([],i.length,t),a=r.length;a--;)i[s=r[a]]&&(i[s]=!(n[s]=i[s]))})})}function u(e){return e&&typeof e.getElementsByTagName!==z&&e}function d(){}function h(e,i){var n,s,r,a,o,c,l,u=V[e+" "];if(u)return i?0:u.slice(0);for(o=e,c=[],l=C.preFilter;o;){(!n||(s=le.exec(o)))&&(s&&(o=o.slice(s[0].length)||o),c.push(r=[])),n=!1,(s=ue.exec(o))&&(n=s.shift(),r.push({value:n,type:s[0].replace(ce," ")}),o=o.slice(n.length));for(a in C.filter)!(s=me[a].exec(o))||l[a]&&!(s=l[a](s))||(n=s.shift(),r.push({value:n,type:a,matches:s}),o=o.slice(n.length));if(!n)break}return i?o.length:o?t.error(e):V(e,c).slice(0)}function p(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function m(e,t,i){var n=t.dir,s=i&&"parentNode"===n,r=H++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,r)}:function(t,i,a){var o,c,l=[B,r];if(a){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,a))return!0}else for(;t=t[n];)if(1===t.nodeType||s){if(c=t[P]||(t[P]={}),(o=c[n])&&o[0]===B&&o[1]===r)return l[2]=o[2];if(c[n]=l,l[2]=e(t,i,a))return!0}}}function f(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function g(e,t,i,n,s){for(var r,a=[],o=0,c=e.length,l=null!=t;c>o;o++)(r=e[o])&&(!i||i(r,n,s))&&(a.push(r),l&&t.push(o));return a}function v(e,t,i,s,r,a){return s&&!s[P]&&(s=v(s)),r&&!r[P]&&(r=v(r,a)),n(function(n,a,o,c){var l,u,d,h=[],p=[],m=a.length,f=n||w(t||"*",o.nodeType?[o]:o,[]),v=!e||!n&&t?f:g(f,h,e,o,c),T=i?r||(n?e:m||s)?[]:a:v;if(i&&i(v,T,o,c),s)for(l=g(T,p),s(l,[],o,c),u=l.length;u--;)(d=l[u])&&(T[p[u]]=!(v[p[u]]=d));if(n){if(r||e){if(r){for(l=[],u=T.length;u--;)(d=T[u])&&l.push(v[u]=d);r(null,T=[],l,c)}for(u=T.length;u--;)(d=T[u])&&(l=r?te.call(n,d):h[u])>-1&&(n[l]=!(a[l]=d))}}else T=g(T===a?T.splice(m,T.length):T),r?r(null,a,T,c):Z.apply(a,T)})}function T(e){for(var t,i,n,s=e.length,r=C.relative[e[0].type],a=r||C.relative[" "],o=r?1:0,c=m(function(e){return e===t},a,!0),l=m(function(e){return te.call(t,e)>-1},a,!0),u=[function(e,i,n){return!r&&(n||i!==k)||((t=i).nodeType?c(e,i,n):l(e,i,n))}];s>o;o++)if(i=C.relative[e[o].type])u=[m(f(u),i)];else{if(i=C.filter[e[o].type].apply(null,e[o].matches),i[P]){for(n=++o;s>n&&!C.relative[e[n].type];n++);return v(o>1&&f(u),o>1&&p(e.slice(0,o-1).concat({value:" "===e[o-2].type?"*":""})).replace(ce,"$1"),i,n>o&&T(e.slice(o,n)),s>n&&T(e=e.slice(n)),s>n&&p(e))}u.push(i)}return f(u)}function b(e,i){var s=i.length>0,r=e.length>0,a=function(n,a,o,c,l){var u,d,h,p=0,m="0",f=n&&[],v=[],T=k,b=n||r&&C.find.TAG("*",l),w=B+=null==T?1:Math.random()||.1,y=b.length;for(l&&(k=a!==R&&a);m!==y&&null!=(u=b[m]);m++){if(r&&u){for(d=0;h=e[d++];)if(h(u,a,o)){c.push(u);break}l&&(B=w)}s&&((u=!h&&u)&&p--,n&&f.push(u))}if(p+=m,s&&m!==p){for(d=0;h=i[d++];)h(f,v,a,o);if(n){if(p>0)for(;m--;)f[m]||v[m]||(v[m]=J.call(c));v=g(v)}Z.apply(c,v),l&&!n&&v.length>0&&p+i.length>1&&t.uniqueSort(c)}return l&&(B=w,k=T),f};return s?n(a):a}function w(e,i,n){for(var s=0,r=i.length;r>s;s++)t(e,i[s],n);return n}function y(e,t,i,n){var s,r,a,o,c,l=h(e);if(!n&&1===l.length){if(r=l[0]=l[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&D.getById&&9===t.nodeType&&N&&C.relative[r[1].type]){if(t=(C.find.ID(a.matches[0].replace(ye,_e),t)||[])[0],!t)return i;e=e.slice(r.shift().value.length)}for(s=me.needsContext.test(e)?0:r.length;s--&&(a=r[s],!C.relative[o=a.type]);)if((c=C.find[o])&&(n=c(a.matches[0].replace(ye,_e),be.test(r[0].type)&&u(t.parentNode)||t))){if(r.splice(s,1),e=n.length&&p(r),!e)return Z.apply(i,n),i;break}}return x(e,l)(n,t,!N,i,be.test(e)&&u(t.parentNode)||t),i}var _,D,C,S,E,x,k,A,I,M,R,L,N,O,U,F,j,P="sizzle"+-new Date,$=e.document,B=0,H=0,W=i(),V=i(),q=i(),K=function(e,t){return e===t&&(I=!0),0},z="undefined",G=1<<31,Y={}.hasOwnProperty,Q=[],J=Q.pop,X=Q.push,Z=Q.push,ee=Q.slice,te=Q.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",se="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=se.replace("w","w#"),ae="\\["+ne+"*("+se+")"+ne+"*(?:([*^$|!~]?=)"+ne+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+re+")|)|)"+ne+"*\\]",oe=":("+se+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ae.replace(3,8)+")*)|.*)\\)|)",ce=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),le=new RegExp("^"+ne+"*,"+ne+"*"),ue=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),de=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),he=new RegExp(oe),pe=new RegExp("^"+re+"$"),me={ID:new RegExp("^#("+se+")"),CLASS:new RegExp("^\\.("+se+")"),TAG:new RegExp("^("+se.replace("w","w*")+")"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,Te=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,we=/'|\\/g,ye=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),_e=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Z.apply(Q=ee.call($.childNodes),$.childNodes),Q[$.childNodes.length].nodeType}catch(De){Z={apply:Q.length?function(e,t){X.apply(e,ee.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}D=t.support={},E=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},M=t.setDocument=function(e){var t,i=e?e.ownerDocument||e:$,n=i.defaultView;return i!==R&&9===i.nodeType&&i.documentElement?(R=i,L=i.documentElement,N=!E(i),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){M()},!1):n.attachEvent&&n.attachEvent("onunload",function(){M()})),D.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),D.getElementsByTagName=s(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),D.getElementsByClassName=ve.test(i.getElementsByClassName)&&s(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),D.getById=s(function(e){return L.appendChild(e).id=P,!i.getElementsByName||!i.getElementsByName(P).length}),D.getById?(C.find.ID=function(e,t){if(typeof t.getElementById!==z&&N){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(ye,_e);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(ye,_e);return function(e){var i=typeof e.getAttributeNode!==z&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=D.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==z?t.getElementsByTagName(e):void 0}:function(e,t){var i,n=[],s=0,r=t.getElementsByTagName(e);if("*"===e){for(;i=r[s++];)1===i.nodeType&&n.push(i);return n}return r},C.find.CLASS=D.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==z&&N?t.getElementsByClassName(e):void 0},U=[],O=[],(D.qsa=ve.test(i.querySelectorAll))&&(s(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&O.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+ne+"*(?:value|"+ie+")"),e.querySelectorAll(":checked").length||O.push(":checked")}),s(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(D.matchesSelector=ve.test(F=L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&s(function(e){D.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),U.push("!=",oe)}),O=O.length&&new RegExp(O.join("|")),U=U.length&&new RegExp(U.join("|")),t=ve.test(L.compareDocumentPosition),j=t||ve.test(L.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},K=t?function(e,t){if(e===t)return I=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!D.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===$&&j($,e)?-1:t===i||t.ownerDocument===$&&j($,t)?1:A?te.call(A,e)-te.call(A,t):0:4&n?-1:1)}:function(e,t){if(e===t)return I=!0,0;var n,s=0,r=e.parentNode,o=t.parentNode,c=[e],l=[t];if(!r||!o)return e===i?-1:t===i?1:r?-1:o?1:A?te.call(A,e)-te.call(A,t):0;if(r===o)return a(e,t);for(n=e;n=n.parentNode;)c.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;c[s]===l[s];)s++;return s?a(c[s],l[s]):c[s]===$?-1:l[s]===$?1:0},i):R},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==R&&M(e),i=i.replace(de,"='$1']"),!(!D.matchesSelector||!N||U&&U.test(i)||O&&O.test(i)))try{var n=F.call(e,i);if(n||D.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(s){}return t(i,R,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==R&&M(e),j(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==R&&M(e);var i=C.attrHandle[t.toLowerCase()],n=i&&Y.call(C.attrHandle,t.toLowerCase())?i(e,t,!N):void 0;return void 0!==n?n:D.attributes||!N?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,s=0;if(I=!D.detectDuplicates,A=!D.sortStable&&e.slice(0),e.sort(K),I){for(;t=e[s++];)t===e[s]&&(n=i.push(s));for(;n--;)e.splice(i[n],1)}return A=null,e},S=t.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=S(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n++];)i+=S(t);return i},C=t.selectors={cacheLength:50,createPseudo:n,match:me,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,_e),e[3]=(e[4]||e[5]||"").replace(ye,_e),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return me.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:i&&he.test(i)&&(t=h(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,_e).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&W(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==z&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(s){var r=t.attr(s,e);return null==r?"!="===i:i?(r+="","="===i?r===n:"!="===i?r!==n:"^="===i?n&&0===r.indexOf(n):"*="===i?n&&r.indexOf(n)>-1:"$="===i?n&&r.slice(-n.length)===n:"~="===i?(" "+r+" ").indexOf(n)>-1:"|="===i?r===n||r.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,s){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),o="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,c){var l,u,d,h,p,m,f=r!==a?"nextSibling":"previousSibling",g=t.parentNode,v=o&&t.nodeName.toLowerCase(),T=!c&&!o;if(g){if(r){for(;f;){for(d=t;d=d[f];)if(o?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;m=f="only"===e&&!m&&"nextSibling"}return!0}if(m=[a?g.firstChild:g.lastChild],a&&T){for(u=g[P]||(g[P]={}),l=u[e]||[],p=l[0]===B&&l[1],h=l[0]===B&&l[2],d=p&&g.childNodes[p];d=++p&&d&&d[f]||(h=p=0)||m.pop();)if(1===d.nodeType&&++h&&d===t){u[e]=[B,p,h];break}}else if(T&&(l=(t[P]||(t[P]={}))[e])&&l[0]===B)h=l[1];else for(;(d=++p&&d&&d[f]||(h=p=0)||m.pop())&&((o?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++h||(T&&((d[P]||(d[P]={}))[e]=[B,h]),d!==t)););return h-=s,h===n||h%n===0&&h/n>=0}}},PSEUDO:function(e,i){var s,r=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[P]?r(i):r.length>1?(s=[e,e,"",i],C.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,s=r(e,i),a=s.length;a--;)n=te.call(e,s[a]),e[n]=!(t[n]=s[a])}):function(e){return r(e,0,s)}):r}},pseudos:{not:n(function(e){var t=[],i=[],s=x(e.replace(ce,"$1"));return s[P]?n(function(e,t,i,n){for(var r,a=s(e,null,n,[]),o=e.length;o--;)(r=a[o])&&(e[o]=!(t[o]=r))}):function(e,n,r){return t[0]=e,s(t,null,r,i),!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:n(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ye,_e).toLowerCase(),function(t){var i;do if(i=N?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===R.activeElement&&(!R.hasFocus||R.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,i){return[0>i?i+t:i]}),even:l(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:l(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:l(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:l(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},C.pseudos.nth=C.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[_]=o(_);for(_ in{submit:!0,reset:!0})C.pseudos[_]=c(_);return d.prototype=C.filters=C.pseudos,C.setFilters=new d,x=t.compile=function(e,t){var i,n=[],s=[],r=q[e+" "];if(!r){for(t||(t=h(e)),i=t.length;i--;)r=T(t[i]),r[P]?n.push(r):s.push(r);r=q(e,b(s,n))}return r},D.sortStable=P.split("").sort(K).join("")===P,D.detectDuplicates=!!I,M(),D.sortDetached=s(function(e){return 1&e.compareDocumentPosition(R.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),D.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||r(ie,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);ee.find=se,ee.expr=se.selectors,ee.expr[":"]=ee.expr.pseudos,ee.unique=se.uniqueSort,ee.text=se.getText,ee.isXMLDoc=se.isXML,ee.contains=se.contains;var re=ee.expr.match.needsContext,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,oe=/^.[^:#\[\.,]*$/;ee.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?ee.find.matchesSelector(n,e)?[n]:[]:ee.find.matches(e,ee.grep(t,function(e){return 1===e.nodeType}))},ee.fn.extend({find:function(e){var t,i=this.length,n=[],s=this;if("string"!=typeof e)return this.pushStack(ee(e).filter(function(){for(t=0;i>t;t++)if(ee.contains(s[t],this))return!0}));for(t=0;i>t;t++)ee.find(e,s[t],n);return n=this.pushStack(i>1?ee.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&re.test(e)?ee(e):e||[],!1).length}});var ce,le=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ue=ee.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:le.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||ce).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof ee?t[0]:t,ee.merge(this,ee.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:X,!0)),ae.test(i[1])&&ee.isPlainObject(t))for(i in t)ee.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return n=X.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=X,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ee.isFunction(e)?"undefined"!=typeof ce.ready?ce.ready(e):e(ee):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),ee.makeArray(e,this))};ue.prototype=ee.fn,ce=ee(X);var de=/^(?:parents|prev(?:Until|All))/,he={children:!0,contents:!0,next:!0,prev:!0};ee.extend({dir:function(e,t,i){for(var n=[],s=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&ee(e).is(i))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),ee.fn.extend({has:function(e){var t=ee(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(ee.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,n=0,s=this.length,r=[],a=re.test(e)||"string"!=typeof e?ee(e,t||this.context):0;s>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&ee.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(r.length>1?ee.unique(r):r)},index:function(e){return e?"string"==typeof e?K.call(ee(e),this[0]):K.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ee.unique(ee.merge(this.get(),ee(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ee.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ee.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ee.dir(e,"parentNode",i)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return ee.dir(e,"nextSibling")},prevAll:function(e){return ee.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ee.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ee.dir(e,"previousSibling",i)},siblings:function(e){return ee.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ee.sibling(e.firstChild)},contents:function(e){return e.contentDocument||ee.merge([],e.childNodes)}},function(e,t){ee.fn[e]=function(i,n){var s=ee.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=ee.filter(n,s)),this.length>1&&(he[e]||ee.unique(s),de.test(e)&&s.reverse()),this.pushStack(s)}});var pe=/\S+/g,me={};ee.Callbacks=function(e){e="string"==typeof e?me[e]||r(e):ee.extend({},e);var t,i,n,s,a,o,c=[],l=!e.once&&[],u=function(r){for(t=e.memory&&r,i=!0,o=s||0,s=0,a=c.length,n=!0;c&&a>o;o++)if(c[o].apply(r[0],r[1])===!1&&e.stopOnFalse){t=!1;break}n=!1,c&&(l?l.length&&u(l.shift()):t?c=[]:d.disable())},d={add:function(){if(c){var i=c.length;!function r(t){ee.each(t,function(t,i){var n=ee.type(i);"function"===n?e.unique&&d.has(i)||c.push(i):i&&i.length&&"string"!==n&&r(i)})}(arguments),n?a=c.length:t&&(s=i,u(t))}return this},remove:function(){return c&&ee.each(arguments,function(e,t){for(var i;(i=ee.inArray(t,c,i))>-1;)c.splice(i,1),n&&(a>=i&&a--,o>=i&&o--)}),this},has:function(e){return e?ee.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=l=t=void 0,this},disabled:function(){return!c},lock:function(){return l=void 0,t||d.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!c||i&&!l||(t=t||[],t=[e,t.slice?t.slice():t],n?l.push(t):u(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},ee.extend({Deferred:function(e){var t=[["resolve","done",ee.Callbacks("once memory"),"resolved"],["reject","fail",ee.Callbacks("once memory"),"rejected"],["notify","progress",ee.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ee.Deferred(function(i){ee.each(t,function(t,r){var a=ee.isFunction(e[t])&&e[t];s[r[1]](function(){var e=a&&a.apply(this,arguments);e&&ee.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r[0]+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ee.extend(e,n):n}},s={};return n.pipe=n.then,ee.each(t,function(e,r){var a=r[2],o=r[3];n[r[1]]=a.add,o&&a.add(function(){i=o},t[1^e][2].disable,t[2][2].lock),s[r[0]]=function(){return s[r[0]+"With"](this===s?n:this,arguments),this},s[r[0]+"With"]=a.fireWith}),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,s=0,r=W.call(arguments),a=r.length,o=1!==a||e&&ee.isFunction(e.promise)?a:0,c=1===o?e:ee.Deferred(),l=function(e,i,n){return function(s){i[e]=this,n[e]=arguments.length>1?W.call(arguments):s,n===t?c.notifyWith(i,n):--o||c.resolveWith(i,n)}};if(a>1)for(t=new Array(a),i=new Array(a),n=new Array(a);a>s;s++)r[s]&&ee.isFunction(r[s].promise)?r[s].promise().done(l(s,n,r)).fail(c.reject).progress(l(s,i,t)):--o;return o||c.resolveWith(n,r),c.promise()}});var fe;ee.fn.ready=function(e){return ee.ready.promise().done(e),this},ee.extend({isReady:!1,readyWait:1,holdReady:function(e){e?ee.readyWait++:ee.ready(!0)},ready:function(e){(e===!0?--ee.readyWait:ee.isReady)||(ee.isReady=!0,e!==!0&&--ee.readyWait>0||(fe.resolveWith(X,[ee]),ee.fn.trigger&&ee(X).trigger("ready").off("ready")))}}),ee.ready.promise=function(t){return fe||(fe=ee.Deferred(),"complete"===X.readyState?setTimeout(ee.ready):(X.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1))),fe.promise(t)},ee.ready.promise();var ge=ee.access=function(e,t,i,n,s,r,a){var o=0,c=e.length,l=null==i;if("object"===ee.type(i)){s=!0;for(o in i)ee.access(e,t,o,i[o],!0,r,a)}else if(void 0!==n&&(s=!0,ee.isFunction(n)||(a=!0),l&&(a?(t.call(e,n),t=null):(l=t,t=function(e,t,i){return l.call(ee(e),i)})),t))for(;c>o;o++)t(e[o],i,a?n:n.call(e[o],o,t(e[o],i)));return s?e:l?t.call(e):c?t(e[0],i):r};ee.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},o.uid=1,o.accepts=ee.acceptData,o.prototype={key:function(e){if(!o.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=o.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,ee.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,s=this.key(e),r=this.cache[s];if("string"==typeof t)r[t]=i;else if(ee.isEmptyObject(r))ee.extend(this.cache[s],t);else for(n in t)r[n]=t[n];return r},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?(n=this.get(e,t),void 0!==n?n:this.get(e,ee.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,s,r=this.key(e),a=this.cache[r];if(void 0===t)this.cache[r]={};else{ee.isArray(t)?n=t.concat(t.map(ee.camelCase)):(s=ee.camelCase(t),t in a?n=[t,s]:(n=s,n=n in a?[n]:n.match(pe)||[])),i=n.length;for(;i--;)delete a[n[i]]}},hasData:function(e){return!ee.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ve=new o,Te=new o,be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,we=/([A-Z])/g;ee.extend({hasData:function(e){return Te.hasData(e)||ve.hasData(e)},data:function(e,t,i){return Te.access(e,t,i)},removeData:function(e,t){Te.remove(e,t)},_data:function(e,t,i){return ve.access(e,t,i)},_removeData:function(e,t){ve.remove(e,t)}}),ee.fn.extend({data:function(e,t){var i,n,s,r=this[0],a=r&&r.attributes;if(void 0===e){if(this.length&&(s=Te.get(r),1===r.nodeType&&!ve.get(r,"hasDataAttrs"))){for(i=a.length;i--;)n=a[i].name,0===n.indexOf("data-")&&(n=ee.camelCase(n.slice(5)),c(r,n,s[n]));ve.set(r,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){Te.set(this,e)}):ge(this,function(t){var i,n=ee.camelCase(e);if(r&&void 0===t){if(i=Te.get(r,e),void 0!==i)return i;if(i=Te.get(r,n),void 0!==i)return i;if(i=c(r,n,void 0),void 0!==i)return i}else this.each(function(){var i=Te.get(this,n);Te.set(this,n,t),-1!==e.indexOf("-")&&void 0!==i&&Te.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Te.remove(this,e)})}}),ee.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=ve.get(e,t),i&&(!n||ee.isArray(i)?n=ve.access(e,t,ee.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=ee.queue(e,t),n=i.length,s=i.shift(),r=ee._queueHooks(e,t),a=function(){ee.dequeue(e,t)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete r.stop,s.call(e,a,r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ve.get(e,i)||ve.access(e,i,{empty:ee.Callbacks("once memory").add(function(){ve.remove(e,[t+"queue",i])})})}}),ee.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?ee.queue(this[0],e):void 0===t?this:this.each(function(){var i=ee.queue(this,e,t);ee._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&ee.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ee.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,s=ee.Deferred(),r=this,a=this.length,o=function(){--n||s.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)i=ve.get(r[a],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(o));return o(),s.promise(t)}});var ye=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_e=["Top","Right","Bottom","Left"],De=function(e,t){return e=t||e,"none"===ee.css(e,"display")||!ee.contains(e.ownerDocument,e)},Ce=/^(?:checkbox|radio)$/i;!function(){var e=X.createDocumentFragment(),t=e.appendChild(X.createElement("div"));t.innerHTML="<input type='radio' checked='checked' name='t'/>",J.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",J.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Se="undefined";J.focusinBubbles="onfocusin"in e;var Ee=/^key/,xe=/^(?:mouse|contextmenu)|click/,ke=/^(?:focusinfocus|focusoutblur)$/,Ae=/^([^.]*)(?:\.(.+)|)$/;ee.event={global:{},add:function(e,t,i,n,s){var r,a,o,c,l,u,d,h,p,m,f,g=ve.get(e);if(g)for(i.handler&&(r=i,i=r.handler,s=r.selector),i.guid||(i.guid=ee.guid++),(c=g.events)||(c=g.events={}),(a=g.handle)||(a=g.handle=function(t){return typeof ee!==Se&&ee.event.triggered!==t.type?ee.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(pe)||[""],l=t.length;l--;)o=Ae.exec(t[l])||[],p=f=o[1],m=(o[2]||"").split(".").sort(),p&&(d=ee.event.special[p]||{},p=(s?d.delegateType:d.bindType)||p,d=ee.event.special[p]||{},u=ee.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&ee.expr.match.needsContext.test(s),namespace:m.join(".")},r),(h=c[p])||(h=c[p]=[],h.delegateCount=0,d.setup&&d.setup.call(e,n,m,a)!==!1||e.addEventListener&&e.addEventListener(p,a,!1)),d.add&&(d.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),s?h.splice(h.delegateCount++,0,u):h.push(u),ee.event.global[p]=!0)},remove:function(e,t,i,n,s){var r,a,o,c,l,u,d,h,p,m,f,g=ve.hasData(e)&&ve.get(e);if(g&&(c=g.events)){for(t=(t||"").match(pe)||[""],l=t.length;l--;)if(o=Ae.exec(t[l])||[],p=f=o[1],m=(o[2]||"").split(".").sort(),p){for(d=ee.event.special[p]||{},p=(n?d.delegateType:d.bindType)||p,h=c[p]||[],o=o[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=h.length;r--;)u=h[r],!s&&f!==u.origType||i&&i.guid!==u.guid||o&&!o.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(h.splice(r,1),u.selector&&h.delegateCount--,d.remove&&d.remove.call(e,u));a&&!h.length&&(d.teardown&&d.teardown.call(e,m,g.handle)!==!1||ee.removeEvent(e,p,g.handle),delete c[p])}else for(p in c)ee.event.remove(e,p+t[l],i,n,!0);ee.isEmptyObject(c)&&(delete g.handle,ve.remove(e,"events"))}},trigger:function(t,i,n,s){var r,a,o,c,l,u,d,h=[n||X],p=Y.call(t,"type")?t.type:t,m=Y.call(t,"namespace")?t.namespace.split("."):[];if(a=o=n=n||X,3!==n.nodeType&&8!==n.nodeType&&!ke.test(p+ee.event.triggered)&&(p.indexOf(".")>=0&&(m=p.split("."),p=m.shift(),m.sort()),l=p.indexOf(":")<0&&"on"+p,t=t[ee.expando]?t:new ee.Event(p,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:ee.makeArray(i,[t]),d=ee.event.special[p]||{},s||!d.trigger||d.trigger.apply(n,i)!==!1)){if(!s&&!d.noBubble&&!ee.isWindow(n)){for(c=d.delegateType||p,ke.test(c+p)||(a=a.parentNode);a;a=a.parentNode)h.push(a),o=a;o===(n.ownerDocument||X)&&h.push(o.defaultView||o.parentWindow||e)}for(r=0;(a=h[r++])&&!t.isPropagationStopped();)t.type=r>1?c:d.bindType||p,u=(ve.get(a,"events")||{})[t.type]&&ve.get(a,"handle"),u&&u.apply(a,i),u=l&&a[l],u&&u.apply&&ee.acceptData(a)&&(t.result=u.apply(a,i),t.result===!1&&t.preventDefault());return t.type=p,s||t.isDefaultPrevented()||d._default&&d._default.apply(h.pop(),i)!==!1||!ee.acceptData(n)||l&&ee.isFunction(n[p])&&!ee.isWindow(n)&&(o=n[l],o&&(n[l]=null),ee.event.triggered=p,n[p](),ee.event.triggered=void 0,o&&(n[l]=o)),t.result}},dispatch:function(e){e=ee.event.fix(e);var t,i,n,s,r,a=[],o=W.call(arguments),c=(ve.get(this,"events")||{})[e.type]||[],l=ee.event.special[e.type]||{};if(o[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(a=ee.event.handlers.call(this,e,c),t=0;(s=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,i=0;(r=s.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,n=((ee.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,o),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,s,r,a=[],o=t.delegateCount,c=e.target;if(o&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!==this;c=c.parentNode||this)if(c.disabled!==!0||"click"!==e.type){for(n=[],i=0;o>i;i++)r=t[i],s=r.selector+" ",void 0===n[s]&&(n[s]=r.needsContext?ee(s,this).index(c)>=0:ee.find(s,this,null,[c]).length),
n[s]&&n.push(r);n.length&&a.push({elem:c,handlers:n})}return o<t.length&&a.push({elem:this,handlers:t.slice(o)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,s,r=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||X,n=i.documentElement,s=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[ee.expando])return e;var t,i,n,s=e.type,r=e,a=this.fixHooks[s];for(a||(this.fixHooks[s]=a=xe.test(s)?this.mouseHooks:Ee.test(s)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new ee.Event(r),t=n.length;t--;)i=n[t],e[i]=r[i];return e.target||(e.target=X),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==d()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===d()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ee.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return ee.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var s=ee.extend(new ee.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ee.event.trigger(s,null,t):ee.event.dispatch.call(t,s),s.isDefaultPrevented()&&i.preventDefault()}},ee.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},ee.Event=function(e,t){return this instanceof ee.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.getPreventDefault&&e.getPreventDefault()?l:u):this.type=e,t&&ee.extend(this,t),this.timeStamp=e&&e.timeStamp||ee.now(),void(this[ee.expando]=!0)):new ee.Event(e,t)},ee.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ee.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ee.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,r=e.handleObj;return(!s||s!==n&&!ee.contains(n,s))&&(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}}),J.focusinBubbles||ee.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){ee.event.simulate(t,e.target,ee.event.fix(e),!0)};ee.event.special[t]={setup:function(){var n=this.ownerDocument||this,s=ve.access(n,t);s||n.addEventListener(e,i,!0),ve.access(n,t,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=ve.access(n,t)-1;s?ve.access(n,t,s):(n.removeEventListener(e,i,!0),ve.remove(n,t))}}}),ee.fn.extend({on:function(e,t,i,n,s){var r,a;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(a in e)this.on(a,t,i,e[a],s);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=u;else if(!n)return this;return 1===s&&(r=n,n=function(e){return ee().off(e),r.apply(this,arguments)},n.guid=r.guid||(r.guid=ee.guid++)),this.each(function(){ee.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,s;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ee(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=u),this.each(function(){ee.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){ee.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?ee.event.trigger(e,t,i,!0):void 0}});var Ie=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Me=/<([\w:]+)/,Re=/<|&#?\w+;/,Le=/<(?:script|style|link)/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,Oe=/^$|\/(?:java|ecma)script/i,Ue=/^true\/(.*)/,Fe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,je={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};je.optgroup=je.option,je.tbody=je.tfoot=je.colgroup=je.caption=je.thead,je.th=je.td,ee.extend({clone:function(e,t,i){var n,s,r,a,o=e.cloneNode(!0),c=ee.contains(e.ownerDocument,e);if(!(J.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ee.isXMLDoc(e)))for(a=v(o),r=v(e),n=0,s=r.length;s>n;n++)T(r[n],a[n]);if(t)if(i)for(r=r||v(e),a=a||v(o),n=0,s=r.length;s>n;n++)g(r[n],a[n]);else g(e,o);return a=v(o,"script"),a.length>0&&f(a,!c&&v(e,"script")),o},buildFragment:function(e,t,i,n){for(var s,r,a,o,c,l,u=t.createDocumentFragment(),d=[],h=0,p=e.length;p>h;h++)if(s=e[h],s||0===s)if("object"===ee.type(s))ee.merge(d,s.nodeType?[s]:s);else if(Re.test(s)){for(r=r||u.appendChild(t.createElement("div")),a=(Me.exec(s)||["",""])[1].toLowerCase(),o=je[a]||je._default,r.innerHTML=o[1]+s.replace(Ie,"<$1></$2>")+o[2],l=o[0];l--;)r=r.lastChild;ee.merge(d,r.childNodes),r=u.firstChild,r.textContent=""}else d.push(t.createTextNode(s));for(u.textContent="",h=0;s=d[h++];)if((!n||-1===ee.inArray(s,n))&&(c=ee.contains(s.ownerDocument,s),r=v(u.appendChild(s),"script"),c&&f(r),i))for(l=0;s=r[l++];)Oe.test(s.type||"")&&i.push(s);return u},cleanData:function(e){for(var t,i,n,s,r,a,o=ee.event.special,c=0;void 0!==(i=e[c]);c++){if(ee.acceptData(i)&&(r=i[ve.expando],r&&(t=ve.cache[r]))){if(n=Object.keys(t.events||{}),n.length)for(a=0;void 0!==(s=n[a]);a++)o[s]?ee.event.remove(i,s):ee.removeEvent(i,s,t.handle);ve.cache[r]&&delete ve.cache[r]}delete Te.cache[i[Te.expando]]}}}),ee.fn.extend({text:function(e){return ge(this,function(e){return void 0===e?ee.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?ee.filter(e,this):this,s=0;null!=(i=n[s]);s++)t||1!==i.nodeType||ee.cleanData(v(i)),i.parentNode&&(t&&ee.contains(i.ownerDocument,i)&&f(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ee.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ee.clone(this,e,t)})},html:function(e){return ge(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Le.test(e)&&!je[(Me.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ie,"<$1></$2>");try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(ee.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,ee.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=V.apply([],e);var i,n,s,r,a,o,c=0,l=this.length,u=this,d=l-1,h=e[0],f=ee.isFunction(h);if(f||l>1&&"string"==typeof h&&!J.checkClone&&Ne.test(h))return this.each(function(i){var n=u.eq(i);f&&(e[0]=h.call(this,i,n.html())),n.domManip(e,t)});if(l&&(i=ee.buildFragment(e,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(s=ee.map(v(i,"script"),p),r=s.length;l>c;c++)a=i,c!==d&&(a=ee.clone(a,!0,!0),r&&ee.merge(s,v(a,"script"))),t.call(this[c],a,c);if(r)for(o=s[s.length-1].ownerDocument,ee.map(s,m),c=0;r>c;c++)a=s[c],Oe.test(a.type||"")&&!ve.access(a,"globalEval")&&ee.contains(o,a)&&(a.src?ee._evalUrl&&ee._evalUrl(a.src):ee.globalEval(a.textContent.replace(Fe,"")))}return this}}),ee.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ee.fn[e]=function(e){for(var i,n=[],s=ee(e),r=s.length-1,a=0;r>=a;a++)i=a===r?this:this.clone(!0),ee(s[a])[t](i),q.apply(n,i.get());return this.pushStack(n)}});var Pe,$e={},Be=/^margin/,He=new RegExp("^("+ye+")(?!px)[a-z%]+$","i"),We=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};!function(){function t(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",r.appendChild(a);var t=e.getComputedStyle(o,null);i="1%"!==t.top,n="4px"===t.width,r.removeChild(a)}var i,n,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",r=X.documentElement,a=X.createElement("div"),o=X.createElement("div");o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",J.clearCloneStyle="content-box"===o.style.backgroundClip,a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(o),e.getComputedStyle&&ee.extend(J,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,i=o.appendChild(X.createElement("div"));return i.style.cssText=o.style.cssText=s,i.style.marginRight=i.style.width="0",o.style.width="1px",r.appendChild(a),t=!parseFloat(e.getComputedStyle(i,null).marginRight),r.removeChild(a),o.innerHTML="",t}})}(),ee.swap=function(e,t,i,n){var s,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];s=i.apply(e,n||[]);for(r in t)e.style[r]=a[r];return s};var Ve=/^(none|table(?!-c[ea]).+)/,qe=new RegExp("^("+ye+")(.*)$","i"),Ke=new RegExp("^([+-])=("+ye+")","i"),ze={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:0,fontWeight:400},Ye=["Webkit","O","Moz","ms"];ee.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=y(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,r,a,o=ee.camelCase(t),c=e.style;return t=ee.cssProps[o]||(ee.cssProps[o]=D(c,o)),a=ee.cssHooks[t]||ee.cssHooks[o],void 0===i?a&&"get"in a&&void 0!==(s=a.get(e,!1,n))?s:c[t]:(r=typeof i,"string"===r&&(s=Ke.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(ee.css(e,t)),r="number"),null!=i&&i===i&&("number"!==r||ee.cssNumber[o]||(i+="px"),J.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),a&&"set"in a&&void 0===(i=a.set(e,i,n))||(c[t]="",c[t]=i)),void 0)}},css:function(e,t,i,n){var s,r,a,o=ee.camelCase(t);return t=ee.cssProps[o]||(ee.cssProps[o]=D(e.style,o)),a=ee.cssHooks[t]||ee.cssHooks[o],a&&"get"in a&&(s=a.get(e,!0,i)),void 0===s&&(s=y(e,t,n)),"normal"===s&&t in Ge&&(s=Ge[t]),""===i||i?(r=parseFloat(s),i===!0||ee.isNumeric(r)?r||0:s):s}}),ee.each(["height","width"],function(e,t){ee.cssHooks[t]={get:function(e,i,n){return i?0===e.offsetWidth&&Ve.test(ee.css(e,"display"))?ee.swap(e,ze,function(){return E(e,t,n)}):E(e,t,n):void 0},set:function(e,i,n){var s=n&&We(e);return C(e,i,n?S(e,t,n,"border-box"===ee.css(e,"boxSizing",!1,s),s):0)}}}),ee.cssHooks.marginRight=_(J.reliableMarginRight,function(e,t){return t?ee.swap(e,{display:"inline-block"},y,[e,"marginRight"]):void 0}),ee.each({margin:"",padding:"",border:"Width"},function(e,t){ee.cssHooks[e+t]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];4>n;n++)s[e+_e[n]+t]=r[n]||r[n-2]||r[0];return s}},Be.test(e)||(ee.cssHooks[e+t].set=C)}),ee.fn.extend({css:function(e,t){return ge(this,function(e,t,i){var n,s,r={},a=0;if(ee.isArray(t)){for(n=We(e),s=t.length;s>a;a++)r[t[a]]=ee.css(e,t[a],!1,n);return r}return void 0!==i?ee.style(e,t,i):ee.css(e,t)},e,t,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){De(this)?ee(this).show():ee(this).hide()})}}),ee.Tween=k,k.prototype={constructor:k,init:function(e,t,i,n,s,r){this.elem=e,this.prop=i,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(ee.cssNumber[i]?"":"px")},cur:function(){var e=k.propHooks[this.prop];return e&&e.get?e.get(this):k.propHooks._default.get(this)},run:function(e){var t,i=k.propHooks[this.prop];return this.pos=t=this.options.duration?ee.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):k.propHooks._default.set(this),this}},k.prototype.init.prototype=k.prototype,k.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ee.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ee.fx.step[e.prop]?ee.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ee.cssProps[e.prop]]||ee.cssHooks[e.prop])?ee.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},k.propHooks.scrollTop=k.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ee.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ee.fx=k.prototype.init,ee.fx.step={};var Qe,Je,Xe=/^(?:toggle|show|hide)$/,Ze=new RegExp("^(?:([+-])=|)("+ye+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[R],it={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),s=Ze.exec(t),r=s&&s[3]||(ee.cssNumber[e]?"":"px"),a=(ee.cssNumber[e]||"px"!==r&&+n)&&Ze.exec(ee.css(i.elem,e)),o=1,c=20;if(a&&a[3]!==r){r=r||a[3],s=s||[],a=+n||1;do o=o||".5",a/=o,ee.style(i.elem,e,a+r);while(o!==(o=i.cur()/n)&&1!==o&&--c)}return s&&(a=i.start=+a||+n||0,i.unit=r,i.end=s[1]?a+(s[1]+1)*s[2]:+s[2]),i}]};ee.Animation=ee.extend(N,{tweener:function(e,t){ee.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,s=e.length;s>n;n++)i=e[n],it[i]=it[i]||[],it[i].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),ee.speed=function(e,t,i){var n=e&&"object"==typeof e?ee.extend({},e):{complete:i||!i&&t||ee.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ee.isFunction(t)&&t};return n.duration=ee.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ee.fx.speeds?ee.fx.speeds[n.duration]:ee.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ee.isFunction(n.old)&&n.old.call(this),n.queue&&ee.dequeue(this,n.queue)},n},ee.fn.extend({fadeTo:function(e,t,i,n){return this.filter(De).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=ee.isEmptyObject(e),r=ee.speed(t,i,n),a=function(){var t=N(this,ee.extend({},e),r);(s||ve.get(this,"finish"))&&t.stop(!0)};return a.finish=a,s||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",r=ee.timers,a=ve.get(this);if(s)a[s]&&a[s].stop&&n(a[s]);else for(s in a)a[s]&&a[s].stop&&et.test(s)&&n(a[s]);for(s=r.length;s--;)r[s].elem!==this||null!=e&&r[s].queue!==e||(r[s].anim.stop(i),t=!1,r.splice(s,1));(t||!i)&&ee.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ve.get(this),n=i[e+"queue"],s=i[e+"queueHooks"],r=ee.timers,a=n?n.length:0;for(i.finish=!0,ee.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;a>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ee.each(["toggle","show","hide"],function(e,t){var i=ee.fn[t];ee.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(I(t,!0),e,n,s)}}),ee.each({slideDown:I("show"),slideUp:I("hide"),slideToggle:I("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ee.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ee.timers=[],ee.fx.tick=function(){var e,t=0,i=ee.timers;for(Qe=ee.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||ee.fx.stop(),Qe=void 0},ee.fx.timer=function(e){ee.timers.push(e),e()?ee.fx.start():ee.timers.pop()},ee.fx.interval=13,ee.fx.start=function(){Je||(Je=setInterval(ee.fx.tick,ee.fx.interval))},ee.fx.stop=function(){clearInterval(Je),Je=null},ee.fx.speeds={slow:600,fast:200,_default:400},ee.fn.delay=function(e,t){return e=ee.fx?ee.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e=X.createElement("input"),t=X.createElement("select"),i=t.appendChild(X.createElement("option"));e.type="checkbox",J.checkOn=""!==e.value,J.optSelected=i.selected,t.disabled=!0,J.optDisabled=!i.disabled,e=X.createElement("input"),e.value="t",e.type="radio",J.radioValue="t"===e.value}();var nt,st,rt=ee.expr.attrHandle;ee.fn.extend({attr:function(e,t){return ge(this,ee.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ee.removeAttr(this,e)})}}),ee.extend({attr:function(e,t,i){var n,s,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return typeof e.getAttribute===Se?ee.prop(e,t,i):(1===r&&ee.isXMLDoc(e)||(t=t.toLowerCase(),n=ee.attrHooks[t]||(ee.expr.match.bool.test(t)?st:nt)),void 0===i?n&&"get"in n&&null!==(s=n.get(e,t))?s:(s=ee.find.attr(e,t),null==s?void 0:s):null!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:(e.setAttribute(t,i+""),i):void ee.removeAttr(e,t))},removeAttr:function(e,t){var i,n,s=0,r=t&&t.match(pe);if(r&&1===e.nodeType)for(;i=r[s++];)n=ee.propFix[i]||i,ee.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!J.radioValue&&"radio"===t&&ee.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),st={set:function(e,t,i){return t===!1?ee.removeAttr(e,i):e.setAttribute(i,i),i}},ee.each(ee.expr.match.bool.source.match(/\w+/g),function(e,t){var i=rt[t]||ee.find.attr;rt[t]=function(e,t,n){var s,r;return n||(r=rt[t],rt[t]=s,s=null!=i(e,t,n)?t.toLowerCase():null,rt[t]=r),s}});var at=/^(?:input|select|textarea|button)$/i;ee.fn.extend({prop:function(e,t){return ge(this,ee.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ee.propFix[e]||e]})}}),ee.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,s,r,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return r=1!==a||!ee.isXMLDoc(e),r&&(t=ee.propFix[t]||t,s=ee.propHooks[t]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:e[t]=i:s&&"get"in s&&null!==(n=s.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||at.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),J.optSelected||(ee.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),ee.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ee.propFix[this.toLowerCase()]=this});var ot=/[\t\r\n\f]/g;ee.fn.extend({addClass:function(e){var t,i,n,s,r,a,o="string"==typeof e&&e,c=0,l=this.length;if(ee.isFunction(e))return this.each(function(t){ee(this).addClass(e.call(this,t,this.className))});if(o)for(t=(e||"").match(pe)||[];l>c;c++)if(i=this[c],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ot," "):" ")){for(r=0;s=t[r++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");a=ee.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(e){var t,i,n,s,r,a,o=0===arguments.length||"string"==typeof e&&e,c=0,l=this.length;if(ee.isFunction(e))return this.each(function(t){ee(this).removeClass(e.call(this,t,this.className))});if(o)for(t=(e||"").match(pe)||[];l>c;c++)if(i=this[c],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ot," "):"")){for(r=0;s=t[r++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");a=e?ee.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):this.each(ee.isFunction(e)?function(i){ee(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var t,n=0,s=ee(this),r=e.match(pe)||[];t=r[n++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else(i===Se||"boolean"===i)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||e===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ot," ").indexOf(t)>=0)return!0;return!1}});var ct=/\r/g;ee.fn.extend({val:function(e){var t,i,n,s=this[0];{if(arguments.length)return n=ee.isFunction(e),this.each(function(i){var s;1===this.nodeType&&(s=n?e.call(this,i,ee(this).val()):e,null==s?s="":"number"==typeof s?s+="":ee.isArray(s)&&(s=ee.map(s,function(e){return null==e?"":e+""})),t=ee.valHooks[this.type]||ee.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))});if(s)return t=ee.valHooks[s.type]||ee.valHooks[s.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(s,"value"))?i:(i=s.value,"string"==typeof i?i.replace(ct,""):null==i?"":i)}}}),ee.extend({valHooks:{select:{get:function(e){for(var t,i,n=e.options,s=e.selectedIndex,r="select-one"===e.type||0>s,a=r?null:[],o=r?s+1:n.length,c=0>s?o:r?s:0;o>c;c++)if(i=n[c],!(!i.selected&&c!==s||(J.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ee.nodeName(i.parentNode,"optgroup"))){if(t=ee(i).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var i,n,s=e.options,r=ee.makeArray(t),a=s.length;a--;)n=s[a],(n.selected=ee.inArray(ee(n).val(),r)>=0)&&(i=!0);return i||(e.selectedIndex=-1),r}}}}),ee.each(["radio","checkbox"],function(){ee.valHooks[this]={set:function(e,t){return ee.isArray(t)?e.checked=ee.inArray(ee(e).val(),t)>=0:void 0}},J.checkOn||(ee.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),ee.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ee.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ee.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var lt=ee.now(),ut=/\?/;ee.parseJSON=function(e){return JSON.parse(e+"")},ee.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(n){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&ee.error("Invalid XML: "+e),t};var dt,ht,pt=/#.*$/,mt=/([?&])_=[^&]*/,ft=/^(.*?):[ \t]*([^\r\n]*)$/gm,gt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,vt=/^(?:GET|HEAD)$/,Tt=/^\/\//,bt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,wt={},yt={},_t="*/".concat("*");try{ht=location.href}catch(Dt){ht=X.createElement("a"),ht.href="",ht=ht.href}dt=bt.exec(ht.toLowerCase())||[],ee.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ht,type:"GET",isLocal:gt.test(dt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":_t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ee.parseJSON,"text xml":ee.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?F(F(e,ee.ajaxSettings),t):F(ee.ajaxSettings,e)},ajaxPrefilter:O(wt),ajaxTransport:O(yt),ajax:function(e,t){function i(e,t,i,a){var c,u,v,T,w,_=t;2!==b&&(b=2,o&&clearTimeout(o),n=void 0,r=a||"",y.readyState=e>0?4:0,c=e>=200&&300>e||304===e,i&&(T=j(d,y,i)),T=P(d,T,y,c),c?(d.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(ee.lastModified[s]=w),w=y.getResponseHeader("etag"),w&&(ee.etag[s]=w)),204===e||"HEAD"===d.type?_="nocontent":304===e?_="notmodified":(_=T.state,u=T.data,v=T.error,c=!v)):(v=_,(e||!_)&&(_="error",0>e&&(e=0))),y.status=e,y.statusText=(t||_)+"",c?m.resolveWith(h,[u,_,y]):m.rejectWith(h,[y,_,v]),y.statusCode(g),g=void 0,l&&p.trigger(c?"ajaxSuccess":"ajaxError",[y,d,c?u:v]),f.fireWith(h,[y,_]),l&&(p.trigger("ajaxComplete",[y,d]),--ee.active||ee.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,s,r,a,o,c,l,u,d=ee.ajaxSetup({},t),h=d.context||d,p=d.context&&(h.nodeType||h.jquery)?ee(h):ee.event,m=ee.Deferred(),f=ee.Callbacks("once memory"),g=d.statusCode||{},v={},T={},b=0,w="canceled",y={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!a)for(a={};t=ft.exec(r);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return b||(e=T[i]=T[i]||e,v[e]=t),this},overrideMimeType:function(e){return b||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)g[t]=[g[t],e[t]];else y.always(e[y.status]);return this},abort:function(e){var t=e||w;return n&&n.abort(t),i(0,t),this}};if(m.promise(y).complete=f.add,y.success=y.done,y.error=y.fail,d.url=((e||d.url||ht)+"").replace(pt,"").replace(Tt,dt[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=ee.trim(d.dataType||"*").toLowerCase().match(pe)||[""],null==d.crossDomain&&(c=bt.exec(d.url.toLowerCase()),d.crossDomain=!(!c||c[1]===dt[1]&&c[2]===dt[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(dt[3]||("http:"===dt[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ee.param(d.data,d.traditional)),U(wt,d,t,y),2===b)return y;l=d.global,l&&0===ee.active++&&ee.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!vt.test(d.type),s=d.url,d.hasContent||(d.data&&(s=d.url+=(ut.test(s)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=mt.test(s)?s.replace(mt,"$1_="+lt++):s+(ut.test(s)?"&":"?")+"_="+lt++)),d.ifModified&&(ee.lastModified[s]&&y.setRequestHeader("If-Modified-Since",ee.lastModified[s]),ee.etag[s]&&y.setRequestHeader("If-None-Match",ee.etag[s])),(d.data&&d.hasContent&&d.contentType!==!1||t.contentType)&&y.setRequestHeader("Content-Type",d.contentType),y.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+_t+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)y.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(h,y,d)===!1||2===b))return y.abort();w="abort";for(u in{success:1,error:1,complete:1})y[u](d[u]);if(n=U(yt,d,t,y)){y.readyState=1,l&&p.trigger("ajaxSend",[y,d]),d.async&&d.timeout>0&&(o=setTimeout(function(){y.abort("timeout")},d.timeout));try{b=1,n.send(v,i)}catch(_){if(!(2>b))throw _;i(-1,_)}}else i(-1,"No Transport");return y},getJSON:function(e,t,i){return ee.get(e,t,i,"json")},getScript:function(e,t){return ee.get(e,void 0,t,"script")}}),ee.each(["get","post"],function(e,t){ee[t]=function(e,i,n,s){return ee.isFunction(i)&&(s=s||n,n=i,i=void 0),ee.ajax({url:e,type:t,dataType:s,data:i,success:n})}}),ee.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ee.fn[t]=function(e){return this.on(t,e)}}),ee._evalUrl=function(e){return ee.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},ee.fn.extend({wrapAll:function(e){var t;return ee.isFunction(e)?this.each(function(t){ee(this).wrapAll(e.call(this,t))}):(this[0]&&(t=ee(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(ee.isFunction(e)?function(t){ee(this).wrapInner(e.call(this,t))}:function(){var t=ee(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ee.isFunction(e);return this.each(function(i){ee(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ee.nodeName(this,"body")||ee(this).replaceWith(this.childNodes)}).end()}}),ee.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},ee.expr.filters.visible=function(e){return!ee.expr.filters.hidden(e)};var Ct=/%20/g,St=/\[\]$/,Et=/\r?\n/g,xt=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;ee.param=function(e,t){var i,n=[],s=function(e,t){t=ee.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=ee.ajaxSettings&&ee.ajaxSettings.traditional),ee.isArray(e)||e.jquery&&!ee.isPlainObject(e))ee.each(e,function(){s(this.name,this.value)});else for(i in e)$(i,e[i],t,s);return n.join("&").replace(Ct,"+")},ee.fn.extend({serialize:function(){return ee.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ee.prop(this,"elements");return e?ee.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ee(this).is(":disabled")&&kt.test(this.nodeName)&&!xt.test(e)&&(this.checked||!Ce.test(e))}).map(function(e,t){var i=ee(this).val();return null==i?null:ee.isArray(i)?ee.map(i,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:i.replace(Et,"\r\n")}}).get()}}),ee.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var At=0,It={},Mt={0:200,1223:204},Rt=ee.ajaxSettings.xhr();e.ActiveXObject&&ee(e).on("unload",function(){for(var e in It)It[e]()}),J.cors=!!Rt&&"withCredentials"in Rt,J.ajax=Rt=!!Rt,ee.ajaxTransport(function(e){var t;return J.cors||Rt&&!e.crossDomain?{send:function(i,n){var s,r=e.xhr(),a=++At;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)r[s]=e.xhrFields[s];e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)r.setRequestHeader(s,i[s]);t=function(e){return function(){t&&(delete It[a],t=r.onload=r.onerror=null,"abort"===e?r.abort():"error"===e?n(r.status,r.statusText):n(Mt[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{
text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=t(),r.onerror=t("error"),t=It[a]=t("abort"),r.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:void 0}),ee.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ee.globalEval(e),e}}}),ee.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ee.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,s){t=ee("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&s("error"===e.type?404:200,e.type)}),X.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Lt=[],Nt=/(=)\?(?=&|$)|\?\?/;ee.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Lt.pop()||ee.expando+"_"+lt++;return this[e]=!0,e}}),ee.ajaxPrefilter("json jsonp",function(t,i,n){var s,r,a,o=t.jsonp!==!1&&(Nt.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Nt.test(t.data)&&"data");return o||"jsonp"===t.dataTypes[0]?(s=t.jsonpCallback=ee.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(Nt,"$1"+s):t.jsonp!==!1&&(t.url+=(ut.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return a||ee.error(s+" was not called"),a[0]},t.dataTypes[0]="json",r=e[s],e[s]=function(){a=arguments},n.always(function(){e[s]=r,t[s]&&(t.jsonpCallback=i.jsonpCallback,Lt.push(s)),a&&ee.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),ee.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||X;var n=ae.exec(e),s=!i&&[];return n?[t.createElement(n[1])]:(n=ee.buildFragment([e],t,s),s&&s.length&&ee(s).remove(),ee.merge([],n.childNodes))};var Ot=ee.fn.load;ee.fn.load=function(e,t,i){if("string"!=typeof e&&Ot)return Ot.apply(this,arguments);var n,s,r,a=this,o=e.indexOf(" ");return o>=0&&(n=e.slice(o),e=e.slice(0,o)),ee.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(s="POST"),a.length>0&&ee.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){r=arguments,a.html(n?ee("<div>").append(ee.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,r||[e.responseText,t,e])}),this},ee.expr.filters.animated=function(e){return ee.grep(ee.timers,function(t){return e===t.elem}).length};var Ut=e.document.documentElement;ee.offset={setOffset:function(e,t,i){var n,s,r,a,o,c,l,u=ee.css(e,"position"),d=ee(e),h={};"static"===u&&(e.style.position="relative"),o=d.offset(),r=ee.css(e,"top"),c=ee.css(e,"left"),l=("absolute"===u||"fixed"===u)&&(r+c).indexOf("auto")>-1,l?(n=d.position(),a=n.top,s=n.left):(a=parseFloat(r)||0,s=parseFloat(c)||0),ee.isFunction(t)&&(t=t.call(e,i,o)),null!=t.top&&(h.top=t.top-o.top+a),null!=t.left&&(h.left=t.left-o.left+s),"using"in t?t.using.call(e,h):d.css(h)}},ee.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ee.offset.setOffset(this,e,t)});var t,i,n=this[0],s={top:0,left:0},r=n&&n.ownerDocument;if(r)return t=r.documentElement,ee.contains(t,n)?(typeof n.getBoundingClientRect!==Se&&(s=n.getBoundingClientRect()),i=B(r),{top:s.top+i.pageYOffset-t.clientTop,left:s.left+i.pageXOffset-t.clientLeft}):s},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===ee.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ee.nodeName(e[0],"html")||(n=e.offset()),n.top+=ee.css(e[0],"borderTopWidth",!0),n.left+=ee.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-ee.css(i,"marginTop",!0),left:t.left-n.left-ee.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Ut;e&&!ee.nodeName(e,"html")&&"static"===ee.css(e,"position");)e=e.offsetParent;return e||Ut})}}),ee.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n="pageYOffset"===i;ee.fn[t]=function(s){return ge(this,function(t,s,r){var a=B(t);return void 0===r?a?a[i]:t[s]:void(a?a.scrollTo(n?e.pageXOffset:r,n?r:e.pageYOffset):t[s]=r)},t,s,arguments.length,null)}}),ee.each(["top","left"],function(e,t){ee.cssHooks[t]=_(J.pixelPosition,function(e,i){return i?(i=y(e,t),He.test(i)?ee(e).position()[t]+"px":i):void 0})}),ee.each({Height:"height",Width:"width"},function(e,t){ee.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){ee.fn[n]=function(n,s){var r=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||s===!0?"margin":"border");return ge(this,function(t,i,n){var s;return ee.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===n?ee.css(t,i,a):ee.style(t,i,n,a)},t,r?n:void 0,r,null)}})}),ee.fn.size=function(){return this.length},ee.fn.andSelf=ee.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ee});var Ft=e.jQuery,jt=e.$;return ee.noConflict=function(t){return e.$===ee&&(e.$=jt),t&&e.jQuery===ee&&(e.jQuery=Ft),ee},typeof t===Se&&(e.jQuery=e.$=ee),ee}),function(e,t,i){function n(i){var n=t.console;r[i]||(r[i]=!0,e.migrateWarnings.push(i),n&&n.warn&&!e.migrateMute&&(n.warn("JQMIGRATE: "+i),e.migrateTrace&&n.trace&&n.trace()))}function s(t,i,s,r){if(Object.defineProperty)try{return void Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:function(){return n(r),s},set:function(e){n(r),s=e}})}catch(a){}e._definePropertyBroken=!0,t[i]=s}var r={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===i&&(e.migrateTrace=!0),e.migrateReset=function(){r={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&n("jQuery is not compatible with Quirks Mode");var a=e("<input/>",{size:1}).attr("size")&&e.attrFn,o=e.attr,c=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},l=e.attrHooks.value&&e.attrHooks.value.set||function(){return i},u=/^(?:input|button)$/i,d=/^[238]$/,h=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,p=/^(?:checked|selected)$/i;s(e,"attrFn",a||{},"jQuery.attrFn is deprecated"),e.attr=function(t,s,r,c){var l=s.toLowerCase(),m=t&&t.nodeType;return c&&(o.length<4&&n("jQuery.fn.attr( props, pass ) is deprecated"),t&&!d.test(m)&&(a?s in a:e.isFunction(e.fn[s])))?e(t)[s](r):("type"===s&&r!==i&&u.test(t.nodeName)&&t.parentNode&&n("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[l]&&h.test(l)&&(e.attrHooks[l]={get:function(t,n){var s,r=e.prop(t,n);return r===!0||"boolean"!=typeof r&&(s=t.getAttributeNode(n))&&s.nodeValue!==!1?n.toLowerCase():i},set:function(t,i,n){var s;return i===!1?e.removeAttr(t,n):(s=e.propFix[n]||n,s in t&&(t[s]=!0),t.setAttribute(n,n.toLowerCase())),n}},p.test(l)&&n("jQuery.fn.attr('"+l+"') may use property instead of attribute")),o.call(e,t,s,r))},e.attrHooks.value={get:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?c.apply(this,arguments):("input"!==i&&"option"!==i&&n("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var i=(e.nodeName||"").toLowerCase();return"button"===i?l.apply(this,arguments):("input"!==i&&"option"!==i&&n("jQuery.fn.attr('value', val) no longer sets properties"),void(e.value=t))}};var m,f,g=e.fn.init,v=e.parseJSON,T=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,i,s){var r;return t&&"string"==typeof t&&!e.isPlainObject(i)&&(r=T.exec(e.trim(t)))&&r[0]&&("<"!==t.charAt(0)&&n("$(html) HTML strings must start with '<' character"),r[3]&&n("$(html) HTML text after last tag is ignored"),"#"===r[0].charAt(0)&&(n("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),i&&i.context&&(i=i.context),e.parseHTML)?g.call(this,e.parseHTML(r[2],i,!0),i,s):g.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?v.apply(this,arguments):(n("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(m=e.uaMatch(navigator.userAgent),f={},m.browser&&(f[m.browser]=!0,f.version=m.version),f.chrome?f.webkit=!0:f.webkit&&(f.safari=!0),e.browser=f),s(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,i){return new t.fn.init(e,i)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(n,s){return s&&s instanceof e&&!(s instanceof t)&&(s=t(s)),e.fn.init.call(this,n,s,i)},t.fn.init.prototype=t.fn;var i=t(document);return n("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var s,r,a=this[0];return!a||"events"!==t||1!==arguments.length||(s=e.data(a,t),r=e._data(a,t),s!==i&&s!==r||r===i)?b.apply(this,arguments):(n("Use of jQuery.fn.data('events') is deprecated"),r)};var w=/\/(java|ecma)script/i,y=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return n("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),y.apply(this,arguments)},e.clean||(e.clean=function(t,i,s,r){i=i||document,i=!i.nodeType&&i[0]||i,i=i.ownerDocument||i,n("jQuery.clean() is deprecated");var a,o,c,l,u=[];if(e.merge(u,e.buildFragment(t,i).childNodes),s)for(c=function(e){return!e.type||w.test(e.type)?r?r.push(e.parentNode?e.parentNode.removeChild(e):e):s.appendChild(e):void 0},a=0;null!=(o=u[a]);a++)e.nodeName(o,"script")&&c(o)||(s.appendChild(o),"undefined"!=typeof o.getElementsByTagName&&(l=e.grep(e.merge([],o.getElementsByTagName("script")),c),u.splice.apply(u,[a+1,0].concat(l)),a+=l.length));return u});var _=e.event.add,D=e.event.remove,C=e.event.trigger,S=e.fn.toggle,E=e.fn.live,x=e.fn.die,k="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",A=new RegExp("\\b(?:"+k+")\\b"),I=/(?:^|\s)hover(\.\S+|)\b/,M=function(t){return"string"!=typeof t||e.event.special.hover?t:(I.test(t)&&n("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(I,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&s(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,i,s,r){e!==document&&A.test(t)&&n("AJAX events should be attached to document: "+t),_.call(this,e,M(t||""),i,s,r)},e.event.remove=function(e,t,i,n,s){D.call(this,e,M(t)||"",i,n,s)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return n("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,i){if(!e.isFunction(t)||!e.isFunction(i))return S.apply(this,arguments);n("jQuery.fn.toggle(handler, handler...) is deprecated");var s=arguments,r=t.guid||e.guid++,a=0,o=function(i){var n=(e._data(this,"lastToggle"+t.guid)||0)%a;return e._data(this,"lastToggle"+t.guid,n+1),i.preventDefault(),s[n].apply(this,arguments)||!1};for(o.guid=r;a<s.length;)s[a++].guid=r;return this.click(o)},e.fn.live=function(t,i,s){return n("jQuery.fn.live() is deprecated"),E?E.apply(this,arguments):(e(this.context).on(t,this.selector,i,s),this)},e.fn.die=function(t,i){return n("jQuery.fn.die() is deprecated"),x?x.apply(this,arguments):(e(this.context).off(t,this.selector||"**",i),this)},e.event.trigger=function(e,t,i,s){return i||A.test(e)||n("Global events are undocumented and deprecated"),C.call(this,e,t,i||document,s)},e.each(k.split("|"),function(t,i){e.event.special[i]={setup:function(){var t=this;return t!==document&&(e.event.add(document,i+"."+e.guid,function(){e.event.trigger(i,null,t,!0)}),e._data(this,i,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,i+"."+e._data(this,i)),!1}}})}(jQuery,window),FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),FastClick.prototype.needsClick=function(e){"use strict";switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===e.type||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){"use strict";switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){"use strict";var i,n;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),n=t.changedTouches[0],i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,e.dispatchEvent(i)},FastClick.prototype.focus=function(e){"use strict";var t;this.deviceIsIOS&&e.setSelectionRange?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){"use strict";var t,i;if(t=e.fastClickScrollParent,!t||!t.contains(e)){i=e;do{if(i.scrollHeight>i.offsetHeight){t=i,e.fastClickScrollParent=i;break}i=i.parentElement}while(i)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){"use strict";return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){"use strict";var t,i,n;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),i=e.targetTouches[0],this.deviceIsIOS){if(n=window.getSelection(),n.rangeCount&&!n.isCollapsed)return!0;if(!this.deviceIsIOS4){if(i.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=i.pageX,this.touchStartY=i.pageY,e.timeStamp-this.lastClickTime<200&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){"use strict";var t=e.changedTouches[0],i=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>i||Math.abs(t.pageY-this.touchStartY)>i?!0:!1},FastClick.prototype.findControl=function(e){"use strict";return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){"use strict";var t,i,n,s,r,a=this.targetElement;if(this.touchHasMoved(e)&&(this.trackingClick=!1,this.targetElement=null),!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;if(this.lastClickTime=e.timeStamp,i=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(r=e.changedTouches[0],a=document.elementFromPoint(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset)||a,a.fastClickScrollParent=this.targetElement.fastClickScrollParent),n=a.tagName.toLowerCase(),"label"===n){if(t=this.findControl(a)){if(this.focus(a),this.deviceIsAndroid)return!1;a=t}}else if(this.needsFocus(a))return e.timeStamp-i>100||this.deviceIsIOS&&window.top!==window&&"input"===n?(this.targetElement=null,!1):(this.focus(a),this.deviceIsIOS4&&"select"===n||(this.targetElement=null,e.preventDefault()),!1);return this.deviceIsIOS&&!this.deviceIsIOS4&&(s=a.fastClickScrollParent,s&&s.fastClickLastScrollTop!==s.scrollTop)?!0:(this.needsClick(a)||(e.preventDefault(),this.sendClick(a,e)),!1)},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){"use strict";return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0},FastClick.prototype.onClick=function(e){"use strict";var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},FastClick.prototype.destroy=function(){"use strict";var e=this.layer;this.deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){"use strict";var t;if("undefined"==typeof window.ontouchstart)return!0;if(/Chrome\/[0-9]+/.test(navigator.userAgent)){if(!FastClick.prototype.deviceIsAndroid)return!0;if(t=document.querySelector("meta[name=viewport]"),t&&-1!==t.content.indexOf("user-scalable=no"))return!0}return"none"===e.style.msTouchAction?!0:!1},FastClick.attach=function(e){"use strict";return new FastClick(e)},"undefined"!=typeof define&&define.amd?define(function(){"use strict";return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,window.TD=window.TD||{},window.TD.config=window.TD.config||{},window.TD.metrics=function(){function e(e){return"[object Array]"===Object.prototype.toString.call(e)}function t(e,t){return e.concat(t)}var i={};return i.DEBUG=TD.config.debug_level>=4,i.throttle=8e3,i.flush=!0,i.restoreFromFlush=!0,i.flushKey="metrics.realtimeData",i.types={counter:{key:"counters",empty:0,append:function(e,t){return e+t},hasValue:function(e){return!!e},defaultValue:1,isValidValue:function(e){return"number"==typeof e&&!isNaN(e)&&e>0}},metric:{key:"metrics",empty:[],append:function(e,t){return e.concat(t)},hasValue:function(e){return!(!e||!e.length)},defaultValue:[],isValidValue:function(t){return e(t)&&t.length}}},i.env=function(){return TD.util&&TD.util.getAppEnv?TD.util.getAppEnv():"unknown"},i.namespaces={raw:function(){return""},by_id:function(){return[TD.version,TD.buildIDShort,i.env()].join("-")}},i.inflateMetricTriple=function(e){var t=e[0],n=e[1],s=e[2],r=i.makeKey(n).split(":"),a=r[0],o=r.slice(1);return Object.keys(i.namespaces).map(function(e){var n=i.namespaces[e](),r=[a,e,n].filter(Boolean),c=i.makeKey.apply(null,r.concat(o));return[t,c,s]})},i.inflate=function(e){return Object.keys(e).map(function(n){return Object.keys(e[n]).map(function(t){return[n,t,e[n][t]]}).map(i.inflateMetricTriple).reduce(t,[])}).reduce(t,[]).reduce(function(e,t){var i=t[0],n=t[1],s=t[2];return e[i]=e[i]||{},e[i][n]=s,e},{})},i.log=function(){function e(){i.send(i.inflate(r)),r={},s=null}function t(){i.throttle?s||(s=setTimeout(e,i.throttle)):e()}function n(e){e.key=i.makeKey(e.key),e.type=e.type||"counter";var n=i.types[e.type],s=r[n.key]||(r[n.key]={}),a="undefined"!=typeof e.value?e.value:n.defaultValue;n.isValidValue(a)&&(n.hasValue(s[e.key])||(s[e.key]=n.empty),s[e.key]=n.append(s[e.key],a),t())}var s,r={};try{var a=localStorage.getItem(i.flushKey);localStorage.removeItem(i.flushKey),a&&(r=JSON.parse(a),t())}catch(o){}return $(window).on("beforeunload",function(){if(i.flush)try{localStorage.setItem(i.flushKey,JSON.stringify(r))}catch(e){}}),$(window).on("metricsFlush",function(){e()}),n}(),i.send=function(e){var t=new XMLHttpRequest;t.open("post",TD.config.api_root+"/metrics",!0),t.setRequestHeader("Content-Type","application/json");try{t.send(JSON.stringify(e)+"\n")}catch(i){}return t},i.makeKey=function(){var e=[].slice.call(arguments);return["blackbird"].concat(e).join(":").toLowerCase().replace(/^((?:blackbird:){2,})/,"blackbird:")},i}(),TD.metrics.error=function(){var e={};return e.preventCallThrough=!1,e.original=function(){},e.handler=function(t,i,n,s,r){var a={action:"error",data:{}};return r?(a.data.type=r.constructor.name,a.data.message=r.message,a.data.stack=r.stack):(a.data.type=(t.match(/([a-z]+error)/i)||[])[1],a.data.message=(t.match(/:(.*)$/)||[])[1],a.data.message=(a.message||"").toString().trim()),a.data.file=i,a.data.line=n,a.data.column=s,a.key=TD.metrics.makeKey(a.action,a.data.type),TD.metrics.log(a),e.preventCallThrough===!0?!0:e.original.apply(null,arguments)},e.attach=function(){e.attached||(e.attached=!0,e.original=window.onerror||e.original,window.onerror=e.handler)},e}(),TD.metrics.event=function(){var e={};e.handler=function(t,i){e.attached&&i&&i.key&&TD.metrics.log(i)},e.attach=function(){e.attached||(e.attached=!0)};try{$(window).on("metric",e.handler)}catch(t){console.error("Could not attach metric event listener.")}return e}(),TD&&TD.config&&(TD.config.disable_metrics_error||TD.metrics.error.attach(),TD.config.disable_metrics_event||TD.metrics.event.attach()),window.TD=window.TD||{},window.TD.sessionMigration=function(){function e(){return TD.util.isMacApp()&&TD.decider.get("migrate_mac_app_session_to_web")||TD.util.isChromeApp()&&TD.decider.get("migrate_chrome_app_session_to_web")}function t(e){return!e.local._session&&!e.session._session}function i(){return TD.storage.store.getSessionMigratedToWeb()}function n(e,t){$(document).trigger("metric",{key:"session-migration:"+e+":"+t})}function s(e){var t=new TD.core.defer.Deferred;return n("migrate","start"),window.frames[l].postMessage(e,TD.config.web_root),window.addEventListener("message",function(e){e.data.migrationSuccessful?(TD.storage.store.setSessionMigratedToWeb(),n("migrate","complete"),t.callback()):t.errback()}),t}function r(){var e=new TD.core.defer.Deferred;return $(document.body).append($("<iframe>").attr({name:l,src:u}).css({display:"none"}).on("load",e.callback.bind(e))),e}function a(){return TD.controller.stats.flushScribeQueue(),$(document).trigger("metricsFlush"),setTimeout(function(){document.location=TD.config.web_root},1e3),TD.core.defer.timeout(1e4)}function o(){$('[name="'+l+'"]').remove()}var c={},l="migrationFrame",u=TD.config.web_root+"/web/templates/migrate.html";return c.migrateSessionToWeb=function(){if(TD.util.isWeb()||!e())return TD.storage.store.removeSessionMigratedToWeb(),TD.core.defer.succeed();var c=TD.storage.store.getSessionMigrationData();if(t(c)||i()){var l=t(c)?"no-session":"previously-migrated";return n("redirect",l),a()}var u=TD.core.defer.succeed(),d=TD.core.defer.timeout(1e4).addCallback(function(){n("migrate","timeout")});return u.addCallback(r),u.addCallback(s.bind(null,c)),u.addCallbacks(function(){return n("redirect","successful-migration"),a()},function(){n("migrate","fail")}),new TD.core.defer.DeferredList([d,u],{fireOnOneCallback:!0}).addCallback(o)},c.unpackSessionStorage=function(){var e="tempSessionData:";Object.keys(localStorage).forEach(function(t){if(0===t.indexOf(e)){var i=t.replace(e,"");sessionStorage.setItem(i,localStorage[t]),localStorage.removeItem(t)}})},c}(),TD.controller.feather=function(){var exposed={};return exposed.latestFeatherId=23,exposed.loadFeathers=function(isRetry){var d=new TD.core.defer.Deferred;return $.get(TD.config.api_root+TD.assets.get("unbundled",{name:"feathers"}),{t:Date.now()}).success(function(feathers){try{eval(feathers),d.callback()}catch(e){d.errback()}}).error(function(e,t,i){isRetry||exposed.loadFeathers(!0),d.errback()}),d},exposed.applyFeathers=function(e){for(var t,i=exposed.latestFeatherId,n=_.sortBy(e,function(e){return e.id}),s=0;s<n.length;s++)if(t=n[s],t.id>i)try{t.patch(),i=t.id}catch(r){console.log("Error patching feather id: "+t.id+" "+r)}exposed.latestFeatherId=i},setInterval(exposed.loadFeathers,3e5),exposed}(),function(e){var t={};e.publish=function(i,n){var s=t[i];s&&e.each(s,function(){this.apply(e,n||[])})},e.subscribe=function(e,i){return t[e]||(t[e]=[]),t[e].push(i),[e,i]},e.unsubscribe=function(i){if(!(i&&i instanceof Array))throw new Error("unsubscribe(): handle must be an instance of Array.");var n=i[0];t[n]&&e.each(t[n],function(e){this==i[1]&&t[n].splice(e,1)})},e.unsubscribeAll=function(e){delete t[e]}}(jQuery),window.TD=window.TD||{},TD.core=TD.core||{},TD.core.base64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},i=function(e){for(var t="",i=0,n=c1=c2=0;i<e.length;)n=e.charCodeAt(i),128>n?(t+=String.fromCharCode(n),i++):n>191&&224>n?(c2=e.charCodeAt(i+1),t+=String.fromCharCode((31&n)<<6|63&c2),i+=2):(c2=e.charCodeAt(i+1),c3=e.charCodeAt(i+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),i+=3);return t},n=function(i){var n,s,r,a,o,c,l,u="",d=0;for(i=t(i);d<i.length;)n=i.charCodeAt(d++),s=i.charCodeAt(d++),r=i.charCodeAt(d++),a=n>>2,o=(3&n)<<4|s>>4,c=(15&s)<<2|r>>6,l=63&r,isNaN(s)?c=l=64:isNaN(r)&&(l=64),u=u+e.charAt(a)+e.charAt(o)+e.charAt(c)+e.charAt(l);return u},s=function(t){var n,s,r,a,o,c,l,u="",d=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<t.length;)a=e.indexOf(t.charAt(d++)),o=e.indexOf(t.charAt(d++)),c=e.indexOf(t.charAt(d++)),l=e.indexOf(t.charAt(d++)),n=a<<2|o>>4,s=(15&o)<<4|c>>2,r=(3&c)<<6|l,u+=String.fromCharCode(n),64!=c&&(u+=String.fromCharCode(s)),64!=l&&(u+=String.fromCharCode(r));return u=i(u)};return{encode:n,decode:s}}(),function(){function e(e,t,i){for(var n=(i||0)-1,s=e?e.length:0;++n<s;)if(e[n]===t)return n;return-1}function t(t,i){var n=typeof i;if(t=t.cache,"boolean"==n||null==i)return t[i]?0:-1;"number"!=n&&"string"!=n&&(n="object");var s="number"==n?i:v+i;return t=(t=t[n])&&t[s],"object"==n?t&&e(t,i)>-1?0:-1:t?0:-1}function i(e){var t=this.cache,i=typeof e;if("boolean"==i||null==e)t[e]=!0;else{"number"!=i&&"string"!=i&&(i="object");var n="number"==i?e:v+e,s=t[i]||(t[i]={});"object"==i?(s[n]||(s[n]=[])).push(e):s[n]=!0}}function n(e){return e.charCodeAt(0)}function s(e,t){for(var i=e.criteria,n=t.criteria,s=-1,r=i.length;++s<r;){var a=i[s],o=n[s];if(a!==o){if(a>o||"undefined"==typeof a)return 1;if(o>a||"undefined"==typeof o)return-1}}return e.index-t.index}function r(e){var t=-1,n=e.length,s=e[0],r=e[n/2|0],a=e[n-1];if(s&&"object"==typeof s&&r&&"object"==typeof r&&a&&"object"==typeof a)return!1;var o=c();o["false"]=o["null"]=o["true"]=o.undefined=!1;var l=c();for(l.array=e,l.cache=o,l.push=i;++t<n;)l.push(e[t]);return l}function a(e){return"\\"+z[e]}function o(){return m.pop()||[]}function c(){return f.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function l(e){e.length=0,m.length<b&&m.push(e)}function u(e){var t=e.cache;t&&u(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,f.length<b&&f.push(e)}function d(e,t,i){t||(t=0),"undefined"==typeof i&&(i=e?e.length:0);for(var n=-1,s=i-t||0,r=Array(0>s?0:s);++n<s;)r[n]=e[t+n];return r}function h(i){function m(e){return e&&"object"==typeof e&&!Ji(e)&&Li.call(e,"__wrapped__")?e:new f(e)}function f(e,t){this.__chain__=!!t,this.__wrapped__=e}function b(e){function t(){if(n){var e=d(n);Ni.apply(e,arguments)}if(this instanceof t){var r=Y(i.prototype),a=i.apply(r,e||arguments);return Ie(a)?a:r}return i.apply(s,e||arguments)}var i=e[0],n=e[2],s=e[4];return Qi(t,e),t}function z(e,t,i,n,s){if(i){var r=i(e);if("undefined"!=typeof r)return r}var a=Ie(e);if(!a)return e;var c=Ei.call(e);if(!W[c])return e;var u=Gi[c];switch(c){case U:case F:return new u(+e);case P:case H:return new u(e);case B:return r=u(e.source,S.exec(e)),r.lastIndex=e.lastIndex,r}var h=Ji(e);if(t){var p=!n;n||(n=o()),s||(s=o());for(var m=n.length;m--;)if(n[m]==e)return s[m];r=h?u(e.length):{}}else r=h?d(e):rn({},e);return h&&(Li.call(e,"index")&&(r.index=e.index),Li.call(e,"input")&&(r.input=e.input)),t?(n.push(e),s.push(r),(h?Qe:cn)(e,function(e,a){r[a]=z(e,t,i,n,s)}),p&&(l(n),l(s)),r):r}function Y(e,t){return Ie(e)?Pi(e):{}}function Q(e,t,i){if("function"!=typeof e)return Jt;if("undefined"==typeof t||!("prototype"in e))return e;var n=e.__bindData__;if("undefined"==typeof n&&(Yi.funcNames&&(n=!e.name),n=n||!Yi.funcDecomp,!n)){var s=Mi.call(e);Yi.funcNames||(n=!E.test(s)),n||(n=I.test(s),Qi(e,n))}if(n===!1||n!==!0&&1&n[1])return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,s){return e.call(t,i,n,s)};case 4:return function(i,n,s,r){return e.call(t,i,n,s,r)}}return Nt(e,t)}function J(e){function t(){var e=c?a:this;if(s){var m=d(s);Ni.apply(m,arguments)}if((r||u)&&(m||(m=d(arguments)),r&&Ni.apply(m,r),u&&m.length<o))return n|=16,J([i,h?n:-4&n,m,null,a,o]);if(m||(m=arguments),l&&(i=e[p]),this instanceof t){e=Y(i.prototype);var f=i.apply(e,m);return Ie(f)?f:e}return i.apply(e,m)}var i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],c=1&n,l=2&n,u=4&n,h=8&n,p=i;return Qi(t,e),t}function X(i,n){var s=-1,a=ce(),o=i?i.length:0,c=o>=T&&a===e,l=[];if(c){var d=r(n);d?(a=t,n=d):c=!1}for(;++s<o;){var h=i[s];a(n,h)<0&&l.push(h)}return c&&u(n),l}function ee(e,t,i,n){for(var s=(n||0)-1,r=e?e.length:0,a=[];++s<r;){var o=e[s];if(o&&"object"==typeof o&&"number"==typeof o.length&&(Ji(o)||he(o))){t||(o=ee(o,t,i));var c=-1,l=o.length,u=a.length;for(a.length+=l;++c<l;)a[u++]=o[c]}else i||a.push(o)}return a}function te(e,t,i,n,s,r){if(i){var a=i(e,t);if("undefined"!=typeof a)return!!a}if(e===t)return 0!==e||1/e==1/t;var c=typeof e,u=typeof t;if(!(e!==e||e&&K[c]||t&&K[u]))return!1;if(null==e||null==t)return e===t;var d=Ei.call(e),h=Ei.call(t);if(d==N&&(d=$),h==N&&(h=$),d!=h)return!1;switch(d){case U:case F:return+e==+t;case P:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case B:case H:return e==yi(t)}var p=d==O;if(!p){var m=Li.call(e,"__wrapped__"),f=Li.call(t,"__wrapped__");if(m||f)return te(m?e.__wrapped__:e,f?t.__wrapped__:t,i,n,s,r);if(d!=$)return!1;var g=e.constructor,v=t.constructor;if(g!=v&&!(Ae(g)&&g instanceof g&&Ae(v)&&v instanceof v)&&"constructor"in e&&"constructor"in t)return!1}var T=!s;s||(s=o()),r||(r=o());for(var b=s.length;b--;)if(s[b]==e)return r[b]==t;var w=0;if(a=!0,s.push(e),r.push(t),p){if(b=e.length,w=t.length,a=w==b,a||n)for(;w--;){var y=b,_=t[w];if(n)for(;y--&&!(a=te(e[y],_,i,n,s,r)););else if(!(a=te(e[w],_,i,n,s,r)))break}}else on(t,function(t,o,c){return Li.call(c,o)?(w++,a=Li.call(e,o)&&te(e[o],t,i,n,s,r)):void 0}),a&&!n&&on(e,function(e,t,i){return Li.call(i,t)?a=--w>-1:void 0});return s.pop(),r.pop(),T&&(l(s),l(r)),a}function ie(e,t,i,n,s){(Ji(t)?Qe:cn)(t,function(t,r){var a,o,c=t,l=e[r];if(t&&((o=Ji(t))||ln(t))){for(var u=n.length;u--;)if(a=n[u]==t){l=s[u];break}if(!a){var d;i&&(c=i(l,t),(d="undefined"!=typeof c)&&(l=c)),d||(l=o?Ji(l)?l:[]:ln(l)?l:{}),n.push(t),s.push(l),d||ie(l,t,i,n,s)}}else i&&(c=i(l,t),"undefined"==typeof c&&(c=t)),"undefined"!=typeof c&&(l=c);e[r]=l})}function ne(e,t){return e+Ii(zi()*(t-e+1))}function se(i,n,s){var a=-1,c=ce(),d=i?i.length:0,h=[],p=!n&&d>=T&&c===e,m=s||p?o():h;if(p){var f=r(m);c=t,m=f}for(;++a<d;){var g=i[a],v=s?s(g,a,i):g;(n?!a||m[m.length-1]!==v:c(m,v)<0)&&((s||p)&&m.push(v),h.push(g))}return p?(l(m.array),u(m)):s&&l(m),h}function re(e){
return function(t,i,n){var s={};i=m.createCallback(i,n,3);var r=-1,a=t?t.length:0;if("number"==typeof a)for(;++r<a;){var o=t[r];e(s,o,i(o,r,t),t)}else cn(t,function(t,n,r){e(s,t,i(t,n,r),r)});return s}}function ae(e,t,i,n,s,r){var a=1&t,o=2&t,c=4&t,l=16&t,u=32&t;if(!o&&!Ae(e))throw new _i;l&&!i.length&&(t&=-17,l=i=!1),u&&!n.length&&(t&=-33,u=n=!1);var h=e&&e.__bindData__;if(h&&h!==!0)return h=d(h),h[2]&&(h[2]=d(h[2])),h[3]&&(h[3]=d(h[3])),!a||1&h[1]||(h[4]=s),!a&&1&h[1]&&(t|=8),!c||4&h[1]||(h[5]=r),l&&Ni.apply(h[2]||(h[2]=[]),i),u&&Fi.apply(h[3]||(h[3]=[]),n),h[1]|=t,ae.apply(null,h);var p=1==t||17===t?b:J;return p([e,t,i,n,s,r])}function oe(e){return en[e]}function ce(){var t=(t=m.indexOf)===vt?e:t;return t}function le(e){return"function"==typeof e&&xi.test(e)}function ue(e){var t,i;return e&&Ei.call(e)==$&&(t=e.constructor,!Ae(t)||t instanceof t)?(on(e,function(e,t){i=t}),"undefined"==typeof i||Li.call(e,i)):!1}function de(e){return tn[e]}function he(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Ei.call(e)==N||!1}function pe(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i=t,t=!1),z(e,t,"function"==typeof i&&Q(i,n,1))}function me(e,t,i){return z(e,!0,"function"==typeof t&&Q(t,i,1))}function fe(e,t){var i=Y(e);return t?rn(i,t):i}function ge(e,t,i){var n;return t=m.createCallback(t,i,3),cn(e,function(e,i,s){return t(e,i,s)?(n=i,!1):void 0}),n}function ve(e,t,i){var n;return t=m.createCallback(t,i,3),be(e,function(e,i,s){return t(e,i,s)?(n=i,!1):void 0}),n}function Te(e,t,i){var n=[];on(e,function(e,t){n.push(t,e)});var s=n.length;for(t=Q(t,i,3);s--&&t(n[s--],n[s],e)!==!1;);return e}function be(e,t,i){var n=Zi(e),s=n.length;for(t=Q(t,i,3);s--;){var r=n[s];if(t(e[r],r,e)===!1)break}return e}function we(e){var t=[];return on(e,function(e,i){Ae(e)&&t.push(i)}),t.sort()}function ye(e,t){return e?Li.call(e,t):!1}function _e(e){for(var t=-1,i=Zi(e),n=i.length,s={};++t<n;){var r=i[t];s[e[r]]=r}return s}function De(e){return e===!0||e===!1||e&&"object"==typeof e&&Ei.call(e)==U||!1}function Ce(e){return e&&"object"==typeof e&&Ei.call(e)==F||!1}function Se(e){return e&&1===e.nodeType||!1}function Ee(e){var t=!0;if(!e)return t;var i=Ei.call(e),n=e.length;return i==O||i==H||i==N||i==$&&"number"==typeof n&&Ae(e.splice)?!n:(cn(e,function(){return t=!1}),t)}function xe(e,t,i,n){return te(e,t,"function"==typeof i&&Q(i,n,2))}function ke(e){return Bi(e)&&!Hi(parseFloat(e))}function Ae(e){return"function"==typeof e}function Ie(e){return!(!e||!K[typeof e])}function Me(e){return Le(e)&&e!=+e}function Re(e){return null===e}function Le(e){return"number"==typeof e||e&&"object"==typeof e&&Ei.call(e)==P||!1}function Ne(e){return e&&"object"==typeof e&&Ei.call(e)==B||!1}function Oe(e){return"string"==typeof e||e&&"object"==typeof e&&Ei.call(e)==H||!1}function Ue(e){return"undefined"==typeof e}function Fe(e,t,i){var n={};return t=m.createCallback(t,i,3),cn(e,function(e,i,s){n[i]=t(e,i,s)}),n}function je(e){var t=arguments,i=2;if(!Ie(e))return e;if("number"!=typeof t[2]&&(i=t.length),i>3&&"function"==typeof t[i-2])var n=Q(t[--i-1],t[i--],2);else i>2&&"function"==typeof t[i-1]&&(n=t[--i]);for(var s=d(arguments,1,i),r=-1,a=o(),c=o();++r<i;)ie(e,s[r],n,a,c);return l(a),l(c),e}function Pe(e,t,i){var n={};if("function"!=typeof t){var s=[];on(e,function(e,t){s.push(t)}),s=X(s,ee(arguments,!0,!1,1));for(var r=-1,a=s.length;++r<a;){var o=s[r];n[o]=e[o]}}else t=m.createCallback(t,i,3),on(e,function(e,i,s){t(e,i,s)||(n[i]=e)});return n}function $e(e){for(var t=-1,i=Zi(e),n=i.length,s=pi(n);++t<n;){var r=i[t];s[t]=[r,e[r]]}return s}function Be(e,t,i){var n={};if("function"!=typeof t)for(var s=-1,r=ee(arguments,!0,!1,1),a=Ie(e)?r.length:0;++s<a;){var o=r[s];o in e&&(n[o]=e[o])}else t=m.createCallback(t,i,3),on(e,function(e,i,s){t(e,i,s)&&(n[i]=e)});return n}function He(e,t,i,n){var s=Ji(e);if(null==i)if(s)i=[];else{var r=e&&e.constructor,a=r&&r.prototype;i=Y(a)}return t&&(t=m.createCallback(t,n,4),(s?Qe:cn)(e,function(e,n,s){return t(i,e,n,s)})),i}function We(e){for(var t=-1,i=Zi(e),n=i.length,s=pi(n);++t<n;)s[t]=e[i[t]];return s}function Ve(e){for(var t=arguments,i=-1,n=ee(t,!0,!1,1),s=t[2]&&t[2][t[1]]===e?1:n.length,r=pi(s);++i<s;)r[i]=e[n[i]];return r}function qe(e,t,i){var n=-1,s=ce(),r=e?e.length:0,a=!1;return i=(0>i?Vi(0,r+i):i)||0,Ji(e)?a=s(e,t,i)>-1:"number"==typeof r?a=(Oe(e)?e.indexOf(t,i):s(e,t,i))>-1:cn(e,function(e){return++n>=i?!(a=e===t):void 0}),a}function Ke(e,t,i){var n=!0;t=m.createCallback(t,i,3);var s=-1,r=e?e.length:0;if("number"==typeof r)for(;++s<r&&(n=!!t(e[s],s,e)););else cn(e,function(e,i,s){return n=!!t(e,i,s)});return n}function ze(e,t,i){var n=[];t=m.createCallback(t,i,3);var s=-1,r=e?e.length:0;if("number"==typeof r)for(;++s<r;){var a=e[s];t(a,s,e)&&n.push(a)}else cn(e,function(e,i,s){t(e,i,s)&&n.push(e)});return n}function Ge(e,t,i){t=m.createCallback(t,i,3);var n=-1,s=e?e.length:0;if("number"!=typeof s){var r;return cn(e,function(e,i,n){return t(e,i,n)?(r=e,!1):void 0}),r}for(;++n<s;){var a=e[n];if(t(a,n,e))return a}}function Ye(e,t,i){var n;return t=m.createCallback(t,i,3),Je(e,function(e,i,s){return t(e,i,s)?(n=e,!1):void 0}),n}function Qe(e,t,i){var n=-1,s=e?e.length:0;if(t=t&&"undefined"==typeof i?t:Q(t,i,3),"number"==typeof s)for(;++n<s&&t(e[n],n,e)!==!1;);else cn(e,t);return e}function Je(e,t,i){var n=e?e.length:0;if(t=t&&"undefined"==typeof i?t:Q(t,i,3),"number"==typeof n)for(;n--&&t(e[n],n,e)!==!1;);else{var s=Zi(e);n=s.length,cn(e,function(e,i,r){return i=s?s[--n]:--n,t(r[i],i,r)})}return e}function Xe(e,t){var i=d(arguments,2),n=-1,s="function"==typeof t,r=e?e.length:0,a=pi("number"==typeof r?r:0);return Qe(e,function(e){a[++n]=(s?t:e[t]).apply(e,i)}),a}function Ze(e,t,i){var n=-1,s=e?e.length:0;if(t=m.createCallback(t,i,3),"number"==typeof s)for(var r=pi(s);++n<s;)r[n]=t(e[n],n,e);else r=[],cn(e,function(e,i,s){r[++n]=t(e,i,s)});return r}function et(e,t,i){var s=-(1/0),r=s;if("function"!=typeof t&&i&&i[t]===e&&(t=null),null==t&&Ji(e))for(var a=-1,o=e.length;++a<o;){var c=e[a];c>r&&(r=c)}else t=null==t&&Oe(e)?n:m.createCallback(t,i,3),Qe(e,function(e,i,n){var a=t(e,i,n);a>s&&(s=a,r=e)});return r}function tt(e,t,i){var s=1/0,r=s;if("function"!=typeof t&&i&&i[t]===e&&(t=null),null==t&&Ji(e))for(var a=-1,o=e.length;++a<o;){var c=e[a];r>c&&(r=c)}else t=null==t&&Oe(e)?n:m.createCallback(t,i,3),Qe(e,function(e,i,n){var a=t(e,i,n);s>a&&(s=a,r=e)});return r}function it(e,t,i,n){if(!e)return i;var s=arguments.length<3;t=m.createCallback(t,n,4);var r=-1,a=e.length;if("number"==typeof a)for(s&&(i=e[++r]);++r<a;)i=t(i,e[r],r,e);else cn(e,function(e,n,r){i=s?(s=!1,e):t(i,e,n,r)});return i}function nt(e,t,i,n){var s=arguments.length<3;return t=m.createCallback(t,n,4),Je(e,function(e,n,r){i=s?(s=!1,e):t(i,e,n,r)}),i}function st(e,t,i){return t=m.createCallback(t,i,3),ze(e,function(e,i,n){return!t(e,i,n)})}function rt(e,t,i){if(e&&"number"!=typeof e.length&&(e=We(e)),null==t||i)return e?e[ne(0,e.length-1)]:p;var n=at(e);return n.length=qi(Vi(0,t),n.length),n}function at(e){var t=-1,i=e?e.length:0,n=pi("number"==typeof i?i:0);return Qe(e,function(e){var i=ne(0,++t);n[t]=n[i],n[i]=e}),n}function ot(e){var t=e?e.length:0;return"number"==typeof t?t:Zi(e).length}function ct(e,t,i){var n;t=m.createCallback(t,i,3);var s=-1,r=e?e.length:0;if("number"==typeof r)for(;++s<r&&!(n=t(e[s],s,e)););else cn(e,function(e,i,s){return!(n=t(e,i,s))});return!!n}function lt(e,t,i){var n=-1,r=Ji(t),a=e?e.length:0,d=pi("number"==typeof a?a:0);for(r||(t=m.createCallback(t,i,3)),Qe(e,function(e,i,s){var a=d[++n]=c();r?a.criteria=Ze(t,function(t){return e[t]}):(a.criteria=o())[0]=t(e,i,s),a.index=n,a.value=e}),a=d.length,d.sort(s);a--;){var h=d[a];d[a]=h.value,r||l(h.criteria),u(h)}return d}function ut(e){return e&&"number"==typeof e.length?d(e):We(e)}function dt(e){for(var t=-1,i=e?e.length:0,n=[];++t<i;){var s=e[t];s&&n.push(s)}return n}function ht(e){return X(e,ee(arguments,!0,!0,1))}function pt(e,t,i){var n=-1,s=e?e.length:0;for(t=m.createCallback(t,i,3);++n<s;)if(t(e[n],n,e))return n;return-1}function mt(e,t,i){var n=e?e.length:0;for(t=m.createCallback(t,i,3);n--;)if(t(e[n],n,e))return n;return-1}function ft(e,t,i){var n=0,s=e?e.length:0;if("number"!=typeof t&&null!=t){var r=-1;for(t=m.createCallback(t,i,3);++r<s&&t(e[r],r,e);)n++}else if(n=t,null==n||i)return e?e[0]:p;return d(e,0,qi(Vi(0,n),s))}function gt(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i="function"!=typeof t&&n&&n[t]===e?null:t,t=!1),null!=i&&(e=Ze(e,i,n)),ee(e,t)}function vt(t,i,n){if("number"==typeof n){var s=t?t.length:0;n=0>n?Vi(0,s+n):n||0}else if(n){var r=Et(t,i);return t[r]===i?r:-1}return e(t,i,n)}function Tt(e,t,i){var n=0,s=e?e.length:0;if("number"!=typeof t&&null!=t){var r=s;for(t=m.createCallback(t,i,3);r--&&t(e[r],r,e);)n++}else n=null==t||i?1:t||n;return d(e,0,qi(Vi(0,s-n),s))}function bt(){for(var i=[],n=-1,s=arguments.length,a=o(),c=ce(),d=c===e,h=o();++n<s;){var p=arguments[n];(Ji(p)||he(p))&&(i.push(p),a.push(d&&p.length>=T&&r(n?i[n]:h)))}var m=i[0],f=-1,g=m?m.length:0,v=[];e:for(;++f<g;){var b=a[0];if(p=m[f],(b?t(b,p):c(h,p))<0){for(n=s,(b||h).push(p);--n;)if(b=a[n],(b?t(b,p):c(i[n],p))<0)continue e;v.push(p)}}for(;s--;)b=a[s],b&&u(b);return l(a),l(h),v}function wt(e,t,i){var n=0,s=e?e.length:0;if("number"!=typeof t&&null!=t){var r=s;for(t=m.createCallback(t,i,3);r--&&t(e[r],r,e);)n++}else if(n=t,null==n||i)return e?e[s-1]:p;return d(e,Vi(0,s-n))}function yt(e,t,i){var n=e?e.length:0;for("number"==typeof i&&(n=(0>i?Vi(0,n+i):qi(i,n-1))+1);n--;)if(e[n]===t)return n;return-1}function _t(e){for(var t=arguments,i=0,n=t.length,s=e?e.length:0;++i<n;)for(var r=-1,a=t[i];++r<s;)e[r]===a&&(Ui.call(e,r--,1),s--);return e}function Dt(e,t,i){e=+e||0,i="number"==typeof i?i:+i||1,null==t&&(t=e,e=0);for(var n=-1,s=Vi(0,ki((t-e)/(i||1))),r=pi(s);++n<s;)r[n]=e,e+=i;return r}function Ct(e,t,i){var n=-1,s=e?e.length:0,r=[];for(t=m.createCallback(t,i,3);++n<s;){var a=e[n];t(a,n,e)&&(r.push(a),Ui.call(e,n--,1),s--)}return r}function St(e,t,i){if("number"!=typeof t&&null!=t){var n=0,s=-1,r=e?e.length:0;for(t=m.createCallback(t,i,3);++s<r&&t(e[s],s,e);)n++}else n=null==t||i?1:Vi(0,t);return d(e,n)}function Et(e,t,i,n){var s=0,r=e?e.length:s;for(i=i?m.createCallback(i,n,1):Jt,t=i(t);r>s;){var a=s+r>>>1;i(e[a])<t?s=a+1:r=a}return s}function xt(){return se(ee(arguments,!0,!0))}function kt(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i="function"!=typeof t&&n&&n[t]===e?null:t,t=!1),null!=i&&(i=m.createCallback(i,n,3)),se(e,t,i)}function At(e){return X(e,d(arguments,1))}function It(){for(var e=-1,t=arguments.length;++e<t;){var i=arguments[e];if(Ji(i)||he(i))var n=n?se(X(n,i).concat(X(i,n))):i}return n||[]}function Mt(){for(var e=arguments.length>1?arguments:arguments[0],t=-1,i=e?et(pn(e,"length")):0,n=pi(0>i?0:i);++t<i;)n[t]=pn(e,t);return n}function Rt(e,t){var i=-1,n=e?e.length:0,s={};for(t||!n||Ji(e[0])||(t=[]);++i<n;){var r=e[i];t?s[r]=t[i]:r&&(s[r[0]]=r[1])}return s}function Lt(e,t){if(!Ae(t))throw new _i;return function(){return--e<1?t.apply(this,arguments):void 0}}function Nt(e,t){return arguments.length>2?ae(e,17,d(arguments,2),null,t):ae(e,1,null,null,t)}function Ot(e){for(var t=arguments.length>1?ee(arguments,!0,!1,1):we(e),i=-1,n=t.length;++i<n;){var s=t[i];e[s]=ae(e[s],1,null,null,e)}return e}function Ut(e,t){return arguments.length>2?ae(t,19,d(arguments,2),null,e):ae(t,3,null,null,e)}function Ft(){for(var e=arguments,t=e.length;t--;)if(!Ae(e[t]))throw new _i;return function(){for(var t=arguments,i=e.length;i--;)t=[e[i].apply(this,t)];return t[0]}}function jt(e,t){return t="number"==typeof t?t:+t||e.length,ae(e,4,null,null,null,t)}function Pt(e,t,i){var n,s,r,a,o,c,l,u=0,d=!1,h=!0;if(!Ae(e))throw new _i;if(t=Vi(0,t)||0,i===!0){var m=!0;h=!1}else Ie(i)&&(m=i.leading,d="maxWait"in i&&(Vi(t,i.maxWait)||0),h="trailing"in i?i.trailing:h);var f=function(){var i=t-(fn()-a);if(0>=i){s&&Ai(s);var d=l;s=c=l=p,d&&(u=fn(),r=e.apply(o,n),c||s||(n=o=null))}else c=Oi(f,i)},g=function(){c&&Ai(c),s=c=l=p,(h||d!==t)&&(u=fn(),r=e.apply(o,n),c||s||(n=o=null))};return function(){if(n=arguments,a=fn(),o=this,l=h&&(c||!m),d===!1)var i=m&&!c;else{s||m||(u=a);var p=d-(a-u),v=0>=p;v?(s&&(s=Ai(s)),u=a,r=e.apply(o,n)):s||(s=Oi(g,p))}return v&&c?c=Ai(c):c||t===d||(c=Oi(f,t)),i&&(v=!0,r=e.apply(o,n)),!v||c||s||(n=o=null),r}}function $t(e){if(!Ae(e))throw new _i;var t=d(arguments,1);return Oi(function(){e.apply(p,t)},1)}function Bt(e,t){if(!Ae(e))throw new _i;var i=d(arguments,2);return Oi(function(){e.apply(p,i)},t)}function Ht(e,t){if(!Ae(e))throw new _i;var i=function(){var n=i.cache,s=t?t.apply(this,arguments):v+arguments[0];return Li.call(n,s)?n[s]:n[s]=e.apply(this,arguments)};return i.cache={},i}function Wt(e){var t,i;if(!Ae(e))throw new _i;return function(){return t?i:(t=!0,i=e.apply(this,arguments),e=null,i)}}function Vt(e){return ae(e,16,d(arguments,1))}function qt(e){return ae(e,32,null,d(arguments,1))}function Kt(e,t,i){var n=!0,s=!0;if(!Ae(e))throw new _i;return i===!1?n=!1:Ie(i)&&(n="leading"in i?i.leading:n,s="trailing"in i?i.trailing:s),V.leading=n,V.maxWait=t,V.trailing=s,Pt(e,t,V)}function zt(e,t){return ae(t,16,[e])}function Gt(e){return function(){return e}}function Yt(e,t,i){var n=typeof e;if(null==e||"function"==n)return Q(e,t,i);if("object"!=n)return ti(e);var s=Zi(e),r=s[0],a=e[r];return 1!=s.length||a!==a||Ie(a)?function(t){for(var i=s.length,n=!1;i--&&(n=te(t[s[i]],e[s[i]],null,!0)););return n}:function(e){var t=e[r];return a===t&&(0!==a||1/a==1/t)}}function Qt(e){return null==e?"":yi(e).replace(sn,oe)}function Jt(e){return e}function Xt(e,t,i){var n=!0,s=t&&we(t);t&&(i||s.length)||(null==i&&(i=t),r=f,t=e,e=m,s=we(t)),i===!1?n=!1:Ie(i)&&"chain"in i&&(n=i.chain);var r=e,a=Ae(r);Qe(s,function(i){var s=e[i]=t[i];a&&(r.prototype[i]=function(){var t=this.__chain__,i=this.__wrapped__,a=[i];Ni.apply(a,arguments);var o=s.apply(e,a);if(n||t){if(i===o&&Ie(o))return this;o=new r(o),o.__chain__=t}return o})})}function Zt(){return i._=Si,this}function ei(){}function ti(e){return function(t){return t[e]}}function ii(e,t,i){var n=null==e,s=null==t;if(null==i&&("boolean"==typeof e&&s?(i=e,e=1):s||"boolean"!=typeof t||(i=t,s=!0)),n&&s&&(t=1),e=+e||0,s?(t=e,e=0):t=+t||0,i||e%1||t%1){var r=zi();return qi(e+r*(t-e+parseFloat("1e-"+((r+"").length-1))),t)}return ne(e,t)}function ni(e,t){if(e){var i=e[t];return Ae(i)?e[t]():i}}function si(e,t,i){var n=m.templateSettings;e=yi(e||""),i=an({},i,n);var s,r=an({},i.imports,n.imports),o=Zi(r),c=We(r),l=0,u=i.interpolate||A,d="__p += '",h=wi((i.escape||A).source+"|"+u.source+"|"+(u===x?C:A).source+"|"+(i.evaluate||A).source+"|$","g");e.replace(h,function(t,i,n,r,o,c){return n||(n=r),d+=e.slice(l,c).replace(M,a),i&&(d+="' +\n__e("+i+") +\n'"),o&&(s=!0,d+="';\n"+o+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=c+t.length,t}),d+="';\n";var f=i.variable,g=f;g||(f="obj",d="with ("+f+") {\n"+d+"\n}\n"),d=(s?d.replace(y,""):d).replace(_,"$1").replace(D,"$1;"),d="function("+f+") {\n"+(g?"":f+" || ("+f+" = {});\n")+"var __t, __p = '', __e = _.escape"+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+L++ +"]")+"\n*/";try{var T=gi(o,"return "+d+v).apply(p,c)}catch(b){throw b.source=d,b}return t?T(t):(T.source=d,T)}function ri(e,t,i){e=(e=+e)>-1?e:0;var n=-1,s=pi(e);for(t=Q(t,i,1);++n<e;)s[n]=t(n);return s}function ai(e){return null==e?"":yi(e).replace(nn,de)}function oi(e){var t=++g;return yi(null==e?"":e)+t}function ci(e){return e=new f(e),e.__chain__=!0,e}function li(e,t){return t(e),e}function ui(){return this.__chain__=!0,this}function di(){return yi(this.__wrapped__)}function hi(){return this.__wrapped__}i=i?Z.defaults(G.Object(),i,Z.pick(G,R)):G;var pi=i.Array,mi=i.Boolean,fi=i.Date,gi=i.Function,vi=i.Math,Ti=i.Number,bi=i.Object,wi=i.RegExp,yi=i.String,_i=i.TypeError,Di=[],Ci=bi.prototype,Si=i._,Ei=Ci.toString,xi=wi("^"+yi(Ei).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),ki=vi.ceil,Ai=i.clearTimeout,Ii=vi.floor,Mi=gi.prototype.toString,Ri=le(Ri=bi.getPrototypeOf)&&Ri,Li=Ci.hasOwnProperty,Ni=Di.push,Oi=i.setTimeout,Ui=Di.splice,Fi=Di.unshift,ji=function(){try{var e={},t=le(t=bi.defineProperty)&&t,i=t(e,e,e)&&t}catch(n){}return i}(),Pi=le(Pi=bi.create)&&Pi,$i=le($i=pi.isArray)&&$i,Bi=i.isFinite,Hi=i.isNaN,Wi=le(Wi=bi.keys)&&Wi,Vi=vi.max,qi=vi.min,Ki=i.parseInt,zi=vi.random,Gi={};Gi[O]=pi,Gi[U]=mi,Gi[F]=fi,Gi[j]=gi,Gi[$]=bi,Gi[P]=Ti,Gi[B]=wi,Gi[H]=yi,f.prototype=m.prototype;var Yi=m.support={};Yi.funcDecomp=!le(i.WinRTError)&&I.test(h),Yi.funcNames="string"==typeof gi.name,m.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:x,variable:"",imports:{_:m}},Pi||(Y=function(){function e(){}return function(t){if(Ie(t)){e.prototype=t;var n=new e;e.prototype=null}return n||i.Object()}}());var Qi=ji?function(e,t){q.value=t,ji(e,"__bindData__",q)}:ei,Ji=$i||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Ei.call(e)==O||!1},Xi=function(e){var t,i=e,n=[];if(!i)return n;if(!K[typeof e])return n;for(t in i)Li.call(i,t)&&n.push(t);return n},Zi=Wi?function(e){return Ie(e)?Wi(e):[]}:Xi,en={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tn=_e(en),nn=wi("("+Zi(tn).join("|")+")","g"),sn=wi("["+Zi(en).join("")+"]","g"),rn=function(e,t,i){var n,s=e,r=s;if(!s)return r;var a=arguments,o=0,c="number"==typeof i?2:a.length;if(c>3&&"function"==typeof a[c-2])var l=Q(a[--c-1],a[c--],2);else c>2&&"function"==typeof a[c-1]&&(l=a[--c]);for(;++o<c;)if(s=a[o],s&&K[typeof s])for(var u=-1,d=K[typeof s]&&Zi(s),h=d?d.length:0;++u<h;)n=d[u],r[n]=l?l(r[n],s[n]):s[n];return r},an=function(e,t,i){var n,s=e,r=s;if(!s)return r;for(var a=arguments,o=0,c="number"==typeof i?2:a.length;++o<c;)if(s=a[o],s&&K[typeof s])for(var l=-1,u=K[typeof s]&&Zi(s),d=u?u.length:0;++l<d;)n=u[l],"undefined"==typeof r[n]&&(r[n]=s[n]);return r},on=function(e,t,i){var n,s=e,r=s;if(!s)return r;if(!K[typeof s])return r;t=t&&"undefined"==typeof i?t:Q(t,i,3);for(n in s)if(t(s[n],n,e)===!1)return r;return r},cn=function(e,t,i){var n,s=e,r=s;if(!s)return r;if(!K[typeof s])return r;t=t&&"undefined"==typeof i?t:Q(t,i,3);for(var a=-1,o=K[typeof s]&&Zi(s),c=o?o.length:0;++a<c;)if(n=o[a],t(s[n],n,e)===!1)return r;return r},ln=Ri?function(e){if(!e||Ei.call(e)!=$)return!1;var t=e.valueOf,i=le(t)&&(i=Ri(t))&&Ri(i);return i?e==i||Ri(e)==i:ue(e)}:ue,un=re(function(e,t,i){Li.call(e,i)?e[i]++:e[i]=1}),dn=re(function(e,t,i){(Li.call(e,i)?e[i]:e[i]=[]).push(t)}),hn=re(function(e,t,i){e[i]=t}),pn=Ze,mn=ze,fn=le(fn=fi.now)&&fn||function(){return(new fi).getTime()},gn=8==Ki(w+"08")?Ki:function(e,t){return Ki(Oe(e)?e.replace(k,""):e,t||0)};return m.after=Lt,m.assign=rn,m.at=Ve,m.bind=Nt,m.bindAll=Ot,m.bindKey=Ut,m.chain=ci,m.compact=dt,m.compose=Ft,m.constant=Gt,m.countBy=un,m.create=fe,m.createCallback=Yt,m.curry=jt,m.debounce=Pt,m.defaults=an,m.defer=$t,m.delay=Bt,m.difference=ht,m.filter=ze,m.flatten=gt,m.forEach=Qe,m.forEachRight=Je,m.forIn=on,m.forInRight=Te,m.forOwn=cn,m.forOwnRight=be,m.functions=we,m.groupBy=dn,m.indexBy=hn,m.initial=Tt,m.intersection=bt,m.invert=_e,m.invoke=Xe,m.keys=Zi,m.map=Ze,m.mapValues=Fe,m.max=et,m.memoize=Ht,m.merge=je,m.min=tt,m.omit=Pe,m.once=Wt,m.pairs=$e,m.partial=Vt,m.partialRight=qt,m.pick=Be,m.pluck=pn,m.property=ti,m.pull=_t,m.range=Dt,m.reject=st,m.remove=Ct,m.rest=St,m.shuffle=at,m.sortBy=lt,m.tap=li,m.throttle=Kt,m.times=ri,m.toArray=ut,m.transform=He,m.union=xt,m.uniq=kt,m.values=We,m.where=mn,m.without=At,m.wrap=zt,m.xor=It,m.zip=Mt,m.zipObject=Rt,m.collect=Ze,m.drop=St,m.each=Qe,m.eachRight=Je,m.extend=rn,m.methods=we,m.object=Rt,m.select=ze,m.tail=St,m.unique=kt,m.unzip=Mt,Xt(m),m.clone=pe,m.cloneDeep=me,m.contains=qe,m.escape=Qt,m.every=Ke,m.find=Ge,m.findIndex=pt,m.findKey=ge,m.findLast=Ye,m.findLastIndex=mt,m.findLastKey=ve,m.has=ye,m.identity=Jt,m.indexOf=vt,m.isArguments=he,m.isArray=Ji,m.isBoolean=De,m.isDate=Ce,m.isElement=Se,m.isEmpty=Ee,m.isEqual=xe,m.isFinite=ke,m.isFunction=Ae,m.isNaN=Me,m.isNull=Re,m.isNumber=Le,m.isObject=Ie,m.isPlainObject=ln,m.isRegExp=Ne,m.isString=Oe,m.isUndefined=Ue,m.lastIndexOf=yt,m.mixin=Xt,m.noConflict=Zt,m.noop=ei,m.now=fn,m.parseInt=gn,m.random=ii,m.reduce=it,m.reduceRight=nt,m.result=ni,m.runInContext=h,m.size=ot,m.some=ct,m.sortedIndex=Et,m.template=si,m.unescape=ai,m.uniqueId=oi,m.all=Ke,m.any=ct,m.detect=Ge,m.findWhere=Ge,m.foldl=it,m.foldr=nt,m.include=qe,m.inject=it,Xt(function(){var e={};return cn(m,function(t,i){m.prototype[i]||(e[i]=t)}),e}(),!1),m.first=ft,m.last=wt,m.sample=rt,m.take=ft,m.head=ft,cn(m,function(e,t){var i="sample"!==t;m.prototype[t]||(m.prototype[t]=function(t,n){var s=this.__chain__,r=e(this.__wrapped__,t,n);return s||null!=t&&(!n||i&&"function"==typeof t)?new f(r,s):r})}),m.VERSION="2.4.1",m.prototype.chain=ui,m.prototype.toString=di,m.prototype.value=hi,m.prototype.valueOf=hi,Qe(["join","pop","shift"],function(e){var t=Di[e];m.prototype[e]=function(){var e=this.__chain__,i=t.apply(this.__wrapped__,arguments);return e?new f(i,e):i}}),Qe(["push","reverse","sort","unshift"],function(e){var t=Di[e];m.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Qe(["concat","slice","splice"],function(e){var t=Di[e];m.prototype[e]=function(){return new f(t.apply(this.__wrapped__,arguments),this.__chain__)}}),m}var p,m=[],f=[],g=0,v=+new Date+"",T=75,b=40,w=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",y=/\b__p \+= '';/g,_=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,C=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,S=/\w*$/,E=/^\s*function[ \n\r\t]+\w/,x=/<%=([\s\S]+?)%>/g,k=RegExp("^["+w+"]*0+(?=.$)"),A=/($^)/,I=/\bthis\b/,M=/['\n\r\t\u2028\u2029\\]/g,R=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],L=0,N="[object Arguments]",O="[object Array]",U="[object Boolean]",F="[object Date]",j="[object Function]",P="[object Number]",$="[object Object]",B="[object RegExp]",H="[object String]",W={};W[j]=!1,W[N]=W[O]=W[U]=W[F]=W[P]=W[$]=W[B]=W[H]=!0;var V={leading:!1,maxWait:0,trailing:!1},q={configurable:!1,enumerable:!1,value:null,writable:!1},K={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},z={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},G=K[typeof window]&&window||this,Y=K[typeof exports]&&exports&&!exports.nodeType&&exports,Q=K[typeof module]&&module&&!module.nodeType&&module,J=Q&&Q.exports===Y&&Y,X=K[typeof global]&&global;!X||X.global!==X&&X.window!==X||(G=X);var Z=h();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(G._=Z,define(function(){return Z})):Y&&Q?J?(Q.exports=Z)._=Z:Y._=Z:G._=Z}.call(this),function(){function e(e){return e?t.escapeRegExp(e):"\\s"}var t,i=String.prototype.trim;t=this._s={capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},join:function(e){for(var t="",i=1;i<arguments.length;i+=1)t+=String(arguments[i]),i!==arguments.length-1&&(t+=String(e));return t},escapeRegExp:function(e){return e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},reverse:function(e){return Array.prototype.reverse.apply(e.split("")).join("")},contains:function(e,t){return-1!==e.indexOf(t)},clean:function(e){return t.strip(e.replace(/\s+/g," "))},trim:function(t,n){return!n&&i?i.call(t):(n=e(n),t.replace(new RegExp("^["+n+"]+|["+n+"]+$","g"),""))},ltrim:function(t,i){return i=e(i),t.replace(new RegExp("^["+i+"]+","g"),"")},rtrim:function(t,i){return i=e(i),t.replace(new RegExp("["+i+"]+$","g"),"")},startsWith:function(e,t){return e.length>=t.length&&e.substring(0,t.length)===t},endsWith:function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t},sprintf:function(){for(var e,t,i,n,s=0,r=arguments[s++],a=[];r;){if(t=/^[^\x25]+/.exec(r))a.push(t[0]);else if(t=/^\x25{2}/.exec(r))a.push("%");else{if(!(t=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(r)))throw"Huh ?!";if(null==(e=arguments[t[1]||s++])||void 0==e)throw"Too few arguments.";if(/[^s]/.test(t[7])&&"number"!=typeof e)throw"Expecting number but found "+typeof e;switch(t[7]){case"b":e=e.toString(2);break;case"c":e=String.fromCharCode(e);break;case"d":e=parseInt(e);break;case"e":e=t[6]?e.toExponential(t[6]):e.toExponential();break;case"f":e=t[6]?parseFloat(e).toFixed(t[6]):parseFloat(e);break;case"o":e=e.toString(8);break;case"s":e=(e=String(e))&&t[6]?e.substring(0,t[6]):e;break;case"u":e=Math.abs(e);break;case"x":e=e.toString(16);break;case"X":e=e.toString(16).toUpperCase()}if(e=/[def]/.test(t[7])&&t[2]&&e>=0?"+"+e:e,i=t[3]?"0"==t[3]?"0":t[3].charAt(1):" ",n=t[5]-String(e).length-0,t[5]){n=n;for(var o=[];n>0;o[--n]=i);i=o.join("")}else i="";i=i,a.push(""+(t[4]?e+i:i+e))}r=r.substring(t[0].length)}return a.join("")}},this._s.strip=t.trim,this._s.lstrip=t.ltrim,this._s.rstrip=t.rtrim,this._&&this._.mixin(this._s)}(),window.TD=window.TD||{},TD.core=TD.core||{},TD.core.sha1=function(e){function t(e,t){var i=e<<t|e>>>32-t;return i}function i(e){var t,i,n="";for(t=7;t>=0;t--)i=e>>>4*t&15,n+=i.toString(16);return n}function n(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}var s,r,a,o,c,l,u,d,h,p=new Array(80),m=1732584193,f=4023233417,g=2562383102,v=271733878,T=3285377520;e=n(e);var b=e.length,w=new Array;for(r=0;b-3>r;r+=4)a=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),w.push(a);switch(b%4){case 0:r=2147483648;break;case 1:r=e.charCodeAt(b-1)<<24|8388608;break;case 2:r=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:r=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}for(w.push(r);w.length%16!=14;)w.push(0);for(w.push(b>>>29),w.push(b<<3&4294967295),s=0;s<w.length;s+=16){for(r=0;16>r;r++)p[r]=w[s+r];for(r=16;79>=r;r++)p[r]=t(p[r-3]^p[r-8]^p[r-14]^p[r-16],1);for(o=m,c=f,l=g,u=v,d=T,r=0;19>=r;r++)h=t(o,5)+(c&l|~c&u)+d+p[r]+1518500249&4294967295,d=u,u=l,l=t(c,30),c=o,o=h;for(r=20;39>=r;r++)h=t(o,5)+(c^l^u)+d+p[r]+1859775393&4294967295,d=u,u=l,l=t(c,30),c=o,o=h;for(r=40;59>=r;r++)h=t(o,5)+(c&l|c&u|l&u)+d+p[r]+2400959708&4294967295,d=u,u=l,l=t(c,30),c=o,o=h;for(r=60;79>=r;r++)h=t(o,5)+(c^l^u)+d+p[r]+3395469782&4294967295,d=u,u=l,l=t(c,30),c=o,o=h;m=m+o&4294967295,f=f+c&4294967295,g=g+l&4294967295,v=v+u&4294967295,T=T+d&4294967295}var h=i(m)+i(f)+i(g)+i(v)+i(T);return h.toLowerCase()},function(){var e=8,t="=",i=0,n=function(t){var i,n=[],s=(1<<e)-1,r=t.length*e;for(i=0;r>i;i+=e)n[i>>5]|=(t.charCodeAt(i/e)&s)<<32-e-i%32;return n},s=function(e){var t,i,n=[],s=e.length;for(t=0;s>t;t+=2){if(i=parseInt(e.substr(t,2),16),isNaN(i))return"INVALID HEX STRING";n[t>>3]|=i<<24-4*(t%8)}return n},r=function(e){var t,n,s=i?"0123456789ABCDEF":"0123456789abcdef",r="",a=4*e.length;for(t=0;a>t;t+=1)n=e[t>>2]>>8*(3-t%4),r+=s.charAt(n>>4&15)+s.charAt(15&n);return r},a=function(e){var i,n,s,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="",o=4*e.length;for(i=0;o>i;i+=3)for(s=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;4>n;n+=1)a+=8*i+6*n<=32*e.length?r.charAt(s>>6*(3-n)&63):t;return a},o=function(e,t){return e>>>t|e<<32-t},c=function(e,t){return e>>>t},l=function(e,t,i){return e&t^~e&i},u=function(e,t,i){return e&t^e&i^t&i},d=function(e){return o(e,2)^o(e,13)^o(e,22)},h=function(e){return o(e,6)^o(e,11)^o(e,25)},p=function(e){return o(e,7)^o(e,18)^c(e,3)},m=function(e){return o(e,17)^o(e,19)^c(e,10)},f=function(e,t){var i=(65535&e)+(65535&t),n=(e>>>16)+(t>>>16)+(i>>>16);return(65535&n)<<16|65535&i},g=function(e,t,i,n){var s=(65535&e)+(65535&t)+(65535&i)+(65535&n),r=(e>>>16)+(t>>>16)+(i>>>16)+(n>>>16)+(s>>>16);return(65535&r)<<16|65535&s},v=function(e,t,i,n,s){var r=(65535&e)+(65535&t)+(65535&i)+(65535&n)+(65535&s),a=(e>>>16)+(t>>>16)+(i>>>16)+(n>>>16)+(s>>>16)+(r>>>16);return(65535&a)<<16|65535&r},T=function(e,t,i){var n,s,r,a,o,c,T,b,w,y,_,D,C,S,E,x,k=[];for(("SHA-224"===i||"SHA-256"===i)&&(D=(t+65>>9<<4)+15,E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_="SHA-224"===i?[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]:[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),e[t>>5]|=128<<24-t%32,e[D]=t,x=e.length,C=0;x>C;C+=16){for(n=_[0],s=_[1],r=_[2],a=_[3],o=_[4],c=_[5],T=_[6],b=_[7],S=0;64>S;S+=1)k[S]=16>S?e[S+C]:g(m(k[S-2]),k[S-7],p(k[S-15]),k[S-16]),w=v(b,h(o),l(o,c,T),E[S],k[S]),y=f(d(n),u(n,s,r)),b=T,T=c,c=o,o=f(a,w),a=r,r=s,s=n,n=f(w,y);_[0]=f(n,_[0]),_[1]=f(s,_[1]),_[2]=f(r,_[2]),_[3]=f(a,_[3]),_[4]=f(o,_[4]),_[5]=f(c,_[5]),_[6]=f(T,_[6]),_[7]=f(b,_[7])}switch(i){case"SHA-224":return[_[0],_[1],_[2],_[3],_[4],_[5],_[6]];case"SHA-256":return _;default:return[]}},b=function(t,i){if(this.sha224=null,this.sha256=null,this.strBinLen=null,this.strToHash=null,"HEX"===i){if(0!==t.length%2)return"TEXT MUST BE IN BYTE INCREMENTS";this.strBinLen=4*t.length,this.strToHash=s(t)}else{if("ASCII"!==i&&"undefined"!=typeof i)return"UNKNOWN TEXT INPUT TYPE";this.strBinLen=t.length*e,this.strToHash=n(t)}};b.prototype={getHash:function(e,t){var i=null,n=this.strToHash.slice();switch(t){case"HEX":i=r;break;case"B64":i=a;break;default:return"FORMAT NOT RECOGNIZED"}switch(e){case"SHA-224":return null===this.sha224&&(this.sha224=T(n,this.strBinLen,e)),i(this.sha224);case"SHA-256":return null===this.sha256&&(this.sha256=T(n,this.strBinLen,e)),i(this.sha256);default:return"HASH NOT RECOGNIZED"}},getHMAC:function(t,i,o,c){var l,u,d,h,p,m,f=[],g=[];switch(c){case"HEX":l=r;break;case"B64":l=a;break;default:return"FORMAT NOT RECOGNIZED"}switch(o){case"SHA-224":m=224;break;case"SHA-256":m=256;break;default:return"HASH NOT RECOGNIZED"}if("HEX"===i){if(0!==t.length%2)return"KEY MUST BE IN BYTE INCREMENTS";u=s(t),p=4*t.length}else{if("ASCII"!==i)return"UNKNOWN KEY INPUT TYPE";u=n(t),p=t.length*e}for(p/8>64?(u=T(u,p,o),u[15]&=4294967040):64>p/8&&(u[15]&=4294967040),d=0;15>=d;d+=1)f[d]=909522486^u[d],g[d]=1549556828^u[d];return h=T(f.concat(this.strToHash),512+this.strBinLen,o),h=T(g.concat(h),512+m,o),l(h)}},window.jsSHA=b}(),TD.util=function(){var e,t,i,n,s,r,a,o,c=0,l=1e3,u=60*l,d=60*u,h=24*d,p=/(.+)(?:_normal)\.(\w+)$/,m=new RegExp("<(?:.|\\n)*?>","gm"),f=/\B(?=(\d{3})+(?!\d))/g,g=/^[@\uff20]?/,v=/^https?:\/\/twitter\.com\/([a-zA-Z0-9_-]+)(?:(?:\/status(?:es)?\/([0-9]+))?|(?:(\/(?:lists|timelines)\/)|\/)?([a-zA-Z0-9_-]+))\/?(\?.*)?$/,T=/^#column=([a-zA-Z0-9+\/=]+)$/,b=/^https?:\/\/tweetdeck.twitter.com\/(#[a-zA-Z0-9+\/=]+)$/,w="Twitter-TweetDeck-blackbird-chrome/{{{clientVersion}}} {{{platform}}}/{{{platformVersion}}}",y=["404","500","about","account","help","jobs","privacy","search","search-advanced","tos"],D=!isNaN(new Date("Mon Oct 08 16:34:01 +0000 2012").getTime());return $.subscribe("/date",function(e){var t=TD.util.parseDateString(e).getTime(),i=(new Date).getTime();c=t-i}),{ANCHOR_TAG_REGEXP:/href=/g,LT_REGEXP:/</g,GT_REGEXP:/>/g,SINGLE_QUOTE_REGEXP:/'/g,QUOTE_REGEXP:/"/g,TWITTER_USERNAME_REGEXP:/@([A-Za-z0-9_]+)/g,parseDateString:function(e){var t;return t=new Date(!D&&e?Date.parse(e.replace(/( \+)/," UTC$1")):e);

},parseISO8601:function(e){return new Date(Date.parse(e))},iso8601:function(e){return(e||new Date).toISOString()},unixTime:function(e){return Math.round(e.getTime()/1e3)},prettyDate:function(e){return TD.util.timeAgo(e.getTime(),!1,!0)},quotedForRegExp:function(e){return String(e||"").replace(/([.\\+*?[^\]$(){}=!<>|:\/\-])/g,"\\$1")},clean:function(e){if(!e)return e;var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[<>"']/g,function(e){return t[e]})},removeHTMLCodes:function(e){var t={"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&#39;":"'","&amp;":"&"};return e.replace(/&(?:lt|gt|quot|apos|#39|amp);/g,function(e){return t[e]})},stripHTMLTags:function(e){return e.replace(m,"")},htmlToText:function(e){return $("<div>"+e+"</div>").text()},h:function(e){var t=$("<div/>"),i=function(e){return e?t.text(e).html().replace(/\"/gi,"&quot;"):e};return this.h=function(e){return i(e)},i(e)},transform:function(e,t){return e?(t=t||{},this.updateEntities(e,t),this.linkify(e,t)):""},cleanWithEmoji:function(e){return e=this.clean(e),TD.decider.get("tweets_emoji")&&(e=TD.emoji.parse(e)),e},updateEntities:function(e,t){var i,n,s,r,a,o,c,l=twttr.txt.modifyIndicesFromUnicodeToUTF16;if(t.convertedToUTF16)return t;if(t.convertedToUTF16=!0,t.media&&t.media.length?l(e,t.media):t.media=[],t.urls&&t.urls.length)l(e,t.urls);else{for(n=this.extractURLEntities(e),c={},t.urls=[],s=0;s<t.media.length;s++)c[t.media[s].url]=!0;for(s=0;s<n.length;s++)c[n[s].url]||t.urls.push(n[s])}for(t.hashtags&&t.hashtags.length?l(e,t.hashtags):t.hashtags=this.extractHashtagEntities(e),t.user_mentions&&t.user_mentions.length?l(e,t.user_mentions):t.user_mentions=[],t.cashtags=twttr.txt.extractCashtagsWithIndices(e),i=this.extractMentionEntities(e),s=0,r=i.length;r>s;s++)a=i[s],o=this.getEntityOverlap(a,t),o?a.list_slug&&a.indices[0]===o.indices[0]&&(o.indices=a.indices,o.list_slug=a.list_slug):t.user_mentions.push(a);return t},extractURLEntities:function(e){return twttr.txt.extractUrlsWithIndices(e)},extractMentionEntities:function(e){var t=twttr.txt.extractMentionsOrListsWithIndices(e);return _.each(t,function(e){e.screen_name=e.screenName,e.list_slug=e.listSlug,delete e.screenName,delete e.listSlug}),t},extractHashtagEntities:function(e){var t=twttr.txt.extractHashtagsWithIndices(e);return _.each(t,function(e){e.text=e.hashtag,delete e.hashtag}),t},getEntityOverlap:function(e,t){var i=t.urls;i=i.concat(t.media),i=i.concat(t.user_mentions),i=i.concat(t.hashtags);for(var n=0,s=i.length;s>n;n++)if(e.indices[0]<i[n].indices[1]&&e.indices[1]>i[n].indices[0])return i[n];return null},linkify:function(e,t){var i,n,s,r,a,o,c="",l=t.urls||[];l=l.concat(t.media||[]),l=l.concat(t.user_mentions||[]),l=l.concat(t.hashtags||[]),l=l.concat(t.cashtags||[]),l.sort(function(e,t){return t.indices[0]-e.indices[0]});for(var u=0,d=l.length;d>u;u++)r=l[u],i=e.substring(0,r.indices[0]),n=e.substring(r.indices[0],r.indices[1]),s=e.substring(r.indices[1]),a="",r.url?a=n===r.url?this.createUrlAnchor(r):n:r.screen_name?a=r.list_slug?TD.ui.template.render("text/list_link_slug",{slug:r.list_slug.substr(1),user:{screenName:r.screen_name},fullName:"@"+r.screen_name+r.list_slug}):TD.ui.template.render("text/profile_link",{user:{screenName:r.screen_name}}):r.text?(o={searchTerm:r.text,symbol:"#",escapedSymbol:escape("#")},a=TD.ui.template.render("text/search_link",o)):r.cashtag&&(o={searchTerm:r.cashtag,symbol:"$",escapedSymbol:escape("$")},a=TD.ui.template.render("text/search_link",o)),c=a+this.cleanWithEmoji(s)+c,e=i;return this.cleanWithEmoji(e)+c},extractTweetIdFromPermalink:function(e){var t,i=e.trim().match(v);return i&&(t=i[2]),t},extractTweetDeckSharedColumnFromFragment:function(e){var t=e.match(T),i=t?t[1]:"";return i},createUrlAnchor:function(e){var t,i,n,s,r,a=e.url,o="url",c=e.expanded_url||e.url,l=c.match(v),u=c.match(b),d=u?this.extractTweetDeckSharedColumnFromFragment(u[1]):"";l&&(i=l[1],n=l[2],l[3]&&(s=l[3].replace(/\//g,"")),r=l[4]);var h=i&&r&&!(n||s);(-1!==y.indexOf(i)||h)&&(i=void 0,r=void 0,n=void 0,s=void 0,d=void 0),_.startsWith(a,"https://")||_.startsWith(a,"http://")||(a="http://"+a);var p="url-ext";return e.isUrlForAttachment&&(p+=" is-url-for-attachment"),t='<a href="'+TD.util.escape(a)+'" target="_blank" class="'+p+'" ',e.expanded_url&&(t+='data-full-url="'+TD.util.escape(e.expanded_url)+'" '),n?(o="tweet",t+='data-tweet-id="'+n+'" '):r?(t+='data-screen-name="'+i+'" ',o="timelines"===s?"viewCustomTimeline":"list",t+='data-slug="'+r+'" '):i?(o="user",t+='data-user-name="'+i+'" '):d&&(o="importSerializedColumn",t+='data-serialized-column="'+d+'" '),t+='rel="'+o+'" ',e.display_url&&e.expanded_url&&8230==e.display_url.charCodeAt(e.display_url.length-1)&&(t+='title="'+TD.util.escape(e.expanded_url)+'" '),t+=">"+TD.util.escape(e.display_url||e.url)+"</a>"},isLinkToTwitterItem:function(e){return v.test(e)},pluralise:function(e,t,i){return 1!=i?t:e},atMentionify:function(e){return e.replace(g,"@")},deMentionify:function(e){return e.replace(g,"")},selectAttrsFrom:function(e,t){for(var i={},n=0;n<t.length;n++)i[t[n]]=e[t[n]];return i},values:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t},isEmpty:_.isEmpty,isWeb:function(){return null==s&&(s=/^https?:\/\//.test(document.location)),s},isMacApp:function(){return null==e&&(e="mac"===TD.util.getAppEnv()),e},isChromeApp:function(){return null==t&&(t=_.startsWith(window.location.href,"chrome-extension://")),t},isChrome:function(){return null==i&&(i=window.navigator.userAgent.indexOf("Chrome")>-1),i},isWrapperApp:function(){return null==r&&(r=Boolean(window.deck&&deck.inApp())),r},getTweetDeckUserAgentString:function(){var e={clientVersion:TD.version+":"+TD.controller.feather.latestFeatherId,platform:TD.util.getAppEnv(),platformVersion:TD.util.isWrapperApp()&&void 0!==deck?deck.getWrapperVersion():""},t=TD.ui.template.toHtml(w,e);return t},visibilityChangeEventName:function(){return null==n&&("undefined"!=typeof document.hidden?n="visibilitychange":"undefined"!=typeof document.mozHidden?n="mozvisibilitychange":"undefined"!=typeof document.msHidden?n="msvisibilitychange":"undefined"!=typeof document.webkitHidden&&(n="webkitvisibilitychange")),n},documentIsHidden:function(){return document.hidden||document.mozHidden||document.msHidden||document.webkitHidden},isTouchDevice:function(){return null==a&&(a=TD.config.force_touchdeck||TD.config.touchdeck&&TD.util.isiOSDevice()),a},isiOSDevice:_.memoize(function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}),attachFastClick:function(){o=FastClick.attach(document.body)},cancelFastClick:function(){"undefined"!=typeof o&&(o.targetElement=null,o.trackingClick=!1)},isUnsupportedWebWrapperVersion:function(){var e,t,i=!1,n=Boolean(TD.util.isWrapperApp()&&deck.getWrapperVersion);if(n){switch(t=deck.getWrapperVersion(),TD.util.getAppEnv()){case"mac":e=TD.minWrapperVersionMac;break;case"win":e=TD.minWrapperVersionWin}i=!e||!t||TD.util.versionComparator(t,e)<0}return i},getFullVersionString:function(){var e={version:TD.version,buildIDShort:TD.buildIDShort,appEnv:TD.util.getAppEnv()};return TD.util.isWrapperApp()&&deck.getWrapperVersion&&(e.wrapperVersion=deck.getWrapperVersion()),TD.ui.template.render("version",e)},isRetina:function(){return window.devicePixelRatio>=1.5},shouldStream:function(){var e=new XMLHttpRequest,t="withCredentials"in e;return t&&TD.settings.getUseStream()&&!TD.decider.get("disable_streaming")&&!TD.config.disable_streaming},getCurrentLocation:function(e,t,i){var n,s,r,a=Number.MAX_VALUE,o=navigator.geolocation,c=function(e){var t=e.coords.accuracy;a>t&&(n=e,a=t),50>t&&(clearTimeout(r),l())},l=function(){o.clearWatch(s),n?t(n):i&&i()};r=setTimeout(l,e),s=o.watchPosition(c,i,{enableHighAccuracy:!0})},openURL:function(e,t){if(_.isString(e)&&(_.startsWith(e,"https://")||_.startsWith(e,"http://")))if(t&&(e=TD.net.util.addURLParameters(e,t)),window.navigator.standalone){var i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank");var n=document.createEvent("HTMLEvents");n.initEvent("click",!0,!0),i.dispatchEvent(n)}else{var s=window.open(e);s&&s.focus()}},maybeOpenClickExternally:function(e){var t=!1,i=$(e.currentTarget),n=i.prop("tagName"),s=i.attr("rel"),r=i.attr("target"),a=e.isTrigger,o=e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||0!==e.button;return"A"===n&&"_blank"===r&&("url"===s||o)&&(TD.util.isWrapperApp()||a?(TD.util.openURL(i.attr("href")),e.preventDefault(),e.stopImmediatePropagation()):e.stopImmediatePropagation(),t=!0),t},openEmail:function(e,t,i){var n="mailto:",s={};t&&(s.subject=t),i&&(s.body=i),e&&(n+=e),n=n+"?"+TD.net.util.formEncode(s),window.open(n)},escape:function(e){return this.clean(e)},truncateText:function(e,t,i,n,s,r){t=void 0==t?"…":t,n=n||0,r=r||0;var a;if(e.length>i+n){var o=e.indexOf(" ",i-r-1);-1!=o&&(i=Math.min(i,o+1)),a=e.substr(0,i),s&&(a=this.transform(a)),a+=t}return a},timesCached:null,timeWords:function(){return TD.util.timesCached||(TD.util.timesCached={longForm:{singular:{now:TD.i("now",null,!0),seconds:TD.i("{{one}} second ago",null,!0),minutes:TD.i("{{one}} minute ago",null,!0),hours:TD.i("{{one}} hour ago",null,!0),days:TD.i("{{one}} day ago",null,!0)},plural:{now:TD.i("now",null,!0),seconds:TD.i("{{plural_number}} seconds ago",null,!0),minutes:TD.i("{{plural_number}} minutes ago",null,!0),hours:TD.i("{{plural_number}} hours ago",null,!0),days:TD.i("{{plural_number}} days ago",null,!0)}},shortForm:{singular:{now:TD.i("now",null,!0),seconds:TD.i("{{one}}s",null,!0),minutes:TD.i("{{one}}m",null,!0),hours:TD.i("{{one}}h",null,!0),days:TD.i("{{one}}d",null,!0)},plural:{now:TD.i("now",null,!0),seconds:TD.i("{{plural_number}}s",null,!0),minutes:TD.i("{{plural_number}}m",null,!0),hours:TD.i("{{plural_number}}h",null,!0),days:TD.i("{{plural_number}}d",null,!0)}}}),TD.util.timesCached},datesCached:null,dates:function(){return TD.util.datesCached||(TD.util.datesCached={months:[TD.i("Jan"),TD.i("Feb"),TD.i("Mar"),TD.i("Apr"),TD.i("May"),TD.i("Jun"),TD.i("Jul"),TD.i("Aug"),TD.i("Sep"),TD.i("Oct"),TD.i("Nov"),TD.i("Dec")],dates:[TD.i("1st"),TD.i("2nd"),TD.i("3rd"),TD.i("4th"),TD.i("5th"),TD.i("6th"),TD.i("7th"),TD.i("8th"),TD.i("9th"),TD.i("10th"),TD.i("11th"),TD.i("12th"),TD.i("13th"),TD.i("14th"),TD.i("15th"),TD.i("16th"),TD.i("17th"),TD.i("18th"),TD.i("19th"),TD.i("20th"),TD.i("21st"),TD.i("22nd"),TD.i("23rd"),TD.i("24th"),TD.i("25th"),TD.i("26th"),TD.i("27th"),TD.i("28th"),TD.i("29th"),TD.i("30th"),TD.i("31st")]}),TD.util.datesCached},timeAgo:function(e,t,i){var n,s,r,a,o=(new Date).getTime(),p=new Date(e).getTime(),m=TD.util.timeWords()[t?"longForm":"shortForm"];return i&&(o+=c),n=o-p,isNaN(n)||-5*l>n?"":(7*l>n?(r="",s="now"):u>n?(r=Math.floor(n/l),s="seconds"):d>n?(r=Math.floor(n/u),s="minutes"):h>n?(r=Math.floor(n/d),s="hours"):(r=Math.floor(n/h),s="days"),m=1===r?m.singular:m.plural,a=TD.ui.template.toHtml(m[s],{one:r,plural_number:r}))},getDayOfWeek:function(e){var t=[TD.i("Sunday"),TD.i("Monday"),TD.i("Tuesday"),TD.i("Wednesday"),TD.i("Thursday"),TD.i("Friday"),TD.i("Saturday")];return t[e.getDay()]},prettyTime:function(e){var t={month:TD.util.dates().months[e.getMonth()],hours24:e.getHours(),hours12:e.getHours()%12||12,minutes:TD.util.padLeadingZero(e.getMinutes()),amPm:TD.i(e.getHours()<12?"am":"pm"),date:TD.util.dates().dates[e.getDate()-1],day:e.getDate(),dayOfWeek:this.getDayOfWeek(e),year:e.getFullYear().toString().slice(2),fullYear:e.getFullYear()};return t},prettyTimeString:function(e){return TD.i("{{hours12}}:{{minutes}}{{amPm}} · {{day}} {{month}} {{fullYear}}",TD.util.prettyTime(e))},prettyTimeOrDateString:function(e){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(1),e>=t?TD.util.prettyTimeOfDayString(e):e>=t-5184e5?TD.i("{{dayOfWeek}}, {{hours12}}:{{minutes}}{{amPm}}",TD.util.prettyTime(e)):TD.i("{{day}} {{month}} {{year}}, {{hours12}}:{{minutes}}{{amPm}}",TD.util.prettyTime(e))},prettyTimeOfDayString:function(e){return TD.i("{{hours12}}:{{minutes}}{{amPm}}",TD.util.prettyTime(e))},prettyDateString:function(e){return TD.i("{{day}} {{month}} {{fullYear}}",TD.util.prettyTime(e))},prettyDateShortString:function(e){return TD.i("{{month}} {{year}}",TD.util.prettyTime(e))},padLeadingZero:function(e){return e.toString().replace(/^(\d)$/,"0$1")},prettyTimeOfDayOrDateString:function(e){return(new Date).toDateString()===e.toDateString()?TD.util.prettyTimeOfDayString(e):TD.util.prettyDateString(e)},isValidNumber:function(e){return"string"==typeof e&&(e=parseFloat(e)),"number"==typeof e&&isFinite(e)},truncateNumber:function(e,t){if(!TD.util.isValidNumber(e))return"";var i=0,n=e;if(t=t||4,String(e).length<=t)return TD.util.prettyNumber(e);for(t-=1;t<String(Math.floor(n)).length;)++i,n/=1e3;return parseFloat(n.toPrecision(t))+["","K","M","B","T"][i]},prettyNumber:function(e){if(!TD.util.isValidNumber(e))return"";"string"==typeof e&&(e=parseInt(e,10));var t=e.toString().split(".");return t[0].replace(f,",")},chirpColumnSort:function(e,t){var i=0,n=e.getSortIndex(),s=t.getSortIndex(),r=n.type;if(n.type!==s.type)return TD.config.internal_build&&console.warn("chirpColumnSort cannot compare",n.type,"to",s.type),0;switch(r){case"milliseconds":case"number":i=s.value-n.value;break;case"numericString":i=TD.util.numericStringComparator(s.value,n.value);break;default:TD.config.internal_build&&console.warn("chirpColumnSort unrecognised sort type:",r),i=0}return i},numericStringComparator:function(e,t){var i=e.length-t.length;return i||(e>t?i=1:t>e&&(i=-1)),i},chirpReverseColumnSort:function(e,t){return TD.util.chirpColumnSort(t,e)},getTopChirp:function(e){return e.reduce(function(e,t){return e&&t?e.belongsAbove(t)?e:t:e||t})},transformTwitterAvatar:function(e,t){return e.replace(p,"$1_"+t+".$2")},getOSName:function(){var e="";return this.isWrapperApp()?e=deck.osname():-1!=navigator.appVersion.indexOf("Win")?e="windows":-1!=navigator.appVersion.indexOf("Mac")?e="osx":-1!=navigator.appVersion.indexOf("Linux")&&(e="linux"),e},numericStringComparator:function(e,t){var i=e.length-t.length;return i||(e>t?i=1:t>e&&(i=-1)),i},hasFeature:function(e){switch(e){case"file":return!!window.File;case"filereader":return!!window.FileReader;default:return}},getAppEnv:function(){var e,t="unknown";if(this.isChromeApp())t="chrome";else if(this.isWrapperApp())switch(e=this.getOSName()){case"osx":t="mac";break;case"windows":t="win"}else _.startsWith(window.location.href,"file://")||(t="web");return t},checkAPIRoot:function(){if("http:"===window.location.protocol||"https:"===window.location.protocol){var e=window.location.protocol+"//"+window.location.host;e!==TD.config.api_root&&(console.log("NOTE: overwriting api_root of",TD.config.api_root,"with",e),TD.config.api_root=e)}},hasFixedScrollBars:function(){var e,t=$("<div>").css({width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"});return $("body").append(t),e=t[0].offsetWidth-t[0].clientWidth,t.remove(),Boolean(e)},bind:function(e,t){return function(){e.apply(t,arguments)}},random:function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))},extendObjectWith:function(e,t){_.each(t,function(t){e[t[0]]=t[1]})},insertLogDivider:_.debounce(function(){console.log(" ")},1),versionComparator:function(e,t){e=e.toString(),t=t.toString();for(var i,n,s=e.split("."),r=t.split("."),a=Math.min(s.length,r.length),o=0;a>o;o++){if(i=parseInt(s[o],10),n=parseInt(r[o],10),i>n)return 1;if(n>i)return-1}return s.length>r.length?1:s.length<r.length?-1:0},getPreciseTime:function(){return window.performance?"function"==typeof window.performance.now?window.performance.now():"function"==typeof window.performance.webkitNow?window.performance.webkitNow():void 0:Date.now()},fnPerformanceWrapper:function(e,t,i){var n=Array.prototype.slice.call(arguments,3);return function(){var s,r=TD.util.getPreciseTime(),a=e.apply(t,n);return s=TD.util.getPreciseTime(),TD.controller.stats.performance.log(i,s-r),a}},logTimeToRenderColumn:function(e,t){var i;t>0&&(i=e/t,TD.controller.stats.performance.log(TD.controller.stats.performance.keys.RENDER_TWEET,i))},TpmCounter:function(e,t,i){var n=0,s=0,r=0,a=[],o=(new Date).getTime(),c=setInterval(function(){var e,c,l,u=(new Date).getTime(),d=u-t;for(a.push({renderedCount:r,startTime:o}),s+=r,r=0,o=u;a.length&&a[0].startTime<d;)e=a.shift(),s-=e.renderedCount;a.length&&(c=u-a[0].startTime,l=6e4/c,n=s*l,$(document).trigger(i,{itemsPerMinute:Math.round(n)}))}.bind(this),e);this.incrementCounter=function(e){r+=e},this.stop=function(){clearInterval(c)}},deterministicObjectHash:function(e){var t=TD.util.createHashableObject(e),i=JSON.stringify(t),n=TD.core.sha1(i);return n=n.substr(0,10)},createHashableObject:function(e){var t,i;if(Array.isArray(e))t=e.map(TD.util.createHashableObject),t.push("A");else if(e===Object(e)){t=[];for(var n in e)e.hasOwnProperty(n)&&(i=TD.util.createHashableObject(e[n]),t.push([n,i]));t.sort(function(e,t){return e[0].localeCompare(t[0])}),t.push("O")}else t=e;return t},isNetworkFailure:function(e){return 0===e.status||500===e.status&&"internal server error"===e.responseText}}}(),function(e,t){"function"==typeof define&&define.amd?define(["scripts/lib/bower_components/lodash/dist/lodash"],t):e.TD.core.defer=t(_)}(this,function(e){var t={};t.NAME="TD.core.defer",t.DEBUG_DEFERREDS=!1;var i=Array.prototype.slice,n=function(e){this.message=e,this.name=e};n.prototype=new Error,n.prototype.toString=function(){return this.message&&this.message!=this.name?this.name+"("+this.message.toString()+")":this.name+"()"};var s=function(e,t,i){i.prototype=new n(e.NAME+"."+t),e[t]=i};s(t,"AlreadyCalledError",function(e){this.deferred=e}),s(t,"CancelledError",function(e){this.deferred=e}),s(t,"GenericError",function(e){this.message=e}),s(t,"XMLHttpRequestError",function(e,t){this.req=e,this.message=t;try{this.number=e.status}catch(i){}if(this.req)switch(this.req.responseText){case"Item cannot be scheduled for the past.":this.humanReadableMessage=TD.i("You can't schedule a Tweet for the past.");break;case"Item too far in the future.":this.humanReadableMessage=TD.i("You can't schedule a Tweet for more than a year ahead.");break;case"You have too many updates scheduled.":this.humanReadableMessage=TD.i("You can only save 150 scheduled Tweets at once. Please delete one or try later.")}});var r=function(){try{throw new Error("DEBUG_DEFERRED stack trace")}catch(e){return e.stack}};return t.Deferred=function(i){this.chain=[],this.id=e.uniqueId("d:"),t.DEBUG_DEFERREDS&&(this.create_stack=r()),this.fired=-1,this.paused=0,this.results=[null,null],this.canceller=i,this.silentlyCancelled=!1,this.chained=!1},t.Deferred.prototype={toString:function(){var e;return e=-1==this.fired?"unfired":0===this.fired?"success":"error","Deferred("+this.id+", "+e+"["+this.chain.length+"])"},cancel:function(){-1==this.fired?(this.canceller?this.canceller(this):this.silentlyCancelled=!0,-1==this.fired&&this.errback(new t.CancelledError(this))):0===this.fired&&this.results[0]instanceof t.Deferred&&this.results[0].cancel()},_resback:function(e){t.DEBUG_DEFERREDS&&(this.invoke_stack=r()),this.fired=e instanceof Error?1:0,this.results[this.fired]=e,this._fire()},_check:function(){if(-1!=this.fired){if(!this.silentlyCancelled)throw new t.AlreadyCalledError(this);return void(this.silentlyCancelled=!1)}},callback:function(e){if(this._check(),e instanceof t.Deferred)throw new Error("Deferred instances can only be chained if they are the result of a callback");this._resback(e)},errback:function(e){if(this._check(),e instanceof t.Deferred)throw new Error("Deferred instances can only be chained if they are the result of a callback");e instanceof Error||(e=new t.GenericError(e)),this._resback(e)},addBoth:function(e){var t=i.call(arguments,1);return this.addCallbacks(e,e,t,t,null,null)},addBothWith:function(e,t){var n=i.call(arguments,2);return this.addCallbacks(t,t,n,n,e,e)},addCallback:function(e){var t=i.call(arguments,1);return this.addCallbacks(e,null,t,null,null,null)},addCallbackWith:function(e,t){var n=i.call(arguments,2);return this.addCallbacks(t,null,n,null,e,null)},addErrback:function(e){var t=i.call(arguments,1);return this.addCallbacks(null,e,null,t,null,null)},addErrbackWith:function(e,t){var n=i.call(arguments,2);return this.addCallbacks(null,t,null,n,null,e)},addCallbacks:function(e,t,i,n,s,r){if(this.chained)throw new Error("Chained Deferreds can not be re-used");return this.chain.push([e,t,i,n,s,r]),this.fired>=0&&this._fire(),this},_fire:function(){for(var e,i,n=this.chain,s=this.fired,r=this.results[s],a=this,o=null,c=function(e){a._resback(e),a.paused--,0===a.paused&&a.fired>=0&&a._fire()};n.length>0&&0===this.paused;){var l=n.shift(),u=l[s];if(null!==u)try{e=l[2+s]?[r].concat(l[2+s]):[r],i=l[4+s],r=u.apply(i,e),s=r instanceof Error?1:0,r instanceof t.Deferred&&(o=c,this.paused++)}catch(d){s=1,r=d instanceof Error?d:new t.GenericError(d),r.stackTrace=r.stack&&r.stack.split?r.stack.split("\n"):[]}}this.fired=s,this.results[s]=r,o&&this.paused&&(r.addBoth(o),r.chained=!0)}},t.DeferredList=function(i,n,s){t.Deferred.apply(this,[s]),this.list=i;var r=[];this.resultList=r,this.finishedCount=0,this.fireOnOneCallback=Boolean(n&&n.fireOnOneCallback),this.fireOnOneErrback=Boolean(n&&n.fireOnOneErrback),this.consumeErrors=Boolean(n&&n.consumeErrors);for(var a=e.bind(this._cbDeferred,this),o=0;o<i.length;o++){var c=i[o];r.push(void 0),c.addCallback(a,o,!0),c.addErrback(a,o,!1)}0!==i.length||this.fireOnOneCallback||this.callback(this.resultList)},t.DeferredList.prototype=new t.Deferred,t.DeferredList.prototype._cbDeferred=function(e,t,i){return this.resultList[t]=[i,e],this.finishedCount+=1,-1==this.fired&&(i&&this.fireOnOneCallback?this.callback([t,e]):!i&&this.fireOnOneErrback?this.errback(e):this.finishedCount==this.list.length&&this.callback(this.resultList)),!i&&this.consumeErrors&&(e=null),e},t.gatherResults=function(e){var i=new t.DeferredList(e,{fireOnOneErrback:!0});return i.addCallback(function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i][1]);return t}),i},t.succeed=function(e){var i=new t.Deferred;return i.callback(e),i},t.fail=function(e){var i=new t.Deferred;return i.errback(e),i},t.maybeDeferred=function(e){var n;try{var s=e.apply(null,i.call(arguments,1));n=s instanceof t.Deferred?s:s instanceof Error?t.fail(s):t.succeed(s)}catch(r){n=t.fail(r)}return n},t.timeout=function(e,t){var i=new TD.core.defer.Deferred;return setTimeout(i.callback.bind(i,t),e),i},t});var twemoji=function(){"use strict";function e(e){return document.createTextNode(e)}function t(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function i(e,t){for(var n,s,r=e.childNodes,a=r.length;a--;)n=r[a],s=n.nodeType,3===s?t.push(n):1!==s||m.test(n.nodeName)||i(n,t);return t}function n(e,t){return d("️"===t?e.slice(0,-1):3===e.length&&"️"===e.charAt(1)?e.charAt(0)+e.charAt(2):e)}function s(t,s){for(var r,a,o,c,l,u,d,m,f,g,v,T=i(t,[]),b=T.length;b--;){for(r=document.createDocumentFragment(),a=T[b],o=a.nodeValue,l=0;c=p.exec(o);)u=c.index,u!==l&&r.appendChild(e(o.slice(l,u))),m=c[0],f=c[1],g=c[2],l=u+m.length,"︎"!==g&&(v=s.callback(n(f,g),s,g),v&&(d=new Image,d.onerror=h.onerror,d.className=s.className,d.setAttribute("draggable","false"),d.alt=m,d.src=v)),r.appendChild(d||e(m)),d=null;l>0&&(l<o.length&&r.appendChild(e(o.slice(l))),a.parentNode.replaceChild(r,a))}return t}function r(e,t){return l(e,function(e,i,s){var r;return"︎"!==s&&(r=t.callback(n(i,s),t,s),r&&(e="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'" ','src="',r,'"',">"))),e})}function a(e){return"number"==typeof e?e+"x"+e:e}function o(e){var t="string"==typeof e?parseInt(e,16):e;return 65536>t?f(t):(t-=65536,f(55296+(t>>10),56320+(1023&t)))}function c(e,i){return i&&"function"!=typeof i||(i={callback:i}),("string"==typeof e?r:s)(e,{callback:i.callback||t,base:"string"==typeof i.base?i.base:h.base,ext:i.ext||h.ext,size:i.folder||a(i.size||h.size),className:i.className||h.className})}function l(e,t){return String(e).replace(p,t)}function u(e){p.lastIndex=0;var t=p.test(e);return p.lastIndex=0,t}function d(e,t){for(var i=[],n=0,s=0,r=0;r<e.length;)n=e.charCodeAt(r++),s?(i.push((65536+(s-55296<<10)+(n-56320)).toString(16)),s=0):n>=55296&&56319>=n?s=n:i.push(n.toString(16));return i.join(t||"-")}var h={base:("https:"===location.protocol?"https:":"http:")+"//twemoji.maxcdn.com/",ext:".png",size:"36x36",className:"emoji",convert:{fromCodePoint:o,toCodePoint:d},onerror:function(){this.parentNode&&this.parentNode.replaceChild(e(this.alt),this)},parse:c,replace:l,test:u},p=/((?:\ud83c\udde8\ud83c\uddf3|\ud83c\uddfa\ud83c\uddf8|\ud83c\uddf7\ud83c\uddfa|\ud83c\uddf0\ud83c\uddf7|\ud83c\uddef\ud83c\uddf5|\ud83c\uddee\ud83c\uddf9|\ud83c\uddec\ud83c\udde7|\ud83c\uddeb\ud83c\uddf7|\ud83c\uddea\ud83c\uddf8|\ud83c\udde9\ud83c\uddea|\u0039\ufe0f?\u20e3|\u0038\ufe0f?\u20e3|\u0037\ufe0f?\u20e3|\u0036\ufe0f?\u20e3|\u0035\ufe0f?\u20e3|\u0034\ufe0f?\u20e3|\u0033\ufe0f?\u20e3|\u0032\ufe0f?\u20e3|\u0031\ufe0f?\u20e3|\u0030\ufe0f?\u20e3|\u0023\ufe0f?\u20e3|\ud83d\udeb3|\ud83d\udeb1|\ud83d\udeb0|\ud83d\udeaf|\ud83d\udeae|\ud83d\udea6|\ud83d\udea3|\ud83d\udea1|\ud83d\udea0|\ud83d\ude9f|\ud83d\ude9e|\ud83d\ude9d|\ud83d\ude9c|\ud83d\ude9b|\ud83d\ude98|\ud83d\ude96|\ud83d\ude94|\ud83d\ude90|\ud83d\ude8e|\ud83d\ude8d|\ud83d\ude8b|\ud83d\ude8a|\ud83d\ude88|\ud83d\ude86|\ud83d\ude82|\ud83d\ude81|\ud83d\ude36|\ud83d\ude34|\ud83d\ude2f|\ud83d\ude2e|\ud83d\ude2c|\ud83d\ude27|\ud83d\ude26|\ud83d\ude1f|\ud83d\ude1b|\ud83d\ude19|\ud83d\ude17|\ud83d\ude15|\ud83d\ude11|\ud83d\ude10|\ud83d\ude0e|\ud83d\ude08|\ud83d\ude07|\ud83d\ude00|\ud83d\udd67|\ud83d\udd66|\ud83d\udd65|\ud83d\udd64|\ud83d\udd63|\ud83d\udd62|\ud83d\udd61|\ud83d\udd60|\ud83d\udd5f|\ud83d\udd5e|\ud83d\udd5d|\ud83d\udd5c|\ud83d\udd2d|\ud83d\udd2c|\ud83d\udd15|\ud83d\udd09|\ud83d\udd08|\ud83d\udd07|\ud83d\udd06|\ud83d\udd05|\ud83d\udd04|\ud83d\udd02|\ud83d\udd01|\ud83d\udd00|\ud83d\udcf5|\ud83d\udcef|\ud83d\udced|\ud83d\udcec|\ud83d\udcb7|\ud83d\udcb6|\ud83d\udcad|\ud83d\udc6d|\ud83d\udc6c|\ud83d\udc65|\ud83d\udc2a|\ud83d\udc16|\ud83d\udc15|\ud83d\udc13|\ud83d\udc10|\ud83d\udc0f|\ud83d\udc0b|\ud83d\udc0a|\ud83d\udc09|\ud83d\udc08|\ud83d\udc07|\ud83d\udc06|\ud83d\udc05|\ud83d\udc04|\ud83d\udc03|\ud83d\udc02|\ud83d\udc01|\ud83d\udc00|\ud83c\udfe4|\ud83c\udfc9|\ud83c\udfc7|\ud83c\udf7c|\ud83c\udf50|\ud83c\udf4b|\ud83c\udf33|\ud83c\udf32|\ud83c\udf1e|\ud83c\udf1d|\ud83c\udf1c|\ud83c\udf1a|\ud83c\udf18|\ud83c\udccf|\ud83c\udd70|\ud83c\udd71|\ud83c\udd7e|\ud83c\udd8e|\ud83c\udd91|\ud83c\udd92|\ud83c\udd93|\ud83c\udd94|\ud83c\udd95|\ud83c\udd96|\ud83c\udd97|\ud83c\udd98|\ud83c\udd99|\ud83c\udd9a|\ud83d\udc77|\ud83d\udec5|\ud83d\udec4|\ud83d\udec3|\ud83d\udec2|\ud83d\udec1|\ud83d\udebf|\ud83d\udeb8|\ud83d\udeb7|\ud83d\udeb5|\ud83c\ude01|\ud83c\ude02|\ud83c\ude32|\ud83c\ude33|\ud83c\ude34|\ud83c\ude35|\ud83c\ude36|\ud83c\ude37|\ud83c\ude38|\ud83c\ude39|\ud83c\ude3a|\ud83c\ude50|\ud83c\ude51|\ud83c\udf00|\ud83c\udf01|\ud83c\udf02|\ud83c\udf03|\ud83c\udf04|\ud83c\udf05|\ud83c\udf06|\ud83c\udf07|\ud83c\udf08|\ud83c\udf09|\ud83c\udf0a|\ud83c\udf0b|\ud83c\udf0c|\ud83c\udf0f|\ud83c\udf11|\ud83c\udf13|\ud83c\udf14|\ud83c\udf15|\ud83c\udf19|\ud83c\udf1b|\ud83c\udf1f|\ud83c\udf20|\ud83c\udf30|\ud83c\udf31|\ud83c\udf34|\ud83c\udf35|\ud83c\udf37|\ud83c\udf38|\ud83c\udf39|\ud83c\udf3a|\ud83c\udf3b|\ud83c\udf3c|\ud83c\udf3d|\ud83c\udf3e|\ud83c\udf3f|\ud83c\udf40|\ud83c\udf41|\ud83c\udf42|\ud83c\udf43|\ud83c\udf44|\ud83c\udf45|\ud83c\udf46|\ud83c\udf47|\ud83c\udf48|\ud83c\udf49|\ud83c\udf4a|\ud83c\udf4c|\ud83c\udf4d|\ud83c\udf4e|\ud83c\udf4f|\ud83c\udf51|\ud83c\udf52|\ud83c\udf53|\ud83c\udf54|\ud83c\udf55|\ud83c\udf56|\ud83c\udf57|\ud83c\udf58|\ud83c\udf59|\ud83c\udf5a|\ud83c\udf5b|\ud83c\udf5c|\ud83c\udf5d|\ud83c\udf5e|\ud83c\udf5f|\ud83c\udf60|\ud83c\udf61|\ud83c\udf62|\ud83c\udf63|\ud83c\udf64|\ud83c\udf65|\ud83c\udf66|\ud83c\udf67|\ud83c\udf68|\ud83c\udf69|\ud83c\udf6a|\ud83c\udf6b|\ud83c\udf6c|\ud83c\udf6d|\ud83c\udf6e|\ud83c\udf6f|\ud83c\udf70|\ud83c\udf71|\ud83c\udf72|\ud83c\udf73|\ud83c\udf74|\ud83c\udf75|\ud83c\udf76|\ud83c\udf77|\ud83c\udf78|\ud83c\udf79|\ud83c\udf7a|\ud83c\udf7b|\ud83c\udf80|\ud83c\udf81|\ud83c\udf82|\ud83c\udf83|\ud83c\udf84|\ud83c\udf85|\ud83c\udf86|\ud83c\udf87|\ud83c\udf88|\ud83c\udf89|\ud83c\udf8a|\ud83c\udf8b|\ud83c\udf8c|\ud83c\udf8d|\ud83c\udf8e|\ud83c\udf8f|\ud83c\udf90|\ud83c\udf91|\ud83c\udf92|\ud83c\udf93|\ud83c\udfa0|\ud83c\udfa1|\ud83c\udfa2|\ud83c\udfa3|\ud83c\udfa4|\ud83c\udfa5|\ud83c\udfa6|\ud83c\udfa7|\ud83c\udfa8|\ud83c\udfa9|\ud83c\udfaa|\ud83c\udfab|\ud83c\udfac|\ud83c\udfad|\ud83c\udfae|\ud83c\udfaf|\ud83c\udfb0|\ud83c\udfb1|\ud83c\udfb2|\ud83c\udfb3|\ud83c\udfb4|\ud83c\udfb5|\ud83c\udfb6|\ud83c\udfb7|\ud83c\udfb8|\ud83c\udfb9|\ud83c\udfba|\ud83c\udfbb|\ud83c\udfbc|\ud83c\udfbd|\ud83c\udfbe|\ud83c\udfbf|\ud83c\udfc0|\ud83c\udfc1|\ud83c\udfc2|\ud83c\udfc3|\ud83c\udfc4|\ud83c\udfc6|\ud83c\udfc8|\ud83c\udfca|\ud83c\udfe0|\ud83c\udfe1|\ud83c\udfe2|\ud83c\udfe3|\ud83c\udfe5|\ud83c\udfe6|\ud83c\udfe7|\ud83c\udfe8|\ud83c\udfe9|\ud83c\udfea|\ud83c\udfeb|\ud83c\udfec|\ud83c\udfed|\ud83c\udfee|\ud83c\udfef|\ud83c\udff0|\ud83d\udc0c|\ud83d\udc0d|\ud83d\udc0e|\ud83d\udc11|\ud83d\udc12|\ud83d\udc14|\ud83d\udc17|\ud83d\udc18|\ud83d\udc19|\ud83d\udc1a|\ud83d\udc1b|\ud83d\udc1c|\ud83d\udc1d|\ud83d\udc1e|\ud83d\udc1f|\ud83d\udc20|\ud83d\udc21|\ud83d\udc22|\ud83d\udc23|\ud83d\udc24|\ud83d\udc25|\ud83d\udc26|\ud83d\udc27|\ud83d\udc28|\ud83d\udc29|\ud83d\udc2b|\ud83d\udc2c|\ud83d\udc2d|\ud83d\udc2e|\ud83d\udc2f|\ud83d\udc30|\ud83d\udc31|\ud83d\udc32|\ud83d\udc33|\ud83d\udc34|\ud83d\udc35|\ud83d\udc36|\ud83d\udc37|\ud83d\udc38|\ud83d\udc39|\ud83d\udc3a|\ud83d\udc3b|\ud83d\udc3c|\ud83d\udc3d|\ud83d\udc3e|\ud83d\udc40|\ud83d\udc42|\ud83d\udc43|\ud83d\udc44|\ud83d\udc45|\ud83d\udc46|\ud83d\udc47|\ud83d\udc48|\ud83d\udc49|\ud83d\udc4a|\ud83d\udc4b|\ud83d\udc4c|\ud83d\udc4d|\ud83d\udc4e|\ud83d\udc4f|\ud83d\udc50|\ud83d\udc51|\ud83d\udc52|\ud83d\udc53|\ud83d\udc54|\ud83d\udc55|\ud83d\udc56|\ud83d\udc57|\ud83d\udc58|\ud83d\udc59|\ud83d\udc5a|\ud83d\udc5b|\ud83d\udc5c|\ud83d\udc5d|\ud83d\udc5e|\ud83d\udc5f|\ud83d\udc60|\ud83d\udc61|\ud83d\udc62|\ud83d\udc63|\ud83d\udc64|\ud83d\udc66|\ud83d\udc67|\ud83d\udc68|\ud83d\udc69|\ud83d\udc6a|\ud83d\udc6b|\ud83d\udc6e|\ud83d\udc6f|\ud83d\udc70|\ud83d\udc71|\ud83d\udc72|\ud83d\udc73|\ud83d\udc74|\ud83d\udc75|\ud83d\udc76|\ud83d\udeb4|\ud83d\udc78|\ud83d\udc79|\ud83d\udc7a|\ud83d\udc7b|\ud83d\udc7c|\ud83d\udc7d|\ud83d\udc7e|\ud83d\udc7f|\ud83d\udc80|\ud83d\udc81|\ud83d\udc82|\ud83d\udc83|\ud83d\udc84|\ud83d\udc85|\ud83d\udc86|\ud83d\udc87|\ud83d\udc88|\ud83d\udc89|\ud83d\udc8a|\ud83d\udc8b|\ud83d\udc8c|\ud83d\udc8d|\ud83d\udc8e|\ud83d\udc8f|\ud83d\udc90|\ud83d\udc91|\ud83d\udc92|\ud83d\udc93|\ud83d\udc94|\ud83d\udc95|\ud83d\udc96|\ud83d\udc97|\ud83d\udc98|\ud83d\udc99|\ud83d\udc9a|\ud83d\udc9b|\ud83d\udc9c|\ud83d\udc9d|\ud83d\udc9e|\ud83d\udc9f|\ud83d\udca0|\ud83d\udca1|\ud83d\udca2|\ud83d\udca3|\ud83d\udca4|\ud83d\udca5|\ud83d\udca6|\ud83d\udca7|\ud83d\udca8|\ud83d\udca9|\ud83d\udcaa|\ud83d\udcab|\ud83d\udcac|\ud83d\udcae|\ud83d\udcaf|\ud83d\udcb0|\ud83d\udcb1|\ud83d\udcb2|\ud83d\udcb3|\ud83d\udcb4|\ud83d\udcb5|\ud83d\udcb8|\ud83d\udcb9|\ud83d\udcba|\ud83d\udcbb|\ud83d\udcbc|\ud83d\udcbd|\ud83d\udcbe|\ud83d\udcbf|\ud83d\udcc0|\ud83d\udcc1|\ud83d\udcc2|\ud83d\udcc3|\ud83d\udcc4|\ud83d\udcc5|\ud83d\udcc6|\ud83d\udcc7|\ud83d\udcc8|\ud83d\udcc9|\ud83d\udcca|\ud83d\udccb|\ud83d\udccc|\ud83d\udccd|\ud83d\udcce|\ud83d\udccf|\ud83d\udcd0|\ud83d\udcd1|\ud83d\udcd2|\ud83d\udcd3|\ud83d\udcd4|\ud83d\udcd5|\ud83d\udcd6|\ud83d\udcd7|\ud83d\udcd8|\ud83d\udcd9|\ud83d\udcda|\ud83d\udcdb|\ud83d\udcdc|\ud83d\udcdd|\ud83d\udcde|\ud83d\udcdf|\ud83d\udce0|\ud83d\udce1|\ud83d\udce2|\ud83d\udce3|\ud83d\udce4|\ud83d\udce5|\ud83d\udce6|\ud83d\udce7|\ud83d\udce8|\ud83d\udce9|\ud83d\udcea|\ud83d\udceb|\ud83d\udcee|\ud83d\udcf0|\ud83d\udcf1|\ud83d\udcf2|\ud83d\udcf3|\ud83d\udcf4|\ud83d\udcf6|\ud83d\udcf7|\ud83d\udcf9|\ud83d\udcfa|\ud83d\udcfb|\ud83d\udcfc|\ud83d\udd03|\ud83d\udd0a|\ud83d\udd0b|\ud83d\udd0c|\ud83d\udd0d|\ud83d\udd0e|\ud83d\udd0f|\ud83d\udd10|\ud83d\udd11|\ud83d\udd12|\ud83d\udd13|\ud83d\udd14|\ud83d\udd16|\ud83d\udd17|\ud83d\udd18|\ud83d\udd19|\ud83d\udd1a|\ud83d\udd1b|\ud83d\udd1c|\ud83d\udd1d|\ud83d\udd1e|\ud83d\udd1f|\ud83d\udd20|\ud83d\udd21|\ud83d\udd22|\ud83d\udd23|\ud83d\udd24|\ud83d\udd25|\ud83d\udd26|\ud83d\udd27|\ud83d\udd28|\ud83d\udd29|\ud83d\udd2a|\ud83d\udd2b|\ud83d\udd2e|\ud83d\udd2f|\ud83d\udd30|\ud83d\udd31|\ud83d\udd32|\ud83d\udd33|\ud83d\udd34|\ud83d\udd35|\ud83d\udd36|\ud83d\udd37|\ud83d\udd38|\ud83d\udd39|\ud83d\udd3a|\ud83d\udd3b|\ud83d\udd3c|\ud83d\udd3d|\ud83d\udd50|\ud83d\udd51|\ud83d\udd52|\ud83d\udd53|\ud83d\udd54|\ud83d\udd55|\ud83d\udd56|\ud83d\udd57|\ud83d\udd58|\ud83d\udd59|\ud83d\udd5a|\ud83d\udd5b|\ud83d\uddfb|\ud83d\uddfc|\ud83d\uddfd|\ud83d\uddfe|\ud83d\uddff|\ud83d\ude01|\ud83d\ude02|\ud83d\ude03|\ud83d\ude04|\ud83d\ude05|\ud83d\ude06|\ud83d\ude09|\ud83d\ude0a|\ud83d\ude0b|\ud83d\ude0c|\ud83d\ude0d|\ud83d\ude0f|\ud83d\ude12|\ud83d\ude13|\ud83d\ude14|\ud83d\ude16|\ud83d\ude18|\ud83d\ude1a|\ud83d\ude1c|\ud83d\ude1d|\ud83d\ude1e|\ud83d\ude20|\ud83d\ude21|\ud83d\ude22|\ud83d\ude23|\ud83d\ude24|\ud83d\ude25|\ud83d\ude28|\ud83d\ude29|\ud83d\ude2a|\ud83d\ude2b|\ud83d\ude2d|\ud83d\ude30|\ud83d\ude31|\ud83d\ude32|\ud83d\ude33|\ud83d\ude35|\ud83d\ude37|\ud83d\ude38|\ud83d\ude39|\ud83d\ude3a|\ud83d\ude3b|\ud83d\ude3c|\ud83d\ude3d|\ud83d\ude3e|\ud83d\ude3f|\ud83d\ude40|\ud83d\ude45|\ud83d\ude46|\ud83d\ude47|\ud83d\ude48|\ud83d\ude49|\ud83d\ude4a|\ud83d\ude4b|\ud83d\ude4c|\ud83d\ude4d|\ud83d\ude4e|\ud83d\ude4f|\ud83d\ude80|\ud83d\ude83|\ud83d\ude84|\ud83d\ude85|\ud83d\ude87|\ud83d\ude89|\ud83d\ude8c|\ud83d\ude8f|\ud83d\ude91|\ud83d\ude92|\ud83d\ude93|\ud83d\ude95|\ud83d\ude97|\ud83d\ude99|\ud83d\ude9a|\ud83d\udea2|\ud83d\udea4|\ud83d\udea5|\ud83d\udea7|\ud83d\udea8|\ud83d\udea9|\ud83d\udeaa|\ud83d\udeab|\ud83d\udeac|\ud83d\udead|\ud83d\udeb2|\ud83d\udeb6|\ud83d\udeb9|\ud83d\udeba|\ud83d\udebb|\ud83d\udebc|\ud83d\udebd|\ud83d\udebe|\ud83d\udec0|\ud83c\udde6|\ud83c\udde7|\ud83c\udde8|\ud83c\udde9|\ud83c\uddea|\ud83c\uddeb|\ud83c\uddec|\ud83c\udded|\ud83c\uddee|\ud83c\uddef|\ud83c\uddf0|\ud83c\uddf1|\ud83c\uddf2|\ud83c\uddf3|\ud83c\uddf4|\ud83c\uddf5|\ud83c\uddf6|\ud83c\uddf7|\ud83c\uddf8|\ud83c\uddf9|\ud83c\uddfa|\ud83c\uddfb|\ud83c\uddfc|\ud83c\uddfd|\ud83c\uddfe|\ud83c\uddff|\ud83c\udf0d|\ud83c\udf0e|\ud83c\udf10|\ud83c\udf12|\ud83c\udf16|\ud83c\udf17|\ue50a|\u3030|\u27b0|\u2797|\u2796|\u2795|\u2755|\u2754|\u2753|\u274e|\u274c|\u2728|\u270b|\u270a|\u2705|\u26ce|\u23f3|\u23f0|\u23ec|\u23eb|\u23ea|\u23e9|\u2122|\u27bf|\u00a9|\u00ae)|(?:(?:\ud83c\udc04|\ud83c\udd7f|\ud83c\ude1a|\ud83c\ude2f|\u3299|\u303d|\u2b55|\u2b50|\u2b1c|\u2b1b|\u2b07|\u2b06|\u2b05|\u2935|\u2934|\u27a1|\u2764|\u2757|\u2747|\u2744|\u2734|\u2733|\u2716|\u2714|\u2712|\u270f|\u270c|\u2709|\u2708|\u2702|\u26fd|\u26fa|\u26f5|\u26f3|\u26f2|\u26ea|\u26d4|\u26c5|\u26c4|\u26be|\u26bd|\u26ab|\u26aa|\u26a1|\u26a0|\u2693|\u267f|\u267b|\u3297|\u2666|\u2665|\u2663|\u2660|\u2653|\u2652|\u2651|\u2650|\u264f|\u264e|\u264d|\u264c|\u264b|\u264a|\u2649|\u2648|\u263a|\u261d|\u2615|\u2614|\u2611|\u260e|\u2601|\u2600|\u25fe|\u25fd|\u25fc|\u25fb|\u25c0|\u25b6|\u25ab|\u25aa|\u24c2|\u231b|\u231a|\u21aa|\u21a9|\u2199|\u2198|\u2197|\u2196|\u2195|\u2194|\u2139|\u2049|\u203c|\u2668)([\uFE0E\uFE0F]?)))/g,m=/IFRAME|NOFRAMES|NOSCRIPT|SCRIPT|STYLE|TEXTAREA/,f=String.fromCharCode;

return h}();!function(){TD.emoji={theme:"",parse:function(e){return twemoji.parse(e,function(e,t,i){switch(e){case"a9":case"ae":case"2122":return!1}return TD.assets.get("emoji",{theme:TD.emoji.theme,icon:e})})}},$(document).one("dataSettingsValues",function(){TD.emoji.theme||(TD.emoji.theme=TD.settings.getTheme())}),$(document).on("dataSettings",function(e){var t=TD.settings.getTheme();TD.emoji.theme!==t&&($(".emoji").each(function(e,i){var n=i.src.match(/((?:[0-9a-f]{2}-)?[0-9a-f]{4,})\.png$/);i.src=TD.assets.get("emoji",{theme:t,icon:n[1]})}),TD.emoji.theme=t)})}(),function(e,t){"function"==typeof define&&define.amd?define([],t):e.TD.util.i18n=t()}(this,function(){var e,t={};return t.getMessage=function(e){if("undefined"==typeof TD_locale_messages)return void 0;var t=TD_locale_messages[e];return t&&t.message?t.message:void 0},t.getLocale=function(){return e?e:(TD.util.isChromeApp()&&(e=t.getMessage("@@ui_locale")),e)},t}),function(e,t){"function"==typeof define&&define.amd?define(["scripts/utils/i18n"],t):e.TD.i=t(TD.util.i18n)}(this,function(e){var t=/[^A-Za-z0-9_]/g,i={};return function(n,s,r){var a,o,c,l=TD.config.i18n_test_length_ratio||.2,u=TD.config.i18n_test_padding_char||"d";return"string"==typeof n&&(n={text:n}),"en_US"===e.getLocale()?o=n.text:(a=i[n.text],void 0===a&&(a=n.text.replace(t,""),i[n.text]=a),o=e.getMessage(a)||n.text),r||(o=TD.ui.template.toHtml(o,s)),TD.config.i18n_test&&(c=Math.round(o.length*l),o+=Array(c+1).join(u)),o}}),function(e,t){"function"==typeof define&&define.amd?define([],t):e.TD.assets=t()}(this,function(){"use strict";function e(e,t){return t=t||{},(e||"").replace(/\{\{([^{}]*?)\}\}/g,function(e,i){var n=t[i];return"string"==typeof n||"number"==typeof n?n:e})}var t={emoji:"/web/assets/emoji/{{theme}}/{{icon}}.png",td_screenshot:"/web/assets/global/backgrounds/td_screenshot@{{resolution}}.png",templates:"/web/templates/{{name}}.html",unbundled:"/web/scripts/unbundled/{{name}}.js",logos:"/web/assets/logos/{{name}}.png",html:"/web/{{name}}.html"};return{get:function(i,n){var s=t[i]?e(t[i],n):i;return(TD.assetsOverlay||{})[s]||s||i}}}),TD.constants={keyCodes:{enter:13,shift:16,escape:27,tab:9,del:8,spacebar:32,upArrow:38,downArrow:40,leftArrow:37,rightArrow:39},charCodes:{space:32,questionMark:63},regexps:{name:/\S+/,username:/^[@＠]?([a-zA-Z0-9_]{1,15})$/,usernameWithAt:/^[@＠]{1}([a-zA-Z0-9_]{1,15}) /,usernameWithSpace:/^[@＠]{1}(\w{1,15})\s*$/,email:/^[\w-]+([^@,\s\<\>\(\)]*[\w-]+)?\@[\w-]+(\.[\w-]+)*\.[a-z]{2,}$/i,tokenSeparator:/[\s-_]+/},time:{oneDay:864e5,oneHour:36e5},TDApi:{ERROR_ACCOUNT_DOESNT_EXIST:"Account does not exist.",ERROR_BAD_PASSWORD:"BadPassword",ERROR_SESSION_EXPIRED:"SessionExpired",ERROR_RATE_LIMIT_EXCEEDED:"RateLimitExceeded"}},TD.languages={_index:null,_initialiseIndex:function(){var e=TD.languages.getAllLanguages();TD.languages._index={},e.forEach(function(e){TD.languages._index[e.code]=e,e.actual_code&&(TD.languages._index[e.actual_code]=e)})},getLanguageFromISOCode:function(e){TD.languages._index||TD.languages._initialiseIndex();var t=TD.languages._index[e];return _.clone(t)},getSystemLanguageCode:function(e){var t=navigator.language||navigator.userLanguage||"";return e&&(t=t.replace(/-[a-z]+$/i,"")),t},isSupportedTranslationSourceLanguage:function(e){var t=TD.languages.getSupportedTranslationSourceLanguages();return-1!==t.indexOf(e.toLowerCase())},isSystemLangSupportedDestinationLanguage:function(){var e=TD.languages.getSupportedTranslationDestinationLanguages();return-1!==e.indexOf(TD.languages.getSystemLanguageCode(!0).toLowerCase())||-1!==e.indexOf(TD.languages.getSystemLanguageCode(!1).toLowerCase())},getSupportedDestinationSystemLanguage:function(){var e=TD.languages.getSupportedTranslationDestinationLanguages();return TD.languages.getSystemLanguageCode(-1!==e.indexOf(TD.languages.getSystemLanguageCode(!0).toLowerCase())?!0:!1)},getAllLanguages:function(){return[{code:"am",localized_name:TD.i("Amharic"),name:"አማርኛ"},{code:"ar",localized_name:TD.i("Arabic"),name:"العربية"},{code:"bg",localized_name:TD.i("Bulgarian"),name:"Български"},{code:"bn",localized_name:TD.i("Bengali"),name:"বাংলা"},{code:"bo",localized_name:TD.i("Tibetan"),name:"བོད་སྐད"},{code:"ca",localized_name:TD.i("Catalan"),name:"Català"},{code:"chr",localized_name:TD.i("Cherokee"),name:"ᏣᎳᎩ"},{code:"cs",localized_name:TD.i("Czech"),name:"čeština"},{code:"da",localized_name:TD.i("Danish"),name:"Dansk"},{code:"de",localized_name:TD.i("German"),name:"Deutsch"},{code:"dv",localized_name:TD.i("Maldivian"),name:"ދިވެހި"},{code:"el",localized_name:TD.i("Greek"),name:"Ελληνικά"},{code:"en",localized_name:TD.i("English"),name:"English"},{code:"es",localized_name:TD.i("Spanish"),name:"Español"},{code:"et",localized_name:TD.i("Estonian"),name:"eesti"},{code:"fa",localized_name:TD.i("Persian"),name:"فارسی"},{code:"fi",localized_name:TD.i("Finnish"),name:"Suomi"},{code:"fr",localized_name:TD.i("French"),name:"Français"},{code:"gu",localized_name:TD.i("Gujarati"),name:"ગુજરાતી"},{code:"iw",actual_code:"he",localized_name:TD.i("Hebrew"),name:"עברית"},{code:"hi",localized_name:TD.i("Hindi"),name:"हिंदी"},{code:"ht",localized_name:TD.i("Haitian Creole"),name:"Kreyòl ayisyen"},{code:"hu",localized_name:TD.i("Hungarian"),name:"Magyar"},{code:"hy",localized_name:TD.i("Armenian"),name:"Հայերեն"},{code:"in",actual_code:"id",localized_name:TD.i("Indonesian"),name:"Bahasa Indonesia"},{code:"is",localized_name:TD.i("Icelandic"),name:"Íslenska"},{code:"it",localized_name:TD.i("Italian"),name:"Italiano"},{code:"iu",localized_name:TD.i("Inuktitut"),name:"ᐃᓄᒃᑎᑐᑦ"},{code:"ja",localized_name:TD.i("Japanese"),name:"日本語"},{code:"ka",localized_name:TD.i("Georgian"),name:"ქართული"},{code:"km",localized_name:TD.i("Khmer"),name:"ខ្មែរ"},{code:"kn",localized_name:TD.i("Kannada"),name:"ಕನ್ನಡ"},{code:"ko",localized_name:TD.i("Korean"),name:"한국어"},{code:"lo",localized_name:TD.i("Lao"),name:"ລາວ"},{code:"lt",localized_name:TD.i("Lithuanian"),name:"Lietuvių"},{code:"lv",localized_name:TD.i("Latvian"),name:"latviešu valoda"},{code:"ml",localized_name:TD.i("Malayalam"),name:"മലയാളം"},{code:"my",localized_name:TD.i("Myanmar"),name:"မြန်မာဘာသာ"},{code:"ne",localized_name:TD.i("Nepali"),name:"नेपाली"},{code:"nl",localized_name:TD.i("Dutch"),name:"Nederlands"},{code:"no",localized_name:TD.i("Norwegian"),name:"Norsk"},{code:"or",localized_name:TD.i("Oriya"),name:"ଓଡ଼ିଆ"},{code:"pa",localized_name:TD.i("Panjabi"),name:"ਪੰਜਾਬੀ"},{code:"pl",localized_name:TD.i("Polish"),name:"Polski"},{code:"pt",localized_name:TD.i("Portuguese"),name:"Português"},{code:"ro",localized_name:TD.i("Romanian"),name:"limba română"},{code:"ru",localized_name:TD.i("Russian"),name:"Русский"},{code:"si",localized_name:TD.i("Sinhala"),name:"සිංහල"},{code:"sk",localized_name:TD.i("Slovak"),name:"slovenčina"},{code:"sl",localized_name:TD.i("Slovene"),name:"slovenski jezik"},{code:"sv",localized_name:TD.i("Swedish"),name:"Svenska"},{code:"ta",localized_name:TD.i("Tamil"),name:"தமிழ்"},{code:"te",localized_name:TD.i("Telugu"),name:"తెలుగు"},{code:"th",localized_name:TD.i("Thai"),name:"ไทย"},{code:"tl",localized_name:TD.i("Tagalog"),name:"Tagalog"},{code:"tr",localized_name:TD.i("Turkish"),name:"Türkçe"},{code:"uk",localized_name:TD.i("Ukrainian"),name:"українська мова"},{code:"ur",localized_name:TD.i("Urdu"),name:"ﺍﺭﺩﻭ"},{code:"vi",localized_name:TD.i("Vietnamese"),name:"Tiếng Việt"},{code:"zh",localized_name:TD.i("Chinese"),name:"中文"}]},getSupportedTranslationSourceLanguages:function(){return["bg","ca","zh","cs","da","nl","en","et","fi","fr","de","el","ht","hi","hu","id","in","it","ja","ko","lv","lt","no","pl","pt","ro","ru","sk","sl","es","sv","th","tr","uk","vi","ar","fa","he"]},getSupportedTranslationDestinationLanguages:function(){return["bg","ca","zh-cn","zh-tw","cs","da","nl","en","et","fi","fr","de","el","ht","hi","hu","id","in","it","ja","ko","lv","lt","no","pl","pt","ro","ru","sk","sl","es","sv","th","tr","uk","vi","ar","fa","he"]}},TD.services.bitly=function(){var e={},t="tweetdeckapi",i="R_b8032856b71a14fabfe64f6845689ddf",n=function(e,n){var s,r="https://api-ssl.bitly.com/v3/"+e;n.login=t,n.apiKey=i,n.format="json";var a=TD.storage.accountController.getAccountsForService("bitly");if(a.length>0){var o=a[0];n.x_login=o.getUserID(),n.x_apiKey=o.getOAuthToken()}return s=TD.net.ajax.jsonp(r,n)};return e.shorten=function(e){var t,i=e;return _.startsWith(e,"http://")||_.startsWith(e,"https://")||(i="http://"+e),t=n("shorten",{longUrl:i}),t.addCallback(function(t){var i=t.data;if(!i||!i.data||!i.data.url)throw"Bit.ly shortening failed";return i.data&&(i.data.long_url=e),i.data}),t},e.shortenTextLinks=function(e){var t=twttr.txt.extractUrls(e),i=t.map(function(e){return TD.util.isLinkToTwitterItem(e)?TD.core.defer.succeed(e):TD.services.bitly.shorten(e)}),n=new TD.core.defer.DeferredList(i);return n.addCallback(function(t){return t.forEach(function(t){var i=t[0],n=t[1];i&&(e=e.replace(n.long_url,n.url))}),e}),n},e}(),!function(e,t){"function"==typeof define?define(t):"undefined"!=typeof module?module.exports=t():this[e]=t()}("klass",function(){function e(e){return s.call(t(e)?e:function(){},e,1)}function t(e){return typeof e===o}function i(e,t,i){return function(){var n=this.supr;this.supr=i[l][e];var s=t.apply(this,arguments);return this.supr=n,s}}function n(e,n,s){for(var r in n)n.hasOwnProperty(r)&&(e[r]=t(n[r])&&t(s[l][r])&&c.test(n[r])?i(r,n[r],s):n[r])}function s(e,i){function s(){}function r(){this.initialize?this.initialize.apply(this,arguments):(i||c&&a.apply(this,arguments),u.apply(this,arguments))}s[l]=this[l];var a=this,o=new s,c=t(e),u=c?e:this,d=c?{}:e;return r.methods=function(e){return n(o,e,a),r[l]=o,this},r.methods.call(r,d).prototype.constructor=r,r.extend=arguments.callee,r[l].implement=r.statics=function(e,t){return e="string"==typeof e?function(){var i={};return i[e]=t,i}():e,n(this,e,a),this},r.mixin=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];void 0===t?console.warn("you have an undefined mixin coming from "+ns):t.call(this,this)}return this},r}var r=this,a=r.klass,o="function",c=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,l="prototype";return e.noConflict=function(){return r.klass=a,this},r.klass=e,e}),klass.mixin=function(e,t){if(_.isString(e)){for(var i=window,n=e.split("."),s=0,r=n.length;r>s;++s)i=i[n[s]]=i[n[s]]||(_.isUndefined(n[s+1])?t:{});return i}_.extend(e,t)},klass.mixin("TD.mixins.caretHelper",function(){return this.statics({spaceBoundary:/\s|$/,wordEnd:/[^+\/.<>()|\\=\s]+$/}).methods({init:function(){this.$input.bind("blur",_.bind(function(e){setTimeout(_.bind(function(){this.hide()},this),1e3)},this)).bind("mouseup",_.bind(function(e){setTimeout(_.bind(function(){this.getCaret()},this),0)},this)).bind("focus",_.bind(function(e){this.getCaret()},this))},getCurrentText:function(){return this.$input.val()},setCaretPosition:function(e){var t=this.$input[0];if(t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",e),i.moveStart("character",e),i.select()}this.lastCaret=e},getCaret:function(){var e=this.$input[0],t=0;if(document.selection){try{e.focus()}catch(i){}var n=document.selection.createRange();if(null==n)return this.lastCaret=0,0;var s=e.createTextRange(),r=s.duplicate();s.moveToBookmark(n.getBookmark()),r.setEndPoint("EndToStart",s),t=r.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return this.lastCaret=t,t},insertOrReplaceSelection:function(e,t){var i=this.$input[0],n=this.getCaret(),s=n+e.length;if(document.selection){i.focus();var r=document.selection.createRange();if(r.text=e,t){var a=i.createTextRange();a.collapse(!0),a.moveEnd("character",s),a.moveStart("character",n),a.select()}else this.setCaretPosition(s)}else if(i.selectionStart||"0"==i.selectionStart){var o=i.selectionStart,c=i.selectionEnd,l=i.scrollTop;i.value=i.value.substring(0,o)+e+i.value.substring(c,i.value.length),i.focus(),i.selectionStart=t?n:s,i.selectionEnd=s,i.scrollTop=l}else i.value+=e,this.setCaretPosition(s),i.focus();this.lastCaret=s,this.$input.change()},getCurrentWord:function(e){var t=this.getCurrentText(),i=t.slice(0,e),n=t.slice(e,t.length),s=t.charAt(e-1);if(!s||" "===s)return"";this.leftBoundary=i.search(this.constructor.wordEnd);var r=i.slice(this.leftBoundary,i.length),a=n.slice(0,n.search(this.constructor.spaceBoundary)),o=r.concat(a);return this.rightBoundary=this.leftBoundary+o.length,o},replaceCurrentWord:function(e){var t=this.getCurrentText().split("");this.oldValueArray=t;var i=t.slice(0,this.leftBoundary),n=t.slice(this.rightBoundary,t.length);(n.length<1||!n[0].match(/\s/))&&(e+=" ");var s=(i.join("")+e).length+1;return{value:i.join("")+e+n.join(""),cursor:s}}}),this}),function(){function e(e,t){return t=t||"","string"!=typeof e&&(e.global&&t.indexOf("g")<0&&(t+="g"),e.ignoreCase&&t.indexOf("i")<0&&(t+="i"),e.multiline&&t.indexOf("m")<0&&(t+="m"),e=e.source),new RegExp(e.replace(/#\{(\w+)\}/g,function(e,t){var i=r.txt.regexen[t]||"";return"string"!=typeof i&&(i=i.source),i}),t)}function t(e,t){return e.replace(/#\{(\w+)\}/g,function(e,i){return t[i]||""})}function i(e,t,i){var n=String.fromCharCode(t);return i!==t&&(n+="-"+String.fromCharCode(i)),e.push(n),e}function n(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function s(e,t,i){return i?!e||e.match(t)&&RegExp["$&"]===e:"string"==typeof e&&e.match(t)&&RegExp["$&"]===e}if("undefined"==typeof r||null===r)var r={};r.txt={},r.txt.regexen={};var a={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};r.txt.htmlEscape=function(e){return e&&e.replace(/[&"'><]/g,function(e){return a[e]})},r.txt.regexSupplant=e,r.txt.stringSupplant=t,r.txt.addCharsToCharClass=i;var o=String.fromCharCode,c=[o(32),o(133),o(160),o(5760),o(6158),o(8232),o(8233),o(8239),o(8287),o(12288)];i(c,9,13),i(c,8192,8202);var l=[o(65534),o(65279),o(65535)];i(l,8234,8238),r.txt.regexen.spaces_group=e(c.join("")),r.txt.regexen.spaces=e("["+c.join("")+"]"),r.txt.regexen.invalid_chars_group=e(l.join("")),r.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,r.txt.regexen.rtl_chars=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/gm,r.txt.regexen.non_bmp_code_pairs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/gm;var u=[];i(u,1024,1279),i(u,1280,1319),i(u,11744,11775),i(u,42560,42655),i(u,1425,1471),i(u,1473,1474),i(u,1476,1477),i(u,1479,1479),i(u,1488,1514),i(u,1520,1524),i(u,64274,64296),i(u,64298,64310),i(u,64312,64316),i(u,64318,64318),i(u,64320,64321),i(u,64323,64324),i(u,64326,64335),i(u,1552,1562),i(u,1568,1631),i(u,1646,1747),i(u,1749,1756),i(u,1758,1768),i(u,1770,1775),i(u,1786,1788),i(u,1791,1791),i(u,1872,1919),i(u,2208,2208),i(u,2210,2220),i(u,2276,2302),i(u,64336,64433),i(u,64467,64829),i(u,64848,64911),i(u,64914,64967),i(u,65008,65019),i(u,65136,65140),i(u,65142,65276),i(u,8204,8204),i(u,3585,3642),i(u,3648,3662),i(u,4352,4607),i(u,12592,12677),i(u,43360,43391),i(u,44032,55215),i(u,55216,55295),i(u,65441,65500),i(u,12449,12538),i(u,12540,12542),i(u,65382,65439),i(u,65392,65392),i(u,65296,65305),i(u,65313,65338),i(u,65345,65370),i(u,12353,12438),i(u,12441,12446),i(u,13312,19903),i(u,19968,40959),i(u,173824,177983),i(u,177984,178207),i(u,194560,195103),i(u,12291,12291),i(u,12293,12293),i(u,12347,12347),r.txt.regexen.nonLatinHashtagChars=e(u.join(""));var d=[];i(d,192,214),i(d,216,246),i(d,248,255),i(d,256,591),i(d,595,596),i(d,598,599),i(d,601,601),i(d,603,603),i(d,611,611),i(d,616,616),i(d,623,623),i(d,626,626),i(d,649,649),i(d,651,651),i(d,699,699),i(d,768,879),i(d,7680,7935),r.txt.regexen.latinAccentChars=e(d.join("")),r.txt.regexen.hashSigns=/[#＃]/,r.txt.regexen.hashtagAlpha=e(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i),r.txt.regexen.hashtagAlphaNumeric=e(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i),r.txt.regexen.endHashtagMatch=e(/^(?:#{hashSigns}|:\/\/)/),r.txt.regexen.hashtagBoundary=e(/(?:^|$|[^&a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/),r.txt.regexen.validHashtag=e(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),r.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@＠]|(?:rt|RT|rT|Rt):?)/,r.txt.regexen.atSigns=/[@＠]/,r.txt.regexen.validMentionOrList=e("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?","g"),r.txt.regexen.validReply=e(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),r.txt.regexen.endMentionMatch=e(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),r.txt.regexen.validUrlPrecedingChars=e(/(?:[^A-Za-z0-9@＠$#＃#{invalid_chars_group}]|^)/),r.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/,r.txt.regexen.invalidDomainChars=t("#{punct}#{spaces_group}#{invalid_chars_group}",r.txt.regexen),r.txt.regexen.validDomainChars=e(/[^#{invalidDomainChars}]/),r.txt.regexen.validSubdomain=e(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),r.txt.regexen.validDomainName=e(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),r.txt.regexen.validGTLD=e(RegExp("(?:(?:abogado|academy|accountants|active|actor|aero|agency|airforce|allfinanz|alsace|archi|army|arpa|asia|associates|attorney|auction|audio|autos|axa|band|bar|bargains|bayern|beer|berlin|best|bid|bike|bio|biz|black|blackfriday|blue|bmw|bnpparibas|boo|boutique|brussels|budapest|build|builders|business|buzz|bzh|cab|cal|camera|camp|cancerresearch|capetown|capital|caravan|cards|care|career|careers|casa|cash|cat|catering|center|ceo|cern|channel|cheap|christmas|chrome|church|citic|city|claims|cleaning|click|clinic|clothing|club|codes|coffee|college|cologne|com|community|company|computer|condos|construction|consulting|contractors|cooking|cool|coop|country|credit|creditcard|crs|cruises|cuisinella|cymru|dad|dance|dating|day|deals|degree|democrat|dental|dentist|desi|diamonds|diet|digital|direct|directory|discount|dnp|domains|durban|dvag|eat|edu|education|email|emerck|engineer|engineering|enterprises|equipment|esq|estate|eus|events|exchange|expert|exposed|fail|farm|feedback|finance|financial|fish|fishing|fitness|flights|florist|flsmidth|fly|foo|forsale|foundation|frl|frogans|fund|furniture|futbol|gal|gallery|gbiz|gent|gift|gifts|gives|glass|gle|global|globo|gmail|gmo|gmx|google|gop|gov|graphics|gratis|green|gripe|guide|guitars|guru|hamburg|haus|healthcare|help|here|hiphop|hiv|holdings|holiday|homes|horse|host|hosting|house|how|ibm|immo|immobilien|industries|info|ing|ink|institute|insure|int|international|investments|jetzt|jobs|joburg|juegos|kaufen|kim|kitchen|kiwi|koeln|krd|kred|lacaixa|land|lawyer|lease|lgbt|life|lighting|limited|limo|link|loans|london|lotto|ltda|luxe|luxury|maison|management|mango|market|marketing|media|meet|melbourne|meme|menu|miami|mil|mini|mobi|moda|moe|monash|mortgage|moscow|motorcycles|mov|museum|nagoya|name|navy|net|network|neustar|new|nexus|ngo|nhk|ninja|nra|nrw|nyc|okinawa|ong|onl|ooo|org|organic|otsuka|ovh|paris|partners|parts|pharmacy|photo|photography|photos|physio|pics|pictures|pink|pizza|place|plumbing|pohl|poker|post|praxi|press|pro|prod|productions|prof|properties|property|pub|qpon|quebec|realtor|recipes|red|rehab|reise|reisen|ren|rentals|repair|report|republican|rest|restaurant|reviews|rich|rio|rip|rocks|rodeo|rsvp|ruhr|ryukyu|saarland|sarl|sca|scb|schmidt|schule|scot|services|sexy|shiksha|shoes|singles|social|software|sohu|solar|solutions|soy|space|spiegel|supplies|supply|support|surf|surgery|suzuki|systems|taipei|tatar|tattoo|tax|technology|tel|tienda|tips|tirol|today|tokyo|tools|top|town|toys|trade|training|travel|tui|university|uno|uol|vacations|vegas|ventures|vermögensberater|vermögensberatung|versicherung|vet|viajes|villas|vision|vlaanderen|vodka|vote|voting|voto|voyage|wales|wang|watch|webcam|website|wed|wedding|whoswho|wien|wiki|williamhill|wme|work|works|world|wtc|wtf|xxx|xyz|yachts|yandex|yoga|yokohama|youtube|zip|zone|дети|москва|онлайн|орг|рус|сайт|بازار|شبكة|موقع|संगठन|みんな|世界|中信|中文网|企业|佛山|公司|公益|商城|商标|在线|广东|我爱你|手机|政务|机构|游戏|移动|组织机构|网址|网络|集团|삼성)(?=[^0-9a-zA-Z@]|$))")),r.txt.regexen.validCCTLD=e(RegExp("(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bl|bm|bn|bo|bq|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|бел|мкд|мон|рф|срб|укр|қаз|الاردن|الجزائر|السعودية|المغرب|امارات|ایران|بھارت|تونس|سودان|سورية|عراق|عمان|فلسطين|قطر|مصر|مليسيا|پاکستان|भारत|বাংলা|ভারত|ਭਾਰਤ|ભારત|இந்தியா|இலங்கை|சிங்கப்பூர்|భారత్|ලංකා|ไทย|გე|中国|中國|台湾|台灣|新加坡|香港|한국)(?=[^0-9a-zA-Z@]|$))")),r.txt.regexen.validPunycode=e(/(?:xn--[0-9a-z]+)/),r.txt.regexen.validSpecialCCTLD=e(RegExp("(?:(?:co|tv)(?=[^0-9a-zA-Z@]|$))")),r.txt.regexen.validDomain=e(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),r.txt.regexen.validAsciiDomain=e(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),r.txt.regexen.invalidShortDomain=e(/^#{validDomainName}#{validCCTLD}$/i),r.txt.regexen.validSpecialShortDomain=e(/^#{validDomainName}#{validSpecialCCTLD}$/i),r.txt.regexen.validPortNumber=e(/[0-9]+/),r.txt.regexen.validGeneralUrlPathChars=e(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~@|&#{latinAccentChars}]/i),r.txt.regexen.validUrlBalancedParens=e("\\((?:#{validGeneralUrlPathChars}+|(?:#{validGeneralUrlPathChars}*\\(#{validGeneralUrlPathChars}+\\)#{validGeneralUrlPathChars}*))\\)","i"),r.txt.regexen.validUrlPathEndingChars=e(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),r.txt.regexen.validUrlPath=e("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),r.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,r.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,r.txt.regexen.extractUrl=e("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),r.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,r.txt.regexen.urlHasProtocol=/^https?:\/\//i,r.txt.regexen.urlHasHttps=/^https:\/\//i,r.txt.regexen.cashtag=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i,r.txt.regexen.validCashtag=e("(^|#{spaces})(\\$)(#{cashtag})(?=$|\\s|[#{punct}])","gi"),r.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i,r.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,r.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,r.txt.regexen.validateUrlPchar=e("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),r.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,r.txt.regexen.validateUrlUserinfo=e("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),r.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,r.txt.regexen.validateUrlIpv4=e(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),r.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,r.txt.regexen.validateUrlIp=e("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),r.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,r.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,r.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,r.txt.regexen.validateUrlDomain=e(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i),r.txt.regexen.validateUrlHost=e("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),r.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,r.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,r.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,r.txt.regexen.validateUrlUnicodeDomain=e(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),r.txt.regexen.validateUrlUnicodeHost=e("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),r.txt.regexen.validateUrlPort=/[0-9]{1,5}/,r.txt.regexen.validateUrlUnicodeAuthority=e("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),r.txt.regexen.validateUrlAuthority=e("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),r.txt.regexen.validateUrlPath=e(/(\/#{validateUrlPchar}*)*/i),r.txt.regexen.validateUrlQuery=e(/(#{validateUrlPchar}|\/|\?)*/i),r.txt.regexen.validateUrlFragment=e(/(#{validateUrlPchar}|\/|\?)*/i),r.txt.regexen.validateUrlUnencoded=e("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var h="tweet-url list-slug",p="tweet-url username",m="tweet-url hashtag",f="tweet-url cashtag",g={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},v={disabled:!0,readonly:!0,multiple:!0,checked:!0};r.txt.tagAttrs=function(e){var t="";for(var i in e){var n=e[i];v[i]&&(n=n?i:null),null!=n&&(t+=" "+r.txt.htmlEscape(i)+'="'+r.txt.htmlEscape(n.toString())+'"')}return t},r.txt.linkToText=function(e,i,n,s){s.suppressNoFollow||(n.rel="nofollow"),s.linkAttributeBlock&&s.linkAttributeBlock(e,n),s.linkTextBlock&&(i=s.linkTextBlock(e,i));var a={text:i,attr:r.txt.tagAttrs(n)};return t("<a#{attr}>#{text}</a>",a)},r.txt.linkToTextWithSymbol=function(e,t,i,n,s){var a=s.symbolTag?"<"+s.symbolTag+">"+t+"</"+s.symbolTag+">":t;i=r.txt.htmlEscape(i);var o=s.textWithSymbolTag?"<"+s.textWithSymbolTag+">"+i+"</"+s.textWithSymbolTag+">":i;return s.usernameIncludeSymbol||!t.match(r.txt.regexen.atSigns)?r.txt.linkToText(e,a+o,n,s):a+r.txt.linkToText(e,o,n,s)},r.txt.linkToHashtag=function(e,t,i){var s=t.substring(e.indices[0],e.indices[0]+1),a=r.txt.htmlEscape(e.hashtag),o=n(i.htmlAttrs||{});return o.href=i.hashtagUrlBase+a,o.title="#"+a,o["class"]=i.hashtagClass,a.charAt(0).match(r.txt.regexen.rtl_chars)&&(o["class"]+=" rtl"),i.targetBlank&&(o.target="_blank"),r.txt.linkToTextWithSymbol(e,s,a,o,i)},r.txt.linkToCashtag=function(e,t,i){var s=r.txt.htmlEscape(e.cashtag),a=n(i.htmlAttrs||{});return a.href=i.cashtagUrlBase+s,a.title="$"+s,a["class"]=i.cashtagClass,i.targetBlank&&(a.target="_blank"),r.txt.linkToTextWithSymbol(e,"$",s,a,i)},r.txt.linkToMentionAndList=function(e,t,i){var s=t.substring(e.indices[0],e.indices[0]+1),a=r.txt.htmlEscape(e.screenName),o=r.txt.htmlEscape(e.listSlug),c=e.listSlug&&!i.suppressLists,l=n(i.htmlAttrs||{});return l["class"]=c?i.listClass:i.usernameClass,l.href=c?i.listUrlBase+a+o:i.usernameUrlBase+a,c||i.suppressDataScreenName||(l["data-screen-name"]=a),i.targetBlank&&(l.target="_blank"),r.txt.linkToTextWithSymbol(e,s,c?a+o:a,l,i)},r.txt.linkToUrl=function(e,t,i){var s=e.url,a=s,o=r.txt.htmlEscape(a),c=i.urlEntities&&i.urlEntities[s]||e;c.display_url&&(o=r.txt.linkTextWithEntity(c,i));var l=n(i.htmlAttrs||{});return s.match(r.txt.regexen.urlHasProtocol)||(s="http://"+s),l.href=s,i.targetBlank&&(l.target="_blank"),i.urlClass&&(l["class"]=i.urlClass),i.urlTarget&&(l.target=i.urlTarget),!i.title&&c.display_url&&(l.title=c.expanded_url),r.txt.linkToText(e,o,l,i)},r.txt.linkTextWithEntity=function(e,i){var n=e.display_url,s=e.expanded_url,a=n.replace(/…/g,"");if(-1!=s.indexOf(a)){var o=s.indexOf(a),c={displayUrlSansEllipses:a,beforeDisplayUrl:s.substr(0,o),afterDisplayUrl:s.substr(o+a.length),precedingEllipsis:n.match(/^…/)?"…":"",followingEllipsis:n.match(/…$/)?"…":""};for(var l in c)c.hasOwnProperty(l)&&(c[l]=r.txt.htmlEscape(c[l]));return c.invisible=i.invisibleTagAttrs,t("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",c)}return n},r.txt.autoLinkEntities=function(e,t,i){i=n(i||{}),i.hashtagClass=i.hashtagClass||m,i.hashtagUrlBase=i.hashtagUrlBase||"https://twitter.com/#!/search?q=%23",i.cashtagClass=i.cashtagClass||f,i.cashtagUrlBase=i.cashtagUrlBase||"https://twitter.com/#!/search?q=%24",i.listClass=i.listClass||h,i.usernameClass=i.usernameClass||p,i.usernameUrlBase=i.usernameUrlBase||"https://twitter.com/",i.listUrlBase=i.listUrlBase||"https://twitter.com/",i.htmlAttrs=r.txt.extractHtmlAttrsFromOptions(i),i.invisibleTagAttrs=i.invisibleTagAttrs||"style='position:absolute;left:-9999px;'";var s,a,o;if(i.urlEntities){for(s={},a=0,o=i.urlEntities.length;o>a;a++)s[i.urlEntities[a].url]=i.urlEntities[a];i.urlEntities=s}var c="",l=0;t.sort(function(e,t){return e.indices[0]-t.indices[0]});for(var u=i.htmlEscapeNonEntities?r.txt.htmlEscape:function(e){return e},a=0;a<t.length;a++){var d=t[a];c+=u(e.substring(l,d.indices[0])),d.url?c+=r.txt.linkToUrl(d,e,i):d.hashtag?c+=r.txt.linkToHashtag(d,e,i):d.screenName?c+=r.txt.linkToMentionAndList(d,e,i):d.cashtag&&(c+=r.txt.linkToCashtag(d,e,i)),l=d.indices[1]}return c+=u(e.substring(l,e.length))},r.txt.autoLinkWithJSON=function(e,t,i){if(t.user_mentions)for(var n=0;n<t.user_mentions.length;n++)t.user_mentions[n].screenName=t.user_mentions[n].screen_name;if(t.hashtags)for(var n=0;n<t.hashtags.length;n++)t.hashtags[n].hashtag=t.hashtags[n].text;if(t.symbols)for(var n=0;n<t.symbols.length;n++)t.symbols[n].cashtag=t.symbols[n].text;var s=[];for(var a in t)s=s.concat(t[a]);return r.txt.modifyIndicesFromUnicodeToUTF16(e,s),r.txt.autoLinkEntities(e,s,i)},r.txt.extractHtmlAttrsFromOptions=function(e){var t={};for(var i in e){var n=e[i];g[i]||(v[i]&&(n=n?i:null),null!=n&&(t[i]=n))}return t},r.txt.autoLink=function(e,t){var i=r.txt.extractEntitiesWithIndices(e,{extractUrlsWithoutProtocol:!1});return r.txt.autoLinkEntities(e,i,t)},r.txt.autoLinkUsernamesOrLists=function(e,t){var i=r.txt.extractMentionsOrListsWithIndices(e);return r.txt.autoLinkEntities(e,i,t)},r.txt.autoLinkHashtags=function(e,t){var i=r.txt.extractHashtagsWithIndices(e);return r.txt.autoLinkEntities(e,i,t)},r.txt.autoLinkCashtags=function(e,t){var i=r.txt.extractCashtagsWithIndices(e);return r.txt.autoLinkEntities(e,i,t)},r.txt.autoLinkUrlsCustom=function(e,t){var i=r.txt.extractUrlsWithIndices(e,{extractUrlsWithoutProtocol:!1});return r.txt.autoLinkEntities(e,i,t)},r.txt.removeOverlappingEntities=function(e){e.sort(function(e,t){return e.indices[0]-t.indices[0]});for(var t=e[0],i=1;i<e.length;i++)t.indices[1]>e[i].indices[0]?(e.splice(i,1),i--):t=e[i]},r.txt.extractEntitiesWithIndices=function(e,t){var i=r.txt.extractUrlsWithIndices(e,t).concat(r.txt.extractMentionsOrListsWithIndices(e)).concat(r.txt.extractHashtagsWithIndices(e,{checkUrlOverlap:!1})).concat(r.txt.extractCashtagsWithIndices(e));return 0==i.length?[]:(r.txt.removeOverlappingEntities(i),i)},r.txt.extractMentions=function(e){for(var t=[],i=r.txt.extractMentionsWithIndices(e),n=0;n<i.length;n++){
var s=i[n].screenName;t.push(s)}return t},r.txt.extractMentionsWithIndices=function(e){for(var t,i=[],n=r.txt.extractMentionsOrListsWithIndices(e),s=0;s<n.length;s++)t=n[s],""==t.listSlug&&i.push({screenName:t.screenName,indices:t.indices});return i},r.txt.extractMentionsOrListsWithIndices=function(e){if(!e||!e.match(r.txt.regexen.atSigns))return[];var t=[];return e.replace(r.txt.regexen.validMentionOrList,function(e,i,n,s,a,o,c){var l=c.slice(o+e.length);if(!l.match(r.txt.regexen.endMentionMatch)){a=a||"";var u=o+i.length,d=u+s.length+a.length+1;t.push({screenName:s,listSlug:a,indices:[u,d]})}}),t},r.txt.extractReplies=function(e){if(!e)return null;var t=e.match(r.txt.regexen.validReply);return!t||RegExp.rightContext.match(r.txt.regexen.endMentionMatch)?null:t[1]},r.txt.extractUrls=function(e,t){for(var i=[],n=r.txt.extractUrlsWithIndices(e,t),s=0;s<n.length;s++)i.push(n[s].url);return i},r.txt.extractUrlsWithIndices=function(e,t){if(t||(t={extractUrlsWithoutProtocol:!0}),!e||(t.extractUrlsWithoutProtocol?!e.match(/\./):!e.match(/:/)))return[];for(var i=[];r.txt.regexen.extractUrl.exec(e);){var n=RegExp.$2,s=RegExp.$3,a=RegExp.$4,o=RegExp.$5,c=RegExp.$7,l=r.txt.regexen.extractUrl.lastIndex,u=l-s.length;if(a)s.match(r.txt.regexen.validTcoUrl)&&(s=RegExp.lastMatch,l=u+s.length),i.push({url:s,indices:[u,l]});else{if(!t.extractUrlsWithoutProtocol||n.match(r.txt.regexen.invalidUrlWithoutProtocolPrecedingChars))continue;var d=null,h=0;if(o.replace(r.txt.regexen.validAsciiDomain,function(e){var t=o.indexOf(e,h);h=t+e.length,d={url:e,indices:[u+t,u+h]},(c||e.match(r.txt.regexen.validSpecialShortDomain)||!e.match(r.txt.regexen.invalidShortDomain))&&i.push(d)}),null==d)continue;c&&(d.url=s.replace(o,d.url),d.indices[1]=l)}}return i},r.txt.extractHashtags=function(e){for(var t=[],i=r.txt.extractHashtagsWithIndices(e),n=0;n<i.length;n++)t.push(i[n].hashtag);return t},r.txt.extractHashtagsWithIndices=function(e,t){if(t||(t={checkUrlOverlap:!0}),!e||!e.match(r.txt.regexen.hashSigns))return[];var i=[];if(e.replace(r.txt.regexen.validHashtag,function(e,t,n,s,a,o){var c=o.slice(a+e.length);if(!c.match(r.txt.regexen.endHashtagMatch)){var l=a+t.length,u=l+s.length+1;i.push({hashtag:s,indices:[l,u]})}}),t.checkUrlOverlap){var n=r.txt.extractUrlsWithIndices(e);if(n.length>0){var s=i.concat(n);r.txt.removeOverlappingEntities(s),i=[];for(var a=0;a<s.length;a++)s[a].hashtag&&i.push(s[a])}}return i},r.txt.extractCashtags=function(e){for(var t=[],i=r.txt.extractCashtagsWithIndices(e),n=0;n<i.length;n++)t.push(i[n].cashtag);return t},r.txt.extractCashtagsWithIndices=function(e){if(!e||-1==e.indexOf("$"))return[];var t=[];return e.replace(r.txt.regexen.validCashtag,function(e,i,n,s,r,a){var o=r+i.length,c=o+s.length+1;t.push({cashtag:s,indices:[o,c]})}),t},r.txt.modifyIndicesFromUnicodeToUTF16=function(e,t){r.txt.convertUnicodeIndices(e,t,!1)},r.txt.modifyIndicesFromUTF16ToUnicode=function(e,t){r.txt.convertUnicodeIndices(e,t,!0)},r.txt.getUnicodeTextLength=function(e){return e.replace(r.txt.regexen.non_bmp_code_pairs," ").length},r.txt.convertUnicodeIndices=function(e,t,i){if(0!=t.length){var n=0,s=0;t.sort(function(e,t){return e.indices[0]-t.indices[0]});for(var r=0,a=t[0];n<e.length;){if(a.indices[0]==(i?n:s)){var o=a.indices[1]-a.indices[0];if(a.indices[0]=i?s:n,a.indices[1]=a.indices[0]+o,r++,r==t.length)break;a=t[r]}var c=e.charCodeAt(n);c>=55296&&56319>=c&&n<e.length-1&&(c=e.charCodeAt(n+1),c>=56320&&57343>=c&&n++),s++,n++}}},r.txt.splitTags=function(e){for(var t,i,n=e.split("<"),s=[],r=0;r<n.length;r+=1)if(i=n[r]){t=i.split(">");for(var a=0;a<t.length;a+=1)s.push(t[a])}else s.push("");return s},r.txt.hitHighlight=function(e,t,i){var n="em";if(t=t||[],i=i||{},0===t.length)return e;var s,a,o,c,l,u,d,h=i.tag||n,p=["<"+h+">","</"+h+">"],m=r.txt.splitTags(e),f="",g=0,v=m[0],T=0,b=0,w=!1,y=v,_=[];for(s=0;s<t.length;s+=1)for(a=0;a<t[s].length;a+=1)_.push(t[s][a]);for(o=0;o<_.length;o+=1){for(c=_[o],l=p[o%2],u=!1;null!=v&&c>=T+v.length;)f+=y.slice(b),w&&c===T+y.length&&(f+=l,u=!0),m[g+1]&&(f+="<"+m[g+1]+">"),T+=y.length,b=0,g+=2,v=m[g],y=v,w=!1;u||null==v?u||(u=!0,f+=l):(d=c-T,f+=y.slice(b,d)+l,b=d,w=o%2===0?!0:!1)}if(null!=v)for(b<y.length&&(f+=y.slice(b)),o=g+1;o<m.length;o+=1)f+=o%2===0?m[o]:"<"+m[o]+">";return f};var T=140,b=[o(65534),o(65279),o(65535),o(8234),o(8235),o(8236),o(8237),o(8238)];r.txt.getTweetLength=function(e,t){t||(t={short_url_length:22,short_url_length_https:23});var i=r.txt.getUnicodeTextLength(e),n=r.txt.extractUrlsWithIndices(e);r.txt.modifyIndicesFromUTF16ToUnicode(e,n);for(var s=0;s<n.length;s++)i+=n[s].indices[0]-n[s].indices[1],i+=n[s].url.toLowerCase().match(r.txt.regexen.urlHasHttps)?t.short_url_length_https:t.short_url_length;return i},r.txt.isInvalidTweet=function(e){if(!e)return"empty";if(r.txt.getTweetLength(e)>T)return"too_long";for(var t=0;t<b.length;t++)if(e.indexOf(b[t])>=0)return"invalid_characters";return!1},r.txt.isValidTweetText=function(e){return!r.txt.isInvalidTweet(e)},r.txt.isValidUsername=function(e){if(!e)return!1;var t=r.txt.extractMentions(e);return 1===t.length&&t[0]===e.slice(1)};var w=e(/^#{validMentionOrList}$/);if(r.txt.isValidList=function(e){var t=e.match(w);return!(!t||""!=t[1]||!t[4])},r.txt.isValidHashtag=function(e){if(!e)return!1;var t=r.txt.extractHashtags(e);return 1===t.length&&t[0]===e.slice(1)},r.txt.isValidUrl=function(e,t,i){if(null==t&&(t=!0),null==i&&(i=!0),!e)return!1;var n=e.match(r.txt.regexen.validateUrlUnencoded);if(!n||n[0]!==e)return!1;var a=n[1],o=n[2],c=n[3],l=n[4],u=n[5];return(!i||s(a,r.txt.regexen.validateUrlScheme)&&a.match(/^https?$/i))&&s(c,r.txt.regexen.validateUrlPath)&&s(l,r.txt.regexen.validateUrlQuery,!0)&&s(u,r.txt.regexen.validateUrlFragment,!0)?t&&s(o,r.txt.regexen.validateUrlUnicodeAuthority)||!t&&s(o,r.txt.regexen.validateUrlAuthority):!1},"undefined"!=typeof module&&module.exports&&(module.exports=r.txt),"function"==typeof define&&define.amd&&define([],r.txt),"undefined"!=typeof window)if(window.twttr)for(var y in r)window.twttr[y]=r[y];else window.twttr=r}(),function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):_.extend(e,t())}(this,function(){var e=0,t=["ms","moz","webkit","o"],i={};i={requestAnimationFrame:window.requestAnimationFrame,cancelAnimationFrame:window.cancelAnimationFrame};for(var n=0;n<t.length&&!i.requestAnimationFrame;n+=1)i.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],i.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];return i.requestAnimationFrame||(i.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),s=window.setTimeout(function(){t(i+n)},n);return e=i+n,s}),i.cancelAnimationFrame||(i.cancelAnimationFrame=function(e){clearTimeout(e)}),i}),TD.components.Base=klass(function(){this.$node=$.createElement("div").addClass("js-component")}).methods({$find:function(){return this.$node.find.apply(this.$node,arguments)},publishEvent:function(e,t){var i={data:t,target:this};TD.storage.notification.notify(e,i)},bubbleEvent:function(e,t){var i={data:t,target:this};this.$node.trigger(e,[i])},destroy:function(){this.$node.remove()},show:function(){this.$node.show()},hide:function(){this.$node.hide()}}),TD.components.Autocomplete=TD.components.Base.extend(function(e,t){var i={limit:5,dmMode:!1};this.options=_.extend(i,t),this.$input=e,this.isCompletionsOpen=!1,this.userIsInteracting=!1,this.dropdownId=_.uniqueId("autocomplete"),this.$node=$.createElement("ul").addClass("lst lst-modal typeahead").insertAfter(this.$input),this.$selectedItem=null,this._registerEvents(),this.usernameRegex=i.dmMode?this.constructor.dmUsername:this.constructor.username,$(document).on("dataTypeaheadSuggestions",this.updateDropdown.bind(this))}).mixin(TD.mixins.caretHelper).statics({username:/^[+\/\.<>()|\\=]?[@＠]([a-zA-Z0-9_]{1,20})$/,dmUsername:/(.*)/,hashtag:/^[#＃]([a-zA-Z0-9_]+)/,SELECT:"td-autocomplete-select",_htmlEscapeAndStrongifyMatches:function(e,t){return TD.util.escape(e.replace(t,"<strong>$1</strong>")).replace(/&lt;(\/?strong)&gt;/g,"<$1>")}}).methods({_registerEvents:function(){var e=this,t="keydown";this.$input.bind(t,_.bind(this.keypress,this)),this.$input.bind("keyup click",_.bind(this.keyup,this)),this.blurHandler=function(){_.delay(function(){e.hide()},500)},this.$input.bind("blur",this.blurHandler),this.$node.delegate("li","mouseenter",function(t){e.$node.find("li.s-selected").removeClass("s-selected"),$(this).addClass("s-selected")}).delegate("li","click",_.bind(function(t){e.$selectedItem=$(t.target).closest("li").addClass("s-selected"),e.$selectedItem.siblings(".s-selected").removeClass("s-selected"),this.$input.focus(),this.select()},this))},_unregisterEvents:function(){var e="keydown";this.$input.unbind(e),this.$input.unbind("keyup click keydown"),this.$input.unbind("bind",this.blurHandler)},keyup:function(e){if(e.keyCode){e.stopPropagation();var t="",i=this.getCurrentText(),n=this.getCaret(),s=!1;if(this.options.dmMode?t=i:(t=this.getCurrentWord(n),"@"===i.charAt(n)&&(t="")),t.match(this.usernameRegex)?(t=RegExp.$1,this.autocompleteType="username",s=!0):t.match(this.constructor.hashtag)&&(t=RegExp.$1,this.autocompleteType="hashtag",s=!0),t.length&&s)switch(e.keyCode){case TD.constants.keyCodes.escape:this.hide(),e.stopPropagation();break;case TD.constants.keyCodes.shift:case TD.constants.keyCodes.upArrow:case TD.constants.keyCodes.downArrow:break;default:"hashtag"==this.autocompleteType?this.lookUpHashtag(t):this.lookUpUser(t)}else this.hide()}},keypress:function(e){var t;switch(e.keyCode){case TD.constants.keyCodes.tab:case TD.constants.keyCodes.enter:t=this.$selectedItem&&this.isCompletionsOpen,!e.shiftKey&&t&&(this.select(),e.preventDefault(),e.stopPropagation());break;case TD.constants.keyCodes.escape:this.isCompletionsOpen&&(e.preventDefault(),e.stopPropagation());break;case TD.constants.keyCodes.upArrow:this.isCompletionsOpen&&!e.shiftKey&&(this.moveSelection("prev"),e.preventDefault(),e.stopPropagation());break;case TD.constants.keyCodes.downArrow:this.isCompletionsOpen&&!e.shiftKey&&(this.moveSelection("next"),e.preventDefault(),e.stopPropagation());break;default:this.$selectedItem=null,this.userIsInteracting=!1}},sanitize:function(e){return e.replace(/ /g,"")},moveSelection:function(e){this.userIsInteracting=!0;var t="next"==e?"li:first":"li:last",i=this.$selectedItem||this.$node.find("li.s-selected");return i.length?(i=i.removeClass("s-selected"),i="next"===e?i.nextAll("li:first"):i.prevAll("li:first"),void(this.$selectedItem=i.length?i.addClass("s-selected"):this.$node.find(t).addClass("s-selected"))):void(this.$selectedItem=this.$node.find(t).addClass("s-selected"))},select:function(){var e,t,i;this.$selectedItem&&("username"===this.autocompleteType?(e=this.$selectedItem.find(".js-screenname").text(),this.options.dmMode||(e="@"+e),t=this.$selectedItem.find("img").attr("src"),i=this.$selectedItem.attr("data-id")):e=this.$selectedItem.find(".js-hashtag").text(),this.set(e,t,i))},set:function(e,t,i){var n=this.replaceCurrentWord(e);this.$input.val(n.value),this.setCaretPosition(n.cursor),this.$input.change(),this.$node.trigger(this.constructor.SELECT,[{screenName:e,avatar:t,id:i}]),this.hide()},show:function(){this.$node.show(),this.isCompletionsOpen=!0},hide:function(){this.$node.hide(),this.isCompletionsOpen=!1,this.userIsInteracting=!1,this.$node.trigger("dataTypeaheadQueryReset")},lookUpHashtag:function(e){e=this.sanitize(e);var t={datasources:["topics"],query:"#"+e,onlyLocalData:!0,dropdownId:this.dropdownId,type:"compose",limits:{topics:5}};TD.decider.get("autocomplete_remote_sources")&&(t.onlyLocalData=!1),this.$node.trigger("uiNeedsTypeaheadSuggestions",t)},lookUpUser:function(e){var t={datasources:["users"],query:e,onlyLocalData:!0,dropdownId:this.dropdownId,type:"compose",limits:{users:5}};TD.decider.get("autocomplete_remote_sources")&&(t.onlyLocalData=!1),this.$node.trigger("uiNeedsTypeaheadSuggestions",t)},updateDropdown:function(e,t){if(!this.userIsInteracting&&t.dropdownId===this.dropdownId){var i,n,s=new RegExp("("+t.query.split("").join("|")+")","gi"),r=[];"hashtag"===this.autocompleteType&&t.suggestions.topics?(n=t.suggestions.topics.slice(0,this.options.limit),r=n.map(function(e){return{value:this.constructor._htmlEscapeAndStrongifyMatches(e.topic,s)}},this),i=TD.ui.template.render("compose/autocomplete_hashtag",{results:r})):"username"===this.autocompleteType&&t.suggestions.users&&(n=t.suggestions.users.slice(0,this.options.limit),r=n.map(function(e){return{id:e.id,screenName:this.constructor._htmlEscapeAndStrongifyMatches(e.screen_name,s),name:this.constructor._htmlEscapeAndStrongifyMatches(e.name,s),isVerified:e.verified,pic:TD.util.transformTwitterAvatar(e.profile_image_url_https,"mini")}},this),i=TD.ui.template.render("compose/autocomplete_twitter_user",{results:r})),this.$node.html(i),r.length?(this.isCompletionsOpen||this.show(),this.moveSelection("next")):this.isCompletionsOpen&&this.hide()}},destroy:function(){this._unregisterEvents(),this.$node.remove()}}),TD.components.Dataminr=TD.components.Base.extend(function(){this.$node=$(TD.ui.template.render("open_column_list_multi_group")),this.items=[],this.menuComponents=[],this._boundHandleWatchlists=this._handleWatchlists.bind(this),$(document).on("dataDataminrWatchlists",this._boundHandleWatchlists),$(document).trigger("uiNeedsDataminrWatchlists")}).statics({}).methods({_handleWatchlists:function(e,t){if(t.watchlists&&0!==t.watchlists.length){this.menuComponents.forEach(function(e){e.destroy()}),this.$node.empty();var i=t.watchlists;i.forEach(function(e){var t=$(TD.ui.template.render("open_column_list_group",{title:e.name})),i=t.filter(".js-list-container");e.value.forEach(function(e){var t=new TD.components.MenuItem;t.dataminr(e),this.menuComponents.push(t),i.append(t.$node)},this),this.$node.append(t)},this),this.menuComponents.length>0&&_.defer(function(){this.menuComponents[0].select()}.bind(this))}},destroy:function(){$(document).off("dataDataminrWatchlists",this._boundHandleWatchlists),this.supr()}}),TD.components.Retweeters=TD.components.Base.extend(function(e,t){function i(e){var t,i={stats:[]};if(this.tweetSummary=e,_.isString(e.retweeters_count))t=e.retweeters_count;else{var n=e.retweeters_count||0;t=Math.max(n,s.length)+""}if(this.tweetSummary.retweeters_count=t,"0"!==t&&e.retweeters&&e.retweeters.length>0&&i.stats.push({count:TD.util.prettyNumber(t),label:TD.util.pluralise(TD.i("Retweet"),TD.i("Retweets"),t),type:"retweeters"}),"0"!==e.favoriters_count&&e.favoriters&&e.favoriters.length>0&&i.stats.push({count:TD.util.prettyNumber(e.favoriters_count),label:TD.util.pluralise(TD.i("Favorite"),TD.i("Favorites"),e.favoriters_count),type:"favoriters"}),i.stats.length>0){var a=TD.ui.template.render("status/tweet_detail_socialstats",i);r.$node.html(a)}else r.destroy()}if(!(!e instanceof TD.services.TwitterStatus||e instanceof TD.services.TwitterConversationMessageEvent)){this.tweet=e.getMainTweet();var n=TD.controller.clients.getClient(this.tweet.account.getKey()),s=[],r=this;n.getTweetSummary(this.tweet.id,i.bind(this),function(){r.destroy()})}}),TD.components.RepliesTo=TD.components.Base.extend(function(e,t,i){this.chirp=e.getMainTweet(),this.mainTweet=this.chirp.getMainTweet(),this.repliesTo=[],this.mediaPreviewSize=t,this.wantsDragHandle=i,this.refreshPeriod=60,this._boundHandleConversation=this._handleConversation.bind(this),this.subscriptions={},this.subscriptions[this.mainTweet.id]=$.subscribe("/tweets/conversation/"+this.mainTweet.id,this._boundHandleConversation),this.client=TD.controller.clients.getClient(this.chirp.account.getKey()),this.pollTaskId=TD.controller.scheduler.schedulePeriodicTask(this.refreshPeriod,function(){this.client.getConversation(this.mainTweet.id)}.bind(this),!0),this.$node.html(TD.ui.template.render("status/tweet_detail_repliesto"))}).methods({_handleConversation:function(e){var t,i,n={};this.repliesTo.forEach(function(e){n[e.id]=!0}),t=e.descendants.filter(function(e){return!n[e.id]}),t.sort(TD.util.chirpReverseColumnSort),this.repliesTo=this.repliesTo.concat(t),t.forEach(function(e){this.subscriptions[e.id]||(this.subscriptions[e.id]=$.subscribe("/tweets/conversation/"+e.id,this._boundHandleConversation))}.bind(this)),i=t.map(function(e){return e.render({mediaPreviewSize:this.mediaPreviewSize,isInConvo:!0,withDragHandle:this.wantsDragHandle&&!e.user.isProtected})}.bind(this)).join(""),this.$find(".js-replies-to").append(i)},findChirp:function(e){var t=null;return this.chirp.id===e?t=this.chirp:this.mainTweet.id===e?t=this.mainTweet:this.repliesTo&&(t=_.detect(this.repliesTo,function(t){return t.id===e})),t},destroy:function(){for(var e in this.subscriptions)$.unsubscribe(this.subscriptions[e]);TD.controller.scheduler.removePeriodicTask(this.pollTaskId),this.supr()}}),TD.components.InReplyTo=TD.components.Base.extend(function(e,t,i,n){var s=this;this.chirp=e,this.mainTweet=this.chirp.getMainTweet(),this.$container=t,this.$detailContentContainer=this.$container.find(".js-detail-container"),this.$detailContent=this.$detailContentContainer.find(".js-detail-content"),this.mediaPreviewSize=i,this.wantsDragHandle=n,this.mainTweet.inReplyToID&&(this.$node.html(TD.ui.template.render("status/tweet_detail_inreplyto")),this.$repliesContainer=this.$find(".js-replies-before"),this.$repliesText=this.$find(".in-reply-to").hide(),this.replies=null,_.defer(function(){s.bubbleEvent(TD.components.InReplyTo.BEGIN)}),this.subscription=$.subscribe("/tweets/conversation/"+this.mainTweet.id,_.bind(this._handleRelatedResults,this)),this.client=TD.controller.clients.getClient(this.chirp.account.getKey()),this.client.getConversation(this.mainTweet.id))}).statics({BEGIN:"td-load-convo",END:"td-load-finish",INREPLYTO_PADDING:20}).methods({_handleRelatedResults:function(e){this.replies&&this.replies.length>0||(this.replies=e.ancestors,_.isEmpty(this.replies)?this._getTweet():this._showReplies())},_getTweet:function(){var e=this;this.client.show(this.mainTweet.inReplyToID,function(t){e.replies=e.replies||[],e.replies.push(t),e._showReplies()},function(){e.bubbleEvent(TD.components.InReplyTo.END)})},_showReplies:function(){_.defer(_.bind(this._showRepliesInternal,this))},_showRepliesInternal:function(){var e,t,i,n,s,r,a;this.bubbleEvent(TD.components.InReplyTo.END),_.isEmpty(this.replies)||(this.replies.sort(TD.util.chirpReverseColumnSort),t=this.mainTweet.id,this.replies=_.filter(this.replies,function(e){return e.id!==t}),i=_.map(this.replies,function(e){return e.render({mediaPreviewSize:this.mediaPreviewSize,isInConvo:!0,withDragHandle:!this.isInOwnCustomTimeline&&!e.user.isProtected})}.bind(this)).join(""),n=this.$detailContentContainer.outerHeight(),s=this.$detailContent.outerHeight(),this.$repliesContainer.html(i),e=this.$node.outerHeight(),n>s&&this.$detailContent.css("padding-bottom",n-s),this.replies.length<=1?r=0:(a=this.$repliesContainer.children().last().outerHeight()+TD.components.InReplyTo.INREPLYTO_PADDING,r=e-a),this.$detailContentContainer.scrollTop(e),this.$detailContentContainer.animate({scrollTop:r},{duration:"fast"}))},findChirp:function(e){var t=null;return this.chirp.id===e?t=this.chirp:this.mainTweet.id===e?t=this.mainTweet:this.replies&&(t=_.detect(this.replies,function(t){return t.id===e})),t},destroy:function(){this.subscription&&$.unsubscribe(this.subscription),this.supr()}}),TD.components.BaseModal=TD.components.Base.extend(function(){this.$node=this._render(),$(document).trigger("uiCloseModal"),this.$title=this.$find(".js-header-title"),this.$closeButton=this.$find(".js-dismiss"),this.$menuContainer=this.$find(".js-mdl-content"),this.$footer=this.$find("footer");var e=_.bind(this.destroy,this);this.$node.bind(TD.components.BaseModal.CLOSE_EVENT,e),this.$node.on("click",".js-dismiss",this.destroy.bind(this)),this.boundCloseModal=this._handleCloseModal.bind(this),$(document).on("uiCloseModal",this.boundCloseModal);var t=_.bind(this.handleDragStart,this),i=_.bind(this.getDragDropBoundary,this);this.$node.draggable({boundary:i,handle:this.$find(".mdl-drag-handle")}),this.$node.on("start.draggable",t),$("div.ovl.scroll-v").on("click",function(t){this===t.target&&e()}),TD.util.isTouchDevice()&&window.navigator.standalone&&($("div.ovl.scroll-v").on("touchmove",function(e){e.preventDefault()}),$("div.ovl.scroll-v").on("touchmove",".scroll-v",function(e){e.stopPropagation()})),this.hasFocus=!1,this.focusId=_.uniqueId("focus"),this._boundHandleFocus=this.handleFocus.bind(this),$(document).on("uiFocus",this._boundHandleFocus),$(document).trigger("uiFocusRequest",{id:this.focusId})}).statics({CLOSE_EVENT:"td-close"}).methods({_render:function(){return $(TD.ui.template.render("large_modal"))},handleFocus:function(e,t){this.hasFocus=t.id===this.focusId?!0:!1},getDragDropBoundary:function(){return this.$node.parent()},handleDragStart:function(){this.$node.css({position:"absolute",top:this.$node.offset().top,left:this.$node.offset().left}),this.$node.parent("#open-modal").addClass("is-dragging")},setAndShowContainer:function(e,t){"boolean"!=typeof t&&(t=!0),t&&e.empty(),e.append(this.$node).show(),this._checkIfTouchModal(e)},show:function(){this.supr()},_checkIfTouchModal:function(e){var t=$("#open-modal");TD.util.isTouchDevice()&&TD.decider.get("touchdeck_modals_v2")?(e.addClass("is-touch-modal"),t.addClass("is-touch-modal")):(e.removeClass("is-touch-modal"),t.removeClass("is-touch-modal"))},_handleCloseModal:function(){this.destroy()},destroy:function(){this.$node.parent("#open-modal").removeClass("is-dragging"),$(document).off("uiFocus",this._boundHandleFocus),$(document).off("uiCloseModal",this.boundCloseModal),$(document).trigger("uiFocusRelease",{id:this.focusId}),this.supr()}}),TD.components.NewFeaturesSplash=TD.components.BaseModal.extend(function(){this.$node.addClass("release-notes-modal"),this.$menuContainer.append(TD.ui.template.render("splash/whats_new")),this.$find(".js-mdl-content").removeClass("horizontal-flow-container"),this.bind(),this.setAndShowContainer($("#splash-modal")),TD.components.NewFeaturesSplash.updateSeenVersion()}).statics({FOR_VERSION:"3.5",shouldShow:function(){var e=TD.components.NewFeaturesSplash.FOR_VERSION,t=TD.settings.getPreviousSplashVersion();return"twitter"!==TD.storage.store.getCurrentAuthType()?!1:1!==TD.util.versionComparator(e,t)?!1:-1===TD.util.versionComparator(TD.version,e)?!1:!0},updateSeenVersion:function(){TD.settings.setPreviousSplashVersion(TD.version)}}).methods({destroy:function(){this.supr(),$("#splash-modal").hide()},bind:function(){var e=this.$find(".js-done");e.click(this.destroy.bind(this));this.$find("[data-action]").click(this._handleActionClick.bind(this))},_handleActionClick:function(e){e.preventDefault();var t=e.target.dataset.action;switch(t){case"signOut":TD.storage.store.setCurrentAuthType("tweetdeck"),TD.controller.init.signOut();break;case"openSettings":$(document).trigger("uiShowAccountSettings")}}}),TD.components.OpenColumn=TD.components.BaseModal.extend(function(){var e=this;this.$footer.append($(TD.ui.template.render("open_column_footer"))),this.$backButton=this.$find(".js-back"),this.$addButton=this.$find(".js-add-column"),this.history=[],this.menu=null,this.$backButton.bind("click",function(t){t.stopPropagation(),e._previous()}),this.$node.on(TD.components.TemporaryColumn.DELETED_EVENT,this._reload.bind(this))}).statics({GO_URL_REGEX:/^(add|profile)$/,GO_EVENT:"/go",instance:null}).methods({canGo:function(e,t){return TD.components.OpenColumn.GO_URL_REGEX.test(e)},go:function(e,t,i,n){TD.components.OpenColumn.instance=this,n&&(this.history=[n]),this.history.push([e,_.clone(t),i]);var s=t.shift();if(this.menu&&this.menu.canGo&&this.menu.canGo(e,t))return this.history.pop(),this.history[this.history.length-1]=fullUrl,void this.menu.go(s,t,i);var r,a=!1,o=!1,c=!1;if("add"===e)switch(s){case"home":r=new TD.components.OpenColumnHome,a=!0;break;case"lists":case"customtimelines":r=new TD.components.OpenCustomTimelines(s);break;case"sharedcolumn":r=new TD.components.OpenSharedColumn(i.state);break;case"trends":r=new TD.components.OpenTrends;break;case"dataminr":r=new TD.components.OpenDataminr;break;default:TD.controller.columnManager.TWITTER_GENERIC[s]&&(r=new TD.components.OpenTwitterGeneric(s))}this._show(s,r,a,o,c),r.go&&r.go(s,t,i)},_show:function(e,t,i,n,s){this.menu&&this.menu.destroy(),this.menu=t,this.$menuContainer.append(t.$node),i||this.menu.setup(this.$addButton),this.$node.toggleClass("s-nonav",i),this.$node.toggleClass("s-narrow",n),this.$backButton.toggle(this.history.length>1).toggleClass("hide",0===this.history.length),this.$title.text("home"===e?TD.i("Choose column type"):"profile"===e?TD.i("Account profile"):"sharedcolumn"===e?TD.i("Shared column"):TD.controller.columnManager.MENU_TITLE[e]||"")},_previous:function(){this.history.pop();var e=this.history.pop();e instanceof Array?this.go.apply(this,e):(this.destroy(),$(e.target).trigger(e.type,[e.data]))},_reload:function(){var e=this.history.pop();e instanceof Array&&this.go.apply(this,e)},destroy:function(){this.menu&&this.menu.destroy(),_.each(this.eventSubscriptions,function(e){$.unsubscribe(e)}),this.$backButton.unbind(),$("#open-modal").hide(),TD.components.OpenColumn.instance=null,this.supr()}}),TD.components.OpenColumnHome=TD.components.Base.extend(function(){var e=this;this.singletonTypes={};var t={},i={};i[TD.controller.columnManager.DATAMINR]=!0,TD.controller.columnManager.DISPLAY_ORDER_SINGLETONS.forEach(function(n){e.singletonTypes[n.type]=!0,t[n.type]=!_.isEmpty(TD.storage.columnController.getColumnsByType(n.type)),i[n.type]=!1}),this.$node=$(TD.ui.template.render("open_column_home",{options:TD.controller.columnManager.DISPLAY_ORDER,isDisabled:function(){return t[this.type]},isHidden:function(){return i[this.type]}})),this.$launchers=this.$find(".js-item-launch"),this.$launchers.bind("click",function(t){var i,n=$(t.currentTarget),s=(n.data("action"),n.data("type")),r=e.singletonTypes[s];n.hasClass("is-disabled")||(r?(i=TD.controller.columnManager.makeColumnFor({type:s,service:"tweetdeck"}),TD.controller.columnManager.addColumnToUI(i),e.bubbleEvent(TD.components.BaseModal.CLOSE_EVENT)):e.publishEvent(TD.components.OpenColumn.GO_EVENT,TD.components.OpenColumnHome.URL_BASE+"/"+s))}),this._boundHandleDataminrAuthenticated=this._handleDataminrAuthenticated.bind(this),$(document).on("dataDataminrAuthenticated",this._boundHandleDataminrAuthenticated),$(document).trigger("uiNeedsDataminrAuth")}).statics({URL_BASE:"/add",DATAMINR_ADD_SELECTOR:'.js-item-launch[data-type="dataminr"]'}).methods({_handleDataminrAuthenticated:function(){this.$find(TD.components.OpenColumnHome.DATAMINR_ADD_SELECTOR).removeClass("is-hidden")},destroy:function(){$(document).off("dataDataminrAuthenticated",this._boundHandleDataminrAuthenticated),this.supr()}}),TD.components.SplitMenu=TD.components.Base.extend(function(){this.$node=$(TD.ui.template.render("open_split_menu")),this.menuItems=[],this.rightPillarComponent=null,this.$leftPinnedContainer=this.$find(".js-left-pinned"),this.$leftPillarContainer=this.$find(".js-left-column"),this.$rightPillarContainer=this.$find(".js-right-column")}).methods({appendMenuItem:function(e){this.menuItems.push(e),this.$leftPillarContainer.append(e.$node)},removeMenuItem:function(e){e.destroy(),this.menuItems=_.without(this.menuItems,e)},appendPinnedMenuItem:function(e){this.menuItems.push(e),this.$leftPillarContainer.addClass("s-with-pinned"),this.$leftPinnedContainer.html(e.$node)},appendMenuItemElement:function(e){this.$leftPillarContainer.append(e)},setRightPillar:function(e){this.rightPillarComponent&&this.rightPillarComponent.destroy(),this.rightPillarComponent=e,this.$rightPillarContainer.html(e.$node)},destroy:function(){_.each(this.menuItems,function(e){e.destroy()}),this.rightPillarComponent&&this.rightPillarComponent.destroy(),this.supr()}}),TD.components.OpenSplitMenu=TD.components.SplitMenu.extend(function(){this.$addButton=null}).methods({setup:function(e){this.$addButton=e,this.$addButton.hide(),this.$addButton.click(_.bind(this._handleAddClick,this))},setChirpPillar:function(e){this.setRightPillar(e);var t=this;e instanceof TD.components.TemporaryColumn&&_.defer(function(){e.populate(),t.$addButton.show(),t.$addButton.prop("disabled",!1)})},_handleAddClick:function(e){this.$addButton.prop("disabled")||this.makeChirpColumnPermanent()},makeChirpColumnPermanent:function(){this.rightPillarComponent&&(this.rightPillarComponent.makePermanent(),this.$addButton.prop("disabled",!0))},destroy:function(){this.$addButton.unbind("click"),this.$addButton.hide(),this.supr()}}),TD.components.OpenTwitterGeneric=TD.components.OpenSplitMenu.extend(function(e){if(this.type=e,this.showUserSearch=!TD.controller.columnManager.SELF_ACCOUNTS_ONLY[e],this.userSearch=null,this.helpText=TD.controller.columnManager.HELP_TEXT[e],this.placeHolder=new TD.components.OpenColumnPlaceholder(this.helpText),this.setChirpPillar(this.placeHolder),this.showUserSearch){this.userSearch=new TD.components.TwitterUserSearch,this.appendPinnedMenuItem(this.userSearch);var t=this.userSearch.detachResultsContainer();this.appendMenuItemElement(t)}this.profileAccount=new TD.components.ProfileAccount,this.profileAccount.$node.hide(),this.appendMenuItem(this.profileAccount),this.selfAccounts=new TD.components.SelfAccounts("twitter"),this.appendMenuItem(this.selfAccounts),this.$node.bind(TD.components.MenuItemBase.BUBBLE_SELECT_EVENT,_.bind(this._handleSelect,this))}).methods({go:function(e,t,i){i.screenName?(this.profileAccount.setUser(i.screenName),this.profileAccount.$node.show(),this.profileAccount.select()):this.selfAccounts.selectDefault()},_handleSelect:function(e,t){var i;if(t.target.account)i=new TD.components.TemporaryColumn,i.genericTwitter(this.type,t.target.account,void 0);else if(t.target.twitterUser){i=new TD.components.TemporaryColumn;var n=this.userSearch.client.oauth.account;i.genericTwitter(this.type,n,t.target.twitterUser)}i&&(this.setChirpPillar(i),e.stopPropagation())}}),TD.components.OpenCustomTimelines=TD.components.OpenSplitMenu.extend(function(e){switch(this.mode=e,this.screenName=null,this.listsComponent=null,this.newCustomTimelineButton=null,this.mode){case"lists":this.helpText=TD.controller.columnManager.HELP_TEXT[TD.controller.columnManager.LISTS];break;case"customtimelines":this.helpText=TD.controller.columnManager.HELP_TEXT[TD.controller.columnManager.CUSTOMTIMELINES]}this.placeHolder=new TD.components.OpenColumnPlaceholder(this.helpText),this.removePlaceholder=new TD.components.OpenColumnPlaceholder(""),this.setChirpPillar(this.placeHolder),this.$node.bind(TD.components.MenuItemBase.BUBBLE_SELECT_EVENT,_.bind(this._handleListSelect,this)),this.$node.bind(TD.components.CustomTimelines.LOADED,_.bind(this._handleListsLoaded,this))}).methods({go:function(e,t,i){i.screenName?(this.screenName=i.screenName,this.listsComponent=new TD.components.CustomTimelines(this.screenName,i.slug,this.mode),this.appendMenuItem(this.listsComponent)):(this.newCustomTimelineButton=new TD.components.NewCustomTimelineButton(this.mode),this.appendPinnedMenuItem(this.newCustomTimelineButton),this.listsComponent=new TD.components.CustomTimelines(null,null,this.mode),this.appendMenuItem(this.listsComponent))},_handleListsLoaded:function(e,t){if(t.target===this.listsComponent&&0===t.data){this.removeMenuItem(this.listsComponent);var i;switch(this.mode){case"lists":i=TD.i(this.screenName?"This user has no public lists":"You are not subscribed to any lists");break;case"customtimelines":i=TD.i(this.screenName?"This user has no collections":"You do not have any collections")}this.listsComponent=new TD.components.OpenColumnPlaceholder(i),this.setChirpPillar(this.removePlaceholder),this.appendMenuItem(this.listsComponent)}},_handleListSelect:function(e,t){var i=t.target.list,n=new TD.components.TemporaryColumn;switch(this.mode){case"lists":n.list(i);break;case"customtimelines":n.customTimeline(i)}this.setChirpPillar(n),e.stopPropagation()}}),TD.components.OpenDataminr=TD.components.OpenSplitMenu.extend(function(){
this.helpText=TD.controller.columnManager.HELP_TEXT[TD.controller.columnManager.DATAMINR],this.placeHolder=new TD.components.OpenColumnPlaceholder(this.helpText),this.setChirpPillar(this.placeHolder),this._boundHandleWatchlistSelect=this._handleWatchlistSelect.bind(this),this._boundHandleWatchlists=this._handleWatchlists.bind(this),this.$node.bind(TD.components.MenuItemBase.BUBBLE_SELECT_EVENT,this._boundHandleWatchlistSelect),$(document).bind("dataDataminrWatchlists",this._boundHandleWatchlists)}).methods({go:function(e,t,i){this.watchlistsComponent&&this.watchlistsComponent.destroy(),this.watchlistsComponent=new TD.components.Dataminr,this.appendMenuItem(this.watchlistsComponent)},_handleWatchlists:function(e,t){if(!t.watchlists||!t.watchlists.length){this.removeMenuItem(this.watchlistsComponent);var i=TD.i("You are not subscribed to any watchlists");this.watchlistsComponent=new TD.components.OpenColumnPlaceholder(i),this.setChirpPillar(this.removePlaceholder),this.appendMenuItem(this.watchlistsComponent)}},_handleWatchlistSelect:function(e,t){var i=new TD.components.TemporaryColumn,n=TD.storage.store.getTwitterLoginAccount();i.dataminr(t.target.watchlist,n.getKey()),this.setChirpPillar(i)},destroy:function(){this.$node.off(TD.components.MenuItemBase.BUBBLE_SELECT_EVENT,this._boundHandleWatchlistSelect),$(document).off("dataDataminrWatchlists",this._boundHandleWatchlists),this.supr()}}),TD.components.OpenSharedColumn=TD.components.OpenSplitMenu.extend(function(e){this.aColumnDeferred=this._deserializeColumn(e)}).methods({go:function(e,t,i){var n=new TD.components.TemporaryColumn;this.aColumnDeferred.addCallback(function(e){n.renderColumn(e),this.setChirpPillar(n)}.bind(this)),this.aColumnDeferred.addErrback(function(){this.destroy(),setTimeout(function(){$(document).trigger("uiCloseModal"),TD.controller.progressIndicator.addMessage(TD.i("Shared column could not be loaded"))},0)}.bind(this)),this.$leftPillarContainer.html(TD.ui.template.render("open_column_shared_help"))},_selectAccountKey:function(e){var t=new TD.core.defer.Deferred,i=e.accountkey,n=$(document);return n.one("dataAccount",function(e,i){t.callback(i.account&&i.account.accountKey)}),n.trigger("uiNeedsAccount",{accountKey:i}),t.addCallback(function(e){var t=new TD.core.defer.Deferred;return e?e:(n.one("dataDefaultAccount",function(e,i){t.callback(i.accountKey)}),n.trigger("uiNeedsDefaultAccount"),t)}),t},_parseColumn:function(e){var t=e.feeds,i=t[0],n=i.type,s=i.service,r=i.metadata,a=new TD.vo.SearchFilter(e.filters),o=this._selectAccountKey(i);return o.addCallback(function(e){return TD.controller.columnManager.makeOtherColumnAndFeeds({type:n,service:s,accountKey:e,metadata:r,searchFilter:a})}),o},_deserializeColumn:function(e){function t(e,s){s.data===i&&(n.off("dataSchemaValidation",t),s.isValid?r.callback(s.data):r.errback(s.validationError))}var i,n=$(document);try{i=JSON.parse(e)}catch(s){return console.warn("Invalid column data supplied: ",s),TD.core.defer.fail(s)}var r=new TD.core.defer.Deferred;return r.addCallback(this._parseColumn.bind(this)),n.on("dataSchemaValidation",t),n.trigger("uiNeedsSchemaValidation",{data:i,schemaName:"sharedColumn"}),r}}),TD.components.OpenTrends=TD.components.OpenSplitMenu.extend(function(){this.trends=new TD.components.Trends,this.appendMenuItem(this.trends),this.helpText=TD.controller.columnManager.HELP_TEXT[TD.controller.columnManager.TRENDS],this.placeHolder=new TD.components.OpenColumnPlaceholder(this.helpText),this.setChirpPillar(this.placeHolder),this.$node.bind(TD.components.MenuItemBase.BUBBLE_SELECT_EVENT,_.bind(this._handleTrendSelect,this))}).methods({_handleTrendSelect:function(e,t){var i=t.target.title,n=new TD.components.TemporaryColumn;n.search(i),this.setChirpPillar(n),e.stopPropagation()}}),TD.components.OpenColumnPlaceholder=TD.components.Base.extend(function(e){this.helperText=e,this.$node=$(TD.ui.template.render("open_column_temp_help",{helpText:e}))}),TD.components.NewCustomTimelineButton=TD.components.Base.extend(function(e){var t=this;this.mode=e;var i='<button class="btn btn-positive"><i class="icon icon-plus icon-small-valigned"></i><span class="label padding-ls">{{{button_txt}}}</span></button>';switch(this.mode){case"lists":this.$button=$(TD.ui.template.toHtml(i,{button_txt:TD.i("Create list")}));break;case"customtimelines":this.$button=$(TD.ui.template.toHtml(i,{button_txt:TD.i("Create collection")}))}this.$button.click(function(e){switch(t.bubbleEvent(TD.components.BaseModal.CLOSE_EVENT),t.mode){case"lists":{new TD.components.ListDetails}break;case"customtimelines":var i=TD.controller.clients.getPreferredClient();i.createCustomTimeline({},function(e){var t=new TD.components.TemporaryColumn;t.customTimeline(e),t.populate(),t.makePermanent(),setTimeout(function(){t.destroy()},0)},function(e){TD.controller.progressIndicator.addMessage(TD.i("Error creating customTimeline: {{status}}",{status:e.status}))})}}),this.$node.append(this.$button),this.$node.addClass("sch-list padding-al")}),TD.components.ListDetails=TD.components.BaseModal.extend(function(e){this.theList=e,this.toAutoAdd=[];var t=TD.storage.accountController.getAccountsForService("twitter");this.$editForm=$(TD.ui.template.render("lists/edit_form",{accounts:t})),this.$menuContainer.append(this.$editForm),this.$footer.append($(TD.ui.template.render("lists/edit_footer"))),this.setAndShowContainer($("#lists-modal")),this.$account=$("#list-account"),this.$name=$("#list-name"),this.$description=$("#list-description"),this.$modePublic=this.$find('input:radio[value="public"]'),this.$modePrivate=this.$find('input:radio[value="private"]'),this.$saveButton=this.$find(".js-save"),this.$name.focus(),this.$saveButton.click(_.bind(this._handleSaveClick,this)),e?(this.$title.text(TD.i("Edit list")),this.$account.val(TD.storage.Account.generateKeyFor("twitter",e.user.id)),this.$account.prop("disabled",!0),this.$name.val(e.name),this.$description.val(e.description),e.isPrivate?this.$modePrivate.prop("checked",!0):this.$modePublic.prop("checked",!0)):this.$title.text(TD.i("Create list"))}).methods({autoAddMember:function(e){this.toAutoAdd.push(e)},_handleSaveClick:function(){var e=this.$account.val(),t=TD.controller.clients.getClient(e),i=this.$name.val(),n=this.$description.val(),s=this.$modePrivate.prop("checked"),r=_.bind(this._handleSaveSuccess,this),a=_.bind(this._handleSaveFailure,this);this.$saveButton.prop("disabled",!0),this.theList?t.updateList(this.theList.id,i,n,s,r,a):t.createList(i,n,s,r,a)},_handleSaveSuccess:function(e){this.destroy();new TD.components.ListMembers(e,this.toAutoAdd)},_handleSaveFailure:function(){this.$saveButton.prop("disabled",!1);var e=TD.i("Problem saving list. Please check the details and try again");TD.controller.progressIndicator.addMessage(e)},destroy:function(){this.supr(),$("#lists-modal").hide()}}),TD.components.ListMembers=TD.components.BaseModal.extend(function(e,t){var i=this;this.theList=e,this.membersIndex={},this.changed=!1,this.client=TD.controller.clients.getClient(e.account.getKey()),this.feedKey=TD.storage.Feed.generateKeyFor(this.theList.account.getKey(),"list",{listId:this.theList.id,ownerId:this.theList.user.id}),this.splitMenu=new TD.components.SplitMenu,this.userSearch=new TD.components.TwitterUserSearch(e.user.account,10,TD.components.ListMember),this.suggestedUsers=new TD.components.SuggestedUsers(e.user.account,10,TD.components.ListMember,e.name),this.loadingPane=new TD.components.OpenColumnPlaceholder(TD.i("Loading list members…")),this.memberList=new TD.components.ListMemberList,this.$title.text(TD.i("{{{1}}} by {{2}}",{1:e.name,2:e.user.screenName})),this.$menuContainer.append(this.splitMenu.$node),this.$footer.append($(TD.ui.template.render("lists/edit_members_footer"))),this.splitMenu.appendPinnedMenuItem(this.userSearch),this.splitMenu.appendMenuItemElement(this.userSearch.detachResultsContainer()),this.splitMenu.appendMenuItem(this.suggestedUsers),this.splitMenu.setRightPillar(this.loadingPane),this.setAndShowContainer($("#lists-modal")),this.userSearch.searchInput.$inputBox.focus(),this.$memberCount=this.memberList.$find(".js-member-count"),this.$editButton=this.$find(".js-edit"),this.$deleteButton=this.$find(".js-delete"),this.$doneButton=this.$find(".js-done"),this.$addColumnOption=this.$find(".js-add-column-option"),this.$addColumnCheckbox=this.$addColumnOption.find(".js-add-column-checkbox"),0===TD.storage.columnController.getColumnsContainingFeed(this.feedKey).length&&(this.$addColumnCheckbox.prop("checked",!0),this.$addColumnOption.removeClass("is-hidden")),this.$editButton.click(_.bind(this._editDetails,this)),this.$deleteButton.click(_.bind(this._deleteList,this)),this.$doneButton.click(_.bind(this._handleDone,this)),this.$node.bind(TD.components.ListMember.ADD_REMOVE_EVENT,_.bind(this._addRemoveMember,this)),this.$node.bind(TD.components.TwitterUserSearch.SEARCH_COMPLETE,function(e,t){var n=t.target;i._checkResultsState(n),i.splitMenu.$leftPillarContainer.scrollTop(0)}),this._updateMemberCount();var n=this._addMembers(t);n.addBothWith(this,this._loadAllMembers),n.addCallback(function(){i.suggestedUsers.render(),i._checkResultsState(i.userSearch),i._checkResultsState(i.suggestedUsers)})}).methods({_addMembers:function(e){var t;if(_.isEmpty(e))t=TD.core.defer.succeed();else{t=new TD.core.defer.Deferred;var i=_.pluck(e,"screenName");this.client.addUsersToList(this.theList.id,i,_.bind(t.callback,t),_.bind(t.errback,t))}return t},_loadAllMembers:function(){var e,t=this,i=function(e){if(t._displayMembers(e.users,!1),e.next_cursor){var n=t._fetchMemberPage(e.next_cursor_str);return n.addCallback(i),n}};return e=this._fetchMemberPage(-1),e.addCallback(i),e},_fetchMemberPage:function(e){var t=new TD.core.defer.Deferred;return this.client.getListMembers(this.theList.id,e,_.bind(t.callback,t),_.bind(t.errback,t)),t},_displayMembers:function(e,t){var i=this;t&&e.reverse(),_.each(e,function(e){if(!i.membersIndex[e.id]){var n=new TD.components.ListMember(e);i.membersIndex[n.user.id]=n,t?i.memberList.prepend(n):i.memberList.append(n)}}),this.loadingPane&&(this.loadingPane.destroy(),this.loadingPane=null,this.splitMenu.setRightPillar(this.memberList))},_updateMemberCount:function(){this.$memberCount.text(this.theList.memberCount)},_editDetails:function(){this.destroy();new TD.components.ListDetails(this.theList)},_deleteList:function(){var e=this,t=_.uniqueId(),i={id:t,title:TD.i("Deleting list!"),message:TD.i("Are you sure you want to delete this list?"),okLabel:TD.i("Delete"),cancelLabel:TD.i("Cancel")},n=function(i,s){s.id===t&&($(document).off("uiConfirmationAction",n),s.result&&e.client.destroyList(e.theList.id,function(){e.theList=null,e.destroy()}))};$(document).on("uiConfirmationAction",n).trigger("uiShowConfirmationDialog",i)},_addRemoveMember:function(e,t){e.stopPropagation();var i=t.target;this.membersIndex[i.user.id]?this.removeMember(i.user):this.addMember(i.user)},addMember:function(e){var t=this;this._changeUserState(e.id,TD.components.ListMember.STATE_WORKING),this.client.addUserToList(this.theList.id,e.screenName,function(i){t._displayMembers([e],!0),t.theList.memberCount++,t._updateMemberCount(),t._changeUserState(e.id,TD.components.ListMember.STATE_MEMBER),t.changed=!0},function(i){t._changeUserState(e.id,TD.components.ListMember.STATE_NON_MEMBER);var n=TD.i("Problem adding {{userName}} to the list {{listName}}. Please try again",{userName:e.name,listName:t.theList.name});TD.controller.progressIndicator.addMessage(n)})},removeMember:function(e){var t=this;this._changeUserState(e.id,TD.components.ListMember.STATE_WORKING),this.client.removeUserFromList(this.theList.id,e.screenName,function(i){var n=t.membersIndex[e.id];n.destroy(),delete t.membersIndex[e.id],t.theList.memberCount--,t._updateMemberCount(),t._changeUserState(e.id,TD.components.ListMember.STATE_NON_MEMBER),t.changed=!0},function(i){t._changeUserState(e.id,TD.components.ListMember.STATE_MEMBER);var n=TD.i("Problem removing {{userName}} from the list {{listName}}. Please try again",{userName:e.name,listName:t.theList.name});TD.controller.progressIndicator.addMessage(n)})},_changeUserState:function(e,t){this.membersIndex[e]&&this.membersIndex[e].setState(t),t===TD.components.ListMember.STATE_MEMBER&&(t=TD.components.ListMember.STATE_MEMBER_CHECKED);var i=this.userSearch.items.concat(this.suggestedUsers.items);_.each(i,function(i){i.user.id==e&&i.setState(t)})},_checkResultsState:function(e){var t=this,i=e===this.suggestedUsers;_.each(e.items,function(e){t.membersIndex[e.user.id]?(e.setState(TD.components.ListMember.STATE_MEMBER_CHECKED),i&&e.hide()):(e.setState(TD.components.ListMember.STATE_NON_MEMBER),i&&e.show())})},_handleDone:function(){if(this.$addColumnCheckbox.prop("checked")){var e=new TD.components.TemporaryColumn;e.list(this.theList),e.makePermanent()}this.destroy()},destroy:function(){if(this.changed&&this.theList){TD.cache.lists.add(this.theList);var e=TD.controller.feedManager.getPoller(this.feedKey);e&&(e.removeAll(),e.refresh())}$("#lists-modal").hide(),this.splitMenu.destroy(),this.userSearch.destroy(),this.suggestedUsers.destroy(),this.memberList.destroy(),this.loadingPane&&this.loadingPane.destroy(),_.each(this.membersIndex,function(e,t){e.destroy()}),this.supr()}}),TD.components.ListMember=TD.components.Base.extend(function(e){this.user=e,this.state=null;var t={fullname:e.name||e.screenName,username:e.screenName,profileImageURL:e.profileImageURL,description:e.description,isProtected:e.isProtected,isVerified:e.isVerified};this.$node=$(TD.ui.template.render("lists/member",t)),this.$addRemoveButton=this.$find(".js-add-remove"),this.$addRemoveButton.click(_.bind(this._handleAddRemoveClick,this)),this.setMember()}).statics({ADD_REMOVE_EVENT:"td-add-remove",STATE_MEMBER:"member",STATE_MEMBER_CHECKED:"member-checked",STATE_NON_MEMBER:"non-member",STATE_WORKING:"working"}).methods({_handleAddRemoveClick:function(){this.bubbleEvent(TD.components.ListMember.ADD_REMOVE_EVENT)},setState:function(e){switch(e){case TD.components.ListMember.STATE_MEMBER:this.setMember();break;case TD.components.ListMember.STATE_MEMBER_CHECKED:this.setMemberChecked();break;case TD.components.ListMember.STATE_NON_MEMBER:this.setNonMember();break;case TD.components.ListMember.STATE_WORKING:this.setWorking()}},setMember:function(){this.state=TD.components.ListMember.STATE_MEMBER,this.$addRemoveButton.removeClass("s-nonmember s-working s-checked").addClass("s-member"),this.$addRemoveButton.prop("disabled",!1)},setMemberChecked:function(){this.state=TD.components.ListMember.STATE_MEMBER_CHECKED,this.$addRemoveButton.removeClass("s-nonmember s-member s-working").addClass("s-checked"),this.$addRemoveButton.prop("disabled",!1)},setNonMember:function(){this.state=TD.components.ListMember.STATE_NON_MEMBER,this.$addRemoveButton.removeClass("s-member s-checked s-working").addClass("s-nonmember"),this.$addRemoveButton.prop("disabled",!1)},setWorking:function(){this.state=TD.components.ListMember.STATE_WORKING,this.$addRemoveButton.removeClass("s-member s-nonmember s-checked").addClass("s-working"),this.$addRemoveButton.prop("disabled",!0)}}),TD.components.ListMemberList=TD.components.Base.extend(function(){this.$node=$(TD.ui.template.render("lists/member_list")),this.$list=this.$find(".js-member-list")}).methods({append:function(e){this.$list.append(e.$node)},prepend:function(e){this.$list.prepend(e.$node)}}),TD.components.CustomTimelines=TD.components.Base.extend(function(e,t,i){this.mode=i;var n,s,r=this,a={},o=TD.storage.clientController.client.getDefaultAccount();switch(this.owners=a,this.screenName=e,e?n="lists"===this.mode?TD.i("@{{screenName}}'s lists",this):TD.i("@{{screenName}}'s collections",this):"lists"===this.mode?n=TD.i("Your lists"):"customtimelines"===this.mode&&(n=TD.i("Your collections")),this.mode){case"lists":s=[{title:n,className:"js-my-custom-timelines"},{title:TD.i("Subscribed to"),className:"js-others-custom-timelines"}];break;case"customtimelines":s=[{title:n,className:"js-my-custom-timelines"}]}if(this.$node=$(TD.ui.template.render("open_column_list_multi_group",{groups:s})),this.$myTimelines=this.$find("ul.js-my-custom-timelines"),this.$otherTimelines=this.$find("ul.js-others-custom-timelines"),this.items=[],this.menuComponents=[],this.slug=t,this.listComparator=function(e,t){var i,n,s=TD.components.CustomTimelines;return a[e.user.id]&&!a[t.user.id]?-1:!a[e.user.id]&&a[t.user.id]?1:a[e.user.id]&&a[t.user.id]?(i=e.account.getKey()===o,n=t.account.getKey()===o,i===n?s.ownerNameComparator(e,t)||s.nameComparator(e,t):i?-1:1):s.nameComparator(e,t)||s.ownerNameComparator(e,t)},e){var c=TD.cache.twitterUsers.getByScreenName(e);c.addCallback(function(t){a[t.id]=!0;var i=TD.controller.clients.getClientsByService("twitter"),n=_.find(i,function(t){return t.oauth.account.getUsername().toLowerCase()===e.toLowerCase()?t:void 0});switch(r.mode){case"lists":n?(r._handleLists(TD.cache.lists.getListsFor(n.oauth.account.getKey())),r.bubbleEvent(TD.components.CustomTimelines.LOADED,r.items.length)):(n=TD.controller.clients.getPreferredClient("twitter"),n.getLists(e,function(e){r._handleLists(e),r.bubbleEvent(TD.components.CustomTimelines.LOADED,r.items.length)}));break;case"customtimelines":n=n||TD.controller.clients.getPreferredClient("twitter"),n.getCustomTimelines(t.id,null,function(e){r._handleLists(e),r.bubbleEvent(TD.components.CustomTimelines.LOADED,r.items.length)})}})}else{var l=TD.controller.clients.getClientsByService("twitter");_.each(l,function(e){a[e.oauth.account.getUserID()]=!0}),_.each(l,function(e){"lists"===r.mode?r._handleLists(TD.cache.lists.getListsFor(e.oauth.account.getKey())):"customtimelines"===r.mode&&r._handleLists(e.customTimelines)}),this.bubbleEvent(TD.components.CustomTimelines.LOADED,r.items.length)}}).statics({LOADED:"td-custom-timelines-loaded",nameComparator:function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return(i>n)-(n>i)},ownerNameComparator:function(e,t){var i=e.user.name.toLowerCase(),n=t.user.name.toLowerCase();return(i>n)-(n>i)}}).methods({_handleLists:function(e){var t=this;if(_.isArray(e)&&0!==e.length){this.items=this.items.concat(e),"lists"==this.mode&&this.items.sort(this.listComparator);var i={};this.items=_.select(this.items,function(e){var t=!i[e.id];return i[e.id]=!0,t}),_.each(this.menuComponents,function(e){e.destroy()});var n;this.menuComponents=_.map(this.items,function(e){var i=new TD.components.MenuItem;switch(this.mode){case"lists":i.list(e),t.owners[e.user.id]?(t.$myTimelines.append(i.$node),t.slug&&e.slug.toLowerCase()===t.slug.toLowerCase()&&e.user.screenName.toLowerCase()===t.screenName.toLowerCase()&&(n=i)):t.$otherTimelines.append(i.$node);break;case"customtimelines":i.customTimeline(e),t.$myTimelines.append(i.$node);var s=e.id.replace("custom-","");t.slug&&s.toLowerCase()===t.slug.toLowerCase()&&(n=i)}return i}.bind(this)),!n&&this.screenName&&this.menuComponents.length>0&&(n=this.menuComponents[0]),n&&_.defer(function(){n.select()})}}}),TD.components.SearchInput=TD.components.Base.extend(function(e){var t=this;this.promptText=_.isString(e)?e:TD.i("Enter a #hashtag or keyword"),this.$node=$(TD.ui.template.render("add_column_search_input",{searchInputClassName:"js-add-column-search-input",searchInputPlaceholder:this.promptText})),this.$inputBox=this.$find(".js-add-column-search-input"),this.$searchButton=this.$find(".js-perform-search"),this.$spinner=this.$find(".js-spinner"),this.$clearButton=this.$find(".js-clear-search"),this.$node.submit(function(e){t._search(),e.preventDefault()}),this.$clearButton.click(function(e){t._clear(),e.preventDefault()}),this.$searchButton.click(function(e){t._search(),e.preventDefault()}),this.boundCancelSearch=this.cancelSearch.bind(this),this.$inputBox.on("uiInputBlur",this.boundCancelSearch)}).methods({cancelSearch:function(){this.$inputBox.val("").blur()},_search:function(){var e=$.trim(this.$inputBox.val());""===e?this._clear():this.prevSearchTerm!==e&&(this.prevSearchTerm=e,this.bubbleEvent("td-search",this.$inputBox.val()))},_clear:function(){this.$inputBox.val(""),this.prevSearchTerm="",this.$inputBox.focus(),this.bubbleEvent("td-search-clear"),this.$clearButton.hide(),this.$searchButton.show()},showActivity:function(){this.$searchButton.hide(),this.$clearButton.hide(),this.$spinner.show()},hideActivity:function(){var e=""!==this.$inputBox.val();this.$clearButton.toggle(e),this.$searchButton.toggle(!e),this.$spinner.hide()},destroy:function(){$(document).off("uiSearchBlur",this.boundCancelSearch),this.$inputBox.unbind(),this.$node.remove()}}),TD.components.MenuItemBase=TD.components.Base.extend(function(){this.eventSubscriptions=[],this.selected=!1,this.eventSubscriptions.push($.subscribe(TD.components.MenuItemBase.GLOBAL_SELECT_EVENT,_.bind(this._handleSelectionEvent,this))),_.defer(_.bind(this._addClickHandler,this))}).statics({GLOBAL_SELECT_EVENT:"/menuitem/select",BUBBLE_SELECT_EVENT:"td-menuitem-select",deselectAll:function(){var e={target:null};TD.storage.notification.notify(this.GLOBAL_SELECT_EVENT,e)}}).methods({_handleSelectionEvent:function(e){this.selected=e.target===this,this.$node.toggleClass("selected",this.selected)},_addClickHandler:function(){var e=this;this.$node.bind("click",function(t){e.selected||e.select()})},select:function(){this.publishEvent(TD.components.MenuItemBase.GLOBAL_SELECT_EVENT,null),this.bubbleEvent(TD.components.MenuItemBase.BUBBLE_SELECT_EVENT)},deselect:function(){this.selected=!1,this.$node.removeClass("selected")},destroy:function(){_.each(this.eventSubscriptions,function(e){$.unsubscribe(e)}),this.$node.remove()}}),TD.components.MenuItem=TD.components.MenuItemBase.extend(function(){this.type=null}).statics({BASIC:"basic",SUBTITLE:"subtitle",PERSON:"person",LIST:"list"}).methods({basic:function(e){return this.type=TD.components.MenuItem.BASIC,this.title=e,this.$node=$(TD.ui.template.render("list_module_list_item",{title:this.title})),this},subtitle:function(e,t){this.type=TD.components.MenuItem.SUBTITLE,this.title=e,this.subtitle=t;var i={title:e,subtitle:t};return this.$node=$(TD.ui.template.render("list_module_subtitle_item",i)),this},selfAccount:function(e){this.type=TD.components.MenuItem.PERSON,this.account=e;var t=(e.getType(),{fullname:e.getName()||e.getUsername(),username:e.getUsername(),profileImageURL:e.getProfileImageURL()});return this.$node=$(TD.ui.template.render("list_module_account_item",t)),this},twitterUser:function(e){this.type=TD.components.MenuItem.PERSON,this.twitterUser=e;var t={fullname:e.name||e.screenName,username:e.screenName,profileImageURL:e.profileImageURL};return this.$node=$(TD.ui.template.render("list_module_account_item",t)),this},list:function(e){this.type=TD.components.MenuItem.LIST,this.list=e;var t={title:e.name,by:TD.i("by {{1}}",{1:e.user.name}),description:e.description,subtitle:TD.i("{{1}} members",{1:e.memberCount}),miniProfileURL:e.user.miniProfileImageURL(),isPrivate:e.isPrivate};return this.$node=$(TD.ui.template.render("list_module_twitter_list_item",t)),this},customTimeline:function(e){this.type=TD.components.MenuItem.LIST,this.list=e;var t={title:e.name,description:e.description};return this.$node=$(TD.ui.template.render("list_module_twitter_customtimeline_item",t)),this},dataminr:function(e){return this.type=TD.components.MenuItem.DATAMINR,this.watchlist=e,this.$node=$(TD.ui.template.render("list_module_dataminr_watchlist",e)),this}}),TD.components.SelfAccounts=TD.components.Base.extend(function(e){var t=TD.storage.accountController.getPostingAccounts();this.titleText=TD.i("Your Accounts"),this.service=e,this.items=[],this.$node=$(TD.ui.template.render("open_column_list_with_header",{title:this.titleText})),this.$list=this.$find(".js-list-container");for(var i=0;i<t.length;i++){var n=t[i],s=n.getType();if(!this.service||s===this.service){var r=(new TD.components.MenuItem).selfAccount(t[i]);this.items.push(r),this.$list.append(r.$node)}}}).methods({selectDefault:function(){for(var e,t=TD.storage.accountController.getDefault(),i=t.getKey(),n=0;n<this.items.length;n++)if(e=this.items[n],i===e.account.getKey()){e.select();break}},destroy:function(){_.each(this.items,function(e){e.destroy()}),this.$node.remove()}}),TD.components.ProfileAccount=TD.components.Base.extend(function(){this.titleText=TD.i("Profile Account"),this.screenName=null,this.twitterUser=null,this.$node=$(TD.ui.template.render("open_column_list_with_header",{title:this.titleText})),this.$list=this.$find(".js-list-container"),this.menuItem=null}).methods({setUser:function(e){this.screenName=e;var t=TD.cache.twitterUsers.getByScreenName(this.screenName);t.addCallbackWith(this,this._renderUser)},_renderUser:function(e){this.twitterUser=e,this.menuItem=(new TD.components.MenuItem).twitterUser(e),this.$list.append(this.menuItem.$node)},select:function(){this.menuItem.select()},destroy:function(){this.menuItem&&this.menuItem.destroy(),this.$node.remove()}}),TD.components.Trends=TD.components.Base.extend(function(){this.defaultWoeid=1,this.isTailoredTrendsOn=TD.decider.get("trends_tailored"),this.isRegionalTrendsOn=TD.decider.get("trends_regional"),this.withLocationSelector=this.isTailoredTrendsOn||this.isRegionalTrendsOn,this.$node=$(TD.ui.template.render("list_module_trends",{withLocationSelector:this.withLocationSelector})),this.$trendList=this.$find(".js-trend-list"),this.trendComponents=[],this.boundHandleChangeTrend=this.handleChangeTrend.bind(this),this.boundHandleChangeCity=this.handleChangeCity.bind(this),this.citiesByCountryWoeid=null,this.$trends=this.$find(".js-trends"),this.$trendsSelect=this.$find(".js-trends-select"),this.$trendsSelect.on("change",this.boundHandleChangeTrend),this.$cities=this.$find(".js-cities"),this.$citiesSelect=this.$find(".js-cities-select"),this.$citiesSelect.on("change",this.boundHandleChangeCity),this.account=TD.storage.accountController.getPreferredAccount("twitter"),this.client=TD.controller.clients.getClient(this.account.getKey());var e=this.preloadTrendSelectors();e.addCallback(this.handleChangeTrend.bind(this)),e.addErrback(function(e){this.$trendList.html(TD.i("There was a problem loading trends. Please try again.")),console.error(e.stack)}.bind(this))}).statics({PLACE_TYPE_TOWN:7,PLACE_TYPE_COUNTRY:12,PLACE_TYPE_WORLDWIDE:19}).methods({handleChangeTrend:function(){var e=this.$trendsSelect.val();try{var t=JSON.parse(e)}catch(i){t={type:"location",id:this.defaultWoeid}}if("tailored"===t.type)return this.showTailoredTrendsFor(t.id);var n=this.citiesByCountryWoeid[t.id];!n||n.length<=1?(this.$cities.addClass("is-hidden"),this.$citiesSelect.html("")):(this.$cities.removeClass("is-hidden"),this.$citiesSelect.html(n)),this.showTrendsForLocation(t.id)},handleChangeCity:function(){var e=this.$citiesSelect.val();this.showTrendsForLocation(e)},makeOptGroup:function(e,t){var i=document.createElement("optgroup");return i.label=e,$(i).attr(t||{})},makeOption:function(e,t){var i=document.createElement("option");return $(i).text(e).attr(t||{})},preloadTrendSelectors:function(){var e=this.makeOptGroup(TD.i("Regions"),{"data-group-id":"regions"});e.append(this.makeOption(TD.i("Worldwide"),{selected:!this.isTailoredTrendsOn,value:JSON.stringify({type:"location",id:this.defaultWoeid}),"data-region":"Worldwide"}));var t=TD.core.defer.succeed({trends:[e],citiesByCountryWoeid:{}});return this.isTailoredTrendsOn&&t.addCallback(this.preloadTailoredTrends.bind(this)),this.isRegionalTrendsOn&&t.addCallback(this.preloadRegionalTrends.bind(this)),t.addCallback(function(e){this.$trendsSelect.append(e.trends),this.withLocationSelector&&this.$trends.removeClass("is-hidden"),this.citiesByCountryWoeid=e.citiesByCountryWoeid}.bind(this)),t},preloadTailoredTrends:function(e){var t=this.makeOptGroup(TD.i("Tailored"),{"data-group-id":"tailored"}),i=TD.storage.accountController.getAccountsForService("twitter").sort(function(e,t){return TD.storage.accountController.getDefault()===e?-1:0}).map(function(e,t){return this.makeOption("@"+e.getUsername(),{value:JSON.stringify({type:"tailored",id:e.getUserID()}),selected:0===t})},this);return t.append(i),e.trends.unshift(t),e},showTailoredTrendsFor:function(e){this.resetTrends();var t=TD.storage.accountController.getAccountFromId(e),i=TD.controller.clients.getClient(t.getKey());i.getTailoredTrends(this.displayTrends.bind(this))},preloadRegionalTrends:function(e){var t=new TD.core.defer.Deferred;return this.client.getTrendLocations(function(i){var n=i.reduce(function(e,t){if(!this.canDisplay(t)||this.isWorldwide(t))return e;switch("undefined"==typeof e[t.country]&&(e[t.country]={$elem:null,$cities:[]}),t.placeType.code){case TD.components.Trends.PLACE_TYPE_COUNTRY:e[t.country].$elem=this.makeOption(t.country,{value:JSON.stringify({type:"location",id:t.woeid}),"data-region":t.country}),e[t.country].$cities.unshift(this.makeOption(TD.i("All cities"),{selected:!0,value:t.woeid}));break;case TD.components.Trends.PLACE_TYPE_TOWN:e[t.country].$cities.push(this.makeOption(t.name,{value:t.woeid}))}return e}.bind(this),{}),s=e.trends.filter(function(e){return"regions"===$(e).attr("data-group-id")})[0];return s?(s.append(Object.keys(n).sort().map(function(t){var i=n[t].$cities[0].val();return e.citiesByCountryWoeid[i]=n[t].$cities,n[t].$elem})),void t.callback(e)):t.callback(e)}.bind(this)),t},canDisplay:function(e){return-1!==[TD.components.Trends.PLACE_TYPE_WORLDWIDE,TD.components.Trends.PLACE_TYPE_TOWN,TD.components.Trends.PLACE_TYPE_COUNTRY].indexOf(e.placeType.code)},isWorldwide:function(e){return e.placeType.code===TD.components.Trends.PLACE_TYPE_WORLDWIDE},showTrendsForLocation:function(e){this.resetTrends(),this.client.getTrends(e,this.displayTrends.bind(this))},displayTrends:function(e){for(var t,e=e.trends,i=0;i<e.length;i++)e[i].promotedContent||(t=(new TD.components.MenuItem).basic(e[i].name),this.trendComponents.push(t),this.$trendList.append(t.$node))},resetTrends:function(){this.$trendList.empty(),this.destroyTrendComponents()},destroyTrendComponents:function(){this.trendComponents.forEach(function(e){e.destroy()}),this.trendComponents=[]},destroy:function(){this.destroyTrendComponents(),this.$trendsSelect.off("click",this.boundHandleChangeTrend),this.$citiesSelect.off("click",this.boundHandleChangeCity),this.$node.remove()}}),TD.components.TwitterUserSearch=TD.components.Base.extend(function(e,t,i){e||(e=TD.storage.accountController.getPreferredAccount("twitter")),e&&(this.listItemComponent=i,this.client=TD.controller.clients.getClient(e.getKey()),this.maxResults=t||TD.components.TwitterUserSearch.MAX_RESULTS,this.searchInput=new TD.components.SearchInput(TD.i("Enter a @name or full name")),this.items=[],this.resultsTitle=TD.i("Search results"),this.$searchResults=$(TD.ui.template.render("open_column_list_with_header",{title:this.resultsTitle})),this.$searchResults.hide(),this.$node=$(this.searchInput.$node),this.$node.append(this.$searchResults),this.$node.bind("td-search",_.bind(this._handleSearchSubmit,this)),this.$node.bind("td-search-clear",_.bind(this._handleSearchClear,this)),this.$searchResultsList=this.$find(".js-list-container"))}).statics({SEARCH_COMPLETE:"td-search-complete",MAX_RESULTS:4}).methods({_handleSearchSubmit:function(e,t){this.searchInput.showActivity();var i=t.data;this._search(i),e.stopPropagation()},_search:function(e){e&&this.client.userSearch(e,_.bind(this._handleUsers,this))},_handleSearchClear:function(e){_.each(this.items,function(e){e.destroy()}),this.$searchResults.hide()},_handleUsers:function(e){this.searchInput.hideActivity();var t,i,n;for(e=_.first(e,this.maxResults),this.items=[],this.$searchResultsList.empty(),t=0,i=e.length;i>t;t++)n=this.listItemComponent?new this.listItemComponent(e[t]):(new TD.components.MenuItem).twitterUser(e[t]),this.items.push(n),this.$searchResultsList.append(n.$node);this.$searchResults.show(),this.bubbleEvent(TD.components.TwitterUserSearch.SEARCH_COMPLETE)},detachResultsContainer:function(){return this.$searchResults.detach()},destroy:function(){_.each(this.items,function(e){e.destroy()}),this.supr()}}),
TD.components.SuggestedUsers=TD.components.TwitterUserSearch.extend(function(e,t,i,n){this.searchTerm=n,this._ready=!1,this._userData=null,this.resultsTitle=TD.i("Suggested"),$(".js-title",this.$searchResults).text(this.resultsTitle),this.$node=this.$searchResults,this.searchInput.$node.detach(),this._search(n)}).methods({_handleUsers:function(e){this._ready?e&&e.length>0&&(this.supr(e),this._userData=null):this._userData=e},render:function(){this._ready||(this._ready=!0,this._handleUsers(this._userData))}}),TD.components.TemporaryColumn=TD.components.Base.extend(function(){this.type=void 0,this.service=void 0,this.accountKey=void 0,this.metaString=void 0,this.column=null,this.$actionButton=null,this.destroyCallbacks=[]}).statics({DELETED_EVENT:"td-column-deleted"}).methods({_init:function(e){var t=TD.controller.columnManager.makeColumnFor(e);this.renderColumn(t)},renderColumn:function(e){this.column=e,e.visible=!0,e.temporary=!0,TD.controller.columnManager.add(this.column);var t=this.column.model,i={columnkey:t.getKey(),columntitle:this.column.getTitleHTML(),columniconclass:this.column.getIconClass(),isTemporary:!0};this.$node=$(TD.ui.template.render("column",i)),TD.util.isTouchDevice()&&TD.decider.get("touchdeck_tweet_controls_v3")&&this.$node.find(".js-chirp-container").addClass("is-touch-tweet-container"),this.$actionButton=this.$find(".js-action-header-button")},populate:function(){TD.ui.columns.setupColumn(this.column),TD.controller.feedScheduler.addColumn(this.column,!1)},makePermanent:function(){var e=this.column.clone();TD.controller.columnManager.addColumnToUI(e)},home:function(e){this._init({type:"home",service:"tweetdeck"})},me:function(){this._init({type:"me",service:"tweetdeck"})},inbox:function(){this._init({type:"privateMe",service:"tweetdeck"})},scheduled:function(){this._init({type:"scheduled",service:"tweetdeck"})},genericTwitter:function(e,t,i){var n,s,r="twitter",a=t.getKey(),o=i?i.id:void 0;i?(n=TD.controller.columnManager.NON_SELF_FEED_TYPE[e]||e,e===TD.controller.columnManager.MENTIONS&&(o="+@"+i.screenName),TD.cache.names.addScreenName(i.id,i.screenName)):(e===TD.controller.columnManager.MENTIONS&&(s=new TD.vo.SearchFilter,s.action.fromJSONObject({showMentions:!0})),e===TD.controller.columnManager.FOLLOWERS&&(s=new TD.vo.SearchFilter,s.action.fromJSONObject({showFollowers:!0})),n=TD.controller.columnManager.SELF_FEED_TYPE[e]||e),this._init({type:n,service:r,accountKey:a,metaString:o,searchFilter:s})},search:function(e,t){if(!t){var i=TD.storage.accountController.getPreferredAccount("twitter");t=i.getKey()}this._init({type:"search",service:"twitter",accountKey:t,metaString:e})},list:function(e){function t(){if(e.isOwnList()){var t=i.$find(".js-action-header-button");t.text(TD.i("Edit")),t.removeClass("is-hidden"),t.click(function(){i.bubbleEvent(TD.components.BaseModal.CLOSE_EVENT),new TD.components.ListMembers(e)})}}var i=this,n=e.user.account.getKey(),s=e.user.id+"/"+e.id;TD.cache.names.addScreenName(e.user.id,e.user.screenName),TD.cache.names.addListName(e.id,e.name),this._init({type:"list",service:"twitter",accountKey:n,metaString:s}),t();var r=$(document),a=function(e,n){i.column.model.privateState.key===n.columnKey&&t()};r.on("uiColumnTitleRefreshed",a),this.destroyCallbacks.push(r.off.bind(r,"uiColumnTitleRefreshed",a))},customTimeline:function(e){function t(){if(e.isOwnCustomTimeline()){var t=i.$find(".js-action-header-button");t.text(TD.i("Delete")),t.removeClass("is-hidden"),t.addClass("btn-negative"),t.click(function(){var e=_.uniqueId(),t={id:e,title:TD.i("Delete"),message:TD.i("Are you sure you want to delete this collection?"),okLabel:TD.i("Delete"),cancelLabel:TD.i("Cancel")},n=function(t,n){n.id===e&&($(document).off("uiConfirmationAction"),n.result&&i.column.deleteCustomTimeline(function(){_.defer(function(){i.bubbleEvent(TD.components.TemporaryColumn.DELETED_EVENT)})}))};r.on("uiConfirmationAction",n),i.destroyCallbacks.push(r.off.bind(r,"uiConfirmationAction",n)),i.$node.trigger("uiShowConfirmationDialog",t)})}}var i=this,n=e.account.getKey(),s=e.user.id+"/"+e.id;TD.cache.names.addCustomTimelineName(e.id,e.name),TD.cache.names.addScreenName(e.user.id,e.user.screenName),this._init({type:TD.util.columnUtils.feedTypes.CUSTOMTIMELINE,service:"twitter",accountKey:n,metaString:s}),t();var r=$(document),a=function(e,n){i.column.model.privateState.key===n.columnKey&&t()};$(document).on("uiColumnTitleRefreshed",a),this.destroyCallbacks.push(r.off.bind(r,"uiColumnTitleRefreshed",a))},dataminr:function(e,t){this._init({type:"dataminr",service:"twitter",accountKey:t,metadata:{watchlist:e}})},destroy:function(){this.column&&this.column.temporary&&TD.controller.columnManager.removeFromAppLayer(this.column.model.getKey()),this.destroyCallbacks.forEach(function(e){e.call(this)}.bind(this)),this.$node.remove()}}),TD.components.ScheduledDatePicker=TD.components.Base.extend(function(e){var t=this;this.$node=$(TD.ui.template.render("compose/schedule")),e.append(this.$node),this.$minutes=$("#scheduled-minute"),this.$hours=$("#scheduled-hour"),this.$datepicker=$("#datepicker"),this.$nextMonth=$("#next-month"),this.$prevMonth=$("#prev-month"),this.$removeDate=$(".js-remove",this.$node),this.$amToggle=$("#amPm"),this.$hours.bind("change",function(){t._refreshDate(),t.publishDateChanged()}),this.$minutes.bind("change",function(){var e=$(this);e.val(("00"+e.val()).slice(-2)),t._refreshDate(),t.publishDateChanged()}),this.$datepicker=this.$datepicker.dateinput({onHide:function(){return!1},change:function(){t._refreshDate(),t.publishDateChanged()},min:-1}),t.datePickerData=this.$datepicker.data("dateinput").show(),this.$nextMonth.bind("click",function(e){t.datePickerData.addMonth(1)}),this.$prevMonth.bind("click",function(e){t.datePickerData.addMonth(-1)}),this.$removeDate.bind("click",function(e){t.publishRemoval()}),this.$amToggle.bind("click",function(e){var i=$(this),n=i.data("value");t._setAmPm(!n)}),t.setDate(new Date)}).methods({_refreshDate:function(){var e=this.$hours.val(),t=Number(e)%12,i=Number(this.$minutes.val());if(!_.isNaN(t)&&!_.isNaN(i)){var n=new Date(this.datePickerData.getValue().getTime()),s=this.$amToggle.data("value");n.setHours(s?t+12:t),n.setMinutes(i),this.date=n,e>12?(this.$hours.val(t),this._setAmPm(!0)):"0"===e&&(this.$hours.val(12),this._setAmPm(!1))}},_setAmPm:function(e){e?(this.$amToggle.text(TD.i("PM")),this.$amToggle.data("value",!0)):(this.$amToggle.text(TD.i("AM")),this.$amToggle.data("value",!1)),this._refreshDate(),this.publishDateChanged()},setDate:function(e){if(e){var t=e.getHours()%12||12,i=e.getHours()>11,n=(TD.i(i?"PM":"AM"),e.getMinutes());this._setAmPm(i),this.datePickerData.setValue(e.getFullYear(),e.getMonth(),e.getDate()),this.$hours.val(t),this.$minutes.val(("00"+n).slice(-2))}this.date=e,this.publishDateChanged()},getDate:function(){return this.date},publishDateChanged:function(e){$.publish("/change/date",[void 0!==e?e:this.getDate()])},publishRemoval:function(){this.date=null,this.publishDateChanged(null),$.publish("/removed/date")}}),TD.components.DetailView=TD.components.Base.extend(function(e,t){this.initialised=!1,this.column=e,this.$column=t,this.$detailContainer=$(".js-column-detail",this.$column),this.$columnsContainer=$("#container"),this.$column.trigger("uiDetailViewOpening",{column:this.column}),this.$column.on("click",".js-column-back",this._handleHeaderClick.bind(this)),this._render(),this.$detailContainer.html(this.$node),this.column.temporary||this.$node.trigger("uiCloseModal"),this.$holder=$(".js-detail-container",this.$column),this.$header=$(".js-column-header",this.$column),TD.ui.columns.refreshTitle(this.column)}).statics({RETWEETER_COUNT:8}).methods({_render:function(){throw"DetailView._render not implemented"},_handleHeaderClick:function(e){this.destroy()},changed:function(e){},deleted:function(e){e.id===this.chirp.id&&this.destroy()},destroy:function(e){var t=this.supr.bind(this);this.$detailContainer.trigger("uiDetailViewClosing"),this.$column.off("click",".js-column-back"),this.$column.trigger("uiDetailViewClosed",{column:this.column}),TD.ui.main.TRANSITION_END_EVENTS?this.$column.one(TD.ui.main.TRANSITION_END_EVENTS,function(){e&&e(),t()}):(e&&e(),this.supr())}}),TD.components.TweetDetailView=TD.components.DetailView.extend(function(e,t){}).statics({CARD_CONTAINER:".js-cards-container",MEDIA_CONTAINER:".js-tweet-media",TWEET_STAT:".js-tweet-stat",RENDER_OPTIONS:{headerClass:"js-detail-header",headerAction:"resetToTopColumn",headerLinkClass:"js-column-back"}}).methods({_render:function(e){var t=$.extend({},TD.components.TweetDetailView.RENDER_OPTIONS,e);this.$node=$(TD.ui.template.render("status/tweet_detail_wrapper",t))},showChirp:function(e,t){if(this.chirp=e,this.parentChirp=t,this._renderChirp(),!e.cards&&e.entities&&e.entities.urls&&e.entities.urls.length){var i=TD.controller.clients.getClient(e.account.getKey());i.show(e.id,_.bind(this._showCardsForChirp,this),_.bind(this._chirpRetrievalError,this))}else this._showCardsForChirp(e);TD.ui.Column.identifyInlinedLinks(this.$node)},_showCardsForChirp:function(e){var t=TD.settings.getDisplaySensitiveMedia();if(e.cards){e.cards.isPossiblySensitive=e.possiblySensitive&&!t;var i=TD.ui.template.render("cards/card_layouts",e.cards);this.$find(TD.components.TweetDetailView.CARD_CONTAINER).html(i)}this.showMedia(e)},showMedia:function(e){if(e.getMedia()){var t=TD.settings.getDisplaySensitiveMedia(),i=e.possiblySensitive&&!t;e.getMedia().forEach(function(e){e.isPossiblySensitive=i});var n=TD.ui.template.render("status/tweet_detail_media",$.extend({},e,{isPossiblySensitive:i}));this.$find(TD.components.TweetDetailView.MEDIA_CONTAINER).html(n)}},_chirpRetrievalError:function(){},_renderChirp:function(e){var t=this.column.isOwnCustomTimeline(),i=!this.column.temporary&&!t;this.$tweetDetail=$(TD.ui.template.render("status/tweet_detail",{withDragHandle:i&&!this.chirp.getMainUser().isProtected,withRemove:t,chirp:this.chirp})),this.$tweetDetail.find(".tweet-location-search").on("click",function(t){return $(document).trigger("uiPerformSearch",{query:'near:"'+e.getLocationFullName()+'"'}),!1}),this.$tweetDetail.find(".js-detail-view-inline-text").html("Reply to "+this.chirp.getReplyUsers().join(" ")),this.$find(".js-tweet-detail").html(this.$tweetDetail);var n=this.$find(".spn-loading"),s=this.$header,r=this.$tweetDetail.find(".js-translate-call-to-action"),a=this.column.getMediaPreviewSize();a!==TD.vo.Column.MEDIA_PREVIEW_OFF&&(a=TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL),this.replies=new TD.components.InReplyTo(this.chirp,this.$detailContainer,a,i),this.retweeters=new TD.components.Retweeters(this.chirp,TD.components.DetailView.RETWEETER_COUNT),this.repliesTo=new TD.components.RepliesTo(this.chirp,a,i),this.$find(".js-inreplyto").replaceWith(this.replies.$node),this.$find(".js-tweet-stats").append(this.retweeters.$node),this.$find(".js-tweet-replies").append(this.repliesTo.$node),this._boundShowSocialProof=this.showSocialProof.bind(this),this.$column.on("click",TD.components.TweetDetailView.TWEET_STAT,this._boundShowSocialProof),this.replies.$node.bind(TD.components.InReplyTo.BEGIN,function(){n.show()}),this.replies.$node.bind(TD.components.InReplyTo.END,function(){s.addClass("gradient-top"),n.hide()}),r.on("click",function(){this.chirp.translate()}.bind(this)),this.initialised=!0,this.$tweetDetail.trigger("uiDetailViewActive",{$chirp:this.$tweetDetail,chirp:this.chirp,parentChirp:this.parentChirp}),TD.controller.stats.tweetImpression(this.chirp.getScribeItemData())},showSocialProof:function(e){var t=$(e.target).closest(TD.components.TweetDetailView.TWEET_STAT).data("type");this.$column.trigger("uiShowSocialProof",{type:t,tweetSummary:this.retweeters.tweetSummary,$chirp:this.$tweetDetail,chirp:this.chirp,parentChirp:this.parentChirp})},destroy:function(){this.$column.off("click",this._boundShowSocialProof);var e=function(){this.initialised&&(this.replies.destroy(),this.retweeters.destroy(),this.repliesTo.destroy())}.bind(this);this.supr(e)},findChirp:function(e){return this.initialised?this.replies.findChirp(e)||this.repliesTo.findChirp(e):void 0},getMostInteresting$Chirp:function(){return this.$tweetDetail}}),TD.components.ConversationDetailView=TD.components.DetailView.extend(function(e,t){t.on("uiColumnTitleRefreshed",this.handleUiColumnTitleRefreshed.bind(this))}).methods({_render:function(){this.$node=$(TD.ui.template.render("status/message_wrapper",{headerClass:"js-detail-header",headerAction:"resetToTopColumn",headerLinkClass:"js-column-back"}))},_renderChirp:function(){var e=this.chirp.renderThread();this.$find(".js-message-detail").html(e),this.initialised=!0,this.chirp.markAsRead(),this.$node.trigger("uiDetailViewActive",{$chirp:this.getMostInteresting$Chirp(),chirp:this.chirp,parentChirp:this.parentChirp});var t=this.chirp.isOneToOne()?"dm:ui:conversation:view:one-to-one":"dm:ui:conversation:view:group-dm";$(document).trigger("metric",{key:t})},showChirp:function(e,t){this.chirp=e,this.parentChirp=t,this.replyBar=new TD.components.ReplyBar(this.chirp),this.$find(".js-message-box").replaceWith(this.replyBar.$node),this._renderChirp(),TD.ui.columns.refreshTitle(this.column,this.chirp),this.$column.trigger("uiColumnTitleRefreshed",{columnKey:this.column.model.getKey()});var i=this.chirp.updateConversation();return i.addCallback(function(e){return e.length?e[0]:void 0}),i.addCallback(this.changed.bind(this)),i},changed:function(e){if(this.initialised&&e&&e.id===this.chirp.id){var t=e.renderThread();this.$find(".js-message-detail").html(t),TD.ui.columns.refreshTitle(this.column,this.chirp)}},findChirp:function(e){return this.initialised?this.chirp.messageIndex[e]:void 0},getMostInteresting$Chirp:function(){return this.$find(".js-message-detail .js-stream-item").first()},handleUiColumnTitleRefreshed:function(e,t){if(this.$column.find(".js-tooltip-target").tooltip("destroy"),t.columnKey&&this.chirp.participants.length>1){var i=TD.emoji.theme;TD.emoji.theme="dark";var n=TD.util.transform(this.chirp.name||"");TD.emoji.theme=i;var s=TD.ui.template.render("participants_tooltip",{title:n,participants:this.chirp.participants});this.$column.find(".js-tooltip-target").tooltip({container:this.$column.find(".js-detail-header"),placement:function(e){var t=this.$column.find(".js-detail-header");return{top:t.position().top+t.height(),left:Math.round((t.width()-$(e).width())/2),placement:"bottom"}}.bind(this),html:!0,title:s,delay:{show:500,hide:100}})}},destroy:function(){var e=function(){this.initialised&&(this.replyBar.destroy(),this.chirp.markAsRead())}.bind(this);this.supr(e)}}),TD.components.DataminrDetailView=TD.components.TweetDetailView.extend(function(e,t){}).statics({HEADER_CONTAINER:".js-dataminr-header",FOOTER_CONTAINER:".js-dataminr-footer",SOURCE_PROFILE_CONTAINER:".js-source-profile",SKIP_TO_REPLIES:".js-skip-to-replies",REPLIES_HEADER:".js-replies-header",FOLLOW_FROM_SELECTOR:".js-action-follow",FOLLOW_STATE_SELECTOR:".prf-follow-status",CLOSE_EVENT:"uiDataminrDetailViewClosed"}).methods({_render:function(){return this.supr({withDataminr:!0})},showChirp:function(e,t){this._dataminrConversationSubscription=$.subscribe("/tweets/conversation/"+e.id,this._handleDataminrConversation.bind(this)),this.supr(e,t),this.addDataminrComponents(e)},addDataminrComponents:function(e){e.dataminr&&(this._showDataminrHeader(e.dataminr),this._showDataminrFooter(e.dataminr),this._showDataminrSourceProfile(e.user,e.account))},_showDataminrFooter:function(e){var t=TD.ui.template.render("status/dataminr_footer",e);this.$find(TD.components.DataminrDetailView.FOOTER_CONTAINER).html(t)},_showDataminrHeader:function(e){var t=TD.ui.template.render("status/dataminr_header",e);this.$find(TD.components.DataminrDetailView.HEADER_CONTAINER).html(t)},_showDataminrSourceProfile:function(e,t){var i=TD.ui.template.render("profile/profile_full",e);this.$find(TD.components.DataminrDetailView.SOURCE_PROFILE_CONTAINER).html(i);var n=require("ui/follow_state"),s=require("ui/relationship"),r={account:t,twitterUser:e,closeEvent:TD.components.DataminrDetailView.CLOSE_EVENT};s.attachTo(this.$find(TD.components.DataminrDetailView.FOLLOW_FROM_SELECTOR),r),n.attachTo(this.$find(TD.components.DataminrDetailView.FOLLOW_STATE_SELECTOR),r)},_handleDataminrConversation:function(e){e.descendants&&e.descendants.length>0&&(this.$find(TD.components.DataminrDetailView.SKIP_TO_REPLIES).removeClass("is-hidden"),this.$find(TD.components.DataminrDetailView.REPLIES_HEADER).removeClass("is-hidden"))},destroy:function(){this.$find(TD.components.DataminrDetailView.FOLLOW_STATE_SELECTOR).trigger(TD.components.DataminrDetailView.CLOSE_EVENT),$.unsubscribe(this._dataminrConversationSubscription),this.supr()}}),TD.components.ReplyBar=TD.components.Base.extend(function(e){if(e&&e.postComment){switch(this._boundHandleGlobalKeydown=this._handleGlobalKeydown.bind(this),this._boundSend=this.send.bind(this),this._boundPopInlineToDocked=this.popInlineToDocked.bind(this),this._boundAddImage=this.addImage.bind(this),this._boundHandleDataTweetSent=this._handleDataTweetSent.bind(this),this._boundHandleDataTweetError=this._handleDataTweetError.bind(this),this.$node=$(TD.ui.template.render("status/tweet_detail_replybar",{from:e.account.getUsername(),avatarURL:e.account.getProfileImageURL()})),this.chirp=e,this.$inputBox=this.$find(".js-reply-tweetbox"),this.$charCount=this.$find(".js-reply-charcount"),this.$sendButton=this.$find(".js-send"),this.$popoutButton=this.$find(".js-reply-popout"),this.$addImageButton=this.$find(".js-reply-add-image"),e.account.getType()){case"twitter":this.charLimit=140}this.$sendButton.bind("click",this._boundSend),this.$popoutButton.bind("click",this._boundPopInlineToDocked),this.$addImageButton.bind("click",this._boundAddImage),$(document).on("dataTweetSent",this._boundHandleDataTweetSent),$(document).on("dataTweetError",this._boundHandleDataTweetError),$(document).on("dataDmSent",this._boundHandleDataTweetSent),$(document).on("dataDmError",this._boundHandleDataTweetError),this._reset()}}).statics({ACTIVITY_EVENTS:"click change focus blur input keydown keypress keyup mousedown mouseup paste",RESET_EVENT:"td-reset",REPLYING_EVENT:"td-replying",OVER_CHAR_COUNT_CLASS:"over-char-count"}).methods({_triggerMetric:function(e){$(document).trigger("metric",{key:"dm:ui:conversation:reply:"+e})},_updateCharCount:function(){var e=twttr.txt.getTweetLength(this.$inputBox.val()),t=this.charLimit-e;0>t||t===this.charLimit?this.$sendButton.prop("disabled",!0):this.$sendButton.prop("disabled",!1),0>t?this.$charCount.addClass(TD.components.ReplyBar.OVER_CHAR_COUNT_CLASS):this.$charCount.removeClass(TD.components.ReplyBar.OVER_CHAR_COUNT_CLASS),this.$charCount.val(t)},_reset:function(){var e="";if(this.chirp instanceof TD.services.TwitterStatus){var t=this.chirp.getMainTweet();e=TD.i("Reply to @{{1}}",{1:t.user.screenName})}else this.chirp instanceof TD.services.TwitterConversation&&(e=TD.i("Reply from @{{1}}",{1:this.chirp.account.getUsername()}));this.$node.removeClass("s-replying"),this.$inputBox.val(e),this.$inputBox.blur().prop("disabled",!1),this.$sendButton.prop("disabled",!1),this.$inputBox.bind(TD.components.ReplyBar.ACTIVITY_EVENTS,_.bind(this._handleActivity,this)),this.bubbleEvent(TD.components.ReplyBar.RESET_EVENT,null),$(window).unbind("keydown",this._boundHandleGlobalKeydown)},_handleActivity:function(e){var t=this;this.$inputBox.unbind(),t.bubbleEvent(TD.components.ReplyBar.REPLYING_EVENT,null),this.$node.addClass("s-replying"),this._triggerMetric("active");var i="",n=[];this.chirp instanceof TD.services.TwitterStatus&&(n=TD.util.getReplyUsers(this.chirp)),n.length>0&&(i=n.join(" ")+" "),this.$inputBox.val(i),this._updateCharCount();var s=i.length,r=i.length;n.length>0&&(s=n[0].length+1),this.$inputBox.bind("keydown change",_.bind(this._handleKeydown,this)),_.defer(function(){t.$inputBox[0].setSelectionRange(s,r)}),this.$inputBox.bind("cut paste",_.bind(this._handleCutPaste,this)),this.$inputBox.bind("keyup",_.bind(this._updateCharCount,this))},_handleCutPaste:function(e){_.defer(_.bind(this._updateCharCount,this))},_handleGlobalKeydown:function(e){e.which===TD.constants.keyCodes.escape&&this._reset()},_handleKeydown:function(e){switch(this._updateCharCount(),e.charCode||e.keyCode){case 10:case 13:(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.send());break;case TD.constants.keyCodes.escape:this.$inputBox.blur(),$(window).bind("keydown",this._boundHandleGlobalKeydown)}},popInlineToDocked:function(){var e={type:"message",text:this.$inputBox.val(),from:[TD.storage.Account.generateKeyFor("twitter",this.chirp.account.getUserID())]};this.chirp.chirpType===TD.services.ChirpBase.MESSAGE_THREAD?e.conversationId=this.chirp.conversationId:e.messageRecipients=[{screenName:this.chirp.getMainUser().screenName}],this._triggerMetric("popout"),$(document).trigger("uiComposeTweet",e),this._reset()},addImage:function(){this._triggerMetric("image:add"),this._boundPopInlineToDocked(),$(document).trigger("uiComposeAddImageClick")},send:function(){var e,t,i=this.$inputBox.val();i&&(this.$sendButton.prop("disabled",!0),this.$inputBox.prop("disabled",!0),this.$inputBox.blur(),this.progressKey=TD.controller.progressIndicator.addTask(TD.i("Sending…")),this.currentRequestId=_.uniqueId("sendTweet"),this._triggerMetric("send"),t={type:"message",text:i,from:[this.chirp.account.getKey()],accountKey:this.chirp.account.getKey(),requestId:this.currentRequestId,messageType:this.chirp.type},e="uiSendDm",t.conversationId=this.chirp.conversationId,t.isReplyBar=!0,$(document).trigger(e,t))},_handleDataTweetSent:function(e,t){this.currentRequestId&&t.request.requestId===this.currentRequestId&&(TD.controller.progressIndicator.taskComplete(this.progressKey),this._reset())},_handleDataTweetError:function(e,t){this.currentRequestId&&t.request.requestId===this.currentRequestId&&(TD.controller.progressIndicator.taskFailed(this.progressKey,t.response.errors[0].message),this.$sendButton.prop("disabled",!1),this.$inputBox.prop("disabled",!1),this.$inputBox.focus())},destroy:function(){$(document).off("dataTweetSent",this._boundHandleDataTweetSent),$(document).off("dataTweetError",this._boundHandleDataTweetError),$(document).off("dataDmSent",this._boundHandleDataTweetSent),$(document).off("dataDmError",this._boundHandleDataTweetError)}}),TD.components.MediaGallery=TD.components.BaseModal.extend(function(e,t,i,n){var s=this;this.chirp=e,this.column=n,this.clickedLink=t,this.clickedMediaEntityId=i,this.$node=$(TD.ui.template.render("media/media_gallery")),this.$closeButton=this.$find(".js-dismiss"),this.$prevButton=this.$find("#media-gallery-prev"),this.$nextButton=this.$find("#media-gallery-next"),this.$embed=this.$find(".js-mediaembed"),this.$tweet=this.$find(".med-tweet"),this.$mainframe=this.$find(".js-embeditem"),this._sizeMedia=this._sizeMedia.bind(this),this.sizeMediaInterval=setInterval(this._sizeMedia,300),this.$closeButton.bind("click",function(){s.destroy()}),this.$prevButton.bind("click",function(){s._prev()}),this.$nextButton.bind("click",function(){s._next()}),this._loadTweet(),this.setAndShowContainer($("#open-modal"),!1),TD.util.isTouchDevice()&&TD.decider.get("touchdeck_tweet_controls_v3")&&this.$node.find(".js-med-tweet").addClass("is-touch-tweet-container"),e.hasMedia()||e.cards?(this.media=e.getMedia().concat(e.getCardsForGallery()),this._setupEmbeds(),e.scribeMediaImpression()):(TD.util.openURL(t),this.destroy())}).statics({MEDIA_FLAG_NSFW:".js-media-flag-nsfw",MEDIA_FLAGGED_NSFW:".js-media-flagged-nsfw",HIDDEN_CLASS:"is-hidden"}).methods({_prev:function(){var e=_.indexOf(this.media,this.currentMedia);0===e&&(e=this.embeds.length),this.currentMedia=this.embeds[e-1],this._renderEmbed()},_next:function(){var e=_.indexOf(this.media,this.currentMedia);e==this.media.length-1&&(e=-1),this.currentMedia=this.media[e+1],this._renderEmbed()},_setupEmbeds:function(){if(this.media&&0!==this.media.length){var e=this;this.currentMedia=this.media[0],this.clickedLink&&_.each(this.media,function(t){(e.clickedMediaEntityId&&t.mediaId===e.clickedMediaEntityId||!e.clickedMediaEntityId&&t.url===e.clickedLink)&&(e.currentMedia=t)}),this._renderEmbed()}},_loadTweet:function(){var e=this;this.$tweet.append(this.chirp.renderInMediaGallery()),this.$tweet.bind("click",function(t){$.publish("chirp/click",[t,e.chirp,e.column])})},_sizeMedia:function(){var e=$("img",this.$mainframe),t=this.$embed.outerHeight(),i=this.$mainframe.height(),n=Math.max(0,e.height()-(t-i));e.css({"max-width":this.$mainframe.width()+"px","max-height":n+"px"})},_fadeIn:function(){this.$mainframe.addClass("is-loaded"),this.$embed.fadeTo("fast",1)},_renderEmbed:function(){var e,t=this.currentMedia;e=t.renderGallery(),this.$embed.html(e),this.$embed.append(TD.ui.template.render("text/gallery_original_link",t)),t.needsSecureUrl||t.isScheduled||this.$embed.append(TD.ui.template.render("text/gallery_flag_media",{flagged:t.flaggedNSFW})),t.needsSecureUrl&&$(document).trigger("uiNeedsSecureImageUrl",{accountKey:this.chirp.account.getKey(),url:t.large()});var i=$("img",this.$embed);0===i.length?_.delay(function(){this._fadeIn(),this._sizeMedia()}.bind(this),1e3):i.load(function(){i.attr("data-maxwidth",i.width()),i.attr("data-maxheight",i.height()),this._sizeMedia(),this._fadeIn()}.bind(this)),this.$find(TD.components.MediaGallery.MEDIA_FLAG_NSFW).click(function(e){var i;t.flaggedNSFW=!0,this.$find(TD.components.MediaGallery.MEDIA_FLAG_NSFW).addClass(TD.components.MediaGallery.HIDDEN_CLASS),this.$find(TD.components.MediaGallery.MEDIA_FLAGGED_NSFW).removeClass(TD.components.MediaGallery.HIDDEN_CLASS),i=TD.controller.clients.getClient(this.chirp.account.getKey()),i.flagTweet(this.chirp.id,function(){},function(){var e=TD.i("Problem flagging media. Please try again");TD.controller.progressIndicator.addMessage(e),this.$find(TD.components.MediaGallery.MEDIA_FLAG_NSFW).removeClass(TD.components.MediaGallery.HIDDEN_CLASS),this.$find(TD.components.MediaGallery.MEDIA_FLAGGED_NSFW).addClass(TD.components.MediaGallery.HIDDEN_CLASS)})}.bind(this)),this.media.length>1?(this.$prevButton.removeClass(TD.components.MediaGallery.HIDDEN_CLASS),this.$nextButton.removeClass(TD.components.MediaGallery.HIDDEN_CLASS),this.$mainframe.addClass("s-shorter"),this.$tweet.find(".js-media").show()):(this.$prevButton.addClass(TD.components.MediaGallery.HIDDEN_CLASS),this.$nextButton.addClass(TD.components.MediaGallery.HIDDEN_CLASS),this.$tweet.find(".js-media").hide())},destroy:function(){this.$node.trigger("uiMediaGalleryClosing"),$("#open-modal").hide(),clearInterval(this.sizeMediaInterval),this.supr()}}),TD.components.FollowFrom=TD.components.Base.extend(function(e,t){var i=this;this.userToFollow=e,this.account=t,this.isSingleAccount=1===TD.storage.accountController.getAccountsForService("twitter").length,this.client=TD.controller.clients.getClient(t.getKey()),this.$node=$(TD.ui.template.render("actions/follow_from",this)),this.$followButton=this.$find(".js-follow-button").click(_.bind(this.handleClick,i)),this.$followButtonHolder=this.$find(".js-action-follow"),this.state="stranger",t.getUserID()==e.id?(this.state="me",this.updateButtonState()):this.client.showFriendship(t.getUserID(),e.id,null,_.bind(this.handleFollowInfoResponse,this),_.bind(this.handleFollowInfoError,this)),this.subscriptions=[$.subscribe("/user/"+this.userToFollow.screenName+"/block",_.bind(this._handleBlock,this)),$.subscribe("/user/"+this.userToFollow.screenName+"/blocked",_.bind(this._handleBlock,this))]}).methods({_handleBlock:function(e){e.getKey()===this.account.getKey()&&(this.state="blocked",this.updateButtonState())},handleFollowInfoResponse:function(e){this.state=e.relationship.source.blocking===!0?"blocked":e.relationship.source.following===!0?"following":"stranger",this.updateButtonState()},handleFollowInfoError:function(e){this.following=!1,this.blocking=!1,this.updateButtonState()},handleClick:function(e){var t=this.account;if(!this.$followButton.prop("disabled")){switch(this.state){case"me":TD.util.openURL("https://twitter.com/settings/profile");break;case"blocked":this.userToFollow.unblock(t,null,_.bind(this.unblockError,this)),this.state="stranger";break;case"pending":case"following":this.userToFollow.unfollow(t,null,_.bind(this.unfollowError,this)),this.state="stranger";break;case"stranger":this.userToFollow.follow(t,_.bind(this.followResponse,this),_.bind(this.followError,this)),this.state="following"}this.updateButtonState()}},followError:function(){this.state="stranger",this.updateButtonState()},unfollowError:function(){this.state="following",this.updateButtonState()},unblockError:function(){this.state="blocked",this.updateButtonState()},followResponse:function(e){e.isProtected&&(this.state="pending",this.updateButtonState())},updateButtonState:function(){switch(this.$followButton.prop("disabled",!1),this.$followButtonHolder.removeClass("s-not-following s-following s-pending s-blocking"),this.state){case"me":this.$followButtonHolder.addClass("s-thats-you");break;case"blocked":this.$followButtonHolder.addClass("s-blocking");break;case"pending":this.$followButtonHolder.addClass("s-pending");break;case"following":this.$followButtonHolder.addClass("s-following");break;case"stranger":this.$followButtonHolder.addClass("s-not-following")}},destroy:function(){_.each(this.subscriptions,function(e){$.unsubscribe(e)}),this.supr()}}),TD.components.AddToCustomTimelineDialog=TD.components.BaseModal.extend(function(e){var t=TD.storage.accountController.getAccountsForService("twitter");return this.myCustomTimelines=[],this.tweetToAdd=e,this.tweetToAdd.user.isProtected?void this.destroy():(t.forEach(function(t){var i=TD.controller.clients.getClient(t.getKey());this.myCustomTimelines=this.myCustomTimelines.concat(i.customTimelines),i.getCustomTimelines(null,e.id,function(e){for(var t=0;t<e.length;t++)this.$find('[data-id="'+e[t].id+'"]').prop("checked",!0)}.bind(this))}.bind(this)),this.myCustomTimelines.sort(function(e,t){return e.name.toLowerCase()>t.name.toLowerCase()}),this.$node.removeClass("s-short").addClass("s-fluid s-wide cmp"),this.$title.html(" "+TD.i("Include Tweet in:")),this.$menuContainer.html(TD.ui.template.render("actions/add_to_customtimeline_dialog",this)).addClass("with-scroll scroll-v scroll-alt").toggleClass("scroll-styled-v",TD.globalRenderOptions.styledScrollbar),this.$checkboxes=this.$find(".js-mdl-content input").click(_.bind(this._changeSubscription,this)),$(".js-dismiss",this.$node).click(_.bind(this.destroy,this)),$("#actions-modal").html(this.$node).show(),this.$checkboxes.first().focus(),this.handleHasCustomTimelines=function(e,t){t.enabled||this.destroy()}.bind(this),$(document).on("uiFeatureCustomTimelines",this.handleHasCustomTimelines),void $(document).trigger("uiNeedsFeatureCustomTimelines"))}).methods({_render:function(){return $(TD.ui.template.render("short_modal",{title:TD.i("Your collections"),hasDoneButton:!0}))},_changeSubscription:function(e){var t=$(e.target),i=t.attr("data-id"),n="checked"===t.attr("checked"),s=t.attr("data-account"),r=n?"uiAddTweetToCustomTimeline":"uiRemoveTweetFromCustomTimeline";$(document).trigger(r,{id:i,account:s,tweetId:this.tweetToAdd.id})},destroy:function(e){$(document).off("uiHasCustomTimelines",this.handleHasCustomTimelines),this.$node.remove(),$("#actions-modal").hide(),e&&e.preventDefault(),this.supr()}}),TD.components.AddToListsDialog=TD.components.BaseModal.extend(function(e){this.myLists=[],this.userToAdd=e,this._setupAccountHandler(),this._requestAccountData(),this.$node.removeClass("s-short").addClass("s-fluid s-wide cmp"),this.$title.html(" "+TD.i("Include {{>text/user_link_screenname}} in:",e)),this.$menuContainer.html(TD.ui.template.render("actions/add_to_list_dialog",this)).addClass("with-scroll scroll-v scroll-alt").toggleClass("scroll-styled-v",TD.globalRenderOptions.styledScrollbar),this.$find(".js-mdl-content input").click(this._changeSubscription.bind(this)),this.$createListButton=this.$find(".js-create-list"),this.$createListButton.click(_.bind(this._createList,this)),
this.setAndShowContainer($("#actions-modal"))}).methods({_render:function(){return $(TD.ui.template.render("short_modal",{title:TD.i("Your lists"),hasDoneButton:!0}))},_changeSubscription:function(e){var t=$(e.target),i=t.attr("id"),n=t.prop("checked"),s=t.attr("data-account"),r=TD.controller.clients.getClient(s),a=TD.storage.Feed.generateKeyFor(s,"list",{listId:i}),o=TD.controller.feedManager.getPoller(a),c=this;n?r.addUserToList(i,this.userToAdd.screenName,function(){o&&_.delay(function(){o.refresh({reset:!0})},1e3)}):r.removeUserFromList(i,this.userToAdd.screenName,function(){o&&o.removeWhere(function(e){return c.userToAdd.id===e.user.id})})},_createList:function(){this.destroy();var e=new TD.components.ListDetails;e.autoAddMember(this.userToAdd)},_handleAccountsData:function(e,t){var i=this;t.accounts.forEach(function(e){var t=TD.controller.clients.getClient(e.accountKey),n=TD.cache.lists.getListsFor(e.accountKey).filter(function(e){return e.isOwnList()});i.myLists=i.myLists.concat(n.sort(function(e,t){return e.name.toLowerCase()>t.name.toLowerCase()})),t.getListMemberships(i.userToAdd.screenName,!0,function(e){e.forEach(function(e){document.getElementById(e.id).checked=!0})})})},_setupAccountHandler:function(){this._boundHandleAccountsData=this._handleAccountsData.bind(this),$(document).on("dataAccounts",this._boundHandleAccountsData)},_requestAccountData:function(){$(document).trigger("uiNeedsAccounts")},destroy:function(e){$(document).off("dataAccounts",this._boundHandleAccountsData),this.$node.remove(),$("#actions-modal").hide(),e&&e.preventDefault(),this.supr()}}),TD.components.ActionDialog=TD.components.BaseModal.extend(function(e){this.tweet=e,this.$node.removeClass("js-modal-panel s-tall-fixed").addClass("cmp s-inreply l-no-txtarea s-fluid-height"),this.mainUser=e.getMainUser(),this.$find(".mdl-inner").replaceWith($(TD.ui.template.render("actions/action_dialog",{isProtected:this.mainUser.isProtected,canQuoteTweet:TD.decider.get("quote_tweet_write")}))),this.$inreplyToHolder=this.$find(".js-inreply"),this.header=new TD.components.ActionHeader,this.header.$node.bind(TD.components.ActionHeader.CLOSE,this.destroy.bind(this)),this.$find(".mdl-header").prepend(this.header.$node),this.$buttons=this.$find(".js-action-button"),this.$buttons.click(this._handleClick.bind(this)),this.$retweetButton=this.$find(".js-retweet-button"),this._boundRetweet=this._retweet.bind(this),this._boundHandleRetweetSuccess=this._handleRetweetSuccess.bind(this),this._boundHandleRetweetFailure=this._handleRetweetFailure.bind(this),$(document).on("uiSendRetweetAction",this._boundRetweet),$(document).on("dataRetweetSuccess",this._boundHandleRetweetSuccess),$(document).on("dataRetweetError",this._boundHandleRetweetFailure),this.displayTweet(e),this.header.accountSelector.$node.on(TD.components.AccountSelector.CHANGE,this._handleAccountSelectionChange.bind(this)),this.header.accountSelector.selectAccounts([e.account.getKey()]),this.setAndShowContainer($("#actions-modal"))}).methods({displayTweet:function(e){var t=e;t&&(t.withAvatar=!0,this.$inreplyToHolder.html(TD.ui.template.render("status/tweet_single",t)).show())},_quote:function(){var e=this.header.accountSelector.getSelectedAccounts(),t=e.map(function(e){return e.account});this.tweet.quoteTo(t),this.destroy()},_editquote:function(){var e=this.header.accountSelector.getSelectedAccounts(),t=e.map(function(e){return e.account});$(document).trigger("uiComposeTweet",{text:this.tweet.getMainTweet().getQuoteText(),from:t,isEditAndRetweet:!0})},_retweet:function(){this.$buttons.prop("disabled",!0);var e=this.header.accountSelector.getSelectedAccounts(),t=e.map(function(e){return e.account});$(document).trigger("uiRetweet",{id:this.tweet.id,from:t})},_handleClick:function(e){var t=$(e.target);if(t.hasClass("is-disabled"))return!1;var i=t.data("action");switch(i){case"quote":this._quote();break;case"editquote":this._editquote(),this.destroy();break;case"retweet":this._retweet()}},_handleAccountSelectionChange:function(e,t){var i=t.selectedAccounts,n=i.some(function(e){var t=TD.storage.accountController.get(e.uid);return t?this.mainUser.id===""+t.getUserID():!1},this),s=n&&1===i.length,r=!i.length,a=r||s;this.$retweetButton.toggleClass("is-disabled",a),s?(this.$retweetButton.addClass("js-show-tip"),this.$retweetButton.attr("title",TD.i("You cannot retweet your own Tweet."))):(this.$retweetButton.removeClass("js-show-tip"),this.$retweetButton.removeAttr("title"))},_handleRetweetSuccess:function(e,t){this.tweet.setRetweeted(!0),TD.controller.stats.retweet(this.tweet.getScribeItemData(),t.response.user.id_str),this.destroy()},_handleRetweetFailure:function(e,t){var i=TD.i("Failed: Retweet");t.response.errors&&t.response.errors.forEach(function(e){i+=" - "+e.message}),TD.controller.progressIndicator.addMessage(i),this.$buttons.prop("disabled",!1)},destroy:function(){$(document).off("uiSendRetweetAction",this._boundRetweet),$(document).off("dataRetweetSuccess",this._boundHandleRetweetSuccess),$(document).off("dataRetweetError",this._boundHandleRetweetFailure),this.header.accountSelector.$node.off(TD.components.AccountSelector.CHANGE),$("#actions-modal").hide(),this.header.destroy(),this.supr()}}),TD.components.ActionHeader=TD.components.Base.extend(function(){"use strict";var e=this;this.$node=$.createElement("div"),this.$node.append($(TD.ui.template.render("actions/action_header"))),this.accountSelector=new TD.components.AccountSelector,this.$node.append(this.accountSelector.$node),this.$composeUsernames=this.$find("h3"),this.$actionText=this.$find("span"),this.accountSelector.$node.bind(TD.components.AccountSelector.CHANGE,function(){var t=_.map(e.accountSelector.getSelectedAccounts(),function(e){return e.username}),i=TD.i("From {{accounts}}",{accounts:t.join(", ")});e.$composeUsernames.text(i)}),this.accountSelector.selectDefaultAccount()}).statics({CHANGE:"td-accounts-change",CLOSE:"td-dialog-close"}).methods({destroy:function(){this.accountSelector.destroy(),this.supr()}}),TD.components.GlobalSettings=TD.components.BaseModal.extend(function(){var e=TD.storage.accountController.isEmpty()?"accounts":"general";this.$optionList=this.$find(".js-setting-list li"),$("a.list-link",this.$node).click(function(e){var t=$(e.currentTarget),i=t.data("action");this.switchTab(i)}.bind(this)),this.setAndShowContainer($("#settings-modal"),!1),this.switchTab(e)}).methods({_render:function(){return $(TD.ui.template.render("short_modal",{title:TD.i("Settings"),content:TD.ui.template.render("settings/global_settings_modal",this.getInfo()),hasDoneButton:!0,centeredFooter:!0}))},getInfo:function(){var e={tabs:[{title:TD.i("General"),action:"general"},{title:TD.i("Services"),action:"services"},{title:TD.i("Mute"),action:"filter"}]};return e},switchTab:function(e){if(e!==this.currentTabName){switch(this.$optionList.removeClass("selected"),this.currentTab&&this.currentTab.destroy(),e){case"general":this.currentTab=new TD.components.GeneralSettings;break;case"services":this.currentTab=new TD.components.ServicesSettings;break;case"filter":this.currentTab=new TD.components.FilterSettings}this.currentTabName=e,this.$optionList.find("[data-action="+e+"]").parent("li").addClass("selected")}},destroy:function(e){this.currentTab&&this.currentTab.destroy(),$("#settings-modal").hide(),e&&e.preventDefault(),this.supr()}}),TD.components.FilterSettings=TD.components.Base.extend(function(){this.$globalSettings=$("#global-settings"),this.$globalSettings.submit(_.bind(this.handleAddFilter,this)),this.$node=$(TD.ui.template.render("settings/global_setting_filter",{})),this.$globalSettings.append(this.$node),this.$filterHolder=$("#filter-results"),this.$node.on("click",".js-remove-filter",_.bind(this.handleRemoveFilter,this)),this.$addFilterInput=$("#filter-input"),this.$addFilterInput.keyup(_.bind(this._validateFilter,this)),this.$filterTypes=$("#filter-types"),this.$filterTypes.change(_.bind(this.handleFilterTypeChange,this)),this.$addFilterButton=$("#add-filter"),this.$addFilterButton.click(_.bind(this.handleAddFilter,this)),this.handleFilterTypeChange(),this.refreshFilters()}).methods({_validateFilter:function(e){var t=this.$filterTypes.val(),i=this.$addFilterInput.val(),n=TD.controller.filterManager.validateFilter(t,i);return n?this.$addFilterButton.removeAttr("disabled"):this.$addFilterButton.attr("disabled","disabled"),n},handleAddFilter:function(e){if(e.preventDefault(),this._validateFilter()){var t=this.$filterTypes.val(),i=this.$addFilterInput.val();TD.controller.filterManager.addFilter(t,i),this.refreshFilters(),this.$addFilterInput.val("")}},handleRemoveFilter:function(e){var t=$(e.target);TD.controller.filterManager.removeFilter(t.data("id")),this.refreshFilters()},handleFilterTypeChange:function(){var e,t=this.$filterTypes.val();switch(t){case TD.vo.Filter.PHRASE:e=TD.i("eg iPad");break;case TD.vo.Filter.SENDER:e=TD.i("eg @JohnDoe123");break;case TD.vo.Filter.SOURCE:e=TD.i("eg TweetSpamApp")}this.$addFilterInput.attr("placeholder",e),this._validateFilter()},refreshFilters:function(){var e=TD.controller.filterManager.getAll(),t="";_.each(e,function(e){t+=TD.ui.template.render("settings/global_setting_filter_row",e)}),this.$filterHolder.html(t),this._validateFilter()},destroy:function(e){this.$node.off("click",".js-remove-filter"),this.$globalSettings.unbind("submit"),this.$node.remove()}}),TD.components.ServicesSettings=TD.components.Base.extend(function(){this.$node=$(TD.ui.template.render("settings/global_setting_services",{}));var e=TD.storage.accountController.getAccountsForService("bitly");e.length>0&&(this.bitlyAccount=e[0]),$("#global-settings").append(this.$node),this.$bitlyForm=$("#bitly-form"),this.$bitlyUsername=$("#bitly-email"),this.$bitlyKey=$("#bitly-key"),this.$linkShorteners=$("#link-shortening"),this.$linkShorteners.change(_.bind(this.handleLinkShortenerChange,this)),this.setLinkShortener()}).methods({handleLinkShortenerChange:function(e){var t=this.$linkShorteners.val();t=t.split("-")[1],TD.settings.setLinkShortener(t),this.setLinkShortener()},setLinkShortener:function(){var e=TD.settings.getLinkShortener();this.$linkShorteners.val("link-"+e),"bitly"==e?(this.$bitlyForm.show(),this.bitlyAccount&&(this.$bitlyUsername.val(this.bitlyAccount.getUserID()),this.$bitlyKey.val(this.bitlyAccount.getOAuthToken()))):this.$bitlyForm.hide()},commitBitlyChanges:function(e,t){var i=this.$bitlyUsername.val(),n=this.$bitlyKey.val();return e&&t&&TD.storage.accountController.blacklistAccount(e),!e||t?(e=new TD.storage.Account,e.setType("bitly"),e.setOAuthToken(n),e.setUserID(i),e.computeKey(),void TD.storage.accountController.manage(e)):void e.setOAuthToken(n)},destroy:function(){var e=TD.settings.getLinkShortener();if("bitly"==e){var t=this.bitlyAccount,i=this.$bitlyUsername.val(),n=this.$bitlyKey.val();i&&n&&(!t||t.getUserID()==i&&t.getOAuthToken()==n?t||this.commitBitlyChanges():this.commitBitlyChanges(t,t.getUserID()!=i))}this.$node.remove()}}),TD.components.GeneralSettings=TD.components.Base.extend(function(){var e={version:TD.util.getFullVersionString()};TD.util.isWrapperApp()&&deck.getWrapperVersion&&(e.wrapperVersion=deck.getWrapperVersion()),this.$node=$(TD.ui.template.render("settings/global_setting_general",e)),$("#global-settings").append(this.$node),this.$streamingForm=this.$find(".js-streaming-form"),this.$streamingUpdates=$("#streaming-updates"),this.$streamingUpdates.change(this.handleStreamingChange.bind(this)),this.setStreaming(),this.$checkForUpdatesForm=this.$find(".js-check-updates-form"),this.$checkForUpdates=$("#check-for-updates"),this.$checkForUpdates.change(this.handleCheckForUpdatesChange.bind(this)),this.setCheckForUpdates(),this.$showStartupNotifications=$("#show-startup-notifications"),this.$showStartupNotifications.change(this.handleShowStartupNotificationsChange.bind(this)),this.setShowStartupNotifications(),this.$displaySensitiveMedia=$("#display-sensitive-media"),this.$displaySensitiveMedia.change(this.handleDisplaySensitiveMediaChange.bind(this)),this.setDisplaySensitiveMedia(),this.$minimizeToTray=$("#minimize-to-tray"),TD.util.isWrapperApp()&&deck.getMinimizeToTraySetting&&deck.setMinimizeToTraySetting?(this.$minimizeToTray.change(this.handleMinimizeToTrayChange.bind(this)),this.setMinimizeToTray()):this.$minimizeToTray.closest(".js-minimize-to-tray").remove(),this.$columnSizeRadios=$(".js-column-size-radio"),this.$columnSizeRadios.change(this.handleColumnWidthChange.bind(this)),this.setColumnWidth(),this.$fontSizeRadioButtons=$(".js-font-size-radio"),this.$fontSizeRadioButtons.change(this.handleFontSizeChange.bind(this)),this.setFontSize(),this.$themeSwitcherRadios=$(".js-theme-radio"),this.$themeSwitcherRadios.change(this.handleThemeSwitcherChange.bind(this)),this.setTheme()}).methods({handleStreamingChange:function(){var e=this.$streamingUpdates.prop("checked");TD.settings.setUseStream(e)},setStreaming:function(){this.$streamingUpdates.prop("checked",TD.settings.getUseStream())},handleCheckForUpdatesChange:function(){var e=this.$checkForUpdates.prop("checked");TD.settings.setCheckForUpdates(e),this.setStreaming()},setCheckForUpdates:function(){this.$checkForUpdatesForm.hide()},handleShowStartupNotificationsChange:function(){var e=this.$showStartupNotifications.prop("checked");TD.settings.setShowStartupNotifications(e)},setShowStartupNotifications:function(){this.$showStartupNotifications.prop("checked",TD.settings.getShowStartupNotifications())},handleDisplaySensitiveMediaChange:function(){var e=this.$displaySensitiveMedia.prop("checked");TD.settings.setDisplaySensitiveMedia(e)},setDisplaySensitiveMedia:function(){this.$displaySensitiveMedia.prop("checked",TD.settings.getDisplaySensitiveMedia())},setFontSize:function(){var e=TD.settings.getFontSize(),t=$('.js-font-size-radio[value="'+e+'"]');t.prop("checked",!0)},handleFontSizeChange:function(e){var t;e.currentTarget.checked&&(t=e.currentTarget.value,TD.settings.setFontSize(t))},setColumnWidth:function(){var e=TD.settings.getColumnWidth(),t=$('.js-column-size-radio[value="'+e+'"]');t.prop("checked",!0)},handleColumnWidthChange:function(e){var t;e.currentTarget.checked&&(t=e.currentTarget.value,TD.settings.setColumnWidth(t))},handleThemeSwitcherChange:function(e){$(document).trigger("uiToggleTheme")},setTheme:function(){var e=TD.settings.getTheme(),t=$('.js-theme-radio[value="'+e+'"]');t.prop("checked",!0)},handleMinimizeToTrayChange:function(){if(TD.util.isWrapperApp()&&deck.setMinimizeToTraySetting){var e=this.$minimizeToTray.prop("checked");deck.setMinimizeToTraySetting(e)}},setMinimizeToTray:function(){TD.util.isWrapperApp()&&deck.getMinimizeToTraySetting&&this.$minimizeToTray.prop("checked",deck.getMinimizeToTraySetting())}}),TD.components.AccountSelector=TD.components.Base.extend(function(e){var t=this;this.$node=$.createElement("ul").addClass("accs cf js-account-selector"),this.cachedSelectedAccounts=[],this.accountIndex={},this.refreshPostingAccounts(),this.$node.on("click",".js-account-item",function(e){var i=$(e.currentTarget);e.stopPropagation(),e.shiftKey?($("li",t.$node).removeClass(TD.components.AccountSelector.SELECTED_CLASS),i.addClass(TD.components.AccountSelector.SELECTED_CLASS)):i.toggleClass(TD.components.AccountSelector.SELECTED_CLASS),t.updateSelectedAccounts()}),this.subscription=$.subscribe("/storage/client/account_whitelist_changed",_.bind(this.refreshPostingAccounts,this))}).statics({CHANGE:"td-accounts-change",SELECTED_CLASS:"acc-selected"}).methods({refreshPostingAccounts:function(){var e,t,i,n,s=TD.storage.accountController.getPostingAccounts(),r=[];for(this.accountIndex={},e=0;e<s.length;e++)t=s[e],i=t.getKey(),r.push(i),this.accountIndex[i]={account:i,uid:i,type:"account",username:t.getUsername(),service:t.getType(),picture:t.getProfileImageURL()};var a=function(e,t,i){var n={accounts:[],show_acc_toggle:i};return n.accounts=_.map(e,function(e){return t[e]}),n};r.length&&(n=TD.ui.template.render("compose/accounts",a(r,this.accountIndex,!0)),this.$node.html(n))},getSelectedAccounts:function(){var e,t,i=[];if(this.cachedSelectedAccounts)return this.cachedSelectedAccounts.concat();e=$("."+TD.components.AccountSelector.SELECTED_CLASS,this.$node);for(var n=0;n<e.length;n++)t=e[n].attributes["data-id"].value,i.push(this.accountIndex[t]);return this.cachedSelectedAccounts=i,i},selectAccounts:function(e){var t,i=this.$node.find(".js-account-item");if(_.isArray(e)&&(i.removeClass(TD.components.AccountSelector.SELECTED_CLASS),e&&e.length)){for(t=0;t<e.length;t++)e[t]&&i.filter("li[data-id='"+e[t]+"']").addClass(TD.components.AccountSelector.SELECTED_CLASS);this.updateSelectedAccounts()}},selectDefaultAccount:function(){var e=TD.storage.accountController.getDefault();e&&this.selectAccounts([e.getKey()])},updateSelectedAccounts:function(){this.cachedSelectedAccounts=null;var e=this.getSelectedAccounts();this.$node.trigger(TD.components.AccountSelector.CHANGE,{selectedAccounts:e})},destroy:function(){$.unsubscribe(this.subscription),this.$node.off("click",".js-account-item"),this.supr()}}),TD.vo.Column=function(e,t){TD.sync.util.assert(e,"must provide sColumn to create aColumn"),this.model=e,TD.sync.util.assert(this.model.getKey(),"vo.Column will most likely fail if your column has no key"),this.ui=new TD.ui.Column(this.model.getKey()),this._feeds=[],this.filters=[],this.description="",this.updateArray=[],this.updateIndex={},this.scribedImpressionIDs=new TD.cache.LRUQueue(200),this._isUpdating=!0,this.feedSubscriptions={},this.deleteSubscriptions={},this.visible=!0,this.visibility={columnWidth:0,visibleWidth:0,visibleHeight:0,visibleFraction:0},this.temporary=!1,this.detailViewComponent=null,this.isFetchingOlderUpdates=!1,this.lastInfiniteScrollTime=null,this.isExhausted=!1,this.CHIRP_BLOCK_SIZE=20,this.COLUMN_CHIRP_LIMIT=20,this.loadFeeds(),this.loadFilters(),t&&this.setFeeds(t),this.isFilterable()||this.updateSearchFilter(new TD.vo.SearchFilter),this.COLUMN_MINIMALIST_TWEET_TPM_THRESHOLD=750,this.streamRate=0;var i=this.updateStreamRate.bind(this);$(document).on("dataStreamRate",i),this.tpm=0;var n=this.updateTpm.bind(this),s="dataColumn"+this.model.getKey()+"Tpm";$(document).on(s,n),this.tpmCounter=new TD.util.TpmCounter(500,5e3,s),this.STREAM_ITEM_CONTENT_SELECTOR=".js-stream-item-content",this.STREAM_ITEM_SELECTOR=".js-stream-item",$.subscribe("/storage/client/settings/display_sensitive_media",this.reloadTweets.bind(this))},TD.vo.Column.MEDIA_PREVIEW_OFF="off",TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL="small",TD.vo.Column.MEDIA_PREVIEW_SIZE_MEDIUM="medium",TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE="large",TD.vo.Column.prototype.reset=function(){this.updateArray=[],this.updateIndex={},this.temporary=!1,this.isFetchingOlderUpdates=!1,this.lastInfiniteScrollTime=null,this.refreshSubscriptions()},TD.vo.Column.prototype.clone=function(){return TD.controller.columnManager.makeColumn(this.model.getType(),this.getFeeds(),this.model.getFilters())},TD.vo.Column.prototype.updateStreamRate=function(e,t){this.streamRate=t.itemsPerMinute},TD.vo.Column.prototype.updateTpm=function(e,t){this.tpm=t.itemsPerMinute},TD.vo.Column.prototype.loadFeeds=function(){if(this.model.managed){var e=this.model.getFeedKeys();if(_.isUndefined(e))return void TD.sync.util.stateLog("loadFeeds() not loading feeds for",this,"given",this.model.state);this._feeds=[];for(var t=0;t<e.length;t++){var i=TD.storage.feedController.get(e[t]);this._feeds.push(i)}this.refreshSubscriptions()}},TD.vo.Column.prototype.getFeeds=function(){return this._feeds.concat()},TD.vo.Column.prototype.getFeedCount=function(){return this._feeds.length},TD.vo.Column.prototype.getFeedsByType=function(e){return this.getFeeds().filter(function(t){return t.getType()===e})},TD.vo.Column.prototype.setFeeds=function(e){this._feeds=e;for(var t=[],i=0;i<this._feeds.length;i++)t.push(this._feeds[i].getKey());this.model.setFeedKeys(t),this.refreshSubscriptions(),this.model.managed&&TD.storage.feedController.manageFeeds(this._feeds)},TD.vo.Column.prototype.addFeed=function(e){for(var t,i=[],n=0;n<this._feeds.length;n++){if(t=_feeds[n].getKey(),t===e.getKey())return;i.push(t)}this._feeds.push(e),i.push(e.getKey()),this.model.setFeedKeys(i),this.refreshSubscriptions(),this.model.managed&&TD.storage.feedController.manageFeeds(this._feeds)},TD.vo.Column.prototype.addFeeds=function(e){if(e&&0!==e.length){var t,i=[],n={};for(e=this._feeds.concat(e),t=0;t<e.length;t++)n[e[t].getKey()]||(n[e[t].getKey()]=!0,i.push(e[t]));this.setFeeds(i)}},TD.vo.Column.prototype.removeFeed=function(e){for(var t,i=[],n=0,s=this._feeds.length-1;s>=0;s--)t=this._feeds[s].getKey(),t===e.getKey()?(this._feeds.splice(s,1),n++):i.push(t);return n>0&&(this.model.setFeedKeys(i),this.refreshSubscriptions(),this.checkChirpIndex()),n},TD.vo.Column.prototype.findChirp=function(e){var t=this.updateIndex[e];if(!t&&this.detailViewComponent&&(t=this.detailViewComponent.findChirp(e)),!t)for(var i=0;i<this.updateArray.length;i++)if(this.updateArray[i].getRelatedTweet()&&this.updateArray[i].getRelatedTweet().id===e){t=this.updateArray[i].getRelatedTweet();break}return t},TD.vo.Column.prototype.findMostInterestingChirp=function(e){var t=this.findChirp(e);return t&&t instanceof TD.services.TwitterAction&&(t=t.getRelatedTweet()||t),t},TD.vo.Column.prototype.checkChirpIndex=function(){var e=this.model.getFeedKeys(),t=_.map(e,TD.controller.feedManager.getPoller),i=_.filter(this.updateArray,function(e){return!_.find(t,function(t){return t.chirpIndex[e.id]})});this.removeFromIndex(null,i,!0)},TD.vo.Column.prototype.refreshSubscriptions=function(){var e,t={},i=this.model.getFeedKeys(),n=this;if("me"===this.model.getType()){var s=!1,r=[];_.each(i,function(e){var t=TD.storage.feedController.get(e);t&&("interactions"===t.getType()&&(s=!0),"mentions"!==t.getType()&&r.push(e))}),s&&(i=r)}for(var a=0;a<i.length;a++)e=i[a],t[e]=!0,this.feedSubscriptions[e]||(this.feedSubscriptions[e]=$.subscribe("/feed/"+e,function(e,t,i){n.mergeAndRenderChirps(t,{shouldNotify:e.feed.managed,lastNotifySortIndex:i})})),this.deleteSubscriptions[e]||(this.deleteSubscriptions[e]=$.subscribe("/delete/"+e,function(e,t){n.removeFromIndex(e,t,!0)}));for(e in this.feedSubscriptions)t[e]||($.unsubscribe(this.feedSubscriptions[e]),delete this.feedSubscriptions[e]);for(e in this.deleteSubscriptions)t[e]||($.unsubscribe(this.deleteSubscriptions[e]),delete this.deleteSubscriptions[e])},TD.vo.Column.prototype.removeSubscriptions=function(){var e;for(e in this.feedSubscriptions)$.unsubscribe(this.feedSubscriptions[e]),delete this.feedSubscriptions[e];for(e in this.deleteSubscriptions)$.unsubscribe(this.deleteSubscriptions[e]),delete this.deleteSubscriptions[e]},TD.vo.Column.prototype.fetchUpdatesFromPoller=function(e){if(!this.isFetchingOlderUpdates){$(document).trigger("metric",{key:"column:fetch:infinite-scroll:request:"+this.getColumnType()});var t,i=this,n=this.updateArray[this.updateArray.length-1],s=[],r=this.updateArray.length+i.CHIRP_BLOCK_SIZE,a=0,o=!1;this.updateArray.length&&!e&&(i.lastInfiniteScrollTime=Date.now()),this.isFetchingOlderUpdates=!0,this.ui.addInfiniteScrollSpinner();var c=function(){var e=i.getFeeds().map(function(e){var t=TD.controller.feedManager.getPoller(e.getKey()),r=t.fetchOlderChirps(n);return r.addCallback(function(n){return n=n.filter(function(e){return!i.updateIndex[e.id]}),$(document).trigger("metric",{key:["column:fetch:infinite-scroll:result",n.length?"some":"none",i.getColumnType()].join(":")}),o=!t.isExhausted||o,a+=i.mergeAndRenderChirps(n,{shouldNotify:e.managed,lastNotifySortIndex:e.getTopSortIndex()}),s.push(n[n.length-1]),n}),r.addErrback(function(e){throw $(document).trigger("metric",{key:["column:fetch:infinite-scroll:result:error",this.getColumnType()].join(":")}),e}),r});return new TD.core.defer.DeferredList(e)},l=function(){if(0===a){if(o)return n=TD.util.getTopChirp(s),s=[],c();i.isExhausted=!0}};return t=c(),t.addCallback(l),t.addCallback(function(){i.ui.removeInfiniteScrollSpinner(),i.isFetchingOlderUpdates=!1,i.truncate(r)}),t}},TD.vo.Column.prototype.mergeAndRenderChirps=function(e,t){t=_.defaults(t||{},{lastNotifySortIndex:null,shouldNotify:!1}),this.ui.hideIsUpdatingMessage(),this._isUpdating&&(this.ui.getChirpContainer().trigger("dataColumnFeedUpdated"),this.ui.hideChirpContainer(),this._isUpdating=!1),0===this.updateArray.length&&this.ui.removeInfiniteScrollSpinner();var i=this.addItemsToIndex(e,t);return 0===this.updateArray.length?this.ui.showNoResultsMessage(this.temporary,this.isOwnCustomTimeline()):this.ui.hideNoResultsMessage(),this.isMessageColumn()&&$(document).trigger("uiMessageUnreadCount",{columnKey:this.model.getKey(),count:this.unreadMessageCount()}),i},TD.vo.Column.prototype.addItemsToIndex=function(e,t){t=t||{};var i,n=t.shouldNotify;t.lastNotifySortIndex&&(i=new TD.services.ChirpBase,i.sortIndex=t.lastNotifySortIndex);var s,r=[],a=this.model.getClearedTimestamp(),o=[];e.sort(TD.util.chirpColumnSort);for(var c=0;c<e.length&&(s=e[c],s.created.getTime()<=a||!s.passFilters(this.filters)||(_.isUndefined(this.updateIndex[s.id])||(this.removeFromIndex(null,[s],!1),this.detailViewComponent&&this.detailViewComponent.changed(s)),this.updateIndex[s.id]=s,r.push(s),n&&(o=o.concat(s.getUnreadChirps(i))),!(r.length>this.CHIRP_BLOCK_SIZE)));c++);if(numAcceptedUpdates=r.length,numAcceptedUpdates){for(var l="",u=[],d=this.updateArray,h={mediaPreviewSize:this.getMediaPreviewSize(),isOwnCustomTimeline:this.isOwnCustomTimeline(),showVerifiedBadge:this.getShowVerified(),isTemporaryColumn:this.temporary};r.length>0||d.length>0;)if(0===r.length)u=u.concat(d),d=[];else if(0===d.length)u=u.concat(r),this.addToView(l,r,h,{insertAtTop:!l,insertAtBottom:!0}),r=[];else{for(var p=[],m=d[0],f=r[0];TD.util.chirpColumnSort(m,f)>0&&r.length>0;)s=r.shift(),p.push(s),r.length>0&&(f=r[0]);p.length>0?(this.addToView(l,p,h,{insertAtTop:!l,insertAtBottom:!1}),u=u.concat(p)):(s=d.shift(),u.push(s),s.passFilters(this.filters)&&(l=s.id))}this.updateArray=u}return n&&$.publish("/notifications/new",[{column:this,items:o}]),numAcceptedUpdates},TD.vo.Column.prototype.removeFromIndex=function(e,t,i){for(var n=0;n<t.length;n++){var s=t[n];this.removeChirp(s),i&&this.detailViewComponent&&this.detailViewComponent.deleted(s)}},TD.vo.Column.prototype.removeChirp=function(e){var t=this.updateIndex[e.id];if(t){for(var i=0;i<this.updateArray.length;i++)if(e=this.updateArray[i],e===t){this.updateArray.splice(i,1);break}delete this.updateIndex[e.id],this.ui.removeChirp(e.id),$(document).trigger("uiColumnChirpsChanged",{id:this.model.getKey()})}0===this.updateArray.length&&this.ui.showIsUpdatingMessage()},TD.vo.Column.prototype.clear=function(){if(0!==this.updateArray.length){var e=this.updateArray[0].created.getTime();this.model.setClearedTimestamp(e),this.truncate(0)}},TD.vo.Column.prototype.truncate=function(e){0===e&&TD.ui.columns.unlockColumnFromElement(this.model.getKey());for(var t=this.getFeeds().map(function(e){var t=TD.controller.feedManager.getPoller(e.getKey());return t&&!t.isExhausted?t.getBottomChirp(t.chirpArray):void 0}),i=TD.util.getTopChirp(t),n=Math.min(e,this.updateArray.length);n>0&&i&&i.belongsAbove(this.updateArray[n-1]);)n--;for(var s=this.updateArray.splice(n),r=0;r<s.length;r++)this.annihilateChirp(s[r].id.toString(),{willBreakScrollPosition:!1});s.length&&(this.isExhausted=!1)},TD.vo.Column.prototype.trimUpdates=function(){var e,t,i,n;if(this.lastInfiniteScrollTime){if(e=Date.now()-this.lastInfiniteScrollTime,!(e>6e4))return;i=Math.floor((this.updateArray.length-this.COLUMN_CHIRP_LIMIT)*(1-e/18e4)),this.maxUpdatesPerColumn=Math.max(this.COLUMN_CHIRP_LIMIT+i,this.COLUMN_CHIRP_LIMIT)}if(this.maxUpdatesPerColumn=TD.ui.columns.isScrolledToTop(this.model.getKey())?this.COLUMN_CHIRP_LIMIT:Math.max(this.maxUpdatesPerColumn||100,100),n=Math.max(this.maxUpdatesPerColumn||this.COLUMN_CHIRP_LIMIT,this.COLUMN_CHIRP_LIMIT),n<this.updateArray.length){t=this.updateArray.splice(n,Math.max(this.updateArray.length-n,0));for(var s=0;s<t.length;s++)this.annihilateChirp(t[s].id.toString(),{willBreakScrollPosition:!1})}},TD.vo.Column.prototype.annihilateChirp=function(e,t){this.ui.removeChirp(e,t),delete this.updateIndex[e]},TD.vo.Column.prototype.chirpInView=function(e){{var t=this.ui.getChirpContainer(),i=t.parents(".js-column-scroller").height(),n=t.children('[data-key="'+e.id.toString()+'"]'),s=n.position().top;n.height()}return i>s},TD.vo.Column.prototype.addToView=function(e,t,i,n){var s,r,a,o,c=this.ui.getChirpContainer(),l=n.insertAtBottom&&n.insertAtTop,u=TD.controller.columnManager.isStreaming(this.model.getKey());0!==t.length&&(0===this.updateArray.length?(a=TD.util.getPreciseTime(),i.doRenderMinimalist=!1,s=this.ui.renderChirps(t,i),o=TD.util.getPreciseTime(),TD.util.logTimeToRenderColumn(o-a,t.length)):(u&&this.tpmCounter.incrementCounter(t.length),i.doRenderMinimalist=this.tpm>this.COLUMN_MINIMALIST_TWEET_TPM_THRESHOLD,s=this.ui.renderChirps(t,i)),r=$(s).filter(this.STREAM_ITEM_SELECTOR),TD.ui.Column.identifyInlinedLinks(r),""===e?l?c.html(r):(TD.ui.columns.isScrolledToTop(this.model.getKey())&&TD.controller.columnManager.isStreaming(this.model.getKey())&&this.trimUpdates(),c.prepend(r)):c.children('[data-key="'+e+'"]').after(r),l?this.ui.fadeInChirpContainer():this.ui.slideInChirps(r,this.temporary,this.streamRate,this.tpm,n))},TD.vo.Column.prototype.getMediaPreviewSize=function(){var e,t=this.model.getMediaPreviewSize();return t||(this.isMessageColumn()&&(t=TD.vo.Column.MEDIA_PREVIEW_OFF),e=this.getSearchFilter(),t=e.content.hasActiveMediaFilter()?TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE:this.getColumnType()===TD.util.columnUtils.columnMetaTypes.INTERACTIONS?TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL:TD.vo.Column.MEDIA_PREVIEW_SIZE_MEDIUM),t},TD.vo.Column.prototype.setMediaPreviewSize=function(e){var t=this.getMediaPreviewSize();e!==t&&this.model.setMediaPreviewSize(e),this.reloadTweets()},TD.vo.Column.prototype.getShowVerified=function(){return"col_search"===this.getColumnType()&&this.temporary},TD.vo.Column.prototype.getTitleHTML=function(e){return TD.util.columnUtils.getColumnTitleHTML(this,e)},TD.vo.Column.prototype.getDetailTitleHTML=function(){return TD.util.columnUtils.getColumnTitleHTML(this)},TD.vo.Column.prototype.getColumnType=function(){return TD.util.columnUtils.getColumnType(this)},TD.vo.Column.prototype.getIconClass=function(){return TD.util.columnUtils.getColumnIconClassByColumnType(this.getColumnType())},TD.vo.Column.prototype.getClass=function(){return TD.util.columnUtils.getColumnClassByColumnType(this.getColumnType())},TD.vo.Column.prototype.isOfType=function(e){return this.getColumnType()===e},TD.vo.Column.prototype.isMessageColumn=function(){return TD.util.columnUtils.isMessageColumn(this)},TD.vo.Column.prototype.isSearchColumn=function(){return this.isOfType(TD.util.columnUtils.columnMetaTypes.SEARCH)},TD.vo.Column.prototype.isActionsColumn=function(){return TD.util.columnUtils.actionColumnTypes.indexOf(this.getColumnType())>-1},TD.vo.Column.prototype.isSingleActionTypeColumn=function(){return TD.util.columnUtils.singleActionColumnTypes.indexOf(this.getColumnType())>-1},TD.vo.Column.prototype.isActivityColumn=function(){return this.isOfType(TD.util.columnUtils.columnMetaTypes.ACTIVITY)},TD.vo.Column.prototype.isCustomTimeline=function(){return this.isOfType(TD.util.columnUtils.columnMetaTypes.CUSTOMTIMELINE)},TD.vo.Column.prototype.isDataminr=function(){return this.isOfType(TD.util.columnUtils.columnMetaTypes.DATAMINR)},TD.vo.Column.prototype.isEmbeddable=function(){return _.include(TD.util.columnUtils.embeddableColumnTypes,this.getColumnType())},TD.vo.Column.prototype.isShareable=function(){var e=TD.util.columnUtils,t=e.shareableColumnTypes;return TD.decider.get("sac_enable_share")&&(t=t.concat(e.columnMetaTypes.FAVORITES,e.columnMetaTypes.USERTWEETS,e.columnMetaTypes.LIST,e.columnMetaTypes.SEARCH)),_.include(t,this.getColumnType())},TD.vo.Column.prototype.isViewable=function(){return _.include(TD.util.columnUtils.viewableColumnTypes,this.getColumnType())},TD.vo.Column.prototype.isClearable=function(){var e=this.getColumnType();

return e!==TD.util.columnUtils.columnMetaTypes.SCHEDULED&&e!==TD.util.columnUtils.columnMetaTypes.CUSTOMTIMELINE},TD.vo.Column.prototype.isOwnList=function(){var e=!1;return _.find(this.getFeeds(),function(t){if("list"===t.getType()){var i=t.getMetadata();e=TD.cache.lists.find(i.listId,i.screenName,i.slug,!0)}return Boolean(e)}),e},TD.vo.Column.prototype.isOwnCustomTimeline=function(){var e=this.getFeedsByType(TD.util.columnUtils.feedTypes.CUSTOMTIMELINE),t=e.some(function(e){var t=e.getMetadata(),i=TD.storage.Account.generateKeyFor("twitter",t.ownerId);return i===e.getAccountKey()});return t},TD.vo.Column.prototype.deleteCustomTimeline=function(e,t){var i=this.getFeedsByType(TD.util.columnUtils.feedTypes.CUSTOMTIMELINE);i.forEach(function(i){var n=i.getMetadata().id,s=TD.controller.clients.getClient(i.getAccountKey()),r=i.getKey();s.deleteCustomTimeline(n,function(){TD.controller.feedManager.deleteFeedsWhere(function(e){return e.getKey()===r}),e&&e()},function(){TD.controller.progressIndicator.addMessage(TD.i("Error deleting collection")),t&&t()})})},TD.vo.Column.prototype.getCustomTimeline=function(){var e,t=this.getCustomTimelineFeed();if(t){var i=t.getMetadata().id,n=TD.controller.clients.getClient(t.getAccountKey());e=n.customTimelines.filter(function(e){return e.id===i})[0]}return e},TD.vo.Column.prototype.getCustomTimelineFeed=function(){var e=this.getFeedsByType(TD.util.columnUtils.feedTypes.CUSTOMTIMELINE);return e[0]},TD.vo.Column.prototype.updateMetadata=function(e){var t,i=this.getFeeds()[0];this._isUpdating=!0,this.ui.showIsUpdatingMessage(),e.term=null,t=TD.storage.feedController.getOrCreateFeed(i.getType(),i.getService(),i.getAccountKey(),e),this.ui.getChirpContainer().trigger("dataColumnUpdatingFeed",{column:this,oldFeed:i,newFeed:t}),TD.controller.feedManager.replaceFeed(i,t,[this.model.getKey()])},TD.vo.Column.prototype.loadFilters=function(){var e=new TD.vo.SearchFilter(this.model.getFilters()),t=e.getFilters();_.isEqual(_.pluck(this.filters,"id"),_.pluck(t,"id"))||(this.filters=t,this.reloadTweets())},TD.vo.Column.prototype.isFilterable=function(){return-1!==TD.util.columnUtils.filterableColumnTypes.indexOf(this.getColumnType())},TD.vo.Column.prototype.reloadTweets=function(){this._isUpdating||(this.truncate(0),this.fetchUpdatesFromPoller(!0))},TD.vo.Column.prototype.getBaseQuery=function(){var e=null,t=this.getFeeds();if(this.isSearchColumn()&&t&&t.length>0){var i=t[0].getMetadata();i&&(e=i.baseQuery?i.baseQuery:i.term)}return e},TD.vo.Column.prototype.updateSearchFilter=function(e){var t,i,n,s,r;e&&(this.isSearchColumn()?this.updateSearchFeedFilter(e):(n=this.getFeeds()[0],n&&this.isActionsColumn()&&!this.isActivityColumn()&&(i=n.getType(),t=TD.util.columnUtils.inferFeedTypeFromActionFilter(e.action),t!==i&&(r=_.clone(n.getMetadata()),s=TD.storage.feedController.getOrCreateFeed(t,n.getService(),n.getAccountKey(),r),this.ui.getChirpContainer().trigger("dataColumnUpdatingFeed",{column:this,oldFeed:n,newFeed:s}),TD.controller.feedManager.replaceFeed(n,s,[this.model.getKey()]))),this.model.setFilters(e.toJSONObject()),this.ui.getChirpContainer().trigger("dataColumnFiltersUpdated")))},TD.vo.Column.prototype.updateSearchFeedFilter=function(e){var t=!1,i=this.getFeeds()[0],n=_.clone(i.getMetadata());n.baseQuery||(n.baseQuery=n.term),e.content&&e.content.matching&&e.content.matching!==n.baseQuery&&(t=!0,n.baseQuery=e.content.matching);var s=new TD.vo.SearchFilter(n.searchFilterData);(t||s.getQueryString()!==e.getQueryString())&&(n.searchFilterData=e.toJSONObject(),this.updateMetadata(n))},TD.vo.Column.prototype.getSearchFilter=function(){var e,t;return this.isSearchColumn()?(t=this.getFeeds()[0].getMetadata(),e=new TD.vo.SearchFilter(t.searchFilterData),e.content.matching||e.content.setMatching(t.baseQuery||t.term)):e=new TD.vo.SearchFilter(this.model.getFilters()),e},TD.vo.Column.prototype.hasActiveSearchFilters=function(){var e=this.getSearchFilter(),t=this.hasActiveUserFilters()||this.hasActiveContentFilters()||this.hasActiveEngagementFilters()||this.hasActiveActionFilters()&&!this.isSingleActionTypeColumn();return this.isSearchColumn()||(t=e.content.matching||t),Boolean(t)},TD.vo.Column.prototype.hasActiveContentFilters=function(){var e,t=this.getSearchFilter();return e=this.isSearchColumn()?t.content.getQueryString():t.content.matching||t.content.getQueryString()||t.content.type!==TD.vo.ContentFilter.TYPE_ANYTHING,Boolean(e)},TD.vo.Column.prototype.hasActiveUserFilters=function(){var e=this.getSearchFilter(),t=e.user.getQueryString();return Boolean(t)},TD.vo.Column.prototype.hasActiveActionFilters=function(){var e=this.getSearchFilter(),t=e.action.getFilters().length;return Boolean(t)},TD.vo.Column.prototype.hasActiveEngagementFilters=function(){var e=this.getSearchFilter(),t=e.engagement.getQueryString();return Boolean(t)},TD.vo.Column.prototype.hasFilterError=function(){var e,t=this.getSearchFilter();return e=this.getColumnType()===TD.util.columnUtils.columnMetaTypes.ACTIVITY?t.action.getFilters().length===TD.vo.ActionFilter.MAX_ACTIVITY_FILTERS:t.action.getFilters().length===TD.vo.ActionFilter.MAX_INTERACTION_FILTERS},TD.vo.Column.prototype.markAllMessagesAsRead=function(){this.isMessageColumn()&&this.getFeeds().forEach(function(e){var t=e.getAccountKey(),i=TD.controller.clients.getClient(t);i.conversations.markAllRead()},this)},TD.vo.Column.prototype.hasUnreadMessages=function(){var e=!1;return this.isMessageColumn()&&(e=this.updateArray.some(function(e){return e.unread})),e},TD.vo.Column.prototype.unreadMessageCount=function(){var e=0;return this.isMessageColumn()&&(e=this.updateArray.reduce(function(e,t){return e+(t.unread?1:0)},0)),e>20&&(e=TD.i("20+")),e.toString()},TD.vo.Filter=function(e,t,i){switch(this.type=e,this.value=t,this.positive=i,_.isString(t)&&(this.value=t.toLowerCase()),this.type){case TD.vo.Filter.PHRASE:this.exact=!1;break;case TD.vo.Filter.SENDER:this.exact=!0,this.fuzzy=!0,this.filterTarget="parent";break;case TD.vo.Filter.SOURCE:this.exact=!0,this.fuzzy=!1;break;case TD.vo.Filter.FOLLOWERS:this.exact=!1,this.range=!0;break;case TD.vo.Filter.IS_RETWEET:this.exact=!0;break;case TD.vo.Filter.IS_FROM_VERIFIED:this.exact=!0,this.filterTarget="parent";break;case TD.vo.Filter.CHIRP_TYPE:this.exact=!0,this.filterTarget="parent"}this.id=this.generateLocalID()},TD.vo.Filter.PHRASE="phrase",TD.vo.Filter.SENDER="sender",TD.vo.Filter.SOURCE="source",TD.vo.Filter.FOLLOWERS="followers",TD.vo.Filter.IS_RETWEET="is_retweet",TD.vo.Filter.IS_MENTION="is_mention",TD.vo.Filter.IS_FAVORITE="is_favorite",TD.vo.Filter.IS_FOLLOW="is_follow",TD.vo.Filter.HAS_IMAGE="has_image",TD.vo.Filter.HAS_VIDEO="has_video",TD.vo.Filter.HAS_GIF="has_gif",TD.vo.Filter.HAS_VINE="has_vine",TD.vo.Filter.HAS_MEDIA="has_media",TD.vo.Filter.HAS_LINK="has_link",TD.vo.Filter.IS_FROM_VERIFIED="verified",TD.vo.Filter.CHIRP_TYPE="chirp_type",TD.vo.Filter.prototype.id=null,TD.vo.Filter.prototype.value=null,TD.vo.Filter.prototype.type=TD.vo.Filter.PHRASE,TD.vo.Filter.prototype.positive=!0,TD.vo.Filter.prototype.exact=!0,TD.vo.Filter.prototype.fuzzy=!1,TD.vo.Filter.prototype.range=!1,TD.vo.Filter.prototype.filterTarget="child",TD.vo.Filter.prototype.generateLocalID=function(){return"filter"+TD.util.deterministicObjectHash(this.toBackendState())},TD.vo.Filter.prototype.pass=function(e){var t=this;switch(e=this._getFilterTarget(e),text=e.getFilterableText(),text=text?text.toLowerCase():null,senders=e.getSenders(),senders=senders?_.map(senders,function(e){return e.toLowerCase()}):null,source=e.getSource(),source=source?source.toLowerCase():null,this.type){case TD.vo.Filter.PHRASE:return this._testString(text);case TD.vo.Filter.SENDER:return this.positive?_.any(senders,function(e){return t._testString(e)}):_.every(senders,function(e){return t._testString(e)});case TD.vo.Filter.SOURCE:return this._testString(source);case TD.vo.Filter.FOLLOWERS:return this._testNumber(followers);case TD.vo.Filter.IS_RETWEET:return this._testBoolean(e.isRetweetedStatus());case TD.vo.Filter.IS_FROM_VERIFIED:return this._testBoolean(e.isFromVerifiedUser());case TD.vo.Filter.HAS_IMAGE:return this._testBoolean(e.hasImage());case TD.vo.Filter.HAS_VIDEO:return this._testBoolean(e.hasVideo());case TD.vo.Filter.HAS_GIF:return this._testBoolean(e.hasAnimatedGif());case TD.vo.Filter.HAS_VINE:return this._testBoolean(e.hasVine());case TD.vo.Filter.HAS_MEDIA:return this._testBoolean(e.hasImage()||e.hasVideo());case TD.vo.Filter.HAS_LINK:return this._testBoolean(e.hasLink());case TD.vo.Filter.CHIRP_TYPE:return this._testString(e.getChirpType())}return!0},TD.vo.Filter.prototype.getDisplayType=function(){switch(this.type){case TD.vo.Filter.PHRASE:return"";case TD.vo.Filter.SENDER:return TD.i("user");case TD.vo.Filter.SOURCE:return TD.i("source");case TD.vo.Filter.FOLLOWERS:return TD.i("followers");case TD.vo.Filter.IS_RETWEET:return TD.i("retweets");case TD.vo.Filter.HAS_MEDIA:return TD.i("media");case TD.vo.Filter.HAS_LINK:return TD.i("links");case TD.vo.Filter.IS_FROM_VERIFIED:return TD.i("verified")}return""},TD.vo.Filter.prototype._getFilterTarget=function(e){return"parent"!==this.filterTarget&&e.targetTweet?e.targetTweet:e},TD.vo.Filter.prototype._testString=function(e){if(!e||!this.value)return!0;if(this.exact){if(e===this.value)return this.positive;if(this.fuzzy&&"@"+e===this.value)return this.positive}else if(-1!==e.indexOf(this.value))return this.positive;return!this.positive},TD.vo.Filter.prototype._testNumber=function(e){if(!_.isNumber(e)||!_.isNumber(this.value))return!0;if(this.exact){if(e===this.value)return this.positive}else if(this.range&&e>=this.value)return this.positive;return!this.positive},TD.vo.Filter.prototype._testBoolean=function(e){return _.isBoolean(e)&&_.isBoolean(this.value)?e===this.value?this.positive:!this.positive:!0},TD.vo.Filter.prototype.toBackendState=function(){return{type:this.type,value:this.value,positive:this.positive,exact:this.exact,fuzzy:this.fuzzy,range:this.range}},TD.vo.Filter.prototype.fromBackendState=function(e){this.type=e.type,this.value=e.value,this.positive=e.positive,this.exact=e.exact,this.fuzzy=e.fuzzy,this.range=e.range,this.id=this.generateLocalID()},TD.vo.SearchFilter=function(e){this.fromJSONObject(e)},TD.vo.SearchFilter.prototype.action=null,TD.vo.SearchFilter.prototype.content=null,TD.vo.SearchFilter.prototype.engagement=null,TD.vo.SearchFilter.prototype.user=null,TD.vo.SearchFilter.prototype.toJSONObject=function(){var e={action:this.action.toJSONObject(),content:this.content.toJSONObject(),engagement:this.engagement.toJSONObject(),user:this.user.toJSONObject()};return e},TD.vo.SearchFilter.prototype.fromJSONObject=function(e){e=e||{},this.action=new TD.vo.ActionFilter(e.action),this.content=new TD.vo.ContentFilter(e.content),this.engagement=new TD.vo.EngagementFilter(e.engagement),this.user=new TD.vo.UserFilter(e.user)},TD.vo.SearchFilter.prototype.getQueryString=function(){var e=[this.content.getQueryString(),this.engagement.getQueryString(),this.user.getQueryString()];return e.join(" ").trim()},TD.vo.SearchFilter.prototype.getFilters=function(){var e=this.action.getFilters();return e=e.concat(this.content.getFilters()),e=e.concat(this.engagement.getFilters()),e=e.concat(this.user.getFilters())},TD.vo.ActionFilter=function(e){this.fromJSONObject(e)},TD.vo.ActionFilter.prototype.showMentions=!0,TD.vo.ActionFilter.prototype.showRetweets=!0,TD.vo.ActionFilter.prototype.showFavorites=!0,TD.vo.ActionFilter.prototype.showFollowers=!0,TD.vo.ActionFilter.prototype.showLists=!0,TD.vo.ActionFilter.MAX_INTERACTION_FILTERS=6,TD.vo.ActionFilter.MAX_ACTIVITY_FILTERS=4,TD.vo.ActionFilter.prototype.setShowMentions=function(e){this.showMentions=Boolean(e)},TD.vo.ActionFilter.prototype.setShowRetweets=function(e){this.showRetweets=Boolean(e)},TD.vo.ActionFilter.prototype.setShowFavorites=function(e){this.showFavorites=Boolean(e)},TD.vo.ActionFilter.prototype.setShowFollowers=function(e){this.showFollowers=Boolean(e)},TD.vo.ActionFilter.prototype.setShowLists=function(e){this.showLists=Boolean(e)},TD.vo.ActionFilter.prototype.toJSONObject=function(){return{showMentions:this.showMentions,showRetweets:this.showRetweets,showFavorites:this.showFavorites,showFollowers:this.showFollowers,showLists:this.showLists}},TD.vo.ActionFilter.prototype.fromJSONObject=function(e){e&&(this.setShowMentions(e.showMentions),this.setShowRetweets(e.showRetweets),this.setShowFavorites(e.showFavorites),this.setShowFollowers(e.showFollowers),this.setShowLists(e.showLists))},TD.vo.ActionFilter.prototype.getSummaryText=function(e){var t,i,n,s=[],r=e===TD.util.columnUtils.columnMetaTypes.ACTIVITY;n=r?TD.vo.ActionFilter.MAX_ACTIVITY_FILTERS:TD.vo.ActionFilter.MAX_INTERACTION_FILTERS;var a=this.getFilters();return a.length===n?t=TD.i("Filter error"):0===a.length?t=TD.i(r?"All activity":"All notifications"):1!==a.length||r?(r||(this.showMentions&&s.push(TD.i("mentions")),this.showRetweets&&s.push(TD.i("retweets"))),this.showFavorites&&s.push(TD.i("favorites")),this.showFollowers&&s.push(TD.i("followers")),this.showLists&&s.push(TD.i("lists")),i=s.pop(),a.length===n-1||this.showLists&&a.length===n-2?t=TD.i("{{actionType}} only",{actionType:i}):(s=s.join(", "),t=TD.i("{{actionTypes}} and {{lastActionType}}",{actionTypes:s,lastActionType:i}))):this.showMentions?this.showRetweets?this.showFavorites?this.showFollowers?this.showLists||(t=TD.i("All except lists")):t=TD.i("All except followers"):t=TD.i("All except favorites"):t=TD.i("All except retweets"):t=TD.i("All except mentions"),t},TD.vo.ActionFilter.prototype.getFilters=function(){var e,t=[];return this.showMentions||(e=new TD.vo.Filter(TD.vo.Filter.CHIRP_TYPE,TD.services.TwitterAction.MENTION,!1),t.push(e)),this.showRetweets||(e=new TD.vo.Filter(TD.vo.Filter.CHIRP_TYPE,TD.services.TwitterAction.RETWEET,!1),t.push(e)),this.showFavorites||(e=new TD.vo.Filter(TD.vo.Filter.CHIRP_TYPE,TD.services.TwitterAction.FAVORITE,!1),t.push(e)),this.showFollowers||(e=new TD.vo.Filter(TD.vo.Filter.CHIRP_TYPE,TD.services.TwitterAction.FOLLOW,!1),t.push(e)),this.showLists||(e=new TD.vo.Filter(TD.vo.Filter.CHIRP_TYPE,TD.services.TwitterAction.LIST_CREATED,!1),t.push(e),e=new TD.vo.Filter(TD.vo.Filter.CHIRP_TYPE,TD.services.TwitterAction.LIST_MEMBER_ADDED,!1),t.push(e)),t},TD.vo.ContentFilter=function(e){this.fromJSONObject(e)},TD.vo.ContentFilter.TYPE_ANYTHING="anything",TD.vo.ContentFilter.TYPE_IMG="img",TD.vo.ContentFilter.TYPE_VID="vid",TD.vo.ContentFilter.TYPE_GIF="gif",TD.vo.ContentFilter.TYPE_VINE="vine",TD.vo.ContentFilter.TYPE_IMG_AND_VID="img_vid",TD.vo.ContentFilter.TYPE_LINKS="links",TD.vo.ContentFilter.LANG_ANY="any",TD.vo.ContentFilter.prototype.matching="",TD.vo.ContentFilter.prototype.excluding="",TD.vo.ContentFilter.prototype.type="anything",TD.vo.ContentFilter.prototype.lang="any",TD.vo.ContentFilter.prototype.includeRTs=!0,TD.vo.ContentFilter.prototype.setMatching=function(e){this.matching=e||""},TD.vo.ContentFilter.prototype.setExcluding=function(e){this.excluding=e||""},TD.vo.ContentFilter.prototype.setType=function(e){this.type=e||TD.vo.ContentFilter.TYPE_ANYTHING},TD.vo.ContentFilter.prototype.setLanguage=function(e){this.lang=e||TD.vo.ContentFilter.LANG_ANY},TD.vo.ContentFilter.prototype.setIncludeRTs=function(e){this.includeRTs=void 0===e?!0:Boolean(e)},TD.vo.ContentFilter.prototype.toJSONObject=function(){return{matching:this.matching,excluding:this.excluding,type:this.type,lang:this.lang,includeRTs:this.includeRTs}},TD.vo.ContentFilter.prototype.fromJSONObject=function(e){e&&(this.setMatching(e.matching),this.setExcluding(e.excluding),this.setType(e.type),this.setLanguage(e.lang),this.setIncludeRTs(e.includeRTs))},TD.vo.ContentFilter.prototype.getQueryString=function(){var e=[];switch(this.type){case TD.vo.ContentFilter.TYPE_IMG:e.push("filter:images");break;case TD.vo.ContentFilter.TYPE_VID:e.push("filter:videos");break;case TD.vo.ContentFilter.TYPE_VINE:e.push("filter:vine");break;case TD.vo.ContentFilter.TYPE_IMG_AND_VID:e.push("(filter:images OR filter:videos)");break;case TD.vo.ContentFilter.TYPE_LINKS:e.push("filter:links")}return this.lang!==TD.vo.ContentFilter.LANG_ANY&&e.push("lang:"+this.lang),this.includeRTs||e.push("exclude:nativeretweets exclude:retweets"),this.excluding&&e.push(this.getExcludingQuery()),e.join(" ")},TD.vo.ContentFilter.prototype.getSummaryText=function(){var e,t=[];switch(this.type){case TD.vo.ContentFilter.TYPE_IMG:t.push(TD.i("showing images"));break;case TD.vo.ContentFilter.TYPE_VID:t.push(TD.i("showing videos"));break;case TD.vo.ContentFilter.TYPE_GIF:t.push(TD.i("showing GIFs"));break;case TD.vo.ContentFilter.TYPE_VINE:t.push(TD.i("showing Vines"));break;case TD.vo.ContentFilter.TYPE_IMG_AND_VID:t.push(TD.i("showing images and videos"));break;case TD.vo.ContentFilter.TYPE_LINKS:t.push(TD.i("showing links"))}if(this.matching&&t.push(TD.i("matching ‘{{{matching}}}’",{matching:this.matching})),this.excluding&&t.push(TD.i("excluding ‘{{{excluding}}}’",{excluding:this.excluding})),this.lang!==TD.vo.ContentFilter.LANG_ANY){var i=TD.languages.getLanguageFromISOCode(this.lang);t.push(TD.i("written in {{{lang}}}",{lang:i.localized_name}))}return this.includeRTs||t.push(TD.i("retweets excluded")),e=0===t.length?TD.i("any"):t.join(", ")},TD.vo.ContentFilter.prototype.getExcludingQuery=function(){if(!this.excluding)return"";var e=TD.services.TwitterSearchParser.extractPhrases(this.excluding,!0);return e=e.map(function(e){return"-"+e}),e.join(" ")},TD.vo.ContentFilter.prototype.getFilters=function(){var e,t,i=[];switch(this.type){case TD.vo.ContentFilter.TYPE_IMG:e=new TD.vo.Filter(TD.vo.Filter.HAS_IMAGE,!0,!0),i.push(e);break;case TD.vo.ContentFilter.TYPE_VID:e=new TD.vo.Filter(TD.vo.Filter.HAS_VIDEO,!0,!0),i.push(e);break;case TD.vo.ContentFilter.TYPE_GIF:e=new TD.vo.Filter(TD.vo.Filter.HAS_GIF,!0,!0),i.push(e);break;case TD.vo.ContentFilter.TYPE_VINE:e=new TD.vo.Filter(TD.vo.Filter.HAS_VINE,!0,!0),i.push(e);break;case TD.vo.ContentFilter.TYPE_IMG_AND_VID:e=new TD.vo.Filter(TD.vo.Filter.HAS_MEDIA,!0,!0),i.push(e);break;case TD.vo.ContentFilter.TYPE_LINKS:e=new TD.vo.Filter(TD.vo.Filter.HAS_LINK,!0,!0),i.push(e)}return this.matching&&(t=TD.services.TwitterSearchParser.extractPhrases(this.matching,!1),t.forEach(function(t){e=new TD.vo.Filter(TD.vo.Filter.PHRASE,t,!0),i.push(e)})),this.excluding&&(t=TD.services.TwitterSearchParser.extractPhrases(this.excluding,!1),t.forEach(function(t){e=new TD.vo.Filter(TD.vo.Filter.PHRASE,t,!1),i.push(e)})),this.includeRTs||(e=new TD.vo.Filter(TD.vo.Filter.IS_RETWEET,!1,!0),i.push(e)),i},TD.vo.ContentFilter.prototype.hasActiveMediaFilter=function(){return[TD.vo.ContentFilter.TYPE_IMG,TD.vo.ContentFilter.TYPE_VID,TD.vo.ContentFilter.TYPE_GIF,TD.vo.ContentFilter.TYPE_VINE,TD.vo.ContentFilter.TYPE_IMG_AND_VID].indexOf(this.type)>-1},TD.vo.EngagementFilter=function(e){this.fromJSONObject(e)},TD.vo.EngagementFilter.prototype.minReplies=0,TD.vo.EngagementFilter.prototype.minRetweets=0,TD.vo.EngagementFilter.prototype.minFavorites=0,TD.vo.EngagementFilter.prototype.setMinReplies=function(e){this.minReplies=parseInt(e,10)},TD.vo.EngagementFilter.prototype.setMinRetweets=function(e){this.minRetweets=parseInt(e,10)},TD.vo.EngagementFilter.prototype.setMinFavorites=function(e){this.minFavorites=parseInt(e,10)},TD.vo.EngagementFilter.prototype.toJSONObject=function(){return{minReplies:this.minReplies,minRetweets:this.minRetweets,minFavorites:this.minFavorites}},TD.vo.EngagementFilter.prototype.fromJSONObject=function(e){e&&(this.setMinReplies(e.minReplies),this.setMinRetweets(e.minRetweets),this.setMinFavorites(e.minFavorites))},TD.vo.EngagementFilter.prototype.getQueryString=function(){if(!TD.decider.get("engagement_filter"))return"";var e=[];return this.minReplies>0&&e.push("min_replies:"+this.minReplies),this.minRetweets>0&&e.push("min_retweets:"+this.minRetweets),this.minFavorites>0&&e.push("min_faves:"+this.minFavorites),e.join(" ")},TD.vo.EngagementFilter.prototype.getSummaryText=function(){var e,t=[];switch(this.minReplies>0&&t.push({count:this.minReplies,label:TD.i("replies")}),this.minRetweets>0&&t.push({count:this.minRetweets,label:TD.i("retweets")}),this.minFavorites>0&&t.push({count:this.minFavorites,label:TD.i("favorites")}),t.length){case 0:e=TD.i("any");break;case 1:e=TD.i("at least {{#0}}{{count}} {{label}}{{/0}}",t);break;case 2:e=TD.i("at least {{#0}}{{count}} {{label}}{{/0}} and {{#1}}{{count}} {{label}}{{/1}}",t);break;case 3:e=TD.i("at least {{#0}}{{count}} {{label}}{{/0}}, {{#1}}{{count}} {{label}}{{/1}} and {{#2}}{{count}} {{label}}{{/2}}",t)}return e},TD.vo.EngagementFilter.prototype.getFilters=function(){return[]},TD.vo.UserFilter=function(e){this.fromJSONObject(e)},TD.vo.UserFilter.FROM_ALL="all",TD.vo.UserFilter.FROM_USER="user",TD.vo.UserFilter.FROM_VERIFIED="verified",TD.vo.UserFilter.FROM_LIST="list",TD.vo.UserFilter.prototype.from_type=null,TD.vo.UserFilter.prototype.from_name=null,TD.vo.UserFilter.prototype.mention_name=null,TD.vo.UserFilter.prototype.setFrom=function(e,t){t&&e!==TD.vo.UserFilter.FROM_VERIFIED&&e!==TD.vo.UserFilter.FROM_ALL||(t=""),this.from_type=e,this.from_name=TD.util.deMentionify(t)},TD.vo.UserFilter.prototype.setMentioned=function(e){this.mention_name=e||"",this.mention_name=TD.util.deMentionify(this.mention_name)},TD.vo.UserFilter.prototype.toJSONObject=function(){return{from_type:this.from_type,from_name:this.from_name,mention_name:this.mention_name}},TD.vo.UserFilter.prototype.fromJSONObject=function(e){e&&(this.setFrom(e.from_type,e.from_name),this.setMentioned(e.mention_name))},TD.vo.UserFilter.prototype.getQueryString=function(){var e=[];switch(this.from_type){case TD.vo.UserFilter.FROM_USER:e.push("from:"+this.from_name);break;case TD.vo.UserFilter.FROM_VERIFIED:e.push("filter:verified");break;case TD.vo.UserFilter.FROM_LIST:e.push("list:"+this.from_name)}return this.mention_name&&e.push("+@"+this.mention_name),e.join(" ")},TD.vo.UserFilter.prototype.getSummaryText=function(){var e,t=[];switch(this.from_type){case TD.vo.UserFilter.FROM_USER:e=TD.storage.accountController.getAccountFromUsername(this.from_name).length>0,t.push(e?TD.i("by me (@{{{name}}})",{name:this.from_name}):TD.i("by @{{{name}}}",{name:this.from_name}));break;case TD.vo.UserFilter.FROM_VERIFIED:t.push(TD.i("by verified users"));break;case TD.vo.UserFilter.FROM_LIST:t.push(TD.i("by members of @{{{name}}}",{name:this.from_name}))}return this.mention_name&&(e=TD.storage.accountController.getAccountFromUsername(this.mention_name).length>0,t.push(e?TD.i("mentioning me (@{{{name}}})",{name:this.mention_name}):TD.i("mentioning @{{{name}}}",{name:this.mention_name}))),0===t.length&&t.push(TD.i("any")),t.join(", ")},TD.vo.UserFilter.prototype.getFilters=function(){var e,t=[];switch(this.mention_name&&(e=new TD.vo.Filter(TD.vo.Filter.PHRASE,TD.util.atMentionify(this.mention_name),!0),t.push(e)),this.from_type){case TD.vo.UserFilter.FROM_USER:e=new TD.vo.Filter(TD.vo.Filter.SENDER,this.from_name,!0),t.push(e);break;case TD.vo.UserFilter.FROM_VERIFIED:e=new TD.vo.Filter(TD.vo.Filter.IS_FROM_VERIFIED,!0,!0),t.push(e)}return t},TD.util.columnUtils=function(){var e={};return e.storageColumnTypes={OTHER:"other",HOME:"home",ME:"me",INBOX:"privateMe",SCHEDULED:"scheduled"},e.feedTypes={HOME:"home",USERTIMELINE:"usertimeline",INTERACTIONS:"interactions",MENTIONS:"mentions",SEARCH:"search",LIST:"list",CUSTOMTIMELINE:"customtimeline",DIRECT:"direct",USERTWEETS:"usertweets",FAVORITES:"favorites",NETWORKACTIVITY:"networkactivity",SCHEDULED:"scheduled",DATAMINR:"dataminr"},e.columnMetaTypes={TIMELINE:"col_timeline",INTERACTIONS:"col_interactions",MENTIONS:"col_mentions",FOLLOWERS:"col_followers",SEARCH:"col_search",LIST:"col_list",CUSTOMTIMELINE:"col_customtimeline",MESSAGES:"col_messages",USERTWEETS:"col_usertweets",FAVORITES:"col_favorites",ACTIVITY:"col_activity",DATAMINR:"col_dataminr",HOME:"col_home",ME:"col_me",INBOX:"col_inbox",SCHEDULED:"col_scheduled",UNKNOWN:"col_unknown"},e.columnMetaTypeToScribeNamespace={},TD.util.extendObjectWith(e.columnMetaTypeToScribeNamespace,[[e.columnMetaTypes.TIMELINE,{page:"home",section:""}],[e.columnMetaTypes.INTERACTIONS,{page:"connect",section:"activity"}],[e.columnMetaTypes.MENTIONS,{page:"connect",section:"mentions"}],[e.columnMetaTypes.SEARCH,{page:"search",section:"tweets"}],[e.columnMetaTypes.LIST,{page:"list",section:"tweets"}],[e.columnMetaTypes.USERTWEETS,{page:"profile_tweets",section:""}],[e.columnMetaTypes.FAVORITES,{page:"favorites",section:""}],[e.columnMetaTypes.ACTIVITY,{page:"network_activity",section:""}],[e.columnMetaTypes.DATAMINR,{page:"dataminr",section:"watchlist"}],[e.columnMetaTypes.HOME,{page:"home",section:""}],[e.columnMetaTypes.ME,{page:"connect",section:"mentions"}]]),e.columnIconClasses={TWITTER:"icon-twitter-bird",HASH:"icon-hash",CONTENT:"icon-content",USER:"icon-user",HOME:"icon-home",INTERACTIONS:"icon-notifications",ACTIVITY:"icon-activity",MENTIONS:"icon-mention",FOLLOWERS:"icon-follow",MESSAGES:"icon-message",SEARCH:"icon-search",LIST:"icon-list",TWEETS:"icon-tweets",FAVORITES:"icon-favorite",SCHEDULED:"icon-schedule",TRENDS:"icon-trending",CUSTOMTIMELINE:"icon-custom-timeline",DATAMINR:"icon-dataminr"},e.columnClasses={TWITTER:"type-twitter",HOME:"column-type-home",INTERACTIONS:"column-type-interactions",ACTIVITY:"column-type-activity",MENTIONS:"column-type-mention",FOLLOWERS:"column-type-new-followers",MESSAGES:"column-type-message",SEARCH:"column-type-search",LIST:"column-type-list",CUSTOMTIMELINE:"column-type-customtimeline",TWEETS:"column-type-tweets",FAVORITES:"column-type-favorite",SCHEDULED:"column-type-scheduled",TRENDS:"column-type-trends"},e.columnMetaTypeToIconClass={},TD.util.extendObjectWith(e.columnMetaTypeToIconClass,[[e.columnMetaTypes.TIMELINE,e.columnIconClasses.HOME],[e.columnMetaTypes.INTERACTIONS,e.columnIconClasses.INTERACTIONS],[e.columnMetaTypes.MENTIONS,e.columnIconClasses.MENTIONS],[e.columnMetaTypes.FOLLOWERS,e.columnIconClasses.FOLLOWERS],[e.columnMetaTypes.SEARCH,e.columnIconClasses.SEARCH],[e.columnMetaTypes.LIST,e.columnIconClasses.LIST],[e.columnMetaTypes.CUSTOMTIMELINE,e.columnIconClasses.CUSTOMTIMELINE],[e.columnMetaTypes.MESSAGES,e.columnIconClasses.MESSAGES],[e.columnMetaTypes.USERTWEETS,e.columnIconClasses.USER],[e.columnMetaTypes.FAVORITES,e.columnIconClasses.FAVORITES],[e.columnMetaTypes.ACTIVITY,e.columnIconClasses.ACTIVITY],[e.columnMetaTypes.HOME,e.columnIconClasses.HOME],[e.columnMetaTypes.ME,e.columnIconClasses.MENTIONS],[e.columnMetaTypes.INBOX,e.columnIconClasses.MESSAGES],[e.columnMetaTypes.SCHEDULED,e.columnIconClasses.SCHEDULED],[e.columnMetaTypes.UNKNOWN,e.columnIconClasses.TWITTER],[e.columnMetaTypes.DATAMINR,e.columnIconClasses.DATAMINR]]),e.columnMetaTypeToClass={},TD.util.extendObjectWith(e.columnMetaTypeToClass,[[e.columnMetaTypes.TIMELINE,e.columnClasses.HOME],[e.columnMetaTypes.INTERACTIONS,e.columnClasses.INTERACTIONS],[e.columnMetaTypes.MENTIONS,e.columnClasses.MENTIONS],[e.columnMetaTypes.FOLLOWERS,e.columnClasses.FOLLOWERS],[e.columnMetaTypes.SEARCH,e.columnClasses.SEARCH],[e.columnMetaTypes.LIST,e.columnClasses.LIST],[e.columnMetaTypes.CUSTOMTIMELINE,e.columnClasses.CUSTOMTIMELINE],[e.columnMetaTypes.MESSAGES,e.columnClasses.MESSAGES],[e.columnMetaTypes.USERTWEETS,e.columnClasses.TWEETS],[e.columnMetaTypes.FAVORITES,e.columnClasses.FAVORITES],[e.columnMetaTypes.ACTIVITY,e.columnClasses.ACTIVITY],[e.columnMetaTypes.HOME,e.columnClasses.HOME],[e.columnMetaTypes.ME,e.columnClasses.MENTIONS],[e.columnMetaTypes.INBOX,e.columnClasses.MESSAGES],[e.columnMetaTypes.SCHEDULED,e.columnClasses.SCHEDULED],[e.columnMetaTypes.UNKNOWN,e.columnClasses.TWITTER]]),e.columnMetaTypeToTitleTemplateData={},TD.util.extendObjectWith(e.columnMetaTypeToTitleTemplateData,[[e.columnMetaTypes.TIMELINE,{title:TD.i("Home",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.INTERACTIONS,{title:TD.i("Notifications",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.MENTIONS,{title:TD.i("Mentions",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.FOLLOWERS,{title:TD.i("Followers",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.SEARCH,{needsUserAttribution:!0}],[e.columnMetaTypes.LIST,{needsUserAttribution:!0}],[e.columnMetaTypes.CUSTOMTIMELINE,{needsUserAttribution:!0,editableFieldClass:"js-customtimeline-title",maxLength:25}],[e.columnMetaTypes.MESSAGES,{title:TD.i("Messages",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.USERTWEETS,{title:TD.i("User",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.FAVORITES,{title:TD.i("Favorites",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.ACTIVITY,{title:TD.i("Activity",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.HOME,{title:TD.i("Home",null,!0)}],[e.columnMetaTypes.ME,{title:TD.i("Mentions",null,!0)}],[e.columnMetaTypes.INBOX,{title:TD.i("Messages",null,!0)}],[e.columnMetaTypes.SCHEDULED,{title:TD.i("Scheduled",null,!0),needsUserAttribution:!0}],[e.columnMetaTypes.DATAMINR,{needsUserAttribution:!0}],[e.columnMetaTypes.UNKNOWN,{title:TD.i("Unknown Column",null,!0)}]]),e.embeddableColumnTypes=[e.columnMetaTypes.FAVORITES,e.columnMetaTypes.USERTWEETS,e.columnMetaTypes.SEARCH,e.columnMetaTypes.LIST,e.columnMetaTypes.CUSTOMTIMELINE],e.shareableColumnTypes=[e.columnMetaTypes.CUSTOMTIMELINE],e.viewableColumnTypes=[e.columnMetaTypes.CUSTOMTIMELINE],e.filterableColumnTypes=[e.columnMetaTypes.TIMELINE,e.columnMetaTypes.INTERACTIONS,e.columnMetaTypes.MENTIONS,e.columnMetaTypes.FOLLOWERS,e.columnMetaTypes.SEARCH,e.columnMetaTypes.LIST,e.columnMetaTypes.CUSTOMTIMELINE,e.columnMetaTypes.MESSAGES,e.columnMetaTypes.USERTWEETS,e.columnMetaTypes.FAVORITES,e.columnMetaTypes.ACTIVITY,e.columnMetaTypes.HOME,e.columnMetaTypes.ME,e.columnMetaTypes.INBOX,e.columnMetaTypes.SCHEDULED,e.columnMetaTypes.DATAMINR],e.actionColumnTypes=[e.columnMetaTypes.INTERACTIONS,e.columnMetaTypes.MENTIONS,e.columnMetaTypes.ACTIVITY,e.columnMetaTypes.FOLLOWERS],e.singleActionColumnTypes=[e.columnMetaTypes.MENTIONS,e.columnMetaTypes.FOLLOWERS],e.mediaPreviewableColumnTypes=[e.columnMetaTypes.TIMELINE,e.columnMetaTypes.INTERACTIONS,e.columnMetaTypes.MENTIONS,e.columnMetaTypes.SEARCH,e.columnMetaTypes.LIST,e.columnMetaTypes.CUSTOMTIMELINE,e.columnMetaTypes.USERTWEETS,e.columnMetaTypes.FAVORITES,e.columnMetaTypes.ACTIVITY,e.columnMetaTypes.HOME,e.columnMetaTypes.ME,e.columnMetaTypes.DATAMINR],e.combinedColumnTypes={},TD.util.extendObjectWith(e.combinedColumnTypes,[[e.columnMetaTypes.ME,!0],[e.columnMetaTypes.INBOX,!0],[e.columnMetaTypes.SCHEDULED,!0]]),e.getColumnType=function(t){var i=t.model.getType(),n=t.getFeeds();switch(i){case e.storageColumnTypes.HOME:return e.columnMetaTypes.HOME;case e.storageColumnTypes.ME:return e.columnMetaTypes.ME;case e.storageColumnTypes.INBOX:return e.columnMetaTypes.INBOX;case e.storageColumnTypes.SCHEDULED:return e.columnMetaTypes.SCHEDULED;default:return 1===n.length?e._inferColumnTypeFromFeed(n[0],t):e.columnMetaTypes.UNKNOWN}},e.isMessageColumn=function(t){var i=e.getColumnType(t);return i===e.columnMetaTypes.MESSAGES||i===e.columnMetaTypes.INBOX},e._twitterFeedTypeToColumnMetaType={},TD.util.extendObjectWith(e._twitterFeedTypeToColumnMetaType,[[e.feedTypes.HOME,e.columnMetaTypes.TIMELINE],[e.feedTypes.USERTIMELINE,e.columnMetaTypes.TIMELINE],[e.feedTypes.INTERACTIONS,e.columnMetaTypes.INTERACTIONS],[e.feedTypes.MENTIONS,e.columnMetaTypes.MENTIONS],[e.feedTypes.SEARCH,e.columnMetaTypes.SEARCH],[e.feedTypes.LIST,e.columnMetaTypes.LIST],[e.feedTypes.CUSTOMTIMELINE,e.columnMetaTypes.CUSTOMTIMELINE],[e.feedTypes.DIRECT,e.columnMetaTypes.MESSAGES],[e.feedTypes.USERTWEETS,e.columnMetaTypes.USERTWEETS],[e.feedTypes.FAVORITES,e.columnMetaTypes.FAVORITES],[e.feedTypes.NETWORKACTIVITY,e.columnMetaTypes.ACTIVITY],[e.feedTypes.DATAMINR,e.columnMetaTypes.DATAMINR]]),e._inferColumnTypeFromFeed=function(t,i){var n,s,r,a=t.getService(),o=t.getType(),c=t.getMetadata(),l=e.columnMetaTypes.UNKNOWN;if("twitter"===a)switch(l=e._twitterFeedTypeToColumnMetaType[o]||l,o){case e.feedTypes.SEARCH:var u=twttr.txt.extractMentionsWithIndices(c.term);
if(1===u.length){var d=u[0];0===d.indices[0]&&d.indices[1]===c.term.length&&(l=e.columnMetaTypes.MENTIONS)}break;case e.feedTypes.INTERACTIONS:n=i.model.getFilters(),n&&(s=new TD.vo.ActionFilter(n.action),r=TD.vo.ActionFilter.MAX_INTERACTION_FILTERS,s.getFilters().length===r-1&&s.showFollowers&&(l=e.columnMetaTypes.FOLLOWERS))}return l},e.getColumnIconClassByColumnType=function(t){return e.columnMetaTypeToIconClass[t]},e.getColumnClassByColumnType=function(t){return e.columnMetaTypeToClass[t]},e.getColumnTitleHTML=function(t,i){i=i||{};for(var n,s,r,a,o,c,l,u,d,h,p=!1,m=t.getColumnType(),f=t.getFeeds(),g=t.model.getTitle(),v=e.columnMetaTypeToTitleTemplateData[m],T={},b=0;b<f.length;b++){if(n=f[b],s=n.getType(),r=n.getMetadata())switch(s){case e.feedTypes.LIST:c=TD.cache.names.getScreenName(r.ownerId),d=TD.cache.names.getListName(r.listId,r.ownerId),d?T.title=d:p=!0;break;case e.feedTypes.CUSTOMTIMELINE:c=TD.cache.names.getScreenName(r.ownerId),l=TD.storage.accountController.get(n.getAccountKey()).getProfileImageURL(),h=TD.cache.names.getCustomTimelineName(r.id),T.title=h;break;case e.feedTypes.SEARCH:m===e.columnMetaTypes.MENTIONS?c=r.term:u=r.baseQuery?r.baseQuery:r.term,u?T.title=u:p=!0;break;case e.feedTypes.DATAMINR:T.title=r.watchlist.name;break;default:r.id?(c=TD.cache.names.getScreenName(r.id),c||(p=!0)):m===e.columnMetaTypes.SCHEDULED&&(c=TD.i("All accounts")),T.title=v.title}c||(a=TD.storage.accountController.get(n.getAccountKey()),o=a.getType(),"tweetdeck"!==o&&(c=a.getUsername(),"twitter"===o&&(c=TD.util.atMentionify(c))))}return v.needsUserAttribution&&(c?(T.needsUserAttribution=v.needsUserAttribution,T.screenName=c,T.profileImageURL=l):p=!0),p?TD.util.escape(g):m===e.columnMetaTypes.UNKNOWN?g?TD.util.escape(g):TD.ui.template.render("column_title",T):i.editable?(T.editableFieldClass=v.editableFieldClass,T.maxLength=v.maxLength,TD.ui.template.render("column_title_editable",T)):TD.ui.template.render("column_title",T)},e.inferFeedTypeFromActionFilter=function(e){var t=this.feedTypes.INTERACTIONS;return e.getFilters().length===TD.vo.ActionFilter.MAX_INTERACTION_FILTERS-1&&e.showMentions&&(t=this.feedTypes.MENTIONS),t},e}(),TD.cache.lists=function(){function e(e){var i=t[e]||{};return t[e]=i,i}var t={},i={};return i.add=function(t){var i=e(t.account.getKey());i[t.id]=t,TD.controller.feedManager.fixListFeeds(),TD.cache.names.updateScreenName(t.user.id,t.user.screenName),TD.cache.names.updateListName(t.id,t.name)},i.unsubscribe=function(t){var i=e(t.account.getKey());delete i[t.id]},i.purge=function(e){var i;if(_.each(t,function(t,n){i=i||t[e],delete t[e]}),i){var n=TD.storage.Feed.generateKeyFor(i.account.getKey(),"list",{listId:e});TD.controller.feedManager.deleteFeedsWhere(function(e){return e.getKey()===n})}},i.getListsFor=function(t){return _.values(e(t))},i.find=function(e,i,n,s,r){var a,o=void 0,c=void 0;return i&&n&&(a="@"+i.toLowerCase()+"/"+n.toLowerCase()),_.each(t,function(t,i){r&&r!==i||_.each(t,function(t,i){(e&&t.id===e||t.fullName.toLowerCase()===a)&&(t.isOwnList()?o=t:c=t)})}),s?o:o||c},i.getAll=function(){var e={};return _.each(t,function(t,i){_.extend(e,t)}),_.values(e)},i}(),TD.cache.LRUQueue=klass(function(e){this.maxSize=e,this.length=0,this._first=void 0,this._last=void 0,this._index={},this._lefts={},this._rights={}}).methods({enqueue:function(e,t){e&&(this.dequeue(e),0==this.length?this._first=this._last=e:(this._lefts[this._first]=e,this._rights[e]=this._first,this._first=e),this._index[e]=t,this.length++,this.prune())},dequeue:function(e){if(!_.isUndefined(this._index[e])){var t=this._lefts[e],i=this._rights[e];t?this._rights[t]=i:this._first=i,i?this._lefts[i]=t:this._last=t,delete this._index[e],delete this._rights[e],delete this._lefts[e],this.length--}},prune:function(){for(;this.maxSize&&this.length>this.maxSize;)this.dequeue(this._last)},get:function(e){return this._index[e]},getOrElse:function(e,t){var i=this._index[e];return void 0===i&&(i=_.isFunction(t)?t():t,this.enqueue(e,i)),i},take:function(e){var t=[],i=this._first;e=Math.min(e,this.length);for(var n=0;e>n;n++)t.push(this._index[i]),i=this._rights[i];return t}}),TD.cache.names=function(){return self={SECONDS_IN_ONE_WEEK:604800,_cache:null},self.init=function(){self._cache=TD.settings.getNameCache(),self._cache.users=self._cache.users||{},self._cache.lists=self._cache.lists||{},self._cache.customTimelines=self._cache.customTimelines||{},$.subscribe("/storage/client/column_order_changed",function(){self.prune(),self.commit()}),$.subscribe("/storage/column/feeds_changed",function(e,t,i){var n=TD.storage.columnController.get(i.getKey());n&&!n.temporary&&self.commit()})},self.getScreenName=function(e){var t,i,n=TD.util.unixTime(new Date),s=TD.storage.Account.generateKeyFor("twitter",e),r=TD.storage.accountController.get(s);return r?(i=TD.util.atMentionify(r.getUsername()),self.addScreenName(e,i)):(t=self._cache.users[e],t&&(i=t.name),(!t||t.timestamp+self.SECONDS_IN_ONE_WEEK<n)&&self._fetchUser(e)),i},self.getListName=function(e,t){var i,n,s=TD.util.unixTime(new Date),r=TD.cache.lists.find(e,"","");return r?(i=r.name,self.addListName(e,i)):(n=self._cache.lists[e],n&&(i=n.name),(!n||n.timestamp+self.SECONDS_IN_ONE_WEEK<s)&&self._fetchList(e,t)),i},self.getCustomTimelineName=function(e,t){var i,n,s=TD.util.unixTime(new Date);return n=self._cache.customTimelines[e],n&&(i=n.name),(!n||n.timestamp+self.SECONDS_IN_ONE_WEEK<s)&&self._fetchCustomTimeline(e,t),i},self.addScreenName=function(e,t){if(self._cache){var i={},n=self._cache.users[e],s=TD.util.atMentionify(t),r=!n||s!==n.name;i.name=s,i.timestamp=TD.util.unixTime(new Date),self._cache.users[e]=i,r&&(self.commit(),TD.storage.notification.notify("/cache/names/change"))}},self.addListName=function(e,t){if(self._cache){var i={},n=self._cache.lists[e],s=!n||t!==n.name;i.name=t,i.timestamp=TD.util.unixTime(new Date),self._cache.lists[e]=i,s&&(self.commit(),TD.storage.notification.notify("/cache/names/change"))}},self.addCustomTimelineName=function(e,t){if(self._cache&&t){var i={},n=self._cache.customTimelines[e],s=!n||t!==n.name;i.name=t,i.timestamp=TD.util.unixTime(new Date),self._cache.customTimelines[e]=i,s&&(self.commit(),TD.storage.notification.notify("/cache/names/change"))}},self.updateScreenName=function(e,t){if(self._cache){var i=self._cache.users[e];i&&self.addScreenName(e,t)}},self.updateListName=function(e,t){if(self._cache){var i=self._cache.lists[e];i&&self.addScreenName(e,t)}},self.updateCustomTimelineName=function(e,t){if(self._cache){var i=self._cache.customTimelines[e];i&&self.addCustomTimelineName(e,t)}},self._fetchUser=function(e){var t=TD.cache.twitterUsers.getById(e);t.addCallback(function(t){self.addScreenName(e,t.screenName)})},self._fetchList=function(e,t){var i=TD.storage.Account.generateKeyFor("twitter",t),n=TD.controller.clients.getClient(i);n=n||TD.controller.clients.getPreferredClient("twitter"),n.getList(e,null,null,function(t){self.addListName(e,t.name)})},self._fetchCustomTimeline=function(e,t){var i=TD.storage.Account.generateKeyFor("twitter",t),n=TD.controller.clients.getClient(i);n=n||TD.controller.clients.getPreferredClient("twitter"),n.getCustomTimeline(e,function(t){self.addCustomTimelineName(e,t.name)})},self.commit=_.debounce(function(){self.prune(),TD.settings.setNameCache(self._cache)},100),self.prune=function(){self._cache=self._getPrunedCache()},self._getPrunedCache=function(){var e={users:{},lists:{},customTimelines:{}},t=TD.storage.feedController.getAll();return _.each(t,function(t){var i,n,s,r=t.getType(),a=t.getMetadata();if(a){switch(r){case TD.util.columnUtils.feedTypes.CUSTOMTIMELINE:s=a.id,i=a.ownerId;break;case TD.util.columnUtils.feedTypes.LIST:n=a.listId,i=a.ownerId;break;default:i=a.id}i&&self._cache.users[i]&&(e.users[i]=self._cache.users[i]),s&&self._cache.customTimelines[s]&&(e.customTimelines[s]=self._cache.customTimelines[s]),n&&self._cache.lists[n]&&(e.lists[n]=self._cache.lists[n])}}),e},self}(),TD.cache.twitterUsers=function(){function e(){_.each(r.splice(a),function(e){delete n[e.id],delete s[e.screenName.toLowerCase()]})}function t(e,t){var i,r,a,o;return e||t?(i=e?n[e]:s[t.toLowerCase()],i?o=TD.core.defer.succeed(i):(r=TD.storage.accountController.getPreferredAccount("twitter"),a=TD.controller.clients.getClient(r.getKey()),o=new TD.core.defer.Deferred,a.showUser(e,t,function(e){o.callback(e)},function(i,n,s){o.errback(new TD.core.defer.XMLHttpRequestError(i,s)),i&&i.errors&&i.errors.forEach(function(i){i===a.ERRORS.SUSPENDED_USER&&$.publish("/user/suspended",[e,t])})}))):o=TD.core.defer.fail("Must provide user ID or screen name"),o}var i={},n={},s={},r=[],a=500;return i.add=function(t){var i=n[t.id];i?delete s[i.screenName.toLowerCase()]:r.unshift(t),n[t.id]=t,s[t.screenName.toLowerCase()]=t,$(document).trigger("dataCachedTwitterUser",t),e()},i.getById=function(e){return t(e,null)},i.getByScreenName=function(e){return t(null,e)},i}(),TD.controller.clients=function(){var e={},t=300,i=function(e,t){switch(e){case"twitter":return new TD.services.TwitterClient(t);case"tweetdeck":return new TD.services.TweetDeckClient}};return{init:function(){$.subscribe("/storage/account/new",function(e){TD.controller.clients.initialiseClients()}),$(document).on("dataContributees",this.handleContributees.bind(this)).on("uiContributeeInviteAccept",this.handleContributeeInviteAccept.bind(this)),TD.controller.clients.initialiseClients()},initialiseClients:function(){for(var n,s=TD.storage.accountController.getPostingAccounts(),r=0;r<s.length;r++)n=e[s[r].getKey()],n||(n=i(s[r].getType(),s[r]),e[s[r].getKey()]=n);e.tweetdeck||(e.tweetdeck=new TD.services.TweetDeckClient),TD.controller.scheduler.schedulePeriodicTask(1200,TD.controller.clients.refreshRetweetBlockLists),TD.controller.scheduler.schedulePeriodicTask(t,this.fetchContributees.bind(this),!0)},getClient:function(t){return e[t]},getTDClient:function(){return e.tweetdeck},getClientsByService:function(t){var i=[];for(var n in e)e[n].type==t&&i.push(e[n]);return i},getPreferredClient:function(e){var t=TD.storage.accountController.getPreferredAccount(e);return t?this.getClient(t.getKey()):void 0},showSharedAccountWarning:function(){var e=new TD.core.defer.Deferred,t=function(){$(document).off("uiAccountSharedWarningContinue uiAccountSharedWarningAbort")},i=function(){$(document).trigger("uiShowAccountSettings")};return $(document).on("uiAccountSharedWarningContinue",function(){t(),i(),e.callback()}).on("uiAccountSharedWarningAbort",function(){t(),i(),e.cancel()}).on("uiAccountSharedWarningDismiss",function(){t(),e.cancel()}).trigger("uiShowAccountSharedWarning"),e},addClient:function(e,t){var i=new TD.core.defer.Deferred,n=TD.settings.getSoleUserState(),s=TD.storage.store.getCurrentAuthType();"twitter"===s&&n.shared&&(i.addCallback(this.showSharedAccountWarning.bind(this)),i.addCallback(function(){n.confirmed=!0,TD.settings.setSoleUserState(n)})),i.addCallback(function(){this.startAddClientFlow(e,t)}.bind(this)),i.callback()},startAddClientFlow:function(e,t){t||(t=new TD.storage.Account,t.setType(e));var i=function(){TD.storage.accountController.manage(t),this.initialiseClients()}.bind(this),n=TD.controller.auth.create(e,t),s=this.getClientsByService(e).length>0;$(document).trigger("metric",{key:"account:manage:start"}),n.start(t,i,s)},removeClient:function(t){var i=TD.storage.accountController.get(t);i&&(e[t]&&e[t].cleanUp&&e[t].cleanUp(),delete e[t],TD.controller.feedManager.deleteFeedsWhere(function(e){return e.getAccountKey()===t}),TD.storage.accountController.blacklistAccount(i))},refreshRetweetBlockLists:function(){if(TD.util.shouldStream()){var e=TD.controller.clients.getClientsByService("twitter");_.each(e,function(e){e.populateRetweetBlockList()})}},fetchContributees:function(){var e=TD.storage.store.getTwitterLoginAccount();e&&$(document).trigger("uiNeedsContributees",{accountKey:e.getKey()})},handleContributeeInviteAccept:function(e,t){var i=TD.storage.accountController.manageContributee(t);i.addCallback(function(){$(document).trigger("dataContributeeInviteSuccess",t)})},handleContributees:function(e,t){var i=TD.storage.store.getTwitterLoginAccount();t.accountKey===i.getKey()&&t.contributees.reduce(function(e,t){return TD.storage.accountController.isContributeeManaged(t)?e.concat([t]):($(document).trigger("dataContributeeNotManaged",t),e)},[]).forEach(function(e){TD.storage.accountController.manageContributee(e)})}}}(),TD.controller.scheduler=function(){var e={};return e.QUERY_INTERVAL=10,e.SLEEP_THRESHOLD=20,e.POST_SLEEP_DELAY=3,e._tickInterval,e._tasks={},e._lastTickTime=null,e.init=function(){this._tickInterval=setInterval(this._handleTick,1e3*this.QUERY_INTERVAL),e._lastTickTime=Date.now(),this._jQueryCleanupTaskId=TD.controller.scheduler.schedulePeriodicTask(600,function(){jQuery.fragments={}}),TD.controller.feedScheduler.init()},e._handleTick=function(){var t=Date.now(),i=(t-e._lastTickTime)/1e3-e.QUERY_INTERVAL;e._lastTickTime=t,i>e.SLEEP_THRESHOLD&&setTimeout(function(){$(document).trigger("dataAppWokenFromSleep",{lateness:i})},1e3*e.POST_SLEEP_DELAY),_.each(e._tasks,function(i){var n=t-i.cycleStartTime;n>i.period&&(e._fireTask(i),i.cycleStartTime=Date.now())})},e._fireTask=function(e){try{e.callback()}catch(t){console.log("Error in periodic task:",e,"Error:",t)}},e.schedulePeriodicTask=function(e,t,i){var n={id:_.uniqueId("sched_task_"),callback:t,period:1e3*e,cycleStartTime:Date.now()};return i&&this._fireTask(n),this._tasks[n.id]=n,n.id},e.updatePeriodicTask=function(e,t,i){var n=this._tasks[e];n&&(n.period=1e3*t,n.callback=i||n.callback)},e.restartPeriodicTask=function(e){var t=this._tasks[e];t&&(t.cycleStartTime=Date.now())},e.removePeriodicTask=function(e){delete this._tasks[e]},e}(),TD.controller.feedScheduler=function(){var e={};return e.DEFAULT_REFRESH_PERIOD=45,e.THROTTLED_REFRESH_PERIOD=120,e._activeColumns={},e._temporaryColumns={},e._taskIndex={},e.init=function(){this._refreshTaskId=TD.controller.scheduler.schedulePeriodicTask(10,this._trimColumns.bind(this),!1),this._streamingTaskId=TD.controller.scheduler.schedulePeriodicTask(120,this._startStreams.bind(this),!1),$.subscribe("/storage/column/feeds_changed",function(t,i,n){var s=n.getKey(),r=TD.controller.columnManager.get(s);r&&e.addColumn(r,!r.temporary)}),$.subscribe("/storage/column/change",function(t){var i=t.getKey(),n=TD.controller.columnManager.get(i);if(n){var s=n.model.getFeedKeys(),r=t.getFeedKeys();_.isEqual(s,r)||e.addColumn(n,!n.temporary)}}),$(document).on("dataRateLimit",this._handleRateLimitData.bind(this)),$(document).on("dataThrottleFeed",this._handleThrottleFeed.bind(this)),$(document).on("dataUserStreamStatus",this._handleStreamStatus.bind(this)),$(document).on("dataAppWokenFromSleep",this._handleAppWoken.bind(this)),$(document).on("dataTwitterAccountAccessEnabled",this._handeAccessEnabled.bind(this))},e._getTask=function(e,t){return this._taskIndex[e]?this._taskIndex[e][t]:void 0},e._setTask=function(e,t,i){this._taskIndex[e]=this._taskIndex[e]||{},this._taskIndex[e][t]=i},e._handleRateLimitData=function(e,t){var i=this._getTask(t.accountKey,t.feedType);i&&(i.rateLimitData=t.rateLimitData,this._setPeriodicTask(i))},e._handleThrottleFeed=function(e,t){var i=this._getTask(t.accountKey,t.feedType);i&&i.isThrottled!==t.doThrottle&&(i.isThrottled=t.doThrottle,this._setPeriodicTask(i))},e._handleStreamStatus=function(t,i){var n=this._taskIndex[i.accountKey];_.each(n,e._setPeriodicTask.bind(this))},e._handleAppWoken=function(e,t){_.each(this._taskIndex,function(e){_.each(e,this._resetTask)}.bind(this)),TD.controller.stats.appWokenFromSleep(t.lateness)},e._handeAccessEnabled=function(e,t){this._taskIndex[t.accountKey]&&_.each(this._taskIndex[t.accountKey],this._resetTask,this)},e._resetTask=function(e){e.doTask({reset:!0}),TD.controller.scheduler.restartPeriodicTask(e.taskId)},e.addColumn=function(e,t){var i,n=e.getFeeds(),s=e.model.getKey();this._activeColumns[s]&&this.removeColumn(s),this._activeColumns[s]=e,e.temporary&&(this._temporaryColumns[s]=e);for(var r=0;r<n.length;r++)i=TD.controller.feedManager.addFeed(n[r]),i.publishChirpsOrFetch(),this._addFeed(n[r]);t&&this._startStreams()},e._addFeed=function(e){var t,i=e.getAccountKey(),n=e.getType(),s=e.getKey();t=this._getTask(i,n)||{accountKey:i,feedType:n,feeds:{},taskId:null,rateLimitData:null,isThrottled:!1,doTask:null},t.doTask||(t.doTask=this._doTaskFactory(t)),this._setTask(i,n,t),t.feeds[s]=e,this._setPeriodicTask(t)},e._setPeriodicTask=function(e){var t=this._calculatePeriod(e);e.taskId?TD.controller.scheduler.updatePeriodicTask(e.taskId,t):e.taskId=TD.controller.scheduler.schedulePeriodicTask(t,e.doTask,!1)},e._doTaskFactory=function(t){return function(i){var n=_.map(t.feeds,function(t,n){return e._refreshFeed(n,i)});return TD.core.defer.gatherResults(n)}},e._calculatePeriod=function(t){var i,n,s,r,a,o,c,l=this.DEFAULT_REFRESH_PERIOD;return t.rateLimitData&&(i=t.rateLimitData.rateLimitRemaining-10,n=t.rateLimitData.rateLimitTotal,s=t.rateLimitData.rateLimitReset+10,r=Date.now()/1e3,a=s-r,c=_.filter(t.feeds,function(t){var i=t.getKey(),n=Boolean(_.some(e._temporaryColumns,function(e){return-1!==e.model.getFeedKeys().indexOf(i)}));return n||!TD.controller.feedManager.isStreaming(i)}),a>0&&i>0&&c.length>0?(o=i/c.length,l=a/o,l=Math.min(l,a)):l=0>=a?this.DEFAULT_REFRESH_PERIOD:a),l=Math.round(l),l=Math.max(l,10),l=Math.min(l,900),(t.isThrottled||TD.decider.get("throttle_polling_period"))&&(l=Math.max(l,this.THROTTLED_REFRESH_PERIOD)),l},e._refreshFeed=function(e,t){var i=i||Boolean(_.some(this._temporaryColumns,function(t){return-1!==t.model.getFeedKeys().indexOf(e)})),n=TD.controller.feedManager.getPoller(e);return n.refresh(t)},e.removeColumn=function(e){delete this._activeColumns[e],delete this._temporaryColumns[e],this._rebuildTaskIndex(),TD.controller.feedManager.cleanupFeeds()},e._rebuildTaskIndex=function(){_.each(this._taskIndex,function(e){_.each(e,function(e){e.feeds={}})}),_.each(this._activeColumns,function(t){_.each(t.getFeeds(),function(t){e._addFeed(t)})}),_.each(this._taskIndex,function(e){_.each(e,function(e){_.isEmpty(e.feeds)&&(TD.controller.scheduler.removePeriodicTask(e.taskId),e.taskId=null)})})},e.refreshColumn=function(e){var t,i=this._activeColumns[e];if(i){t=i.getFeeds();for(var n=0;n<t.length;n++)this._refreshFeed(t[n].getKey())}},e.refreshAccountFeeds=function(e,t){_.each(this._taskIndex[e],function(e){e.doTask(t)})},e._startStreams=function(){for(var e=TD.storage.accountController.getAccountsForService("twitter"),t=0;t<e.length;t++)TD.controller.clients.getClient(e[t].getKey()).checkUserStream()},e._trimColumns=function(){_.each(this._activeColumns,function(e,t){e.trimUpdates()})},e}(),TD.controller.FeedPoller=function(e){this.OPTIMUM_ARRAY_LENGTH=200,this.CLEANUP_WAIT_PERIOD=12e4,this.TWEET_ID_QUEUE_LENGTH=500,this.REFRESH_LOCK_EXPIRY=6e4,this.feed=e,this.mark="",this.chirpArray=[],this.chirpIndex={},this.seenTweetIDs=new TD.cache.LRUQueue(this.TWEET_ID_QUEUE_LENGTH),this.refreshLock=0,this.isInitialLoad=!0,this.isExhausted=!1,this.lastInfiniteScrollTime=0,this.shouldTrackHighWaterMark=!1,this._checkNotifications=function(){var e=TD.storage.columnController.getColumnsContainingFeed(this.feed.getKey());this.shouldTrackHighWaterMark=e.some(function(e){return e.getHasSound()||e.getHasNotification()})},this._checkNotifications(),this.subscription=$.subscribe("/storage/column/column_flags_changed",this._checkNotifications.bind(this)),this.removeChirp=function(e){var t,i=this.chirpIndex[e];if(i){for(var n=0;n<this.chirpArray.length;n++)if(t=this.chirpArray[n],t===i){this.chirpArray.splice(n,1);break}delete this.chirpIndex[e],$.publish("/delete/"+this.feed.getKey(),[this,[i]])}},this.removeWhere=function(e){this.doWhere(e,function(e){this.removeChirp(e.id)}.bind(this))},this.doWhere=function(e,t){var i=this.chirpArray.filter(e);i.forEach(t)},this.removeAll=function(){for(var e=this.chirpArray.length;e--;)this.removeChirp(this.chirpArray[e].id);this.seenTweetIDs=new TD.cache.LRUQueue(this.TWEET_ID_QUEUE_LENGTH)},this.acceptChirps=function(e){if(e&&e.length){var t=this.addChirpsToMemCache(e);this.isInitialLoad&&!TD.settings.getShowStartupNotifications()&&this.saveHighWaterMark(),this.publishChirps(t),this.saveHighWaterMark()}else this.publishChirps([]);this.isInitialLoad=!1},this.saveHighWaterMark=function(){if(this.shouldTrackHighWaterMark){var t=this.chirpArray[0].getSortIndex();e.setTopSortIndex(t);var i=this.chirpArray[0].created.getTime();e.setLatestTime(Math.max(e.getLatestTime(),i))}},this.publishChirpsOrFetch=function(){return this.chirpArray&&this.chirpArray.length?this.publishAll():void this.refresh({reset:!0})},this.getBottomChirp=function(e){return e[e.length-1]},this.calculateUpperBound=function(e){if(e.length){var t,i,n,s=this.feed.getType(),r=TD.controller.FeedPoller.CURSORED_ON_TWEET_TIMESTAMP[s],a=s===TD.controller.FeedPoller.FEED_TYPES.search,o=TD.controller.FeedPoller.CURSORED_FEED_TYPES[s],c=TD.controller.FeedPoller.SCHEDULED_FEED_TYPES[s],l=s===TD.controller.FeedPoller.FEED_TYPES.dataminr,u=s===TD.controller.FeedPoller.FEED_TYPES.direct,d=this.getBottomChirp(e).id,h=TD.decider.get("universal_search_timelines"),p=function(e,t,i){return t>e.length-1?e:e.substr(0,t)+i+e.substr(t+1)};if(c)d=this.getBottomChirp(e).created.getTime()/1e3;else if(a&&h)d=h&&TD.decider.get("universal_search_timelines_by_id")?this.getBottomChirp(e).id:this.getBottomChirp(e).created.getTime()/1e3;else if(r)d=this.getBottomChirp(e).minPosition||this.getBottomChirp(e).created.getTime(),d-=1;else if(o){for(n=e.length-1;n>=0;n--)if(t=e[n],t.cursor){d=t.cursor;break}}else if(l)d=this.getBottomChirp(e).dataminr.created.getTime();else if(u)d=this.getBottomChirp(e).minEntryId;else if("string"==typeof d)for(n=d.length-1;n>=0;n--){if(i=d.charAt(n),"0"!==i){i=String(Number(i)-1),d=p(d,n,i);break}d=p(d,n,9)}else d--;return d}},this.calculateLowerBound=function(e){var t,i=this.feed.getType(),n=TD.controller.FeedPoller.CURSORED_ON_TWEET_TIMESTAMP[i],s=i===TD.controller.FeedPoller.FEED_TYPES.search,r=TD.controller.FeedPoller.CURSORED_FEED_TYPES[i],a=TD.controller.FeedPoller.SCHEDULED_FEED_TYPES[i],o=i===TD.controller.FeedPoller.FEED_TYPES.dataminr,c=i===TD.controller.FeedPoller.FEED_TYPES.usertweets,l=i===TD.controller.FeedPoller.FEED_TYPES.direct,u=1,d=0,h=TD.decider.get("universal_search_timelines");if(!e.length)return u;if(a)u=e[0].created.getTime()/1e3;else if(s&&h)u=h&&TD.decider.get("universal_search_timelines_by_id")?e[0].id:e[0].created.getTime()/1e3;else if(n)u=e[0].maxPosition||e[0].created.getTime().toString();else if(r){for(d=0;d<e.length;d++)if(t=e[d],t.cursor){u=t.cursor;break}}else if(o)u=e[0].dataminr.created.getTime();else if(l)u=e.length&&e[0].cursor;else if(c)u=e[0].getSinceId();else for(d=0;1===u&&d<e.length;)e[d].isOwnChirp()||(u=e[d].getSinceId()),d++;return u},this.addChirpsToMemCache=function(e){var t,i,n,s,r,a,o=[],c=[],l=!0;for(t=0;t<e.length;t++)i=e[t],n=this.chirpIndex[i.id],s=this.isRepeatedRetweet(i),n?n.update(i)&&c.push(n):s||(o.push(i),c.push(i),this.chirpIndex[i.id]=i);return o.sort(TD.util.chirpColumnSort),this.chirpArray.length&&o.length&&(r=this.chirpArray[0],a=o[o.length-1],l=r.belongsAbove(a)),this.chirpArray=o.concat(this.chirpArray),l&&this.chirpArray.sort(TD.util.chirpColumnSort),c},this.isRepeatedRetweet=function(e){var t,i,n=!1;return e instanceof TD.services.TwitterStatus&&(t=e.getMainTweet().id,i=this.seenTweetIDs.get(t)||0,n=e.isRetweetedStatus()&&i>0,this.seenTweetIDs.enqueue(t,i+1)),n},this.refresh=function(e){e=e||{},e.retries=e.retries||0;var t=Date.now(),i=t<this.refreshLock+this.REFRESH_LOCK_EXPIRY;if(i)return TD.core.defer.succeed();e.reset&&this.removeAll(),this.refreshLock=t;var n=this.fetchChirps(new TD.services.Cursor({lowerBound:this.calculateLowerBound(this.chirpArray)}),{forceFetch:e.reset});return n.addCallback(function(e){this.refreshLock=0,this.acceptChirps(e)}.bind(this)),n.addErrback(function(t){if(this.refreshLock=0,!TD.decider.get("disable_network_failure_retry")&&e.reset&&t.message&&"responseText"in t.message){var i=t.message,n=TD.util.isNetworkFailure(i);if(n)return this.retryRefresh(e)}}.bind(this)),n},this.retryRefresh=function(e){var t=_.assign({},e,{retries:e.retries+1});$(document).trigger("metric",{key:"feed_poller:refresh:retry:request"});var i=Math.min(1e3*Math.pow(2,e.retries/2),6e4),n=TD.core.defer.timeout(i);return n.addCallback(this.refresh.bind(this,t)),1===t.retries&&n.addCallback(function(e){return $(document).trigger("metric",{key:"feed_poller:refresh:retry:success"}),e}),n},this.fetchOlderChirps=function(e){if(this.lastInfiniteScrollTime=Date.now(),this.isExhausted)return TD.core.defer.succeed(this.chirpArray);if(this.chirpArray.length){var t=!e,i=this.getBottomChirp(this.chirpArray),n=t||i.belongsBelow(e);if(n)return TD.core.defer.succeed(this.chirpArray)}var s=this.fetchChirps(new TD.services.Cursor({upperBound:this.calculateUpperBound(this.chirpArray)}));return s.addCallback(function(e){return this.addChirpsToMemCache(e),0===e.length&&(this.isExhausted=!0),this.chirpArray}.bind(this)),s},this.fetchChirps=function(t,i){i=_.defaults(i||{},{forceFetch:!1}),i.poller=this,i.feedType=this.feed.getType(),i.metadata=this.feed.getMetadata();var n=TD.controller.clients.getClient(this.feed.getAccountKey());return n?n.getChirpsForFeed(t,i):TD.core.defer.fail(new Error("Could not find client for feed: "+e.getAccountKey()))},this.isStreamableForOauthUser=function(e){var t=this.feed.getType(),i=this.feed.getMetadata(),n=!!TD.controller.FeedPoller.STREAMING_FEED_TYPES[t];switch(t){case"favorites":n=!i.id||i.id===e;break;case"search":n=TD.services.TwitterSearchParser.isStreamable(i.term)}return n},this.trimChirps=function(){if(!(this.chirpArray.length<this.OPTIMUM_ARRAY_LENGTH)){var e=Date.now()-this.lastInfiniteScrollTime;if(!(e<this.CLEANUP_WAIT_PERIOD)){for(var t=this.chirpArray.splice(this.OPTIMUM_ARRAY_LENGTH,Number.MAX_VALUE),i=0;i<t.length;i++)delete this.chirpIndex[t[i].id];this.isExhausted=!1}}},this.addChirps=function(e){var t=this.addChirpsToMemCache(e);this.publishChirps(t)},this.publishAll=function(){this.publishChirps(this.chirpArray)},this.publishChirps=function(e){$.publish("/feed/"+this.feed.getKey(),[this,e.concat(),this.feed.getTopSortIndex()])},this.destroy=function(){var e=this.feed;this.chirpArray=[],this.chirpIndex={},$.unsubscribeAll("/feed/"+e.getKey()),$.unsubscribeAll("/delete/"+e.getKey()),$.unsubscribe(this.subscription)}},TD.controller.FeedPoller.FEED_TYPES={customTimeline:"customtimeline",direct:"direct",dataminr:"dataminr",favorites:"favorites",home:"home",interactions:"interactions",list:"list",mentions:"mentions",networkactivity:"networkactivity",scheduled:"scheduled",search:"search",useractivity:"useractivity",usertimeline:"usertimeline",usertweets:"usertweets"},TD.controller.FeedPoller.STREAMING_FEED_TYPES={home:!0,mentions:!0,favorites:!0,search:!0,interactions:!0,networkactivity:!0},TD.controller.FeedPoller.CURSORED_ON_TWEET_TIMESTAMP={interactions:!0,networkactivity:!0,useractivity:!0},TD.controller.FeedPoller.CURSORED_FEED_TYPES={customtimeline:!0},TD.controller.FeedPoller.SCHEDULED_FEED_TYPES={scheduled:!0},TD.controller.feedManager=function(){function e(){var e,t=TD.storage.accountController.getDefault(),i=t.getKey();"twitter"===t.getType()&&(e=TD.storage.feedController.getAll(),e=_.filter(e,function(e){return"search"===e.getType()&&e.getAccountKey()!==i}),_.each(e,function(e){var t=TD.storage.feedController.getOrCreateFeed(e.getType(),e.getService(),i,e.getMetadata());TD.controller.feedManager.replaceFeed(e,t)}))}function t(e,t){var i,n=t&&t.toLowerCase();i=t?TD.i("User @{{screenName}} has been suspended",{screenName:t}):TD.i("User has been suspended"),TD.controller.progressIndicator.addMessage(i),TD.controller.feedManager.deleteWhere(function(i){var s=i.getMainUser&&i.getMainUser();return s?e&&e==s.id||t&&n===s.screenName.toLowerCase():!1})}function i(e,t,i){var n=i.getRelatedTweet();if(!n)return!1;var s=n.id===e||n.retweetedStatus&&n.retweetedStatus.id===e,r=n.account.getKey()===t;return s&&r}var n={},s={};return n.init=function(){var i,n=TD.storage.feedController.getAll();for(i=0;i<n.length;i++){var r=n[i];s[r.getKey()]=new TD.controller.FeedPoller(r)}TD.controller.scheduler.schedulePeriodicTask(120,TD.controller.feedManager.trimPollers),$.subscribe("/user/removeTweets",this.deleteUserChirps),$.subscribe("/user/suspended",t),$.subscribe("/storage/client/default_account_changed",e),$(document).on("dataUndoRetweetSuccess",this.handleUndoRetweetSuccess.bind(this)),$(document).on("dataUndoRetweetError",this.handleUndoRetweetError.bind(this))},n.handleUndoRetweetSuccess=function(e,t){this.deleteWhere(function(e){return e.retweetedStatus&&e.retweetedStatus.id===t.tweetId&&e.creatorAccount&&e.creatorAccount.getKey()===t.from}),this.doWhere(i.bind(null,t.tweetId,t.from),function(e){e.getRelatedTweet().setRetweeted(!1)})},n.handleUndoRetweetError=function(e,t){TD.controller.progressIndicator.addMessage(TD.i("Undo retweet failed")),this.doWhere(i.bind(null,t.tweetId,t.from),function(e){e.getRelatedTweet().setRetweeted(!0)})},n.getPoller=function(e){return s[e]},n.trimPollers=function(){for(var e in s)s[e].trimChirps()},n.addFeed=function(e){var t=e.getKey(),i=s[t];return i?i:(i=new TD.controller.FeedPoller(e),s[t]=i,i)},n.removeFeed=function(e){var t=e.getKey(),i=s[t];delete s[t],i.destroy(),"twitter"==e.getService()&&(client=TD.controller.clients.getClient(e.getAccountKey()),client&&client.checkUserStream())},n.cleanupFeeds=function(){var e=TD.controller.columnManager.getAll(),t={};for(var i in e)for(var r=e[i].getFeeds(),a=0;a<r.length;a++)t[r[a].getKey()]=!0;for(var o in s)if(!t[o]){var c=s[o].feed;n.removeFeed(c),TD.storage.feedController.remove(c.getKey())}},n.deleteChirp=function(e){n.deleteWhere(function(t){if(t.id===e)return!0;if(t.getRelatedTweet){var i=t.getRelatedTweet();return i&&i.id===e}return!1})},n.deleteWhere=function(e,t){var i,n;for(var r in s)i=s[r],n=i.feed.getType(),t&&"home"!==n&&"networkactivity"!==n||i.removeWhere(e)},n.doWhere=function(e,t){var i;for(var n in s)i=s[n],i.doWhere(e,t)},n.deleteUserChirps=function(e,t,i){var s=function(i){try{var n=i.getCreator&&i.getCreator();return n&&n.id===e&&i.account.getUserID()===t}catch(s){}return!1};n.deleteWhere(s,i)},n.deleteFeedsWhere=function(e){var t,i,n,s,r,a=TD.storage.clientController.client.getColumnOrder();for(s=0;s<a.length;s++){for(t=TD.controller.columnManager.get(a[s]),i=t.getFeeds(),r=i.length-1;r>=0;r--)n=i[r],e(n)&&(TD.storage.feedController.remove(n),t.removeFeed(n));0===t.getFeedCount()&&TD.controller.columnManager.deleteColumn(t.model.getKey())}},n.replaceFeed=function(e,t,i){var s=TD.controller.columnManager.getAll();i&&(s=_.filter(s,function(e){return-1!==i.indexOf(e.model.getKey())})),_.each(s,function(i){i.removeFeed(e)>0&&i.addFeed(t)}),n.cleanupFeeds()},n.fixListFeeds=_.debounce(_.once(function(){var e=function(e,t){var i=TD.storage.feedController.getOrCreateFeed(e.getType(),e.getService(),e.getAccountKey(),{listId:t.id,ownerId:t.user.id});TD.controller.feedManager.replaceFeed(e,i)},t=[],i=TD.storage.feedController.getAll();i=_.filter(i,function(e){var t=(e.getType(),e.getMetadata());return"list"!==e.getType()||t.listId&&t.ownerId?!1:!0}),_.each(i,function(i){var n=i.getMetadata(),s=TD.cache.lists.find(null,n.screenName,n.slug);s?e(i,s):t.push(i)}),_.each(t,function(t){var i=TD.controller.clients.getClient(t.getAccountKey()),n=t.getMetadata(),s=function(i){e(t,i)},r=function(){};i.getList(null,n.screenName,n.slug,s,r)})}),5e3),n.isStreaming=function(e){var t,i,n=this.getPoller(e),s=!1;return n&&(t=n.feed,i=TD.controller.clients.getClient(t.getAccountKey()),s=i.feedIsStreaming(e)),s},n}(),TD.controller.progressIndicator=function(){function e(){n=$(".js-progress-indicator"),n.on("click",".js-dismiss",i)}function t(){var t,r=null,o="";if(n&&n.length||e(),h)switch(r=h.message,h.state){case a:o=TD.i("Failed");break;case s:o=TD.i("Success")}if(r){var c=TD.ui.template.render("topbar/alert_message",{prefix:o,
message:r});n.html(c);var l=n.find(".js-status-message");t=u,u=l.height(),t!==u?(t||l.css("bottom",-u),l.animate({bottom:0},200)):l.css("bottom",0)}else i()}function i(){var e=n.find(".js-status-message");e.animate({bottom:-u},200,function(){n.empty(),h=null}),u=0}var n,s="complete",r="working",a="failed",o="message",c=7e3,l=3e3,u=0,d={},h=null;return d.addTask=function(e){var i=_.uniqueId("msg_");return h={key:i,message:e,state:r,timeout:null},t(),i},d.addMessage=function(e){var i=_.uniqueId("msg_");return h={key:i,message:e,state:o,timeout:null},h.timeout=setTimeout(function(){d.deleteTask(i)},c),t(),i},d.deleteTask=function(e){h&&h.key===e&&(h=null,t())},d.taskComplete=function(e,i){h&&h.key===e&&(h.state=s,h.message=i||h.message,h.timeout=setTimeout(function(){d.deleteTask(e)},l),t())},d.taskFailed=function(e,i){h&&h.key===e&&(h.state=a,h.message=i||h.message,h.timeout=setTimeout(function(){d.deleteTask(e)},c),t())},d.changeMessage=function(e,i){h&&h.key===e&&(h.message=i,t())},d}(),TD.controller.notifications=function(){function e(e){var s=e.column,r=e.items;if(r=r.filter(function(e){return e.passFilters(s.filters)&&!e.isOwnChirp()}),0!==r.length){var a=[];if(s.model.getHasNotification()&&d)for(var u=0;u<r.length;u++){var g=r[u],v=c[g.id];if(v)f(s.type)>f(v.columnType)&&(v.columnKey=s.model.getKey(),v.columnTitle=s.getTitleHTML(),v.columnType=s.model.getType(),v.accountKey=g.account.getKey());else{var b={chirpID:g.messageThreadId||g.id,accountKey:g.account.getKey(),columnKey:s.model.getKey(),columnTitle:s.getTitleHTML(),columnType:s.model.getType()};switch(d){case h:case p:var w=g.getGrowlData();if(!w)continue;w.img=w.img||TD.assets.get("logos",{name:"32"}),_.extend(b,w);break;case m:if(b.html=g.renderNotification(),!b.html)continue}a.push(b),c[r[u].id]=b}}T()?deck.notificationWindow.acceptAction({data:{updates:a}}):(l=l||s.model.getHasSound(),o=o.concat(a),!i&&(o.length>0||l)&&(i=setTimeout(t,n)))}}function t(){if(i=null,l&&(document.getElementById("update-sound").play(),l=!1),o.length&&d){var e=d===h?o.slice(0,5):o;d!==m?(e.forEach(function(e){var t;switch(d){case h:deck.doGrowl(e.title,e.text,e.img,e.chirpID,e.columnKey);break;case p:t=new u(e.title,{body:e.text,icon:e.img}),t.onclose=a.reset,t.onshow=function(){setTimeout(function(){t.close()},5e3)},t.onclick=function(){a.showDetailView(e.columnKey,e.chirpID),TD.util.isChromeApp()&&chrome.extension.getBackgroundPage().TD.bg.utils.showTDTab(),window.focus()}}}),a.reset(),o=[]):TD.util.isWrapperApp()&&deck.showNotification&&(!deck.notificationWindow||deck.notificationWindow.closed?(a.reset(),deck.notificationWindow=window.open(s,r),deck.notificationWindow.mainWindow=window):a.onNotificationsReady())}}var i,n=500,s=TD.assets.get("templates",{name:"notification"}),r="tweetdeck-notification",a={},o=[],c={},l=!1,u=window.Notification,d=!1,h="growl",p="w3c",m="windows",f=function(e){switch(e){case"privateMe":return 5;case"direct":return 4;case"me":return 3;case"mentions":return 2;case"home":return 1;case"search":return-1;default:return 0}},g=function(e){var t,i=!1,n=!0;switch(e.action){case"url":TD.util.openURL(e.href),n=!1;break;case"user":t=_.last(e.href.split("/")),$(document).trigger("uiShowProfile",{id:t});break;case"hashtag":$(document).trigger("uiPerformSearch",{query:e.text});break;case"showColumn":i=!0;break;case"showChirp":i=!0,a.showDetailView(e.info.columnKey,e.info.chirpID)}n&&TD.util.isWrapperApp()&&deck.showPrimaryWindow(),i&&$(document).trigger("uiColumnsScrollColumnToCenter",{columnKey:e.info.columnKey}),T()&&deck.notificationWindow.acceptAction({data:"closeNotification"})},v=function(){return TD.util.isWrapperApp()?!0:a.isPermissionGranted()},T=function(){return TD.util.isWrapperApp()&&deck.notificationWindow&&!deck.notificationWindow.closed&&deck.notificationWindow.acceptAction},b=function(e){var t=v();return t&&(d=p,e&&e("granted")),t};return a.init=function(){TD.util.isWrapperApp()?d=deck.showNotification?m:h:u&&b(),$.subscribe("/notifications/new",e.bind(this))},a.hasNotifications=function(){return!!d||u&&"denied"!==u.permission},a.isPermissionGranted=function(){return!!d||u&&"granted"===u.permission},a.onNotificationsReady=function(){T()&&(deck.notificationWindow.acceptAction({data:{updates:o}}),o=[])},a.onNotificationAction=function(e){g(e)},a.reRender=function(e){var t=c[e.id];if(t&&T){var i=e.renderNotification();t.html=i,deck.notificationWindow.acceptAction({data:{replaceID:e.id,accountKey:e.account.getKey(),html:i}})}},a.getPermission=function(e){b(e)||u.requestPermission(function(t){"permission"in u||(u.permission=t),b(e)})},a.showDetailView=function(e,t){$(document).trigger("uiColumnFocus",{columnKey:e});var i=TD.controller.columnManager.get(e),n=i.findMostInterestingChirp(chirpID),s=i.findChirp(chirpID);TD.ui.updates.showDetailView(i,n,s)},a.reset=function(){c={},l=!1},a}(),TD.controller.stats=function(){var e={},t={INIT:"init",MAIN:"main_init",COLUMN_MANAGER:"column_manager_init",COLUMN_SCHEDULER:"column_scheduler_init",NOTIFICATIONS:"notifications_init",FILTER_MANAGER:"filter_manager_init",RENDER_TWEET:"render_tweet"},i="twid",n="interval",s="f",r="oid",a="tw",o="is_touch_device",c=10,l={};TD.util.extendObjectWith(l,[[TD.util.columnUtils.columnMetaTypes.MENTIONS,{legacyId:2,namespace:{section:"twitter",component:"mention"}}],[TD.util.columnUtils.columnMetaTypes.FOLLOWERS,{legacyId:3,namespace:{section:"twitter",component:"followers"}}],[TD.util.columnUtils.columnMetaTypes.TIMELINE,{legacyId:3,namespace:{section:"twitter",component:"home"}}],[TD.util.columnUtils.columnMetaTypes.SEARCH,{legacyId:4,namespace:{section:"twitter",component:"search"}}],[TD.util.columnUtils.columnMetaTypes.MESSAGES,{legacyId:5,namespace:{section:"twitter",component:"inbox"}}],[TD.util.columnUtils.columnMetaTypes.FAVORITES,{legacyId:8,namespace:{section:"twitter",component:"favorites"}}],[TD.util.columnUtils.columnMetaTypes.LIST,{legacyId:22,namespace:{section:"twitter",component:"list"}}],[TD.util.columnUtils.columnMetaTypes.SCHEDULED,{legacyId:28,namespace:{section:"tweetdeck",component:"scheduledupdates"}}],[TD.util.columnUtils.columnMetaTypes.USERTWEETS,{legacyId:32,namespace:{section:"twitter",component:"usertweets"}}],[TD.util.columnUtils.columnMetaTypes.USERTIMELINE,{legacyId:33,namespace:{section:"twitter",component:"usertimeline"}}],[TD.util.columnUtils.columnMetaTypes.HOME,{legacyId:34,namespace:{section:"tweetdeck",component:"home"}}],[TD.util.columnUtils.columnMetaTypes.ME,{legacyId:35,namespace:{section:"tweetdeck",component:"me"}}],[TD.util.columnUtils.columnMetaTypes.INBOX,{legacyId:36,namespace:{section:"tweetdeck",component:"inbox"}}],[TD.util.columnUtils.columnMetaTypes.INTERACTIONS,{legacyId:37,namespace:{section:"twitter",component:"interactions"}}],[TD.util.columnUtils.columnMetaTypes.ACTIVITY,{legacyId:38,namespace:{section:"twitter",component:"networkactivity"}}],[TD.util.columnUtils.columnMetaTypes.CUSTOMTIMELINE,{legacyId:39,namespace:{section:"twitter",component:"customtimeline"}}],[TD.util.columnUtils.columnMetaTypes.DATAMINR,{legacyId:39,namespace:{section:"dataminr",component:"watchlist"}}]]);var u,d,h,p,m,f,g="Twitter-TweetDeck-{{{client_name}}}/{{{client_version}}} {{{platform}}}/{{{platform_version}}}",v="deck",T={},b={},w=[],y=$(document),D=function(e,t){if(!f||!h)return void w.push([e,t]);if(e=e||{},t=t||{},e.client=v,t.user_agent=p,t.guest_id=h,!t.user_id){var i=TD.storage.store.getTwitterLoginAccount()||TD.storage.accountController.getDefault();i&&(t.user_id=i.getUserID())}f.scribe(e,t),y.trigger("scribing",{terms:e,data:t}),TD.config.scribe_debug_level>1&&console.log("Scribing:",e,t)},C=function(){var e,t={};try{e=TD.storage.accountController.getPreferredAccount("twitter")}catch(i){}return e&&(t[a]=e.getUserID()),t};return e.generateScribeUserAgent=function(e,t,i,n){var s={client_name:e,client_version:t,platform:i,platform_version:n},r=TD.ui.template.toHtml(g,s);return r},e.generateScribeGuestId=function(e,t){var i="tweetdeck:"+e+":"+t,n=TD.core.sha1(i),s=parseInt(n.substr(0,13),16);return s},e.flushScribeQueue=function(){m&&m.flush(m.getBuffer())},e.updateTransportOptions=function(e){return m?void m.updateOptions(e):void TD.sync.util.warn("scribeTransport options not updated as controller.stats not initialised")},e.init=function(){var t=TD.util.getAppEnv();u=TD.config.client_name+"-"+t,p=e.generateScribeUserAgent(u,TD.version,t,"1");var i={bufferEvents:!0,useAjax:!1,flushOnUnload:!0};m=new ScribeTransport(i),f=new ClientEvent(m),TD.config.scribe_debug_level>0&&this.setupDebugMode(),TD.controller.scheduler.schedulePeriodicTask(900,function(){e.impression(),e.twitterSession(),$(document).trigger("metric",{key:"ping"})},!0),TD.controller.scheduler.schedulePeriodicTask(60,TD.controller.stats.flushScribeQueue),$(document).on("scribeEvent",function(e,t){this.generic(t.terms,t.data)}.bind(this))},e.setUid=function(t){if(d=t,h="",t){for(h=e.generateScribeGuestId(p,TD.core.sha1(t));w.length;){var i=w.shift();D(i[0],i[1])}e.impression()}},e.generic=function(e,t){D(e,t)},e.setExperiments=function(e){T=e},e.getExperimentBucket=function(e){var t=T[e];return t?t.bucket:""},e.experimentImpression=function(e){var t,i,n=T[e];n&&(e=n.experiment_key,b[e]||(t={page:"ddg",section:n.experiment_key,component:"",element:"",action:"experiment"},i={experiment_key:n.experiment_key,bucket:n.bucket,version:n.version},D(t,i),b[e]=!0))},e.setupDebugMode=function(){var e=!1,t={},i=function(i){var n,s="error"===i.validationLevel&&"event_namespace"===i.parentFieldName,r="scribe error",a="";if(s&&e){if(n=[i.fieldName,i.fieldValue].join(" "),t[n])return;t[n]=!0}"warning"===i.validationLevel&&(r="scribe warning"),s&&(a="Please add "+i.fieldName+" “"+i.fieldValue+"” to go/namespace"),console.error(r.toUpperCase(),a,i)};m.updateOptions({debug:!0,bufferEvents:!1,useAjax:!0,flushOnUnload:!0,debugHandler:function(e){e&&e.response&&(e.response.errors.forEach(i),e.response.warnings.forEach(i))}}),m.options.url="https://twitter.com"+m.SCRIBE_API_ENDPOINT},e.checkNamespace=function(e,t){if(-1===t.indexOf(e))throw new Error("value must be in "+t)},e.impression=function(){var e={action:"impression",page:"main"},t=C();t[n]="900",t[s]=TD.controller.feather.latestFeatherId,t[o]=!1,TD.util.isTouchDevice()&&(t[o]=!0),D(e,t)},e.twitterSession=function(){if("web"===TD.util.getAppEnv()){var e,t,i=TD.storage.store.getTwitterLoginAccount();if(i){var n=document.cookie.match(/(?:^|;\s*)twid="(.*?)"\s*;/);if(n){var s=n[1],r=s.split("|")[0],a=TD.net.util.formDecode(r);e=a.u}t=e?e===i.getUserID()?"same":"different":"none";var o={page:"accounts",section:"twitter_session",action:t};D(o)}}},e.favorite=function(e,t){var i={page:"column",section:"tweet",action:"favorite"},n={items:[e],user_id:t};D(i,n)},e.unfavorite=function(e,t){var i={page:"column",section:"tweet",action:"unfavorite"},n={items:[e],user_id:t};D(i,n)},e.retweet=function(e,t){var i={page:"column",section:"tweet",action:"retweet"},n={items:[e],user_id:t};D(i,n)},e.embedTweetDialogOpen=function(e){var t={page:"main",section:"embed_tweet_dialog",action:"open"},n={};n[i]=e,D(t,n)},e.translate=function(e,t,n,s,o){var c={page:"column",section:"tweet",action:"translate"},l={};l[r]=e,l[i]=t,l[a]=n,l.dest_lang=s,l.src_lang=o,D(c,l)},e.reportUser=function(e,t){var i={page:"column",section:"tweet",component:"report_user",element:t||"",action:e};D(i)},e.reportUserAbusive=function(e,t){var i={page:"column",section:"tweet",component:"report_user_abusive",element:t||"",action:e};D(i)},e.reportDM=function(e){var t={page:"column",section:"tweet",component:"report_message",element:"",action:e};D(t)},e.sharedAccountWarning=function(e){var t={page:"main",section:"shared_account_warning",action:e};D(t)},e._genericColumnEvent=function(e,t,i){var n=l[e],s={page:"column",section:"unknown",component:"unknown",action:t};i&&(s.element=i),n&&n.namespace?_.extend(s,n.namespace):console.log("Tracking: Unknown column type",e),D(s)},e.addColumn=function(t){e._genericColumnEvent(t,"add")},e.removeColumn=function(t){e._genericColumnEvent(t,"remove")},e.compose=function(e){e=e||{};var t={page:e.page||"compose",section:e.section,component:e.component,action:e.action},i={with_image:Boolean(e.withImage),scheduled:Boolean(e.isScheduled)};e.twitterId&&(i.user_id=e.twitterId),e.isScheduled&&(t.action+="_scheduled"),D(t,i)},e.postTweet=function(t,i,n){e.compose({action:"send_tweet",twitterId:t,withImage:i,isScheduled:n})},e.postReply=function(t,i,n,s){e.compose({action:"send_reply",component:s?"inline_compose":"docked_compose",twitterId:t,withImage:i,isScheduled:n})},e.composeFromContextMenu=function(e){var t={page:"compose",component:"docked_compose",element:"chrome_context_menu",action:e};D(t)},e.postMessage=function(t){var i=t.isGroupDm?"send_group_dm":"send_dm",n={action:i,twitterId:t.twitterId,withImage:t.withImage,component:"docked_compose"};t.isReplyBar&&(n.page="main",n.section="messages",n.component="reply_bar"),e.compose(n)},e.quoteTweet=function(){var e={page:"main",section:"tweet",element:"tweet",action:"quote"};D(e)},e.discardQuoteTweet=function(){var e={page:"main",section:"compose",element:"tweet",action:"discard_quote_tweet"};D(e)},e.shareTweetViaDM=function(){var e={page:"main",section:"tweet",element:"share_tweet_via_dm",action:"click"};D(e)},e.sharedTweetDM=function(){var e={page:"main",section:"messages",element:"shared_tweet_dm",action:"click"};D(e)},e.composeClearReply=function(){var e={page:"compose",action:"clear_reply"};D(e)},e.composeStackReply=function(){var e={page:"compose",action:"stack_reply"};D(e)},e.composePopFromInline=function(){var e={page:"compose",component:"inline_compose",element:"pop_inline_to_docked",action:"click"};D(e)},e.messageBannerImpression=function(e){var t={page:"main",section:"message_banner",action:"impression"},i={message_id:e};D(t,i)},e.messageBannerDismiss=function(e){var t={page:"main",section:"message_banner",action:"dismiss"},i={message_id:e};D(t,i)},e.messageBannerClick=function(e,t){var i={page:"main",section:"message_banner",action:"click"},n={message_id:e,button_id:t};D(i,n)},e.searchboxFocus=function(){var e={page:"main",component:"search_box",action:"focus_field"};D(e)},e.searchboxPerformSearch=function(e){var t={page:"main",component:"search_box",action:"search"},i={query:e};D(t,i)},e.typeaheadItemSelected=function(e,t,i){var n={page:"main",component:"search_box",element:"typeahead",action:"search"},s={query:e,type:t,index:i};D(n,s)},e.typeaheadRecentItemSelected=function(e,t,i){var n={page:"main",component:"search_box",element:"recent",action:"search"},s={query:e,type:t,index:i};D(n,s)},e.viewedTweetSocialProof=function(e){var t={page:"column",section:"social_proof",component:e,action:"impression"};switch(e){case"retweeters":t.component="retweeted_by";break;case"favoriters":t.component="favorited_by";break;default:throw"Social proof type “"+e+"” not recognised"}D(t)},e.setting=function(e,t){var i={page:"settings",section:e},n={section:{condensed:"narrow","full-size":"wide"}};_.isBoolean(t)?i.action=t?"on":"off":(i.component=n.section[t]||t,i.action="select"),D(i)},e.defaultAccountSelected=function(){D({page:"settings",section:"default_account",action:"select"})},e.apiErrorResponse=function(e,t,i){var n={page:"api",action:"request"},s={status_code:e};TD.util.random(0,99)<c&&(t&&(s.event_info=t),i&&(s.url=i),D(n,s))},e.performance=function(){var e={},i=function(){return e[t.RENDER_TWEET]&&e[t.INIT]&&e[t.MAIN]&&e[t.COLUMN_MANAGER]&&e[t.COLUMN_SCHEDULER]&&e[t.FILTER_MANAGER]&&e[t.NOTIFICATIONS]};return{log:function(t,n){e[t]=n,i()&&(e={})},keys:t}}(),e.advancedSearchSettings=function(e,t,i,n){var s={section:{},component:{action:"interactions"},element:{written_in:"language"}},r={page:"main",section:s.section[e]||e,component:s.component[t]||t,element:s.element[i]||i,action:"change"},a={value:n};D(r,a)},e.actionFilterError=function(){var e={page:"main",section:"column_options",component:"interactions",action:"validation_error"},t={error:"No interaction types selected"};D(e,t)},e.columnActionClick=function(e,t){var i={page:"main",section:"column_options",element:e,action:"click"};t=t||{},D(i,t)},e.conversationDetailViewImpression=function(e){var t={page:"main",section:"messages",component:"conversation",element:e,action:"impression"};D(t)},e.messagesColumnHeaderClick=function(e){var t={page:"main",section:"messages",component:"header",element:e,action:"click"};D(t)},e.messageAttachmentClick=function(e){var t={page:"main",section:"messages",component:"message",element:e,action:"click"};D(t)},e.unknownStreamData=function(e){var t={page:"api",section:"userstream",action:"unrecognized_data"};D(t,e)},e.navbarListsClick=function(){var e={page:"main",section:"navbar",element:"lists",action:"click"};D(e)},e.navbarAddColumnClick=function(){var e={page:"main",section:"navbar",element:"add_column",action:"click"};D(e)},e.navbarPageLeft=function(){var e={page:"main",section:"navbar",component:"column_nav",element:"page_left",action:"click"};D(e)},e.navbarReorderColumns=function(){var e={page:"main",section:"navbar",component:"column_nav",action:"reorder"};D(e)},e.navbarJumpToColumn=function(){var e={page:"main",section:"navbar",component:"column_nav",element:"column_item",action:"click"};D(e)},e.navbarPageRight=function(){var e={page:"main",section:"navbar",component:"column_nav",element:"page_right",action:"click"};D(e)},e.navbarSettingsClick=function(){var e={page:"main",section:"navbar",element:"settings",action:"click"};D(e)},e.navbarMigrate=function(e){var t=["impression","click"];if(-1===t.indexOf(e))throw new Error("action must be in "+t);var i={page:"main",section:"navbar",element:"migrate",action:e};D(i)},e.navbarComposeClick=function(){var e={page:"main",section:"navbar",element:"compose",action:"click"};D(e)},e.tweetStreamImpression=function(e,t,i){if(!(t.length<1)){var n={component:"stream",action:"results"};i&&(n.element="linger");var s={items:t},r=TD.util.columnUtils.columnMetaTypeToScribeNamespace[e];r&&(n=_.extend(n,r),D(n,s))}},e.tweetImpression=function(e){var t={page:"tweet",component:"tweet",action:"impression"},i={items:[e]};D(t,i)},e.mediaImpression=function(e){var t={page:"tweet",component:"gallery",element:"photo",action:"impression"},i={items:[e]};D(t,i)},e.appWokenFromSleep=function(e){var t={page:"main",action:"wake"},i={secondsSinceSleep:e};D(t,i)},e.purgedServices=function(e){e.forEach(function(e){var t={page:"main",section:"service",action:"remove"};D(t,{service:e})})},e.purgedFeed=function(e){var t={page:"main",section:"feed",action:"remove"};D(t,e)},e.customTimelineCreated=function(){var e={page:"main",component:"customtimeline",action:"create"};D(e)},e.customTimelineUpdated=function(){var e={page:"main",component:"customtimeline",action:"update"};D(e)},e.customTimelineDeleted=function(){var e={page:"main",component:"customtimeline",action:"delete"};D(e)},e.tweetAddedToCustomTimeline=function(){var e={page:"main",component:"customtimeline",element:"tweet",action:"add"};D(e)},e.tweetRemovedFromCustomTimeline=function(){var e={page:"main",component:"customtimeline",element:"tweet",action:"remove"};D(e)},e.migrateAppflow=function(t,i){e.checkNamespace(t,["migrate_education","migrate_risk","migrate_risk_agreement","migrate_teams","migrate_team_instructions","migrate_team_member"]),e.checkNamespace(i,["impression","previous","cancel","next","ok"]);var n={page:"startflow",section:t,action:i};D(n)},e.migrateStartflow=function(t,i,n){e.checkNamespace(t,["migrate_tweetdeck_login","migrate_twitter_login","migrate_final_confirmation","migrate_progress","migrate_progress_success","migrate_progress_team_setup"]),e.checkNamespace(i,["impression","previous","cancel","next","restart"]);var s={page:"startflow",section:t,element:n?"error":void 0,action:i};D(s)},e.dataminrAuthRequest=function(){var e={page:"api",section:"dataminr",element:"authorize",action:"request"};D(e)},e.dataminrApiRequest=function(t){e.checkNamespace(t,["alerts","watchlists"]);var i={page:"api",section:"dataminr",element:t,action:"request"};D(i)},e.dataminrClickImpression=function(t,i){e.checkNamespace(i,["show_followers","show_following","website","map","dataminr_settings","user_media","dataminr","search","search_any","search_all","hashtag"]),e.checkNamespace(t,["dataminr_alert","dataminr_alert_detail"]);var n={page:"main",section:t,element:i,action:"click"};D(n)},e.soleUserWarningImpression=function(){var e={page:"startflow",section:"sole_user",action:"impression"},t={user_id:d};D(e,t)},e.soleUserWarningClick=function(t){e.checkNamespace(t,["sole_user_confirmed","sole_user_shared","sole_user_ignore_warning"]);var i={page:"startflow",section:"sole_user",component:t,action:"click"},n={user_id:d};D(i,n)},e}(),TD.controller.filterManager=function(){var e={},t=[],i=function(){var e=[];_.each(t,function(t){e.push(t.toBackendState())}),TD.settings.setGlobalFilter(e)};return e.init=function(){var i=TD.settings.getGlobalFilter();_.each(i,function(e){var i=new TD.vo.Filter;i.fromBackendState(e),t.push(i)}),e.reapplyAllFilters()},e.reapplyAllFilters=function(){_.each(TD.controller.columnManager.getAll(),function(e){e.reloadTweets()})},e.pass=function(e,i){var n,s;for(n=0,s=t.length;s>n;n++)if(!t[n].pass(e))return!1;if(i)for(n=0,s=i.length;s>n;n++)if(!i[n].pass(e))return!1;return!0},e.getAll=function(e,i){return t},e.addFilter=function(n,s,r){var a=new TD.vo.Filter(n,s,Boolean(r));return t.push(a),e.reapplyAllFilters(),i(),a},e.validateFilter=function(e,i){return e&&i?0==_.trim(i).length?!1:_.any(t,function(t){return t.type===e&&t.value===i})?!1:!0:!1},e.removeFilter=function(n){var s;_.each(t,function(e,t){e.id===n&&(s=t)}),t.splice(s,1),e.reapplyAllFilters(),i()},e.hasFilterApplied=function(e,i){return t.some(function(t){return t.type===e&&t.value===i})},e}(),function(e,t){"function"==typeof define&&define.amd?define([],t):e.TD.decider=t()}(this,function(){"use strict";function e(){var e={};this.accessLevels={scheduler:[{level:"READ_BACKGROUND",deciderKey:"scheduler_read_background"},{level:"READ_VISIBLE",deciderKey:"scheduler_read_visible"},{level:"WRITE",deciderKey:"scheduler_write"},{level:"WRITE_MEDIA",deciderKey:"scheduler_write_media"}],migration:[{level:"NORMAL_MIGRATION",deciderKey:"account_migration_v2"},{level:"FORCED_MIGRATION",deciderKeyByEnv:{mac:"account_migration_v2_forced","default":"account_migration_v2_forced_web_win_chrome"}}]},this.updateFromBackendForGuestID=function(e){var t=TD.sync.tdapi.getGuestDecider(e);return t.addCallback(function(e){this.updateFromBackend(e.decider)}.bind(this)),t},this.updateFromBackend=function(t){e=t||{},$(document).trigger("dataDeciderUpdated")},this.get=function(t){if(TD.config.decider_overlay&&"undefined"!=typeof TD.config.decider_overlay[t]){var i=TD.config.decider_overlay[t];return i}return e[t]},this.getAll=function(){return _.clone(e)},this.getAllWithOverlay=function(){return Object.keys(TD.config.decider_overlay||{}).reduce(function(e,t){return e[t]=this.get(t),e}.bind(this),this.getAll())},this.hasAccessLevel=function(e,t){return this.accessLevels[e].reduce(function(e,i){var n=i.level===t,s=i.deciderKey;!s&&i.deciderKeyByEnv&&(s=i.deciderKeyByEnv[TD.util.getAppEnv()]||i.deciderKeyByEnv["default"]);var r=e.canAccessPreviousLevel&&!!this.get(s);return{canAccessPreviousLevel:r,canAccessDesiredLevel:n?r:e.canAccessDesiredLevel}}.bind(this),{canAccessPreviousLevel:!0,canAccessDesiredLevel:!1}).canAccessDesiredLevel}}return new e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):e.TD.sync.util=t()}(this,function(){var e={},t=0,i=2,n=4,s=8;e.maybe_log=function(e,t){var i=_.isUndefined(t)?1:t;TD.config.debug_level>=i&&console.log(e)},e.NotJsonable=function(e){_.extend(this,e),this.___=e.toString()},e.NotJsonable.prototype={};var r=function(t){console.log.apply(console,_.map(t,function(t){if(!_.isUndefined(t))try{return JSON.parse(JSON.stringify(t))}catch(i){return new e.NotJsonable(t)}}))};return e.stateLog=function(){TD.config.debug_level>=i&&r(arguments)},e.verboseLog=function(){TD.config.debug_level>=n&&r(_.toArray(arguments))},e.warn=function(){TD.config.debug_level>=t&&console.log.apply(console,_.toArray(arguments))},e.trace=function(t,i){e.maybe_log("TRACE: "+t+": "+(i||""),1)},e.printStacktrace=function(){if(TD.config.debug_menu)try{throw new Error("stack trace or gtfo")}catch(e){console.log(e.stack)}},e.getStack=function(){try{throw new Error("stack trace or gtfo")}catch(e){return TD.util.isChromeApp()?e.stack.split("\n").slice(2).join("\n"):""}},e.errmark=function(t,i){return t||(t=i,i="missing message"),console.log("---ERROR--->>>>>->>>>->>>->>->--"+i+"--<-<<--"),e.maybe_log(t),console.log(t.stack),t},e.assert=function(t,i,n){if(!t)throw console.log("------------------------------------------"),console.log(["ASSERT FAILURE",i,n]),e.printStacktrace(),console.log("------------------------------------------"),TD.sync.trace&&TD.sync.trace.assert(i,n),"AssertionError"},e.precondition=function(t,i,n){if(!t)throw console.log("------------------------------------------"),console.log(["PRECONDITION FAILURE",i,n]),e.printStacktrace(),console.log("------------------------------------------"),TD.sync.trace&&TD.sync.trace.assert("PRECONDITION "+i,n),"PreconditionAssertionError"},e._break=function(){console.log("you might want to set a breakpoint here ;-)")},e.warning=function(t){data=_.toArray(arguments).slice(1),console.log(["WARNING",t,e.pformat(data)])},e.error=function(t){data=_.toArray(arguments).slice(1),console.log(["ERROR",t,e.pformat(data)])},e.list_to_set=function(e){var t={};return _.each(e,function(e){t[e]=!0}),t},e.pprint=function(t){return e.maybe_log(JSON.stringify(t,null,"  "),i),t},e.pformat=function(e){return JSON.stringify(e,null,"  ")},e.repr=function(e){return JSON.stringify(e)},e.clone=function(t){if(null===t||_.isUndefined(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(i){return e.stateLog("util.clone couldn't parse object",t,i),["<not jsonable>",t]}},e.dictMap=function(e,t,i){var n={};return _.each(_.map(e,t,i),function(e){n[e[0]]=e[1]}),n},e.stall=function(e,t){_.isUndefined(t)&&(t=0);var i=new TD.core.defer.Deferred;return _.delay(_.bind(i.callback,i),1e3*t,e),i},e.autoRetry=function(e,t,i){var n=e();return t.forEach(function(t){n.addErrback(function(n){if(!i||i(n)){var s=new TD.core.defer.Deferred;return s.addCallback(e),setTimeout(function(){s.callback()},t),s}return n})}),n},e.makeThingScheduler=function(t,i,n,r,a){var o=!1,c=!1;r=r||function(){return!0},a=_.isUndefined(a)?1:a;var l=[],u=function(){if(e.maybe_log(["_maybe_do_stuff",n,"want stuff done:",o,"am doing stuff:",c],s),!o)return void e.maybe_log("not doing stuff; someone else did stuff before us",s);if(c)return void e.maybe_log("am already doing stuff",s);c=!0,o=!1;var r=TD.controller.progressIndicator;if(i)var a=r.addTask(i);var d=TD.core.defer.maybeDeferred(t);d.addCallback(function(e){if(c=!1,i&&r.deleteTask(a),o)u();else{var t=l;l=[];for(var n=0;n<t.length;n++)try{t[n].callback(e)}catch(s){_.defer(_.bind(t[n].errback,t[n]),s)}}}),d.addErrback(function(s){e.errmark(s,'do_stuff for "'+n+'" yielded error when calling; '+t),c=!1,i&&r.taskFailed(a);var o=l;l=[];for(var u=0;u<o.length;u++)try{o[u].errback(s)}catch(d){_.defer(_.bind(o[u].errback,o[u]),d)}})};return function(t){if(!r())return e.maybe_log("not triggering (guarded): "+n,s),TD.core.defer.succeed();t=_.isUndefined(t)?a:t,e.maybe_log('trigger func called "'+n+'"',s),o=!0;var i=new TD.core.defer.Deferred;return l.push(i),setTimeout(u,1e3*t),i}},e}),function(e,t){"function"==typeof define&&define.amd?define([],t):e.TD.storage.MemoryStorage=t()}(this,function(){"use strict";function e(){this.data={},this.length=0}return e.prototype.clear=function(){this.data={},this.length=0},e.prototype.getItem=function(e){var t=this.data[e];return void 0!==t?t:null},e.prototype.key=function(e){throw new Error("MemoryStore.key not implemented.")},e.prototype.removeItem=function(e){null!==this.getItem(e)&&(delete this.data[e],this.length--)},e.prototype.setItem=function(e,t){null===this.getItem(e)&&this.length++,this.data[e]=""+t},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["scripts/storage/memory_storage","scripts/sync/util"],t):_.extend(e.TD.storage,t(e.TD.storage.MemoryStorage,e.TD.sync.util))}(this,function(e,t){"use strict";function i(t){t?this._initBackend(t):this._backend=new e}var n="tweetdeckAccount",s="currentAuthType",r="staySignedIn",a="__hasAlreadyReloaded",o="_session",c="sessionMigratedToWeb",l="migrate",u="accountsLastVerified",d="__version__",h="ScribeTransport",p="guestID",m=[h],f=m.concat([d,"previousMultiUserAccount",r,s,p,l,h]),g={local:localStorage,session:sessionStorage};return i.getPreviousStorage=function(){var e=_.pairs(g),t=_.find(e,function(e){return e[1].getItem(n)||e[1].getItem(s)||e[1].getItem(r)});return t?t[0]:null},i._testStore=function(e,n){t.stateLog("_testStore()");for(var s=!1,r=!1,a="__test__",o="test",c=1024;o.length<c;)o+=o;try{e.setItem(a,o),s=e.getItem(a)===o,e.removeItem(a)}catch(l){s=!1,r=l.code===window.DOMException.QUOTA_EXCEEDED_ERR,r&&0===e.length&&TD.sync.util.warn(l,"In Safari private browsing mode")}if(n&&r)try{i.flushDataFromStore(e),s=i._testStore(e,!1)}catch(l){s=!1}return s},i.flushDataFromStore=function(e,t){t=(t||[]).concat(f),i.wipe(e,t)},i.flushBackend=function(e,t){return i.flushDataFromStore(g[e],t)},i.wipeAll=function(){[localStorage,sessionStorage].forEach(i.wipe)},i.wipe=function(e,t){var i={};t=_.uniq((t||[]).concat(m)),t.forEach(function(t){var n=e.getItem(t);n&&(i[t]=n)});try{e.clear()}catch(n){console.warn("Clearing",e,"failed:",n)}_.each(i,function(t,i){e.setItem(i,t)})},i.shouldTryReload=function(){var e;try{e=!!sessionStorage.getItem(a),sessionStorage.setItem(a,!0)}catch(t){e=!0}return!e},i.removeReloadedFlag=function(){sessionStorage.removeItem(a)},i.flushWebstorage=function(e){TD.sync.util.trace("clearing web storage");try{Object.keys(g).forEach(function(t){i.flushDataFromStore(g[t],e)})}catch(t){console.error("Unable to clear webstorage.",t)}},i.clearOtherBackends=function(e){Object.keys(g).forEach(function(t){t!==e&&i.wipe(g[t])})},i.prototype.init=function(e,n){this._initBackend(e),n&&n.uid!==this.getTweetdeckAccount()&&(t.stateLog("New login. Clearing previous webstorage."),i.flushBackend(e),i.clearOtherBackends(e))},i.prototype._initBackend=function(n){this._backendType="unknown",t.stateLog("Initializing backend with",n),_.isFunction(n.getItem)&&i._testStore(n)?this._backend=n:"local"===n&&i._testStore(window.localStorage,!0)?(this._migrateBackend(window.localStorage),this._backend=window.localStorage,this._backendType="local"):"session"===n&&i._testStore(window.sessionStorage,!0)?(this._migrateBackend(window.sessionStorage),this._backend=window.sessionStorage,this._backendType="session"):(t.stateLog("store._initBackend(): Falling back to MemoryStorage."),this._backend=new e,this._backendType="memory"),this._tryUpgrade()},i.prototype._migrateBackend=function(e,t){if(t=t||this._getPersistentBackend(),t!==e)for(var i in t)if(t.hasOwnProperty(i)){try{e.setItem(i,t.getItem(i))}catch(n){if(n.code===window.DOMException.QUOTA_EXCEEDED_ERR)return void TD.sync.util.warn("Migration failed due to quota limits.",n);throw n}t.removeItem(i)}},i.prototype._getPersistentBackend=function(){return this._backend instanceof e?localStorage:this._backend},i.prototype._tryUpgrade=function(){try{TD.storage.upgrade.doUpgrade(this._backend)}catch(e){TD.sync.util.warn("Error during store upgrade:",e),i.flushWebstorage()}},i.prototype._upgradeTweetdeckAccountSession=function(){var e=this._backend.getItem("tweetdeck_account");if(e&&(this._backend.setItem("tweetdeckAccount",e),this._backend.removeItem("tweetdeck_account")),e=this._backend.getItem("tweetdeckAccount"),e&&"{"===e.charAt(0))try{e=JSON.parse(e).email,this._backend.setItem("tweetdeckAccount",e)}catch(t){console.warn("Upgrading TweetDeck account session failed.",t)}},i.prototype.getTweetdeckAccount=function(){var e=this._backend.getItem(n);return e?e:void t.stateLog("store.getTweetdeckAccount(): tdacct invalid",e);

},i.prototype.setTweetdeckAccount=function(e){TD.sync.util.assert(e,"user identifer must be given to set tweetdeck account"),this._backend.setItem(n,e)},i.prototype.getTwitterLoginAccount=function(){var e,t;return"twitter"===this.getCurrentAuthType()?(e=this.getTweetdeckAccount(),t=TD.storage.accountController.getAccountFromId(e)):void 0},i.prototype.getOrCreateGuestID=function(){var e=this._backend.getItem(p);return e||(e=this.createGuestID(),this._backend.setItem(p,e)),e},i.prototype.createGuestID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},i.prototype.getCurrentAuthType=function(){var e=this._getPersistentBackend().getItem(s)||"twitter";return"{"===e.charAt(0)&&(e="tweetdeck"),t.stateLog("getCurrentAuthType(): ",e),e},i.prototype.setCurrentAuthType=function(e){this._getPersistentBackend().setItem(s,e)},i.prototype.setStaySignedIn=function(e){this._getPersistentBackend().setItem(r,e)},i.prototype.getSessionMigratedToWeb=function(){return this._getPersistentBackend().getItem(c)},i.prototype.setSessionMigratedToWeb=function(){this._getPersistentBackend().setItem(c,!0)},i.prototype.removeSessionMigratedToWeb=function(){this._getPersistentBackend().removeItem(c)},i.prototype._getLastVerifiedTimestamps=function(){var e={};try{e=this.getJSON(u)}catch(i){t.stateLog("_getLastVerifiedTimestamps(): failed",i)}return e},i.prototype.getMigrateData=function(){var e;try{e=JSON.parse(sessionStorage.getItem(l))}catch(t){}return e||{}},i.prototype.getLastVerifiedTimestamp=function(e){var t,i,n=this._getLastVerifiedTimestamps();return t=n[e.getKey()]||0,i=e.getUpdated()||0,Math.max(t,i)},i.prototype.setLastVerifiedTimestamp=function(e){var t=this._getLastVerifiedTimestamps(),i=t[e.getKey()]||0,n=e.getUpdated()||0,s=Math.max(i,n);s!==i&&(t[e.getKey()]=s,this.setJSON(u,t))},i.prototype.removeLastVerifiedTimestamp=function(e){var t=this._getLastVerifiedTimestamps();delete t[e.getKey()],this.setJSON(u,t)},i.prototype.getSessionData=function(){this._upgradeTweetdeckAccountSession();var e={authType:this.getCurrentAuthType(),uid:this._backend.getItem(n),migrate:this.getMigrateData(),session:null,sessionExists:!1,staySignedIn:!!this.getJSON(r)};return e.uid&&(e.session=this._backend.getItem(o),TD.sync.tdapi.setSession(e.session),e.sessionExists=TD.sync.tdapi.isLoggedIn()),e},i.prototype.setSessionData=function(e){this._backend.setItem(o,JSON.stringify(e))},i.prototype.getSessionMigrationData=function(){var e=["__version__","previousMultiUserAccount","staySignedIn","currentAuthType","guestID","migrate","tweetdeckAccount","_session","accountsLastVerified"];return{local:e.reduce(function(e,t){var i=localStorage.getItem(t);return null!==i&&(e[t]=i),e},{}),session:e.reduce(function(e,t){var i=sessionStorage.getItem(t);return null!==i&&(e[t]=i),e},{})}},i.prototype.checkVersion=function(e){var t=this._backend.getItem(d);if(null!==t&&~t!==~e)throw new Error("Wrong version number in store. (saved) %s != (given) %s",t,e)},i.prototype.setVersion=function(e){this._backend.setItem(d,e)},i.prototype.getJSON=function(e){return JSON.parse(this._backend.getItem(e)||"{}")},i.prototype.setJSON=function(e,t){this._backend.setItem(e,JSON.stringify(t))},i.prototype.setJSONCritical=function(e,t,i){try{this._backend.setItem(e,JSON.stringify(t))}catch(n){if(n.code!==window.DOMException.QUOTA_EXCEEDED_ERR||i)throw n;$(document).trigger("dataStorageFull"),this.setJSONCritical(e,t,!0)}},{Store:i,store:new i}}),TD.sync.trace=function(e){var t={},i=[];return t.record=function(){var t=(new Date).toLocaleTimeString();i.push([t].concat(_.toArray(arguments))),TD.config.debug_trace&&e.stateLog.apply(null,["-------- TRACE: "+t].concat(_.toArray(arguments))),TD.config.debug_menu||i.length>200&&i.splice(0,100)},t.request=function(e,i,n){t.record("request",e,n.type,i,_.clone(n))},t.response=function(e,i,n,s){t.record("response",e,i,_.clone(n),_.clone(s))},t.objInit=function(e,i,n){t.record("obj init",e,_.clone(i),_.clone(n))},t.manage=function(i,n){t.record("manage",i,n,e.clone(n.getStateForLocalstorage()))},t.update=function(e,i,n){t.record("update",e,i,_.clone(n))},t.push=function(i,n,s,r){t.record("push",i,n,_.clone(s),e.clone(r))},t.tsResults=function(e,i,n,s,r,a){t.record("t+s results",e,_.clone(i),_.clone(n),_.clone(s),_.clone(r),a)},t.tsResult=function(e,i,n,s,r,a){t.record("t+s result",e,_.clone(i),_.clone(n),s,_.clone(r),a)},t.conflicts=function(e,i,n,s,r){t.record("conflicts",e,_.clone(i),_.clone(n),_.clone(s),r)},t.conflict=function(e,i,n,s,r){t.record("conflict",e,_.clone(i),_.clone(n),_.clone(s),r)},t.assert=function(i,n){t.record("ASSERT",i,n,e.getStack())},t.clear=function(){i=[]},t.logDump=function(){var e="-------------------------------------------------------------";console.log(e+" TRACE dump "+e),_.each(i,function(e){console.log.call(console,e)}),console.log(e+"  END dump  "+e)},t.logSummarise=function(){var t="-------------------------------------------------------------";console.log(t+" TRACE dump "+t);var n=e.list_to_set(["obj init","update"]);_.each(i,function(e){n[e[1]]||console.log.call(console,e)}),console.log(t+"  END dump  "+t)},t}(TD.sync.util),TD.sync.tdapi=function(e,t,i,n){var s={},r=null,a=null,o=function(e,t){return"x-td-basic "+n.encode(e+":"+t)},c=function(){if(!r)throw new Error("Not Logged In");return"X-TD-Session "+r},l=function(e){return _.isUndefined(e.session)||(r=e.session),e},u=function(e){return r=null,e},d=function(e){try{e.req.responseJSON=JSON.parse(e.req.responseText)}catch(t){TD.sync.util.verboseLog("Could not parse error response JSON. Probably was none.",t)}return e};s.getGuestDecider=function(e){var t="/decider?identifier="+e,i={type:"GET"};return s.drequest(t,i,{})},s.login=function(e,t){var i="/login",n={type:"POST",headers:{Authorization:o(e,t),"X-TD-Authtype":"tweetdeck"}},r=s.drequest(i,n,{});return r.addCallback(l),r},s.twogin=function(e,t){var i="/login",n={type:"POST",headers:{Authorization:o(e,t),"X-TD-Authtype":"twitter"}},r=s.drequest(i,n,{});return r.addErrback(d),r.addCallback(l),r},s.twoginSend2FACode=function(e,t,i){var n="/login",r={login_verification_request_id:i.requestId,login_verification_user_id:""+i.userId};i.code&&(r.login_verification_challenge_response=i.code);var a={type:"POST",data:JSON.stringify(r),contentType:"application/json",headers:{"X-TD-Authtype":"twitter"}},o=s.drequest(n,a,{});return o.addErrback(d),o.addCallback(l),o},s.logout=function(e){e=e||{};var t="/logout"+(e.allSessions?"?all_sessions=true":""),i=s.drequest(t,s.getReq({method:"POST"}));return i.addCallback(u),i},s.doMigration=function(e){var i=e&&e.email;if(!i)return TD.core.defer.succeed();var n=new t.Deferred;return $(document).one("uiMigrationLoginConfirmation",function(){n.callback(e)}).trigger("dataNeedsMigrateLoginConfirmation"),n.addCallback(function(){var t=s.importSetup(e.email,e.passhash);return t.addCallback(function(t){return t.isTeamOrganiser=e.isTeamOrganiser,$(document).trigger("uiMigrateSuccess",t),t}),t}),n.addCallback(function(){var i=new t.Deferred;return $(document).one("uiMigrateCompleteConfirmation",function(){i.callback(e)}).trigger("dataNeedsMigrateCompleteConfirmation"),i}),n.addErrback(function(e){var i,n=new t.Deferred;try{i=e.req.responseJSON}catch(s){i={}}return $(document).trigger("uiMigrateError",{message:e.message,code:e.number,data:_.defaults(i,{error:"UnknownError"})}),n}),n},s.importSetup=function(e,t){return s.requestWithBody("/import","POST",{from_username:e,passhash:t})},s.importPreview=function(e,t){return s.drequest("/import/preview",{type:"POST",headers:{},data:JSON.stringify({from_username:e,passhash:t}),contentType:"application/json"})},s.isLoggedIn=function(){return Boolean(r)},s.setSession=function(e){var t=null;e&&(t=JSON.parse(e)),t&&(r=t)},s.saveSession=function(){TD.storage.store.setSessionData(r)},s.onAuthFail=function(e,t){a=e},s.createAccount=function(e,t,i,n){var r=TD.util.iso8601(new Date),a="/user"+TD.config.td_create_key+r,c=new window.jsSHA(a,"ASCII"),u=c.getHMAC(TD.config.td_create_secret,"ASCII","SHA-256","B64"),d="/user",h={type:"PUT",headers:{Authorization:o(e,t),"x-td-sig":u,"x-td-timestamp":r,"x-td-create":TD.config.td_create_key}},p=s.drequest(d,h);return p.addCallback(l),p},s.Conflict=function(e){this.body=e};var h=new RegExp("^([^:]*): (.*)$"),p=function(e,t){_.isUndefined(t)&&(t={});var i=e.getAllResponseHeaders(),n=i.split("\r\n");return 1==n.length&&(n=i.split("\n")),_.each(n,function(e){var i=e.match(h);i&&(t[i[1].toLowerCase()]=i[2])}),t};return s.drequest=function(n,r,o,c){var l=_.uniqueId(r&&r.reqid?"["+r.reqid+"]rq:":"rq:");if(e.stateLog("drequest",l,n,r),(null===r||_.isUndefined(r))&&(r=s.getReq()),i.request(l,n,r),"/"==n.charAt(0)&&(n=TD.config.api_root+n),!_.startsWith(n,"http://")&&!_.startsWith(n,"https://"))return t.fail(new Error("Malformed url"));r.headers=_.defaults(r.headers||{},{"X-Twitter-Client-Version":TD.util.getTweetDeckUserAgentString()});var u=function(i,n){var s=jQuery.ajax(i,n),r=new t.Deferred;return s.done(function(e,t,i){r.callback(i)}),s.fail(function(i,n,s){409===i.status?(e.assert("Conflict"===s,"409 should be Conflict"),r.callback(i)):r.errback(new t.XMLHttpRequestError(i,s))}),r},d=u(n,r);d.reqid=l;var h=function(e){var t,i=e.req;if(401!==i.status||c)throw e;if(t=p(i),"X-TD-Session"!==t["www-authenticate"])throw e;throw a&&a(),e};d.addErrback(h);var m=function(t,a){var c,u=function(t){if(""===t)return t;try{return JSON.parse(t)}catch(i){return _.isEmpty(t)||e.warn(["failed to json parse drequest response;",t,"for request",n,r]),t}};return c=409===t.status?new s.Conflict(u(t.responseText)):u(t.responseText),o&&p(t,o),o&&o.date&&TD.storage.notification.notify("/date",o.date),e.stateLog("drequest ret",l,n,c,t.getAllResponseHeaders().split("\n")),i.response(l,n,c,o),c};return d.addCallback(m,l),d},s.requestWithBody=function(e,t,i,n,r,a,o){var c=s.getReq({type:t,reqid:a,headers:r||{},data:JSON.stringify(i),contentType:"application/json"});return s.drequest(e,c,n,o)},s.getReq=function(e){var t={type:"GET",headers:{}};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.headers.Authorization=c(),e&&e.method&&(t.type=e.method),t},s}(TD.sync.util,TD.core.defer,TD.sync.trace,TD.core.base64),TD.storage.notification=function(e){var t={},i=[],n=function(){var e=i.splice(0,i.length);_.each(e,function(e){if(e.topic)try{jQuery.publish(e.topic,e.args)}catch(t){console.log("FAILURE publishing event",e,t)}else e.d&&e.d.callback()})};return t.notify=function(e){var t=Array.prototype.slice.call(arguments,1);i.push({topic:e,args:t}),_.defer(n)},t.flush=function(){var t=new e.Deferred;return i.push({d:t}),_.defer(n),t},t}(TD.core.defer),TD.storage.StoredObj=function(e,t,i,n,s,r,a){function o(e){this.controller=e}return o.prototype.controller=null,o.prototype.managed=!1,o.prototype.stateCache=null,o.prototype.state=null,o.prototype.privateState=null,o.prototype.eventname="/storage/object",o.prototype._init=function(i){i||(i={}),a.objInit(this,i),this.state={},this.privateState={},_.isEmpty(i)?(this.deltaQ=[],this.stateCache=null):(this.deltaQ=[new e.StoredDelta("init",i)],this.stateCache=_.clone(i)),t.verboseLog("StoredObj.init",this,i,this.deltaQ)},o.prototype.getApiid=function(){var e=this.getPrivate("apiid");return t.assert(e,"missing apiid",this),e},o.prototype.hasApiid=function(){return Boolean(this.getPrivate("apiid"))},o.prototype.setApiid=function(e){return a.update("set apiid",this,[e]),this.setPrivate("apiid",e)},o.prototype.getKey=function(){return this.getPrivate("key")},o.prototype.setKey=function(e){return this.setPrivate("key",e)},o.prototype._prepCache=function(){return null===this.stateCache&&(t.assert(0===this.deltaQ.length,"empty stateCache must coincide with empty ΔQ"),this.stateCache=_.clone(this.state)),this.stateCache},o.prototype.set=function(i,n){return a.update("set",this,[i,n]),t.assert("columns"!==i,"you should be setting column_order, not columns"),this._prepCache(),this.deltaQ.push(new e.StoredDelta("set",i,n)),this.stateCache[i]=n,r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.setListPermutation=function(i,n){TD.config.debug_checks&&this.checkCache();var o=this.get(i);if(_.isEqual(n,o))return a.update("set null list permutation",this,[i,o,n]),t.stateLog("ignoring request to change list at",i),s.succeed();a.update("set list permutation",this,[i,o,n]);var c=e.StoredDelta.listPermutator(i,o,n);return t.verboseLog("set list permutation",o,"→",n,"Δs:",c),this.deltaQ=this.deltaQ.concat(c),this.stateCache=e.StoredDelta.applyMultiple(this.deltaQ,this.state),TD.config.debug_checks&&this.checkCache(),r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.listPrepend=function(t,i){a.update("list prepend",this,[t,i]);var n=this.get(t);return n||(n=[]),this._prepCache(),this.deltaQ.push(new e.StoredDelta("linsert",t,i,0)),this.stateCache[t]=[i].concat(n),r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.listAppend=function(t,i){a.update("list append",this,[t,i]);var n=this.get(t);return n||(n=[]),this._prepCache(),this.deltaQ.push(new e.StoredDelta("linsert",t,i,n.length)),this.stateCache[t]=n.concat([i]),r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.listAdd=function(i,n){var o=this.get(i);o||(o=[]);var c=new e.StoredDelta("ladd",i,n,o.length),l=c.applyToValue(i,o);return _.isEqual(l,o)?(a.update("set null list add",this,[i,o,l]),t.stateLog("ignoring request to add to list at",i),s.succeed()):(a.update("list add",this,[i,n]),this._prepCache(),this.deltaQ.push(c),this.stateCache[i]=l,r.notify(this.eventname+"/change",this),this.controller.triggerPush())},o.prototype.listTruncate=function(t,i){a.update("list truncate",this,[t,i]);var n=this.get(t);return n||(n=[]),this._prepCache(),this.deltaQ.push(new e.StoredDelta("ltrunc",t,i)),n.length>i&&n.splice(i,n.length-i),this.stateCache[t]=n,r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.listRemove=function(t,i){a.update("list remove",this,[t,i]);var n=this.get(t)||[];return this._prepCache(),this.deltaQ.push(new e.StoredDelta("ldel",t,i)),this.stateCache[t]=_.without(n,i),r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.listDedupe=function(t){a.update("list dedupe",this,[t]);var i=this.get(t)||[];this._prepCache();var n=new e.StoredDelta("ldedupe",t);return this.deltaQ.push(n),this.stateCache[t]=n.applyToValue(t,i),r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.dictSet=function(t,i,n){a.update("dict set",this,[t,i,n]),this._prepCache();var s=_.clone(this.get(t));return this.deltaQ.push(new e.StoredDelta("hset",t,i,n)),s||(s={}),s[i]=n,this.stateCache[t]=s,r.notify(this.eventname+"/change",this),this.controller.triggerPush()},o.prototype.setPrivate=function(e,t){var i=this.privateState[e];return this.privateState[e]=t,i!==t&&r.notify(this.eventname+"/change",this),s.succeed()},o.prototype.getPrivate=function(e){return this.privateState[e]},o.prototype.immutableSet=function(e,i){var n=this.state[e];if(i!=n)throw t.warn("ERROR: attempt to change",e,"of",this,"from",n,"to",i),new Error("attempt to modify immutable field "+e);return s.succeed()},o.prototype.setValueIffDifferent=function(e,i,n,a){var o=this.get(e);return _.isEqual(o,i)?s.succeed(null):(t.verboseLog(this,"setValueIffDifferent",e,"from",o,"to",i),n&&r.notify(n,i,o,this),a&&a(i,o),r.notify(this.eventname+"/change",this),this.set(e,i))},o.prototype.get=function(e){return null===this.stateCache?this.state[e]:this.stateCache[e]},o.prototype.latestDelta=function(){return _.isEmpty(this.deltaQ)?null:this.deltaQ[this.deltaQ.length-1].id},o.prototype.getStateForBackend=function(){TD.config.debug_checks&&(t.precondition(this.isDirty(),"don't call getStateForBackend unless isDirty"),this.checkCache());var e=_.clone(null!==this.stateCache?this.stateCache:this.state);return!e.mtime&&this.state.mtime&&(e.mtime=this.state.mtime),{"Δid":this.latestDelta(),state:this.transformForRemote(e,this.privateState)}},o.prototype.postProcessNewRemoteState=function(){},o.prototype.newRemoteState=function(i){a.update("new remote state",this,i),TD.config.debug_checks&&(t.stateLog("checking cache"),this.checkCache()),t.verboseLog("transforming to local:",this,t.clone(i)),this.state=this.transformToLocal(i),0!==this.deltaQ.length?(t.assert(null!==this.stateCache,"if we have Δs, we should have cache"),t.verboseLog("applying pending deltas",this,t.clone(this.deltaQ)),this.stateCache=e.StoredDelta.applyMultiple(this.deltaQ,this.state)):t.assert(null===this.stateCache,"if no Δs, should have no cache"),this.postProcessNewRemoteState(),TD.config.debug_checks&&(t.stateLog("checking cache"),this.checkCache()),r.notify(this.eventname+"/change",this)},o.prototype.commit=function(i,n){a.update("commit",this,[i+" : "+n]);var s=_.pluck(this.deltaQ,"id").indexOf(i);if(-1===s)throw t.stateLog("asked to commit "+i+" but it doesn't exist in "+_.map(this.deltaQ,function(e){return e.toString()})),new Error("invalid deltaId supplied");if(TD.config.debug_checks&&this.checkCache(),s===this.deltaQ.length-1)this.deltaQ=[],this.state=_.clone(this.stateCache),this.state.mtime=n,this.stateCache=null,TD.config.debug_checks&&this.checkCache();else{var r=this.deltaQ.splice(0,s+1),o=e.StoredDelta.applyMultiple(r,this.state);this.state=o,this.state.mtime=n,this.stateCache.mtime=n,TD.config.debug_checks&&this.checkCache(),this.controller.triggerPush()}},o.prototype.checkCache=function(){var i=e.StoredDelta.checkStateCache(this.state,this.deltaQ,this.stateCache);t.assert(i,"cache != state+Δs")},o.prototype.checkInvariants=function(){this.hasApiid()||t.assert(_.isEmpty(this.state),'must have no "state" if no apiid'),t.assert(this.state&&_.isUndefined(this.state.apiid),"apiid in non-priv state, bad"),this.isDirty()?(t.assert(!_.isEmpty(this.deltaQ),"deltaQ must be non-empty if dirty"),t.assert(null!==this.stateCache,"cache must be present if dirty"),this.checkCache(),this.hasApiid()&&t.assert(null!==this.latestDelta(),"latestDelta() must not return null for Δid for dirty object")):(t.assert(_.isEmpty(this.deltaQ),"deltaQ must be empty if not dirty"),t.assert(null===this.stateCache,"cache must be absent if not dirty"))},o.prototype.isDirty=function(){return this.hasApiid()?0!==this.deltaQ.length:(t.assert(0!==this.deltaQ.length,"should be dirty if no apiid"),!0)},o}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.util,TD.core.defer,TD.storage.notification,TD.sync.trace),TD.storage.StoredDelta=function(e,t,i,n,s){function r(t){this.type=t,e.assert(c[t]&&a,"unknown type "+t),this.args=_.toArray(arguments).slice(1),this.id="Δ"+(new Date).getTime()+_.uniqueId(":"),o(t,this.args),"init"===t&&(e.verboseLog("initialisation delta",this.id,this.args[0]),"mtime"in this.args[0]&&(e.warn("WARNING init Δ contains mtime!",e.clone(this.args[0])),e._break()))}var a={init:1,set:2,del:1,lmove:3,ldel:2,linsert:3,ladd:3,ltrunc:2,ldedupe:1,hset:3,other:0},o=function(t,i){var n=a[t];switch(e.assert(i.length===n,"wrong no. args for "+t+", expected "+n+" got "+i.length),t){case"ltrunc":e.assert("number"==typeof i[1],"ltrunc: length must be number");break;case"linsert":case"ladd":case"ldel":case"lmove":e.assert("string"==typeof i[1],"list elements must be strings")}};r.prototype.toString=function(){return"StoredDelta["+this.id+"]("+this.type+": "+JSON.stringify(this.args)+")"},r.prototype.serialise=function(){return[this.type].concat(this.args)};var c={init:function(t,i){if(!_.isEqual(t,{})){var n=e.clone(t),s=e.clone(i);return delete n.mtime,delete s.mtime,_.isEqual(n,s)?(e.warn("WARNING Δ init_state === state",e.clone(t),"init:",i.mtime,"state:",t.mtime),t):void e.warn("WARNING discarding init_state",e.clone(i),"in favour of",e.clone(t))}return _.clone(i)},set:function(e,t,i){return e[t]=i,e},del:function(e,t){return delete e[t],e},lmove:function(e,t,i,n){var s=_.clone(e[t]),r=s.indexOf(i);return-1!=r?(s.splice(r,1),s.splice(r+n,0,i),e[t]=s,e):void 0},ldel:function(e,t,i){var n;return n=_.isUndefined(e[t])?[]:_.without(e[t],i),e[t]=n,e},linsert:function(e,t,i,n){var s;return s=_.isUndefined(e[t])?[]:_.clone(e[t]),s.splice(n,0,i),e[t]=s,e},ladd:function(e,t,i,n){if(_.include(e[t],i))return e;var s;return s=_.isUndefined(e[t])?[]:_.clone(e[t]),s.splice(n,0,i),e[t]=s,e},ltrunc:function(e,t,i){var n;return n=_.isUndefined(e[t])?[]:e[t],n.length>i&&n.splice(i,n.length-i),e[t]=n,e},ldedupe:function(e,t){var i;return i=_.isUndefined(e[t])?[]:e[t],e[t]=_.uniq(i),e},hset:function(e,t,i,n){var s=_.clone(e[t]);return s||(s={}),s[i]=n,e[t]=s,e}};r.prototype.apply=function(t){var i=_.clone(t),n=c[this.type],s=n.apply(this,[i].concat(this.args));return s?s:(e.warn("WARNING: unable to apply Δ",this.toString(),"to",e.clone(t)),_.clone(t))},r.prototype.applyToValue=function(e,t){var i={};return i[e]=t,this.apply(i)[e]},r.listPermutator=function(t,i,n){var s=[],a=_.clone(i);if(e.verboseLog("StoredDelta.listPermutator",i,"→",n),i.length!=_.union(i).length||n.length!=_.union(n).length)throw e.stateLog("Duplicate error in listPermutator",{original:i,original_:_.union(i),target:n,targetu:_.union(n)}),new TypeError("lists must not contain duplicates");_.each(_.difference(i,n),function(e){s.push(new r("ldel",t,e)),a.splice(a.indexOf(e),1)});for(var o=0;o<n.length;o++)if(a[o]!=n[o]){var c=n[o],l=a.indexOf(c);-1===l?(s.push(new r("ladd",t,c,o)),a.splice(o,0,c)):(s.push(new r("lmove",t,c,o-l)),a.splice(l,1),a.splice(o,0,c))}return s},r.applyMultiple=function(e,t){return _.reduce(e,function(e,t){return t.apply(e)},t)};var l=function(e,t){function i(){return e.apply(this,t)}return i.prototype=e.prototype,new i};return r.deserialiseDeltas=function(e){return _.map(e,function(e){return l(r,e)})},r.checkStateCache=function(t,i,n){if(null===n&&0===i.length)return!0;ccache=_.clone(n),delete ccache.mtime;var s=r.applyMultiple(i,_.clone(t));return delete s.mtime,_.isEqual(ccache,s)?!0:(e.stateLog("cache",n,"!= goal",s,"for",t,"+",i),!1)},r}(TD.sync.util,TD.sync.tdapi,TD.util,TD.core.defer,TD.storage.notification),TD.storage.SobjController=function(e,t,i,n,s,r){var a=function(){this._objects=null,this._objectsByApiid=null,this.reqsinflight=null,this.apiEndpoint=null,this._moduleName=null};return a.prototype.toString=function(){return"<SobjController["+(this._moduleName||"unknown")+"]>"},a.prototype.triggerPush=function(){throw t.printStacktrace(),new Error("NotImplemented")},a.prototype.bindTrigger=function(i){var n=t.makeThingScheduler,s=e.store.getTweetdeckAccount.bind(e.store);this.triggerPush=n(_.bind(this.pushDirty,this),null,i,s)},a.prototype.remove=function(e){var t=this._objects[e];t&&(t.managed=!1,t.hasApiid()&&delete this._objectsByApiid[t.getApiid()]),delete this._objects[e]},a.prototype.getAll=function(){return _.values(this._objects)},a.prototype.getByApiid=function(e){return t.assert(e,"must provide apiid; "+t.repr(e)),t.assert("undefined"!=e,"huh? where did that come from?"),this._objectsByApiid[e]},a.prototype.pushPreflight=function(){return s.succeed(null)},a.prototype.pushDirty=function(){TD.config.debug_checks&&this.checkInvariants();var e=_.uniqueId("pD:");r.push(this,"pushDirty",null,e);var t=this,i=this.pushPreflight();return i.addCallback(function(){var i=_.filter(t._objects,function(e){return e.isDirty()});if(_.isEmpty(i))return r.push(t,"(not dirty)",null,e),s.succeed();var n=t.pushObjects(i,e);return n.addCallback(function(){return t.pushDirty()}),n}),i},a.prototype.prePushCheckInvariants=function(e){},a.prototype.pushObjects=function(e,n){if(t.verboseLog(this.toString()+".pushObjects()",this,e),n||(n=_.uniqueId("pO:")),r.push(this,"pushObjects",e,n),t.assert(this.apiEndpoint,"api endpoint must be set"),_.isEmpty(e))return r.push(this,"(empty)",e,n),s.succeed([]);TD.config.debug_checks&&this.prePushCheckInvariants(e);var a=_.map(e,function(e){return e.getStateForBackend()}),o=_.pluck(a,"Δid"),c=_.pluck(a,"state");r.push(this,"objs+Δs",e,o,n),TD.config.debug_checks&&(_.each(c,function(e){t.assert(e.mtime||!e.id,"for a test and set request, we expect (require) either mtime (modify) or absence of id (create) for every object")}),_.isEmpty(this.reqsinflight)||(t.warn("WARNING! called pushObjects",e,"when already have requests in flight",t.clone(this.reqsinflight)),t._break()));var l={},u=i.requestWithBody(this.apiEndpoint,"POST",c,l,{"x-td-mtime-check":"partial"},n);if(TD.config.debug_checks){this.reqsinflight.push(u.reqid);var d=this;u.addBoth(function(e){return d.reqsinflight=_.without(d.reqsinflight,u.reqid),e})}return u.addCallbackWith(this,this._processTSResults,e,o,l,n),u},a.prototype._processTSResults=function(e,n,s,a,o){r.tsResults(this,e,n,s,a,o),e instanceof i.Conflict&&(r.conflicts(this,e.body,n,a,o),e=e.body),t.assert(e.length==n.length,"wrong number of responses/objects!"),t.assert(e.length==s.length,"wrong number of responses/deltas!"),t.verboseLog("objects",n,"deltas",s),_.each(s,function(e){t.assert(null!==e,"Δid must not be null")});var c=a["x-td-mtime"];t.assert(c,"require x-td-mtime header in object PUT");for(var l,u=this,d=function(e,i){t.verboseLog("_processTSResults:check_set_apiid",e,i),e.hasApiid()?t.assert(e.getApiid()==i,"apiid mismatch"):(u._objectsByApiid[i]=e,e.setApiid(i))},h=0;h<e.length;h++)l=e[h],_.isString(l)?(t.verboseLog("_processTSResults",n[h],e[h]),d(n[h],e[h]),n[h].commit(s[h],c)):(r.conflict(this,l,n[h],a,o),t.verboseLog("_processTSResults: not an apiid:",l),n[h].newRemoteState(e[h]))},a.prototype.pushObject=function(e,n){t.verboseLog(this.toString()+".pushObject()",this,e,n),r.push(this,"object",e);var s=e.getStateForBackend(),a=s["Δid"],o=s.state;t.assert(o.mtime,"for a test and set request, we expect (require) mtime");var c={},l=i.requestWithBody(n,"PUT",o,c,{"x-td-iff-mtime":o.mtime});return l.addCallbackWith(this,this._processTSResult,e,a,c),l},a.prototype._processTSResult=function(e,n,s,a){r.tsResult(this,e,n,s,a),t.verboseLog("object",n,"delta",s),t.assert(null!==s,"Δid must not be null");var o;if(e instanceof i.Conflict)t.verboseLog("_processTSResult: got a conflict:",e),o=n.newRemoteState(e.body);else{t.assert(_.isString(e),"don't know how to handle response");var c=a["x-td-mtime"];t.assert(c,"require x-td-mtime header in object PUT"),t.verboseLog("_processTSResult",n,e),o=n.commit(s,c)}return o},a.prototype.checkInvariants=function(){var e=this;_.each(this._objects,function(i){var n=i.checkInvariants;n&&n.call(i),i.hasApiid()&&t.assert(e._objectsByApiid[i.getApiid()],"all managed objects with apiid must be in _objectsByApiid")})},a}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.storage.notification,TD.core.defer,TD.sync.trace),TD.storage.FeedController=function(e,t,i,n,s){var r=function(){var i=this;this.apiEndpoint="/feeds",this._moduleName="feeds",this.reqsinflight=[],this.bindTrigger("feedctr"),i._objects={},i._objectsByApiid={},this.toString=function(){return"<FeedController>"},this.init=function(){t.trace("feedController init"),TD.config.debug_checks&&this.checkInvariants()},this.reset=function(){this._objects={},this._objectsByApiid={}},this.updateFromBackend=function(i){var s=this;t.stateLog("feedController.updateFromBackend:",i),_.each(i,function(t,i){var r=s._objectsByApiid[i];r?(r.newRemoteState(t),n.notify("/storage/feed/updated",r)):(r=e.Feed.newFromBackendState(t),r.setApiid(i),s.manage(r),n.notify("/storage/feed/new",r))})},this.get=function(e){return this._objects[e]},this.manage=function(e){e.managed=!0;var n=this._objects[e.getKey()];return n&&e===n?i.triggerPush():(n&&(t.warn("WARNING replacing feed",n,"with",e,"please use feedController.getOrCreateFeed",[t.getStack().split("\n")]),n.getLatestTime()>e.getLatestTime()&&t.warn("Warning: latestTime weirdness:",n.getLatestTime(),e.getLatestTime()),n.hasApiid()&&e.setApiid(n.getApiid()),n.isDirty()&&(_.isEmpty(n.deltaQ)||"init"!=n.deltaQ[0].type)&&t.assert(!n.isDirty(),"houston, we have a problem")),this._objects[e.getKey()]=e,e.hasApiid()&&(this._objectsByApiid[e.getApiid()]=e),i.triggerPush())},this.manageFeeds=function(e){for(var t=0;t<e.length;t++)i.manage(e[t])},this._selfcheckapiids=function(){for(var e in this._objects){var t=this._objects[e];t.apiid&&_assert(t==i.getByApiid(t.apiid),"lookup failed")}},i.isEmpty=function(){return _.isEmpty(this._objects)},i.getOrCreateFeed=function(t,i,n,s,r){var a,o,c;if("search"!==t||s.term||s.baseQuery&&s.searchFilterData&&(a=new TD.vo.SearchFilter(s.searchFilterData),s.term=[s.baseQuery,a.getQueryString()].join(" ")),c=e.Feed.generateKeyFor(n,t,s),o=this._objects[c],!o){var l={type:t,service:i,accountkey:n,metadata:s,apiid:r};o=new e.Feed(l)}return r&&(o.apiid=r,this._objectsByApiid[r]=o),o}};return r.prototype=new e.SobjController,e.feedController=new r,r}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.storage.notification,TD.core.defer),TD.storage.ColumnController=function(e,t,i,n,s){var r=function(){var i=this;this.apiEndpoint="/columns",this._moduleName="columns",this.reqsinflight=[],this.bindTrigger("colctr"),$.subscribe("/storage/account/new",function(e){i.addToCombinedColumns(e)}),$.subscribe("/storage/client/account_whitelist_changed",function(){i.rebuildScheduledColumns()}),$(document).one("TD.ready",function(){i.rebuildScheduledColumns()}),this._objects={},this._objectsByApiid={},this.toString=function(){return"<ColumnController>"},this.init=function(){t.trace("columnController init"),TD.config.debug_checks&&this.checkInvariants()},this.reset=function(){this._objects={},this._objectsByApiid={}},this.updateFromBackend=function(i){var s=this;t.stateLog("columnController.updateFromBackend:",i),_.each(i,function(t,i){var r=s._objectsByApiid[i];r?r.newRemoteState(t):(r=e.Column.newFromBackendState(t),r.setApiid(i),s.manage(r),n.notify("/storage/column/new",r))})},this.get=function(e){return this._objects[e]},this.getColumnsContainingFeed=function(e){var t=[];return _.each(this._objects,function(i){_.each(i.getFeedKeys(),function(n){n==e&&t.push(i)})}),t},this.getColumnsByType=function(e){return _.filter(this._objects,function(t){return t.getType()===e})},this.manage=function(e){return e.managed=!0,t.assert(e.getKey(),"columns must have valid keys to be managed!"),this._objects[e.getKey()]=e,e.hasApiid()&&(this._objectsByApiid[e.getApiid()]=e),this.triggerPush()},this.remove=function(e){var t=this._objects[e];t&&(t.managed=!1),delete this._objects[e]},this.getAll=function(){return _.values(this._objects)},this.getByApiid=function(e){t.assert(e,"must provide apiid; "+t.repr(e)),t.assert("undefined"!==e,"huh? where did that come from?");var i=this._objectsByApiid[e];return i||(t.warn("WARNING: col ",e," not found in cols_by_apiid ",_.keys(this._objectsByApiid)),t.stateLog("this._objects, apiids; ",t.pformat(_.map(this._objects,function(e,t){return[t,e.getApiid()]})))),i},this.isEmpty=function(){return _.isEmpty(this._objects)},this._selfcheckapiids=function(){for(var e in this._objects){var t=this._objects[e];t.hasApiid()&&_assert(t==this.getByApiid(t.getApiid()),"lookup failed")}},this.addToCombinedColumns=function(i){t.stateLog("ADDING ACCOUNT TO COMBINED COLS",i);for(var n,s,r,a,o=e.clientController.client.getColumnOrder(),c={home:!0,me:!0,privateMe:!0},l=function(e){return e.getKey()},u=0;u<o.length;u++)if(n=this.get(o[u])){if(s=n.getType(),c[s]){switch(r=null,s){case"me":r=this.getMeFeeds([i]);break;case"privateMe":r=this.getInboxFeeds([i])}r&&(a=r.map(l),n.setFeedKeys(n.getFeedKeys().concat(a)),n.managed&&e.feedController.manageFeeds(r))}}else t.warn("Warning: Column not found!"),t._break()},this.rebuildScheduledColumns=function(){var t=this.getScheduledFeeds(),i=t.map(function(e){return e.getKey()});this.getColumnsByType("scheduled").forEach(function(n){n.setFeedKeys(i),n.managed&&e.feedController.manageFeeds(t),setTimeout(function(){TD.controller.feedScheduler.refreshColumn(n.getKey())},200)})};var s=function(t,i){var n=e.feedController;return n.getOrCreateFeed(t,i.getType(),i.getKey(),{})};this.getMeFeeds=function(e){
for(var t=[],i=0;i<e.length;i++)"twitter"===e[i].getType()&&t.push(s("mentions",e[i]));return t},this.getInboxFeeds=function(e){for(var t=[],i=0;i<e.length;i++)"twitter"===e[i].getType()&&t.push(s("direct",e[i]));return t},this.getScheduledFeeds=function(){var e=TD.storage.accountController.getAccountsForService("twitter");return e.map(s.bind(this,TD.util.columnUtils.feedTypes.SCHEDULED))},this.prePushCheckInvariants=function(i){_.each(i,function(i){_.each(i.getFeedKeys(),function(i){t.assert(e.feedController.get(i),"feeds must exist + be managed in columns push; "+i),t.assert(e.feedController.get(i).hasApiid(),"feeds must all have apiid in columns push; "+i)})})}};return r.prototype=new e.SobjController,r.prototype.pushPreflight=function(){return e.feedController.triggerPush(.05)},e.columnController=new r,r}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.storage.notification,TD.core.defer),TD.storage.AccountController=function(e,t,i,n,s){var r=function(){var r=this;this._moduleName="accounts",this.reqsinflight=[],r.ACCEPTED_ACCOUNT_TYPES={twitter:!0,bitly:!0},this._objects={},this._unverified={},r.blacklistAccount=function(i){t.stateLog("blacklisting",i);var s=i.getKey();e.clientController.client.addToAccountBlacklist(s),this._objects[s]&&r.remove(s),e.clientController.client.delFromAccountWhitelist(s),n.notify("/storage/account/blacklisted",i)},r.whitelistAccounts=function(i){t.stateLog("whitelisting",i),e.clientController.client?_.each(i,function(t){e.clientController.client.addToAccountWhitelist(t.getKey()),e.clientController.client.delFromAccountBlacklist(t.getKey())}):t.warn("Can't update whitelist: client not initialised")},r.isEmpty=function(){return _.isEmpty(this._objects)},r.isSingleUser=function(){return 1===this.getAll().length},r.getDefault=function(){if(e.clientController.client){var t=e.clientController.client.getDefaultAccount();return t&&this._objects[t]?this._objects[t]:r.isEmpty()?null:(r.setDefault(r.getAll()[0].getKey()),this._objects[e.clientController.client.getDefaultAccount()])}},r.getUserIdentifier=function(){var t,i=e.store.getCurrentAuthType();return"twitter"===i?(t=r.getAccountFromId(e.store.getTweetdeckAccount()),t?t.state.username:""):e.store.getTweetdeckAccount()},r.setDefault=function(t){e.clientController.client.setDefaultAccount(t)},r.getAccountsForService=function(e){return _.select(this._objects,function(t){return t.getType()===e})},r.getAccountFromUsername=function(e){var t=r.getAccountsForService("twitter");return e=e.toLowerCase(),_.select(t,function(t){return t.getUsername().toLowerCase()===e})},r.getAccountFromId=function(e){var t=r.getAccountsForService("twitter");return _.find(t,function(t){return""+t.getUserID()===e})},r.getPreferredAccount=function(e){var t=r.getDefault();return!t||e&&t.getType()!=e?r.getAccountsForService(e)[0]:t},this.init=function(){t.trace("accountController init"),jQuery.subscribe("/storage/client/change",function(e){_.each(e.getAccountBlacklist(),function(e){r._objects[e]&&r.remove(e)})})},this.reset=function(){this._objects={}},this.triggerPush=function(){t.assert(!1,"triggerPush() should not be called on account controller")},this.updateFromBackend=function(i,n){t.stateLog("accountController.updateFromBackend:",i);var s=t.list_to_set(n.settings.account_whitelist||[]);i=i||[],i=i.filter(function(t){var i=e.Account.generateKeyFor(t.service,t.uid),n=s[i];return this.ACCEPTED_ACCOUNT_TYPES[t.service]?(n||(this._unverified[i]=e.Account.newFromBackendState(t)),n):!1}.bind(this));var r=this;_.each(i,function(i){var n=e.Account.generateKeyFor(i.service,i.uid),s=r._objects[n];s?(t.stateLog("updating existing",s,"with",i),s.newRemoteState(i)):(t.stateLog("creating new Account with",i),s=e.Account.newFromBackendState(i),r.manage(s))})},this.get=function(e){return"tweetdeck"===e?{getKey:function(){return"tweetdeck"},getUserID:function(){return"tweetdeck"},getType:function(){return"tweetdeck"}}:this._objects[e]},this.manage=function(t){if(!t.getKey())throw $(document).trigger("metric",{key:"account:manage:fail"}),{name:"TypeError",message:"account must have its .key set"};return t.managed=!0,this._objects[t.getKey()]||n.notify("/storage/account/new",t),this._objects[t.getKey()]=t,this.whitelistAccounts([t]),e.store.setLastVerifiedTimestamp(t),$(document).trigger("metric",{key:"account:manage:success"}),this.pushAccount(t)},this.manageContributee=function(e){var t=TD.storage.Account.generateKeyFor("twitter",e.id),i=this.get(t);return i?this.updateAccountFromContributee(i,e):this.createAccountFromContributee(e)},this.createAccountFromContributee=function(e){var t=new TD.storage.Account(null,{contributor:!0});return t.setType("twitter"),t.setUserID(e.id),t.setIsAdmin(e.isAdmin),t.computeKey(),this._verifyAndManageAccount(t)},this.updateAccountFromContributee=function(e,t){var i=TD.core.defer.succeed();return e.getPrivate("isAccessDenied")&&(e.setPrivate("isAccessDenied",!1),$(document).trigger("dataTwitterAccountAccessEnabled",{accountKey:e.getKey()}),i.addCallback(e.makeContributor.bind(e))),i.addCallback(e.setIsAdmin.bind(e,t.isAdmin)),i},this.isContributeeManaged=function(e){var t=TD.storage.Account.generateKeyFor("twitter",e.id);return!!this.get(t)},r.remove=function(t){var i=this._objects[t];return i.managed=!1,delete this._objects[t],n.notify("/storage/account/removed",i),e.store.removeLastVerifiedTimestamp(i),i.isContributor()&&$(document).trigger("uiRemoveContributee",{accountKey:TD.storage.store.getTwitterLoginAccount().getKey(),userId:i.getUserID()}),this.deleteAccount(i)},r.getAll=function(){var e=_.values(this._objects);return e.sort(r.accountComparator),e},r.getPostingAccounts=function(){return _.filter(r.getAll(),function(e){return"bitly"!==e.getType()})},r.accountComparator=function(e,t){var i=e.getType?e.getType():e.service,n=t.getType?t.getType():t.service,s=e.getUserID?e.getUserID():e.uid,r=t.getUserID?t.getUserID():t.uid,a="twitter"==i?2:1,o="twitter"==n?2:1;return o>a?1:a>o?-1:2==a&&2==o?s>r?1:-1:i>n?1:-1},r.getDefaults=function(){var e=r.getAll(),t=r.getDefault(),i=[],n={};t&&(n[t.getType()]=!0,i.push(t));for(var s=0;s<e.length;s++)n[e[s].getType()]||(n[e[s].getType()]=!0,i.push(e[s]));return i},r.loginTweetdeck=function(e,n){t.stateLog("aC.loginTweetdeck()",e,n);var s=TD.core.sha1(n),r=i.login(e,s);return r.addCallback(function(t){return{httpStatus:200,account:{uid:e,password:s,plaintextPassword:n},data:t}}),r.addErrback(function(e){return{httpStatus:e.number,message:e.message,data:e.req.responseJSON}}),r},r.loginTwitter=function(e,n){t.stateLog("aC.loginTwitter()",e,n);var s=i.twogin(e,n);return s.addCallback(function(e){return{httpStatus:200,account:{uid:e&&e.user_id,password:null,plaintextPassword:n},data:e,xAuth:e.xauth_response||{}}}),s.addErrback(function(e){return{httpStatus:e.number,message:e.message,data:e.req.responseJSON,xAuth:e.req.responseJSON.xauth_response||{}}}),s},r.loginTwitterWith2FACode=function(e,n,s){t.stateLog("aC.loginTwitterWith2FACode()",e,n,s);var r=i.twoginSend2FACode(e,n,s);return r.addCallback(function(e){return{httpStatus:200,account:{uid:e&&e.user_id,password:null,plaintextPassword:n},data:e,xAuth:e.xauth_response||{}}}),r.addErrback(function(e){return{httpStatus:e.number,message:e.message,data:e.req.responseJSON,xAuth:e.req.responseJSON.xauth_response||{}}}),r},r.createTweetdeckAccount=function(e,n){t.stateLog("aC.createTweetdeckAccount()",e,n);var s=TD.core.sha1(n),r=i.createAccount(e,s);return r.addErrback(t.errmark,"accountController.js:createTweetDeckAccount():->tdapi.createAccount()"),r.addCallback(function(){return{account:{uid:null,password:s,plaintextPassword:n},data:{accounts:[]}}}),r.addErrback(t.errmark,"accountController.js:createTweetDeckAccount()"),r},r.pushAccounts=function(){return s.gatherResults(_.map(this._objects,function(e){return r.pushAccount(e)}))},r.pushAccount=function(e){if(i.isLoggedIn()){var t=e.getKey();if(t&&this._objects[t]){var n=e.getStateForBackend(),s="/accounts/"+e.getType()+"/"+e.getUserID();return i.requestWithBody(s,"POST",n)}}},r.deleteAccount=function(e){if(i.isLoggedIn()){t.stateLog("sync.controller.deleteAccount:",e);var n="/accounts/"+e.getType()+"/"+e.getUserID();return i.drequest(n,i.getReq({method:"DELETE"}))}},r._verifyAndManageAccount=function(e,t){var i=TD.controller.auth.create(e.getType(),e),n=new s.Deferred;return i.verifyAccount(n.callback.bind(n),n.errback.bind(n)),t&&n.addErrback(function(){}),n.addCallback(function(){return TD.storage.accountController.manage(e)}),n},r.verifyNewTwoginAccount=function(){t.stateLog("verifyNewTwoginAccount");var i,n,s;return"twitter"===TD.storage.store.getCurrentAuthType()&&(n=e.Account.generateKeyFor("twitter",TD.storage.store.getTweetdeckAccount()),s=this._unverified[n],s&&(i=this._verifyAndManageAccount(s,!0))),this._unverified={},i||TD.core.defer.succeed()},r.verifyStoredAccounts=function(){t.stateLog("verifyStoredAccounts: starting");var i,n=[],a=Date.now()-TD.constants.time.oneDay,o=r.getAll();return _.each(o,function(t){(e.store.getLastVerifiedTimestamp(t)<a||!t.getProfileImageURL()||!t.getUsername()||!t.getName())&&n.push(this._verifyAndManageAccount(t,!0))}.bind(this)),i=new s.DeferredList(n),i.addCallback(function(){t.stateLog("verifyStoredAccounts: done.")}),i}};return r.prototype=new e.SobjController,e.accountController=new r,r}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.storage.notification,TD.core.defer),TD.storage.ClientController=function(e,t,i,n,s,r,a){var o=function(){var i=this;this.apiEndpoint="/clients",_.defer(function(){var n=t.makeThingScheduler,s=e.store.getTweetdeckAccount.bind(e.store);i.triggerPush=n(_.bind(i.pushIfDirty,i),null,"clisync",s)}),this._moduleName="clients",this.reqsinflight=[],this._objects={},this._objectsByApiid=this._objects,this.client=null,this.toString=function(){return"<ClientController>"},this.init=function(){t.stateLog("client controller init start",this.client),t.trace("clientController init"),TD.config.sync_name in this._objects?(this.client=this._objects[TD.config.sync_name],t.assert(this.client.getName(),"need name!"),t.stateLog("client controller new client:",this.client)):t.stateLog("no initial client state; deferring client creation"),t.stateLog("clientController.init: client: ",this.client)},this.reset=function(){this.client=null},this.createNewClient=function(){t.stateLog("clientController.createNewClient()");var i=this,s={name:TD.config.sync_name,columns:[],settings:{}},r={},a=n.requestWithBody("/clients","POST",s,r);return a.addCallback(function(){t.stateLog("createNewClient resp headers; ",r);var n=r["x-td-mtime"];return t.assert(n,"require x-td-mtime header in client POST"),s.mtime=n,i.client=e.Client.newFromBackendState(s),t.assert(i.client.getName(),"Client should have name at this point"),i._objects[i.client.getName()]=i.client,t.stateLog("clientController.createNewClient with",i.client.state),i.triggerPush()}),a},this.updateFromBackend=function(i){null===this.client?(this.client=e.Client.newFromBackendState(i),this._objects[this.client.getName()]=this.client,t.stateLog("client controller (ufb) new client:",this.client)):this.client.newRemoteState(i)},this.pushIfDirty=function(){if(TD.config.debug_checks&&this.checkInvariants(),a.push(this,"dirty",null),this.client.isDirty()){a.push(this,"dirty",this.client);var i=this,n=e.columnController.triggerPush();return n.addCallback(function(){return t.assert(i.client.isDirty(),"?!? push dirty, but not dirty"),i.pushObject(i.client,"/clients/"+i.client.getName())}),n.addCallback(function(){return i.pushIfDirty()}),n}return a.push(this,"not dirty",null),r.succeed()}};return o.prototype=new e.SobjController,e.clientController=new o,o}(TD.storage,TD.sync.util,TD.util,TD.sync.tdapi,TD.storage.notification,TD.core.defer,TD.sync.trace),TD.storage.Feed=function(e,t,i,n){var s=function(e,t){this._init(e),_.isUndefined(t)||(this.state=this.transformToLocal(t)),this.setKey(s.generateKeyFor(this.getAccountKey(),this.getType(),this.getMetadata()))};return s.prototype=new e.StoredObj(e.feedController),s.prototype.eventname="/storage/feed",s.generateKeyFor=function(e,i,n){n=n||{};var s=TD.util.deterministicObjectHash(n),r=[e,i,s];return t.assert(e,"accountkey not set in Feed.generateKey"),t.assert(i,"type not set in Feed.generateKey"),encodeURI(r.join(":"))},s.prototype.getType=function(){return this.get("type")},s.prototype.setType=function(e){return this.immutableSet("type",e)},s.prototype.getService=function(){return this.get("service")},s.prototype.setService=function(e){return this.immutableSet("service",e)},s.prototype.getAccountKey=function(){return this.get("accountkey")},s.prototype.setAccountKey=function(e){return this.immutableSet("accountkey",e)},s.prototype.getTopSortIndex=function(){var e=this.get("marks");return e?e.top_sort_index?e.top_sort_index||null:{value:this.getLatestTime(),type:"milliseconds"}:null},s.prototype.setTopSortIndex=function(e){var t,i=this.get("marks")||{};return Array.isArray(i)&&(i=_.extend({},i)),i[0]=i[0]||{},i.top_sort_index=e,t=this.set("marks",i)},s.prototype.getLatestTime=function(){var e=this.get("marks");if(!e||_.isEmpty(e))return 0;var t=e[0];return t.last_notification||0},s.prototype.setLatestTime=function(e){var t=this.get("marks");return!t||_.isEmpty(t)?this.set("marks",[{last_notification:e}]):(t[0].last_notification=e,this.set("marks",t))},s.prototype.getMetadata=function(){return _.clone(this.get("metadata"))},s.prototype.setMetadata=function(e){return this.immutableSet("metadata",e)},s.prototype.transformForRemote=function(i,n){var s=e.accountController.get(i.accountkey);t.assert(s&&s.getUserID(),"must have acct + uid for feed transform");var r=s.getUserID(),a={type:i.type,service:i.service,account:{userid:r.toString()},metadata:JSON.stringify(i.metadata),marks:i.marks};return i.mtime&&(a.mtime=i.mtime),n.apiid&&(a.id=n.apiid),a},s.prototype.reprocessNotificationMarks=function(e,t){var i=null,n=null;if(t&&t.marks&&!_.isEmpty(t.marks)&&(i=t.marks[0].last_notification,n=t.marks),e.marks&&!_.isEmpty(e.marks)){n=e.marks;var s=e.marks[0].last_notification;i&&s?i=Math.max(i,s):s&&(i=s)}return n?n[0].last_notification=i:n=i?[{last_notification:i}]:[],n},s.prototype.transformToLocal=function(t){var i={type:t.type,service:t.service,accountkey:e.Account.generateKeyFor(t.service,t.account.userid),metadata:JSON.parse(t.metadata),mtime:t.mtime,marks:t.marks};return i},s.newFromBackendState=function(e){return new s(null,e)},s}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.util),TD.storage.Column=function(e,t,i,n,s){var r=function(e){this._init(e),this.privateState.key||(this.privateState.key="c"+(new Date).getTime()+_.uniqueId("s"))};r.prototype=new e.StoredObj(e.columnController),r.prototype.eventname="/storage/column",r.prototype.getTitle=function(){var e=this.get("title");return _.isUndefined(e)?"loading…":e},r.prototype.setTitle=function(e){return this.set("title",e)},r.prototype.getDescription=function(){return this.get("description")},r.prototype.setDescription=function(e){return this.set("description",e)},r.prototype.getType=function(){return this.get("type")},r.prototype.setType=function(e){return this.set("type",e)},r.prototype.getFilters=function(){return this.get("filters")},r.prototype.setFilters=function(e){return this.setValueIffDifferent("filters",e)},r.prototype.getHasSound=function(){var e=this.get("settings");return Boolean(e&&e.has_sound)},r.prototype.setHasSound=function(e){return e=Boolean(e),s.notify("/storage/column/column_flags_changed","has_sound",e,this),this.dictSet("settings","has_sound",e)},r.prototype.getHasNotification=function(){var e=this.get("settings");return Boolean(e&&e.has_notification)},r.prototype.setHasNotification=function(e){return e=Boolean(e),s.notify("/storage/column/column_flags_changed","has_notification",e,this),this.dictSet("settings","has_notification",e)},r.prototype.getMediaPreviewSize=function(){var e=this.get("settings");return e?e.media_preview_size:null},r.prototype.setMediaPreviewSize=function(e){return $(document).trigger("dataColumnSettings",{columnKey:this.getKey(),mediaPreviewSize:e}),this.dictSet("settings","media_preview_size",e)},r.prototype.getClearedTimestamp=function(){var e=this.get("settings");return e&&e.cleared_timestamp?e.cleared_timestamp:0},r.prototype.setClearedTimestamp=function(e){return s.notify("/storage/column/column_marks_changed","cleared_timestamp",e,this),this.dictSet("settings","cleared_timestamp",e)},r.prototype.getFeedKeys=function(){return this.get("feedkeys")},r.prototype.setFeedKeys=function(e){return this.setValueIffDifferent("feedkeys",_.isArray(e)?_.uniq(e.sort(),!0):e,"/storage/column/feeds_changed")};var a=["mtime","type","title","description","settings","position","bookmarks","filters"];return r.prototype.transformForRemote=function(i,n){var s=function(i){var n=e.feedController.get(i);return t.assert(n&&n.hasApiid(),"feeds must have apiid when transforming column for remote"),n.getApiid()},r={};return _.each(a,function(e){r[e]=i[e]}),r.feeds=_.map(i.feedkeys,s),i.mtime&&(r.mtime=i.mtime),n.apiid&&(r.id=n.apiid),r},r.prototype.transformToLocal=function(i){TD.config.debug_checks&&_.each(i.feeds,function(n){t.assert(e.feedController.getByApiid(n),"feed not found by apiid in "+t.pformat(i.feeds))});var n={};return _.each(a,function(e){n[e]=i[e]}),n.feedkeys=_.map(i.feeds,function(t){return e.feedController.getByApiid(t).getKey()}),n.apiid=i.id,n},r.newFromBackendState=function(e){var t=new r;return t.newRemoteState(e),t},r}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.util,TD.storage.notification),TD.storage.Account=function(e,t,i,n,s){var r=function(i,n){i?(this.state=_.clone(i),this.privateState={}):(this.state={},this.privateState={});var s=this,r=function(){s.controller.pushAccount(s)},a=e.store.getTweetdeckAccount.bind(e.store);this.triggerPush=t.makeThingScheduler(r,null,"account",a,.2),n&&n.contributor&&this.makeContributor()};r.prototype=new e.StoredObj(e.accountController),r.prototype.eventname="/storage/account",r.generateKeyFor=function(e,t){return"tweetdeck"===e?"tweetdeck":encodeURI(e+":"+t)},r.CONTRIBUTOR_OAUTH_TOKEN="CONTRIBUTOR",r.prototype.computeKey=function(){if(!this.getType()||!this.getUserID())throw{name:"NotReadyError",message:"cannot computeKey on account; insufficient data"};this.setKey(r.generateKeyFor(this.getType(),this.getUserID()))},r.prototype.set=function(e,t){return this.state[e]=t,i.notify(this.eventname+"/change",this),this.triggerPush()},r.prototype.checkInvariants=function(){t.assert(_.isEmpty(this.deltaQ),"Accounts must not have Δs"),t.assert(null===this.stateCache,"Accounts do not use stateCache")},r.prototype.getUsername=function(){return this.get("username")},r.prototype.setUsername=function(e){return this.set("username",e)},r.prototype.getName=function(){return this.get("name")},r.prototype.setName=function(e){return this.set("name",e)},r.prototype.getUserID=function(){return this.get("userId")},r.prototype.setUserID=function(e){return this.set("userId",e)},r.prototype.getType=function(){return this.get("type")},r.prototype.setType=function(e){return this.set("type",e)},r.prototype.getOAuthToken=function(){return this.get("oauth_token")},r.prototype.setOAuthToken=function(e){return this.set("oauth_token",e)},r.prototype.getTokenSecret=function(){return this.get("token_secret")},r.prototype.setTokenSecret=function(e){return this.set("token_secret",e)},r.prototype.getProfileImageURL=function(){var e=this.get("profileImageURL");return e&&TD.util.isRetina()&&(e=e.replace(TD.services.TwitterUser.NORMAL_SUFFIX_REGEXP,TD.services.TwitterUser.BIGGER_SUFFIX)),e},r.prototype.setProfileImageURL=function(e){return this.set("profileImageURL",e)},r.prototype.getIsPrivate=function(){return this.getPrivate("isPrivate")},r.prototype.setIsPrivate=function(e){return this.setPrivate("isPrivate",e)},r.prototype.getUpdated=function(){return this.getPrivate("updated")},r.prototype.setUpdated=function(e){return this.setPrivate("updated",e)},r.prototype.isContributor=function(){return this.getOAuthToken()===r.CONTRIBUTOR_OAUTH_TOKEN},r.prototype.makeContributor=function(){return this.setOAuthToken(r.CONTRIBUTOR_OAUTH_TOKEN)},r.prototype.getIsAdmin=function(){var e=!this.isContributor()||this.getPrivate("isAdmin");return!!e},r.prototype.setIsAdmin=function(e){return this.setPrivate("isAdmin",!!e)},r.prototype.getStateForBackend=function(){var e={secret:this.getTokenSecret(),screen_name:this.getUsername(),name:this.getName(),avatar:this.getProfileImageURL(),key:this.getOAuthToken()};return e};var a={key:"oauth_token",token:"oauth_token",secret:"token_secret",screen_name:"username",service:"type",uid:"userId",avatar:"profileImageURL",name:"name"};return r.prototype.newRemoteState=function(e){var i=this;t.stateLog(this,".updateFromBackend(",e,")"),_.each(a,function(t,n){e[n]&&i.set(t,e[n])})},r.newFromBackendState=function(e){var t=new r;return t.newRemoteState(e),t.computeKey(),t},r.prototype.isSameUser=function(e){return this.getUsername().toLowerCase()===e.toLowerCase()},r}(TD.storage,TD.sync.util,TD.storage.notification,TD.util,TD.core.base64),TD.storage.Client=function(e,t,i,n,s,r,a){var o=10,c=function(e){t.trace("Client constructor:"),t.stateLog("Client constructor: ",e);var i=e&&e.column_order;i&&!_.isEqual(i,_.union(i))&&(t.warn("WARNING! removing duplicates in column_order",_.clone(i)),e.column_order=_.union(i)),t.assert(!e||!e.columns,'"columns" should not be in local client state'),this._init(e),this.managed=!0,TD.config.debug_checks&&this.checkInvariants()};c.prototype=new e.StoredObj(e.clientController),c.prototype.eventname="/storage/client",c.prototype.recent_searches_limit=o,c.prototype.getName=function(){return this.get("name")},c.prototype.getApiid=function(){return this.get("name")},c.prototype.hasApiid=function(){return!0},c.prototype.getColumnOrder=function(){return _.clone(this.get("column_order")||[])},c.prototype.setColumnOrder=function(e){_.each(e,function(e){t.precondition("string"==typeof e,"must provide string column keys")});this.get("column_order");if(!_.isEqual(e,_.union(e)))throw t.warn("ERROR: column_order contains duplicates:",e),new Error("column_order must not contain duplicates");return s.notify("/storage/client/column_order_changed"),this.setListPermutation("column_order",e)},c.prototype.removeColumn=function(e){return s.notify("/storage/client/column_order_changed"),this.listRemove("column_order",e)},c.prototype.appendColumn=function(e){return s.notify("/storage/client/column_order_changed"),this.listAdd("column_order",e)},c.prototype.cleanAccountLists=function(){this.listDedupe("account_whitelist"),this.listDedupe("account_blacklist")},c.prototype.getAccountBlacklist=function(){return _.clone(this.get("account_blacklist")||[])},c.prototype.addToAccountBlacklist=function(t){var i=this.get("account_blacklist")||[];if(_.include(i,t))return r.succeed(null);var n=this.listAdd("account_blacklist",t);return s.notify("/storage/client/account_blacklist_changed",i,this.get("account_blacklist"),this),e.accountController.remove(t),n},c.prototype.delFromAccountWhitelist=function(e){var t=this.get("account_whitelist")||[];if(!_.include(t,e))return r.succeed(null);var i=this.listRemove("account_whitelist",e),n=this.get("account_whitelist");return s.notify("/storage/client/account_whitelist_changed",t,n,this),$(document).trigger("dataAccountWhitelist",{accountKeys:n}),i},c.prototype.addToAccountWhitelist=function(e){var t=this.get("account_whitelist")||[];if(_.include(t,e))return r.succeed(null);var i=this.listAdd("account_whitelist",e),n=this.get("account_whitelist");return s.notify("/storage/client/account_whitelist_changed",t,n,this),$(document).trigger("dataAccountWhitelist",{accountKeys:n}),i},c.prototype.delFromAccountBlacklist=function(e){var t=this.get("account_blacklist")||[];if(!_.include(t,e))return r.succeed(null);var i=this.listRemove("account_blacklist",e);return s.notify("/storage/client/account_blacklist_changed",t,this.get("account_blacklist"),this),i},c.prototype.getAccountWhitelist=function(){return _.clone(this.get("account_whitelist"))},c.prototype.getDefaultAccount=function(){return this.get("default_account")},c.prototype.addRecentSearch=function(e){return r.gatherResults([this.listRemove("recent_searches",e),this.listPrepend("recent_searches",e),this.listTruncate("recent_searches",this.recent_searches_limit)])},c.prototype.getRecentSearches=function(){return this.get("recent_searches")||[]},c.prototype.clearRecentSearches=function(){this.set("recent_searches",[])},c.prototype.postProcessNewRemoteState=function(){var e=this.getColumnOrder(),i=_.union(e);_.isEqual(i,e)||(t.warn("WARNING! found duplicates in column order, collapsing",e),this.state.column_order=i)},c.prototype.setDefaultAccount=function(e){return t.assert(!_.isUndefined(e),"huh? you wanted to do what now?"),this.setValueIffDifferent("default_account",e,"/storage/client/default_account_changed")};var l=["account_blacklist","account_whitelist","default_account","settings","recent_searches"];return c.prototype.transformForRemote=function(i,n){t.stateLog("Client.transformToLocal L",i);var s={};_.each(l,function(e){i[e]&&(s[e]=i[e])});var r={settings:s,name:i.name};return r.columns=_.map(i.column_order||[],function(i){var n=e.columnController.get(i);return t.assert(n.hasApiid(),"Column "+i+" does not have apiid",n),n.getApiid()}),i.mtime&&(r.mtime=i.mtime),t.stateLog("Client.transformToLocal R",r),r},c.prototype.transformToLocal=function(i){t.stateLog("Client.transformToLocal R",i);var n={},s=!1;n.column_order=_.filter(_.map(i.columns,function(n){if(!n)return t.warn("WARNING: bogus data in rstate.columns!",t.pformat(i.columns)),null;var r=e.columnController.getByApiid(n);return r||(t.stateLog("allocating new empty local sColumn for",n),r=new e.Column,r.setApiid(n),e.columnController.manage(r),s=!0),r.getKey()}),Boolean),s&&TD.sync.controller.ueberpull();var r=i.settings||{};return _.each(l,function(e){r[e]&&(n[e]=r[e])}),n.mtime=i.mtime,n.name=i.name,t.stateLog("Client.transformToLocal L",n),n},c.prototype.setApiid=function(e){t.assert(!1,"no-one should ever set apiid on Client")},c.newFromBackendState=function(e){var t=new c;return t.newRemoteState(e),t},c}(TD.storage,TD.sync.util,TD.sync.tdapi,TD.util,TD.storage.notification,TD.core.defer,TD.sync.trace),TD.settings=function(e,t){function i(e,i){var r={};return t.notify(o+e,i),_.isEqual(i,n(e))?TD.core.defer.succeed():(-1===M.indexOf(e)&&(_.isString(i)||_.isBoolean(i)||_.isNumber(i))&&TD.controller.stats.setting(e,i),r[e]=i,$(document).trigger("dataSettingsValues",r),s.dictSet("settings",e,i))}function n(e){var t,i;if(!s)throw new Error("Settings client hasn't been initialized. Call settings.init() first.");return t=s.get("settings"),i=void 0,t&&(i=t[e]),_.isUndefined(i)&&(i=a[e]),(_.isArray(i)||_.isObject(i))&&(i=TD.sync.util.clone(i)),i}var s,r={},a={},o="/storage/client/settings/",c="use_stream",l="use_notification_sound",u="language",d="check_for_updates",h="use_narrow_columns",p="column_width",m="font_size",f="theme",g="scheduled_col_autoadded",v="link_shortener",T="use_jmp",b="global_filter",w="previous_splash_version",y="show_startup_notifications",D="name_cache",C="seen_message_ids",S="navbar_width",E="compose_stay_open",x="display_sensitive_media",k="sole_user",A="dataminr_auth_token",I="account_selector_grid_mode",M=[w,A];return r.linkShorteners=[{id:"twitter",title:"Twitter"},{id:"bitly",title:"Bit.ly"}],r.SoleUserState=function(e){this.state=e||"sole_user_initial"},r.SoleUserState.prototype={get initial(){return"sole_user_initial"===this.state},set initial(e){throw new Error("Can't transition from initial state to "+e)},get shared(){return"sole_user_shared"===this.state},set shared(e){if(e){if(!this.initial)throw new Error("Must be in initial state to transition to shared.");this.state="sole_user_shared"}},get confirmed(){return"sole_user_confirmed"===this.state},set confirmed(e){if(e){if(!this.initial&&!this.shared)throw new Error("Must be in initial or shared state to transition to confirmed.");this.state="sole_user_confirmed"}}},r.init=function(){s=e.clientController.client,s||console.warn("Initialized settings before storage.clientController.init() was called.")},a[c]=!0,r.getUseStream=function(){return Boolean(n(c))},r.setUseStream=function(e){return i(c,Boolean(e))},a[l]=!0,r.getUseNotificationSound=function(){return Boolean(n(l))},r.setUseNotificationSound=function(e){return i(l,Boolean(e))},r.getLanguage=function(){return String(n(u))},r.setLanguage=function(e){return i(u,String(e))},a[d]=!0,r.getCheckForUpdates=function(){return Boolean(n(d))},r.setCheckForUpdates=function(e){return i(d,Boolean(e))},a[k]=0,r.getSoleUserState=function(){return new r.SoleUserState(n(k))},r.setSoleUserState=function(e){return i(k,e.state)},a[h]=!1,a[p]="medium",r.getColumnWidth=function(){var e=n(h);return _.isBoolean(e)&&(i(h,null),e)?(r.setColumnWidth("narrow"),"narrow"):n(p)},r.setColumnWidth=function(e){return i(p,e)},a[m]="medium",r.getFontSize=function(){return n(m)},r.setFontSize=function(e){return i(m,e)},a[f]="light",r.getTheme=function(){return n(f)},r.setTheme=function(e){return i(f,String(e))},a[v]="twitter",r.getLinkShortener=function(){return String(n(v))},r.setLinkShortener=function(e){return i(v,String(e))},a[T]=!1,r.getUseJmp=function(){return Boolean(n(T))},r.setUseJmp=function(e){return i(T,Boolean(e))},r.getGlobalFilter=function(){return n(b)},r.setGlobalFilter=function(e){return i(b,e)},a[y]=!0,r.getShowStartupNotifications=function(){return Boolean(n(y))},r.setShowStartupNotifications=function(e){return i(y,Boolean(e))},a[x]=!1,r.getDisplaySensitiveMedia=function(){return Boolean(n(x))},r.setDisplaySensitiveMedia=function(e){return i(x,Boolean(e))},a[g]=!1,r.getScheduledColAdded=function(){return Boolean(n(g))},r.setScheduledColAdded=function(e){return i(g,Boolean(e))},a[w]="0",r.getPreviousSplashVersion=function(){return n(w)},r.setPreviousSplashVersion=function(e){return i(w,String(e))},a[D]={},r.getNameCache=function(){return n(D)},r.setNameCache=function(e){return i(D,e)},a[C]=[],r.getIdsForSeenMessages=function(){return n(C)},r.setIdsForSeenMessages=function(e){return i(C,e)},a[S]="condensed",r.getNavbarWidth=function(){return n(S)},r.setNavbarWidth=function(e){return i(S,e)},a[E]=!1,r.getComposeStayOpen=function(){return Boolean(n(E))},r.setComposeStayOpen=function(e){return i(E,Boolean(e))},a[A]=null,r.getDataminrAuthToken=function(){return n(A)},r.setDataminrAuthToken=function(e){return i(A,e)},a[I]="grid",r.getAccountSelectorGridMode=function(){return n(I)},r.setAccountSelectorGridMode=function(e){return i(I,e)},r}(TD.storage,TD.storage.notification),TD.storage.upgrade=function(e,t,i,n){var s={};return s.CURRENT_VERSION=4,s.getVersion=function(e){var t=e.getItem("__version__");return null===t?s.guessVersion(e):Number(t)},s.guessVersion=function(e){var t=e.getItem("settings"),i=e.getItem("clients"),n=e.getItem("columns");if(i&&!t&&(i=JSON.parse(i),!_.isEmpty(i))){var r=_.values(i)[0];if("ΔQ"in r)return 2}return!i&&t&&n?0:s.CURRENT_VERSION},s.doUpgrade=function(e){var t=s.getVersion(e);(!t||4>t)&&s._upgradeAllToV4(e)},s._upgradeAllToV4=function(t){console.log("Upgrading store to v4"),TD.storage.Store.flushDataFromStore(t,TD.sync.controller.PERSISTENT_STORAGE_ITEMS),e.store.setVersion(4)},s}(TD.storage,TD.config,TD.sync.util,TD.core.defer),TD.sync.controller=function(e,t,i){var n={};return n.PERSISTENT_STORAGE_ITEMS=["tweetdeckAccount","_session","__hasAlreadyReloaded"],n.debugFlushAndReload=function(){TD.storage.Store.flushWebstorage(),TD.util.isWrapperApp()&&deck.tearDown(),window.location.reload()},n.flushSyncDataAndReload=function(){TD.storage.Store.flushWebstorage(n.PERSISTENT_STORAGE_ITEMS),TD.util.isWrapperApp()&&deck.tearDown(),window.location.reload()},n.debugInstallOldChromeData=function(){TD.storage.Store.flushWebstorage();var e=/^[a-zA-Z0-9\+\/=]*$/,t=TD.debug.spoof_data;t.match(e)&&(t=TD.core.base64.decode(t));var i=JSON.parse(t);_.each(i,function(e,t){localStorage.setItem(t,e);

})},n.debugQueryRemote=function(t,i){var s=n.fetchAllBackendData();return s.addCallback(e.pprint),s},n.fetchAllBackendData=function(){var n=t.drequest("/accounts"),s=TD.storage.clientController,r=s.client&&s.client.getName()||TD.config.sync_name,a="/clients/"+r+"/all",o=t.drequest(a),c=!1;o.addErrback(function(i){if(404===i.number){e.stateLog("Controller.fetchAllBackendData(): client didn't exist!");var n=s.createNewClient();return n.addCallback(function(){return c=!0,t.drequest(a)}),n}return i});var l=new i.gatherResults([n,o]);return l.addCallback(function(e){var t;return t=e[1],t.accounts=e[0],t.isNewClient=c,t}),l},n.updateFromBackendData=function(e){TD.storage.accountController.updateFromBackend(e.accounts,e.client),TD.storage.feedController.updateFromBackend(e.feeds),TD.storage.columnController.updateFromBackend(e.columns),TD.storage.clientController.updateFromBackend(e.client),TD.decider.updateFromBackend(e.decider),TD.controller.stats.setExperiments(e.ddg||{})},n.ueberpull=function(){e.trace("überpull");var t=i.succeed();return t.addCallback(function(){return TD.storage.columnController.triggerPush(.05)}),t.addErrback(e.errmark,"d.Eb:triggerPush"),t.addCallback(function(){return n.fetchAllBackendData()}),t.addErrback(e.errmark,"d.Eb:fetchAllBackendData"),t.addCallback(function(e){n.updateFromBackendData(e),$(document).trigger("dataMessages",{messages:e.messages})}),t.addErrback(e.errmark,"d.Eb:sync.controller.updateFromBackend"),t},n.initFromTdLogin=function(t){var s=i.succeed(t),r=!1;return s.addCallback(n.init),s.addErrback(function(t){return e.warn("WARNING! sync.controller.init() failed",t),t}),s.addCallback(n.fetchAllBackendData),s.addErrback(function(t){return e.warn("WARNING! sync.controller get all sunc data failed",t),t}),s.addCallback(function(e){n.updateFromBackendData(e),r=e.isNewClient}),s.addErrback(function(t){return e.warn("WARNING! sync.controller update all failed",t),t}),s.addCallback(function(e){return{isNewClient:r}}),s},n.debuggery=function(){jQuery.subscribe("/storage/object/change",function(){e.warn("ERROR; untyped StoredObj change notification",_.toArray(arguments)),e._break()})},n.checkInvariants=function(){var e=[TD.storage.feedController,TD.storage.columnController,TD.storage.accountController,TD.storage.clientController];_.each(e,function(e){var t=e.checkInvariants;t&&t.call(e)})},n.init=function(t){e.trace("sync controller init"),n.store=t,n.debuggery(),TD.storage.feedController.init(t),TD.storage.columnController.init(t),TD.storage.accountController.init(t),TD.storage.clientController.init(t);var i=TD.config.sync_period;_.isUndefined(i)&&(i=600),n.loop=setInterval(n.ueberpull,1e3*i)},n.reset=function(){n.loop&&(clearInterval(n.loop),delete n.loop),TD.storage.columnController.reset(),TD.storage.feedController.reset(),TD.storage.accountController.reset(),TD.storage.clientController.reset()},n}(TD.sync.util,TD.sync.tdapi,TD.core.defer),TD.sync.ui=function(e,t){var i={};return i.dispatch_ui_event=function(i){var n={flushreload:e.debugFlushAndReload,dumptrace:TD.sync.trace.logDump,cleartrace:TD.sync.trace.clear,queryremote:e.debugQueryRemote,ueberpull:e.ueberpull,junk:function(){console.log("junk fondled")}}[i];if(n){var s;try{s=t.maybeDeferred(n)}catch(r){return void console.log(r)}s.addCallback(function(e,t){util.stateLog('result for event "'+t+'": ',e)},i),s.addErrback(function(e,t){util.warn("ERROR for event",t,": ",e),console.log(e.stack)},i)}else alert('no handler for event "'+i+'"')},i}(TD.sync.controller,TD.core.defer),function(e,t){"function"==typeof define&&define.amd?define([],t):e.TD.ui.template=t()}(this,function(){function e(e){e=e.replace(u,"/");var t=d[e];return void 0===t&&(t=l.getHogan(e),t=a.compile(t,h),d[e]=t),t}function t(t,i){var n=this.partials[t];return i=i||{},i[n.name]||(i[n.name]=e(n.name)),Hogan.Template.prototype.ep.call(this,t,i)}function i(e,t,i){for(var s=Hogan.parse.call(this,e,t,i),r="",a=0;a<s.length;a++)if("_v"===s[a].tag&&0===s[a].n.indexOf("%TRANSLATION-HINT")){var o=s.splice(a,1)[0];a--,r=o.n.substring(o.n.indexOf("mode=")+"mode=".length)}return n(s,r,t,i)}function n(e,t,i,a){for(var o=[],c=0;c<e.length;c++)if("#"===e[c].tag&&"_i"===e[c].n){var l=r(i.substring(e[c].i,e[c].end),t);"raw"===l.tag?o.push(l):Array.prototype.push.apply(o,Hogan.parse(Hogan.scan(l,a.delimiters),i,a))}else"#"===e[c].tag||"^"===e[c].tag||"<"===e[c].tag||"$"===e[c].tag?(e[c].nodes=n(e[c].nodes,t,i,a),o.push(e[c])):o.push(e[c]);return s(o)}function s(e){if(0===e.length)return e;for(var t=[e[0]],i=1;i<e.length;i++)if("_t"!==t[t.length-1].tag||"\n"!==e[i].tag&&"_t"!==e[i].tag)t.push(e[i]);else{var n=t[t.length-1],s=e[i].text;void 0===s&&(s="\n"),n.text+=""+s}return t}function r(e,t){var i;return i=""!==t?{text:e,mode:t}:e,TD.i(i,null,!0)}var a,o,c,l={},u=/\\/g,d={},h={sectionTags:[{o:"_i",c:"i"}]};return c=function(e,i,n,s){this.ep=t,Hogan.Template.call(this,e,i,n,s)},c.prototype=Hogan.Template.prototype,o=function(){},o.prototype=Hogan,a=new o,a.template=c,a.parse=i,l.getHogan=function(e){var t=e+".mustache",i=TD.mustaches[t];return void 0===i?console.error('TD.mustaches["'+t+'"] is not defined'):i=i.trim(),i},l.render=function(t,i,n){var s,r=e(t),a=[];i=i||{};for(var o in TD.globalRenderOptions)void 0===i[o]&&(i[o]=TD.globalRenderOptions[o],a.push(o));return s=r.render(i,n),a.forEach(function(e){delete i[e]}),s.trim()},l.toHtml=function(e,t,i){var n=a.compile(e,h);return n.render(t,i).trim()},l.toHtmlFromRaw=function(e,t){var i=Hogan.compile(e);return i.render(t)},l.toURLFromRaw=function(e,t){return e.replace(/\{\{([^}]+?)\}\}/g,function(e,i){return encodeURIComponent(t[i])})},l}),TD.net.StreamRequest=function(e,t){var i=function(){console.log((new Date).toUTCString(),">",t.getUsername(),">",arguments)};this.receivedChars=0,this.readChars=0;var n,s,r,a,o,c=100,l=this,u=!1,d=function(e,t){var i=new XMLHttpRequest;return"withCredentials"in i?i.open(e,t,!0):i=null,i},h=function(e){i("Signer HTTP status:",e.xhr.status),200===e.xhr.status&&(r=e.data.headers.Authorization,p())},p=function(){return(o=d("GET",e))?(o.setRequestHeader("Authorization",r),o.setRequestHeader("X-User-Agent","TweetDeck Chrome "+TD.version),o.send(),void m()):void v("CORS not supported",0)},m=function(){f(),o.readyState!==XMLHttpRequest.DONE&&setTimeout(m,c)},f=function(){switch(o.readyState){case XMLHttpRequest.LOADING:var e,t=o.responseText.lastIndexOf("\r");if(u||(i("Stream HTTP status:",o.status),u=!0),l.receivedChars=o.responseText.length,t>=l.readChars){e=o.responseText.substring(l.readChars,t+1),l.readChars+=e.length;try{g(e)}catch(n){console.log("Callback error:",n)}}break;case XMLHttpRequest.DONE:v("Stream interrupted",o.status)}},g=function(e){n&&n(e)},v=function(e,t){s&&s(e,t)};this.onStreaming={connect:function(e){n=e},disconnect:function(e){n===e&&(n=null)}},this.onFailure={connect:function(e){s=e},disconnect:function(e){s===e&&(s=null)}},this.goStreaming=function(){if(t.isContributor())v("Cannot stream contributor accounts",0);else{var i=TD.net.ajax.signRequest(t,e,"GET");i.addCallback(h),i.addErrback(function(e){v("Failed to sign request",0)})}},this.deleteLater=function(){i("Closing stream connection"),a&&(a.onreadystatechange=null),o&&(o.onreadystatechange=null,o.abort()),g=null,v=null}},TD.net.util=function(){var e={},t=encodeURIComponent,i=/[!'()]/g,n=/\*/g;return encodeURIComponent=function(e){return t(e).replace(i,escape).replace(n,"%2A")},e.addURLParam=function(t,i,n){var s={};return s[i]=n,e.addURLParameters(t,s)},e.addURLParameters=function(t,i){var n=e.buildQueryString(i),s=t;return n?(s+=-1===t.indexOf("?")?"?":"&",s+n):t},e.buildQueryString=function(e){var t,i=[];if(e)for(var n in e)void 0!==e[n]&&(t=n+"="+encodeURIComponent(e[n]),i.push(t));return i.join("&")},e.formDecode=function(e){var t,i,n,s=e.split("#",1)[0].split("&"),r={};return s.forEach(function(e){if(n=e.indexOf("="),n>0){t=e.slice(0,n),i=e.slice(n+1);try{t=decodeURIComponent(t)}catch(s){}try{i=decodeURIComponent(i)}catch(s){}r[t]=i}}),r},e.decodeURL=function(t){var i=t.split("?");return i.length>1?e.formDecode(i[1]):{}},e.formEncode=function(e){var t=[];for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return t.join("&")},e.getQueryStringParams=function(){var e=window.location.href.split("?");if(e.length>=2){var t=e.slice(1).join("?");return this.formDecode(t)}return{}},e}(),TD.controller.init=function(e,t,i,n,s,r,a,o,c){"use strict";var l={},u=!1,d=!1,h=2592e3,p=3;l.purgedServices=[],l.restarts=0,l.preload=function(){TD.util.isTouchDevice()&&window.navigator.standalone&&($("head meta[name=viewport]").remove(),$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">')),TD.util.isTouchDevice()&&($("html").addClass("touch-device"),TD.decider.get("touchdeck_font_size_v2")&&$("html").addClass("with-touch-font-size"),TD.util.attachFastClick()),TD.controller.stats.init()},l.start=function(t,s){var r,c=TD.core.defer.succeed(),m=TD.util.getAppEnv();return"chrome"===m&&chrome.extension.getViews({type:"tab"}).length>1?void n.warn("Duplicate Chrome App tab. Aborting init."):(TD.util.isWrapperApp()&&(TD.util.isUnsupportedWebWrapperVersion()?(deck.closeLoadingScreen&&deck.closeLoadingScreen(),window.location.assign(TD.config.api_root+TD.assets.get("html",{name:"deprecated"})+"?appenv"+m)):TD.controller.scheduler.schedulePeriodicTask(h,function(){window.location.reload(!0)})),c.addCallback(function(){var e,t;return"windows"===TD.util.getOSName()&&$("html").addClass("os-windows"),TD.util.isChrome()&&$("html").addClass("is-chrome"),r=TD.controller.feather.loadFeathers(!1),TD.util.isWeb()&&TD.sessionMigration.unpackSessionStorage(),t=TD.storage.Store.getPreviousStorage(),n.stateLog("Previous storage type:",t),t&&TD.storage.store.init(t),e=TD.storage.store.getSessionData(),TD.decider.updateFromBackendForGuestID(TD.storage.store.getOrCreateGuestID()).addBoth(TD.sessionMigration.migrateSessionToWeb).addCallback(l.doLogin.bind(l,e,s))}),c.addCallback(function(e){return r.addBoth(function(){return e}),r}),u=!1,c.addCallback(function(e){return u=e.createdAccount,e}),c.addCallback(f),d=!1,c.addCallback(function(e){return d=e.isNewClient,e}),c.addCallback(e.notification.flush),c.addCallback(g),c.addCallback(function(){return o.gatherResults([e.feedController.triggerPush(.05),e.columnController.triggerPush(.05)])}),c.addCallback(function(){e.store.checkVersion(e.upgrade.CURRENT_VERSION)}),c.addCallback(g),c.addCallback(function(){if(u){var t=e.clientController.client,n=i.upgrade.CURRENT_VERSION;return console.log("freshly created account; no upgrades, recording v",n),t.dictSet("settings","version",n)}return i.upgrade.doUpgrades()}),c.addCallback(function(){return e.accountController.verifyNewTwoginAccount()}),c.addCallback(function(){TD.storage.Store.removeReloadedFlag()}),c.addErrback(function(e){throw TD.storage.Store.shouldTryReload()&&TD.sync.controller.flushSyncDataAndReload(),e}),c.addCallback(TD.settings.init),c.addCallback(function(){var e=new o.Deferred;return $(document).one("dataMigrateData",function(t,i){e.callback(i)}).trigger("uiNeedsMigrateData"),e.addCallback(function(e){var t=TD.sync.tdapi.doMigration(e);return t.addCallback(function(t){return e&&e.active&&(y(),TD.components.NewFeaturesSplash.updateSeenVersion()),t}),t}),e}),c.addCallback(function(){i.stats.setUid(TD.storage.store.getTweetdeckAccount())}),c.addCallback(w),c.addCallback(D),c.addErrback(function(e){if(n.warn(e,"controller.init.start failed, restarting",e.message),e.message.soleUserDenied)return void l.signOut();if(e.stackTrace)try{console.log(e.stackTrace.join("\n"))}catch(t){console.log("Unable to get stackTrace to report error:",t)}return a.controller.reset(),l.restarts++<=p?l.start(null,e.message):(alert("Fatal error: "+e.message),void TD.storage.Store.wipeAll())}),c)},l.doLogin=function(e,t){return n.stateLog("init.doLogin(sessionData=",e,"errorMsg=",t,"authType=",e.authType,")"),TD.util.isWrapperApp()&&deck.closeLoadingScreen&&deck.closeLoadingScreen(),!e.uid||e.migrate.active||t?this.setupLoginScreen(e,t):this.continueLogin(e)},l.setupLoginScreen=function(e,t){return t&&n.warn("Login failed with message: "+t),this.showLoginScreen(e,t)},l.showLoginScreen=function(e,t){var i=new o.Deferred;return $(document).one("uiLoginAuthComplete",function(e,t){i.callback(t)}),$(document).trigger("uiLoginShowLoginForm",{sessionData:e,errorMsg:t}),i},l.continueLogin=function(e){n.trace("init.continueLogin()");var t;if(e.sessionExists){var i=function(){return c.drequest("/user",null,null,!0)};t=TD.sync.util.autoRetry(i,[5e3,1e4],m),t.addCallback(function(){var t={account:{uid:e.uid},staySignedIn:e.staySignedIn};return"twitter"===TD.storage.store.getCurrentAuthType()&&(t.data={screen_name:e.uid}),t})}else t=o.fail(!1);return t.addErrback(function(t){var i;return n.warn("TD login of existing account/session failed",t),t.req?m(t)?i=TD.i("Unable to connect. Please check your network."):401==t.req.status&&n.trace("Session expired. Re-displaying login screen."):i=TD.i("Sorry, something went wrong. It's not you, it's us. Please try again later."),l.showLoginScreen(e,i)}),t};var m=function(e){if(!e.req)throw e;return 0===e.req.status||12007===e.req.status},f=function(t){n.trace("init.initFromLogin()");var i=t.account;return e.store.init(t.staySignedIn?"local":"session",i),c.saveSession(),c.onAuthFail(l.abort),i.uid&&e.store.setTweetdeckAccount(i.uid),a.controller.initFromTdLogin(e.store)},g=function(){n.trace("init.purgeDeprecatedAccounts()"),T("buzz"),T("foursquare"),T("facebook"),v(),l.purgedServices.length>0&&TD.controller.stats.purgedServices(l.purgedServices),b(function(e){var t="twitter"===e.getService()&&"sentdirect"===e.getType();return t&&TD.controller.stats.purgedFeed({service:e.getService(),type:e.getType(),message:"Purged sentdirect feed (no longer supported)"}),t}),b(function(t){var i=_.isUndefined(e.accountController.get(t.getAccountKey()));return i&&TD.controller.stats.purgedFeed({service:t.getService(),type:t.getType(),accountKey:t.getAccountKey(),message:"Purged feed due to bad account key"}),i})},v=function(){e.columnController.getAll().forEach(function(e){if(1===e.getFeedKeys().length)switch(e.getType()){case TD.util.columnUtils.storageColumnTypes.HOME:case TD.util.columnUtils.storageColumnTypes.INBOX:case TD.util.columnUtils.storageColumnTypes.ME:e.setType(TD.util.columnUtils.storageColumnTypes.OTHER);break;default:return}})},T=function(t){var i=e.accountController.getAccountsForService(t);_.isEmpty(i)||(l.purgedServices.push(t),_.each(i,function(t){e.accountController.blacklistAccount(t)})),b(function(e){return e.getService()===t})},b=function(t){var i,n,s,r;if(i=_.filter(e.feedController.getAll(),t),n=_.map(i,function(t){var i=t.getKey();return e.feedController.remove(i),i}),s=_.filter(e.columnController.getAll(),function(e){var t=_.difference(e.getFeedKeys(),n);return e.setFeedKeys(t),_.isEmpty(t)}),r=_.map(s,function(e){return e.getKey()}),!_.isEmpty(r)){var a=e.clientController.client;a.setColumnOrder(_.difference(a.getColumnOrder(),r)),_.each(r,function(t){e.columnController.remove(t)})}},w=function(){n.trace("UI.startflow.doLoginSoleUserCheck()");var e=TD.storage.store.getCurrentAuthType(),t=TD.settings.getSoleUserState();if("tweetdeck"===e||!t.initial)return TD.core.defer.succeed();var i,s=new o.Deferred,r=$(document),a=TD.storage.store.getTwitterLoginAccount();return a&&(i=a.getUsername()),r.on("uiLoginConfirmSoleUser",function(e,t){s.callback()}).on("uiLoginDenySoleUser",function(){a&&TD.storage.store.setJSONCritical("previousMultiUserAccount",{timestamp:Date.now(),accountID:a.getUserID()}),s.errback({soleUserDenied:!0})}).trigger("uiLoginShowSoleUserDialog",{username:i}),s.addCallback(y),s.addCallback(function(){r.off("uiLoginConfirmSoleUser uiLoginDenySoleUser")}),s},y=function(){var e=TD.settings.getSoleUserState();e.initial&&(e.shared=!0,TD.settings.setSoleUserState(e))},D=function(){return TD.util.fnPerformanceWrapper(C,null,i.stats.performance.keys.INIT)()},C=function(){return"tweetdeck"===TD.storage.store.getCurrentAuthType()&&TD.decider.hasAccessLevel("migration","FORCED_MIGRATION")?void $(document).trigger("uiMigrateStart"):(n.trace("init.initControllerAndUI()"),$(document).trigger("uiNeedsSettings"),i.clients.init(),i.feedManager.init(),TD.cache.names.init(),TD.decider.get("disable_instagram")&&delete TD.services.TwitterMedia.SERVICES.instagram,TD.util.fnPerformanceWrapper(t.main.init,t.main,i.stats.performance.keys.MAIN)(),TD.util.fnPerformanceWrapper(i.columnManager.init,i.columnManager,i.stats.performance.keys.COLUMN_MANAGER)(),TD.util.fnPerformanceWrapper(i.scheduler.init,i.scheduler,i.stats.performance.keys.COLUMN_SCHEDULER)(),TD.util.fnPerformanceWrapper(i.notifications.init,i.notifications,i.stats.performance.keys.NOTIFICATIONS)(),TD.util.fnPerformanceWrapper(i.filterManager.init,i.filterManager.init,i.stats.performance.keys.FILTER_MANAGER)(),TD.ready=!0,n.trace("init: TD.ready"),$(document).trigger("TD.ready"),d||setTimeout(function(){e.accountController.verifyStoredAccounts(),e.clientController.client.cleanAccountLists()},2e4),void(e.accountController.isEmpty()?($(document).trigger("uiShowAccountSettings"),TD.components.NewFeaturesSplash.updateSeenVersion()):TD.components.NewFeaturesSplash.shouldShow()&&new TD.components.NewFeaturesSplash))};return l.signOut=function(e){TD.storage.Store.flushWebstorage();var t=c.logout(e);return TD.util.isWrapperApp()&&t.addBoth(function(){deck.tearDown()}),t.addBoth(function(){window.location.reload()}),t},l.abort=function(){window.location.reload()},l}(TD.storage,TD.ui,TD.controller,TD.sync.util,TD.util,TD.net.util,TD.sync,TD.core.defer,TD.sync.tdapi),TD.controller.upgrade=function(e,t,i,n){var s={};return s.CURRENT_VERSION=2,s.doUpgrades=function(){var t=null,r=e.clientController.client.get("settings");t=_.isUndefined(r)||_.isUndefined(r.version)?0:Number(r.version);for(var a=function(t,i){return e.clientController.client.dictSet("settings","version",i)},o=n.succeed(),c=1;c<=s.CURRENT_VERSION;c++)if(c>t){var l="version_"+c.toString();s.hasOwnProperty(l)&&(console.log("performing upgrade to v",c,l),o.addCallback(s[l]),o.addCallback(a,c))}return o.addErrback(function(e){throw i.warn("WARNING: controller.upgrade failed!!!"),console.log(e),e}),o},s.version_1=function(){e.columnController.getAll().forEach(function(e){var t,i=TD.storage.feedController.get(e.getFeedKeys()[0]).getType();i===TD.util.columnUtils.feedTypes.MENTIONS&&(t=new TD.vo.SearchFilter(e.getFilters()),t.action.fromJSONObject({showMentions:!0,showRetweets:!1,showFavorites:!1,showFollowers:!1,showLists:!1}),e.setFilters(t.toJSONObject()))})},s.version_2=function(){var t=TD.storage.clientController.client.get("settings").show_inline_media;t===!1&&e.columnController.getAll().forEach(function(e){e.setMediaPreviewSize(TD.vo.Column.MEDIA_PREVIEW_OFF)})},s}(TD.storage,TD.config,TD.sync.util,TD.core.defer),TD.controller.columnManager=function(e,t,i){var n={},s={},r=[];n.TIMELINE="timeline",n.MENTIONS="mentions",n.FOLLOWERS="followers",n.SEARCH="search",n.LISTS="lists",n.CUSTOMTIMELINES="customtimelines",n.MESSAGES="messages",n.TRENDS="trends",n.TWEETS="tweets",n.FAVORITES="favorites",n.HOME="home",n.ME="me",n.INBOX="privateMe",n.SCHEDULED="scheduled",n.NETWORKACTIVITY="networkactivity",n.INTERACTIONS="interactions",n.DATAMINR="dataminr",n.columnTypeToIconClass={},TD.util.extendObjectWith(n.columnTypeToIconClass,[[n.TIMELINE,TD.util.columnUtils.columnIconClasses.HOME],[n.INTERACTIONS,TD.util.columnUtils.columnIconClasses.INTERACTIONS],[n.MENTIONS,TD.util.columnUtils.columnIconClasses.MENTIONS],[n.FOLLOWERS,TD.util.columnUtils.columnIconClasses.FOLLOWERS],[n.SEARCH,TD.util.columnUtils.columnIconClasses.SEARCH],[n.LISTS,TD.util.columnUtils.columnIconClasses.LIST],[n.CUSTOMTIMELINES,TD.util.columnUtils.columnIconClasses.CUSTOMTIMELINE],[n.MESSAGES,TD.util.columnUtils.columnIconClasses.MESSAGES],[n.TWEETS,TD.util.columnUtils.columnIconClasses.USER],[n.FAVORITES,TD.util.columnUtils.columnIconClasses.FAVORITES],[n.NETWORKACTIVITY,TD.util.columnUtils.columnIconClasses.ACTIVITY],[n.HOME,TD.util.columnUtils.columnIconClasses.HOME],[n.ME,TD.util.columnUtils.columnIconClasses.MENTIONS],[n.INBOX,TD.util.columnUtils.columnIconClasses.MESSAGES],[n.SCHEDULED,TD.util.columnUtils.columnIconClasses.SCHEDULED],[n.TRENDS,TD.util.columnUtils.columnIconClasses.TRENDS],[n.DATAMINR,TD.util.columnUtils.columnIconClasses.DATAMINR]]),n.SELF_ACCOUNTS_ONLY={},n.SELF_ACCOUNTS_ONLY[n.MESSAGES]=!0,n.SELF_ACCOUNTS_ONLY[n.NETWORKACTIVITY]=!0,n.SELF_ACCOUNTS_ONLY[n.INTERACTIONS]=!0,n.SELF_ACCOUNTS_ONLY[n.FOLLOWERS]=!0,n.TWITTER_GENERIC={},n.TWITTER_GENERIC[n.TIMELINE]=!0,n.TWITTER_GENERIC[n.MENTIONS]=!0,n.TWITTER_GENERIC[n.FOLLOWERS]=!0,n.TWITTER_GENERIC[n.MESSAGES]=!0,n.TWITTER_GENERIC[n.TWEETS]=!0,n.TWITTER_GENERIC[n.FAVORITES]=!0,n.TWITTER_GENERIC[n.NETWORKACTIVITY]=!0,n.TWITTER_GENERIC[n.INTERACTIONS]=!0,n.SELF_FEED_TYPE={},n.SELF_FEED_TYPE[n.TIMELINE]="home",n.SELF_FEED_TYPE[n.MESSAGES]="direct",n.SELF_FEED_TYPE[n.TWEETS]="usertweets",n.SELF_FEED_TYPE[n.FOLLOWERS]="interactions",n.NON_SELF_FEED_TYPE={},n.NON_SELF_FEED_TYPE[n.TIMELINE]="usertimeline",n.NON_SELF_FEED_TYPE[n.TWEETS]="usertweets",n.NON_SELF_FEED_TYPE[n.MENTIONS]="search",n.MENU_TITLE={},n.MENU_TITLE[n.TIMELINE]=TD.i("Home"),n.MENU_TITLE[n.MENTIONS]=TD.i("Mentions"),n.MENU_TITLE[n.SEARCH]=TD.i("Search"),n.MENU_TITLE[n.FOLLOWERS]=TD.i("Followers"),n.MENU_TITLE[n.LISTS]=TD.i("Lists"),n.MENU_TITLE[n.CUSTOMTIMELINES]=TD.i("Collections"),n.MENU_TITLE[n.MESSAGES]=TD.i("Messages"),n.MENU_TITLE[n.TRENDS]=TD.i("Trending"),n.MENU_TITLE[n.TWEETS]=TD.i("User"),n.MENU_TITLE[n.FAVORITES]=TD.i("Favorites"),n.MENU_TITLE[n.ME]=TD.i("Mentions"),n.MENU_TITLE[n.INBOX]=TD.i("Messages"),n.MENU_TITLE[n.SCHEDULED]=TD.i("Scheduled"),n.MENU_TITLE[n.NETWORKACTIVITY]=TD.i("Activity"),n.MENU_TITLE[n.INTERACTIONS]=TD.i("Notifications"),n.MENU_TITLE[n.DATAMINR]=TD.i("Dataminr"),n.MENU_ATTRIBUTION={},n.MENU_ATTRIBUTION[n.ME]=TD.i("(all accounts)"),n.MENU_ATTRIBUTION[n.INBOX]=TD.i("(all accounts)"),n.DISPLAY_ORDER=[{type:n.TIMELINE,service:"twitter"},{type:n.SEARCH,service:"twitter"},{type:n.INTERACTIONS,service:"twitter"},{type:n.FOLLOWERS,service:"twitter"},{type:n.MENTIONS,service:"twitter"},{type:n.MESSAGES,service:"twitter"},{type:n.ME},{type:n.INBOX},{type:n.NETWORKACTIVITY,service:"twitter"},{type:n.TWEETS,service:"twitter"},{type:n.FAVORITES,service:"twitter"},{type:n.TRENDS,service:"twitter"},{type:n.LISTS,service:"twitter"},{type:n.CUSTOMTIMELINES,service:"twitter","class":"feature-customtimelines"},{type:n.SCHEDULED},{type:n.DATAMINR,service:"dataminr"}],n.DISPLAY_ORDER_SINGLETONS=[{type:n.ME},{type:n.INBOX},{type:n.SCHEDULED}],n.DISPLAY_ORDER_PROFILE=[{type:n.TWEETS,service:"twitter",profile:!0},{type:n.MENTIONS,service:"twitter",profile:!0},{type:n.LISTS,service:"twitter",profile:!0},{type:n.CUSTOMTIMELINES,service:"twitter",profile:!0,"class":"feature-customtimelines"},{type:n.TIMELINE,service:"twitter",profile:!0},{type:n.FAVORITES,service:"twitter",profile:!0}];var a=n.DISPLAY_ORDER.concat(n.DISPLAY_ORDER_SINGLETONS).concat(n.DISPLAY_ORDER_PROFILE);_.each(a,function(e){e.title=e.title||n.MENU_TITLE[e.type],e.attribution=e.attribution||n.MENU_ATTRIBUTION[e.type],e.columnIconClass=e.columnIconClass||n.columnTypeToIconClass[e.type]}),n.HELP_TEXT={},n.HELP_TEXT[n.TIMELINE]=TD.i("Add a Timeline column for your own accounts, or search for a user and add theirs"),n.HELP_TEXT[n.MENTIONS]=TD.i("Add a Mentions column for your own accounts, or search for a user and add theirs"),n.HELP_TEXT[n.SEARCH]=TD.i("Add a column for a saved or recent Search, or enter a new search in the box"),n.HELP_TEXT[n.LISTS]=TD.i("Create a new list, or select an existing list to edit or add a column"),n.HELP_TEXT[n.CUSTOMTIMELINES]=TD.i("Create a new collection, or select an existing timeline"),n.HELP_TEXT[n.MESSAGES]=TD.i("Add a Direct Messages column for your accounts"),n.HELP_TEXT[n.TRENDS]=TD.i("Add a column to monitor Tweets for any Trend"),n.HELP_TEXT[n.TWEETS]=TD.i("Add a column for Tweets sent from your own accounts, or search for a user and add theirs"),n.HELP_TEXT[n.FAVORITES]=TD.i("Add a Favorites column for your own accounts, or search for a user and add theirs"),n.HELP_TEXT[n.INTERACTIONS]=TD.i("Add a column to monitor your mentions, retweets, favourites, follows and list additions in real time"),n.HELP_TEXT[n.NETWORKACTIVITY]=TD.i("Add a column to view favourites, follows and list additions by your friends in real time"),n.HELP_TEXT[n.DATAMINR]=TD.i("Add a column to view alerts for a Dataminr watchlist"),n.STREAMING_FULL="streaming_full",n.STREAMING_NONE="streaming_none",n.STREAMING_PARTIAL="streaming_partial",n.init=function(){o(),n.checkColumns(),$.subscribe("/storage/client/column_order_changed",o),$.subscribe("/storage/client/change",o),$.subscribe("/storage/column/feeds_changed",function(e,t,i){var s=n.get(i.getKey());s&&s.loadFeeds()}),$.subscribe("/storage/column/change",function(e){var i=n.get(e.getKey());if(i){var s=i.model.getFeedKeys(),r=e.getFeedKeys();if(_.isEqual(s,r)||i.loadFeeds(),e.managed&&e.hasApiid()){var i=n.getByApiid(e.getApiid());TD.ui.columns.refreshTitle(i)}i.loadFilters()}else t.stateLog("loading new new column",e),o()}),$.subscribe("/cache/names/change",function(){_.each(n.getAll(),function(e){TD.ui.columns.refreshTitle(e)})}),$.subscribe("/storage/account/new",function(e){1===TD.storage.accountController.getAll().length&&n.checkColumns()}),$(document).on("uiNeedsScheduledColumnVisible",this.handleMakeOrRefreshScheduledColumn),$(document).on("uiNeedsColumnOrder",n.handleUiNeedsColumnOrder),$(document).on("uiNeedsColumns",n.handleUiNeedsColumns)},n.handleUiNeedsColumns=function(){n.sendColumns()},n.handleUiNeedsColumnOrder=function(){n.sendColumnOrder()},n.sendColumnOrder=function(){$(document).trigger("dataColumnOrder",{columnOrder:r})},n.sendColumns=function(){$(document).trigger("dataColumns",{columns:n.getAllOrdered()})},n.checkColumns=function(){var t=TD.storage.accountController.getPreferredAccount("twitter");0===e.clientController.client.getColumnOrder().length&&t&&n.makeDefaultColumns(t)},n.get=function(e){return s[e]},n.getByApiid=function(e){return _.find(s,function(t){return t.model.hasApiid()&&t.model.getApiid()===e?t:null})},n.getAll=function(){return _.clone(s)},n.getAllOrdered=function(){for(var e=this.getAll(),t=[],i=0;i<r.length;i++)t.push(e[r[i]]);return t},n.add=function(e){s[e.model.getKey()]=e},n.deleteColumn=function(t){var i=s[t];i&&!i.temporary&&TD.controller.stats.removeColumn(i.getColumnType());e.clientController.client.removeColumn(t)},n.removeFromAppLayer=function(t){var i=s[t];i&&i.removeSubscriptions(),delete s[t],e.columnController.remove(t),TD.controller.feedScheduler.removeColumn(t),TD.ui.columns.removeColumn(t)},n.move=function(e,t){var i,s,a=r.indexOf(e),c=r.concat();if("right"===t)s=Math.min(a+1,r.length-1);else{if("left"!==t)return;s=Math.max(a-1,0)}i=r[s],c[s]=c[a],c[a]=i,TD.storage.clientController.client.setColumnOrder(c),o(),n.showColumn(e)};var o=function(){var t=e.clientController.client.getColumnOrder(),i=!_.isEqual(r,t);i&&c(t),$(document).trigger("dataColumnsLoaded")},c=function(i){var s=_.difference(r,i),a=_.difference(i,r),o=[];_.each(s,function(e){n.removeFromAppLayer(e),TD.ui.columns.removeColumn(e)}),_.each(a,function(s){var r,a=n.get(s);if(!a){if(r=e.columnController.get(s),!r)return void t.stateLog("WARNING: column not found for",s,"all columns:",e.columnController.getAll(),"in column_order",i);a=new TD.vo.Column(r),n.add(a)}o.push(a)}),TD.ui.columns.addColumnsToView(o),r=i,n.sendColumnOrder(),n.sendColumns(),_.each(a,function(e){var t=n.get(e);TD.controller.feedScheduler.addColumn(t,!0)})};return n.addColumnToUI=function(t){var i,s=t.model.getKey();return t.reset(),n.add(t),e.feedController.manageFeeds(t.getFeeds()),e.columnController.manage(t.model),i=e.clientController.client.appendColumn(s),o(),_.defer(n.showColumn,s),TD.controller.stats.addColumn(t.getColumnType()),i},n.makeColumnFor=function(t){var i,s,r=t.metadata||{},a=t.searchFilter,o=e.accountController.getAccountsForService("twitter");if("tweetdeck"===t.service)switch(t.type){case"me":s=e.columnController.getMeFeeds(o),i=n.makeColumn("me",s);break;case"privateMe":s=e.columnController.getInboxFeeds(o),i=n.makeColumn("privateMe",s);break;case"scheduled":s=e.columnController.getScheduledFeeds(),i=n.makeColumn("scheduled",s)}else{switch(t.type){case"usertimeline":case"favorites":case"usertweets":t.metaString&&(r.id=parseInt(t.metaString,10));break;case"search":a=new TD.vo.SearchFilter,r.searchFilterData=a.toJSONObject(),r.baseQuery=t.metaString;break;case"list":var c=t.metaString.split("/");TD.sync.util.assert(2===c.length,"List meta should contain both ownerId and listId",c),r.ownerId=c[0],r.listId=c[1];break;case"customtimeline":var c=t.metaString.split("/");TD.sync.util.assert(2===c.length,"Collection meta should contain both ownerId and id",c),r.ownerId=c[0],r.id=c[1]}i||(i=n.makeOtherColumnAndFeeds({type:t.type,service:t.service,accountKey:t.accountKey,metadata:r,searchFilter:a}))}return i},n.makeDefaultColumns=function(e){var t=[];"twitter"===e.getType()&&(t=["home","interactions","direct","networkactivity"]),_.each(t,function(t){var i=n.makeColumnFor({type:t,service:e.getType(),accountKey:e.getKey()});n.addColumnToUI(i)})},n.makeColumn=function(t,i,n){var s={type:t,feedkeys:[],settings:{}};n&&(s.filters=n);var r=new TD.vo.Column(new e.Column(s),i);return r},n.makeOtherColumnAndFeeds=function(t){var i=e.feedController,s=[];return s.push(i.getOrCreateFeed(t.type,t.service,t.accountKey,t.metadata)),n.makeColumn("other",s,t.searchFilter)},n.handleMakeOrRefreshScheduledColumn=function(e,t){t=t||{};var i=TD.storage.columnController.getColumnsByType("scheduled");if(!i.length&&!TD.settings.getScheduledColAdded()&&t.allowAdd){var s=n.makeColumnFor({type:"scheduled",service:"tweetdeck"});return n.addColumnToUI(s),void TD.settings.setScheduledColAdded(!0)}i.forEach(function(e){try{TD.controller.feedScheduler.refreshColumn(e.getKey())}catch(t){console.error("Refreshing scheduled column failed")}})},n.showColumn=function(e){$(document).trigger("uiColumnFocus",{columnKey:e})},n.isStreaming=function(e){var t=n.getStreamingState(e);return t!==n.STREAMING_NONE},n.getStreamingState=function(e){var t,i=n.STREAMING_NONE,s=n.get(e),r=0;return s&&(t=s.model.getFeedKeys(),_.each(t,function(e){TD.controller.feedManager.isStreaming(e)&&r++}),i=0===r?n.STREAMING_NONE:r===t.length?n.STREAMING_FULL:n.STREAMING_PARTIAL),i},n.getColumnsByAccountKey=function(e){return _.values(s).filter(function(t){return t.getFeeds().some(function(t){return t.getAccountKey()===e})})},n.findChirpByAccountKey=function(e,t){for(var i,s=n.getColumnsByAccountKey(t),r=0;r<s.length&&!(i=s[r].findChirp(e));r+=1);return i},n}(TD.storage,TD.sync.util,TD.core.defer),TD.controller.auth=function(){var e={},t={twitter:"TwitterAuth",bitly:"BitlyValidate"};return e.create=function(e,i){return TD.sync.util.assert(t[e],'bad name for auth "'+e+'"'),new TD.controller.auth[t[e]](i)},e}(),TD.controller.auth.AuthorisationProcessor=function(){this.start=function(e,t,i){TD.util.isChromeApp()?this.start_chrome(e,t,i):TD.util.isWrapperApp()?this.start_wrapper(e,t,i):this.start_web(e,t,i)},this.start_wrapper=function(e,t,i){var n=deck.authenticateOn(this.getAuthURL(e,i)),s=this,r=function(i){var r=s.getTokenFromURL(e.getType(),i);r&&(r.access_token?s.updateAccount(r.access_token,t):s.updateAccount(r.oauth_token,r.oauth_token_secret,t),n.hide(),n.deleteLater())};n.loadedUrl.connect(r),n.show()},this.start_web=function(e,t,i){var n=window.open(this.getAuthURL(e,i),"mywindow","width=800,height=450"),s=this,r=function(){var i,a;try{n&&n.location&&n.location.href&&(i=n.location.href)}catch(o){}return i&&(a=s.getTokenFromURL(e.getType(),i))?(a.access_token?s.updateAccount(a.access_token,t):s.updateAccount(a.oauth_token,a.oauth_token_secret,t),void n.close()):void setTimeout(r,250);

};setTimeout(r,500)},this.getAuthURL=function(e,t){var i="oauth",n=e.getType(),s={};if("twitter"===n){var r=Boolean(t),a=e.getUsername();r&&(s.force_login=r),a&&(s.screen_name=a)}return TD.net.util.addURLParameters(TD.config.api_root+"/"+i+"/authorize/"+n,s)},this.getTokenFromURL=function(e,t){var i,n;return(_.contains(t,"/oauth/success/"+e)||_.contains(t,"/oauth2/success/"+e))&&(n=t.split("?")[1],i=TD.net.util.formDecode(n)),i},this.start_chrome=function(e,t,i){var n,s,r=this;chrome.tabs.getSelected(null,function(e){n=e.id}),s={url:this.getAuthURL(e,i)},chrome.tabs.create(s,function(i){var s=i.id;chrome.tabs.onUpdated.addListener(function(i,a,o){var c;i===s&&o.url&&"complete"==o.status&&(c=r.getTokenFromURL(e.getType(),o.url),c&&(c.access_token?r.updateAccount(c.access_token,t):r.updateAccount(c.oauth_token,c.oauth_token_secret,t),chrome.tabs.update(n,{selected:!0}),chrome.tabs.remove(i)))})})}},TD.controller.auth.TwitterAuth=function(e){var t=this;t.account=e,this.verifyAccount=function(e,i){$(document).trigger("metric",{key:"auth:twitter:verify:start"});var n=t.account,s=TD.config.twitter_api_base+"/"+TD.config.twitter_api_version,r=s+"/account/verify_credentials.json",a=TD.net.ajax.request(r,{account:n,isSigned:!0});a.addCallback(function(t){var s=t.data,r=n.getUserID();r&&r!=s.id?(console.log("Attempting to update wrong account:",n,"Using data:",s),$(document).trigger("metric",{key:"auth:twitter:verify:wrong_account"}),TD.sync.util.printStacktrace(),TD.controller.progressIndicator.addMessage("Failed to add account. Please try again later."),i()):($(document).trigger("metric",{key:"auth:twitter:verify:success"}),n.setUsername(s.screen_name),n.setName(s.name),n.setProfileImageURL(s.profile_image_url_https),n.setUserID(s.id_str),n.setIsPrivate(s["protected"]),n.setUpdated((new Date).getTime()),n.computeKey(),e(n))}),a.addErrback(function(e){return $(document).trigger("metric",{key:"auth:twitter:verify:fail"}),TD.controller.progressIndicator.addMessage("Failed to verify account. Please try again later."),e}),i&&a.addErrback(i)},this.updateAccount=function(e,i,n){var s=t.account;s.setUsername(""),s.setUserID(""),s.setType("twitter"),s.setOAuthToken(e),s.setTokenSecret(i),this.verifyAccount(n)}},TD.controller.auth.BitlyValidate=function(e){var t=this;t.account=e,this.updateAccount=function(e,t){this.verifyAccount(t)},this.verifyAccount=function(e,i){var n=t.account,s="https://api-ssl.bitly.com/v3/validate",r={x_login:n.get("userId"),x_apiKey:n.get("oauth_token"),apiKey:"R_b8032856b71a14fabfe64f6845689ddf",login:"tweetdeckapi",format:"json"},a=TD.net.ajax.jsonp(s,r);a.addCallback(function(t){var s=t.data;return s.data&&1==s.data.valid?(n.setUpdated((new Date).getTime()),n.computeKey(),void e(n)):void i()}),a.addErrback(i)}},TD.controller.auth.TwitterAuth.prototype=new TD.controller.auth.AuthorisationProcessor,TD.services.ChirpBase=function(e){this.account=e},TD.services.ChirpBase.kMEDIA_CLASS="s-media",TD.services.ChirpBase.RETWEET_CLASS="is-retweet",TD.services.ChirpBase.FAVORITE_CLASS="is-favorite",TD.services.ChirpBase.UNREAD_CLASS="is-unread",TD.services.ChirpBase.TWEET="tweet",TD.services.ChirpBase.CONVERSATION_JOIN="conversation_participants_join",TD.services.ChirpBase.CONVERSATION_PARTICIPANTS_JOIN="conversation_participants_join",TD.services.ChirpBase.CONVERSATION_PARTICIPANTS_FAILED="conversation_participants_failed",TD.services.ChirpBase.CONVERSATION_NAME_UPDATE="conversation_name_update",TD.services.ChirpBase.MESSAGE="message",TD.services.ChirpBase.MESSAGE_THREAD="message_thread",TD.services.ChirpBase.SCHEDULED_STATUS="scheduled_status",TD.services.ChirpBase.SCHEDULED_GROUP="scheduled_group",TD.services.ChirpBase.SCHEDULED_TWEET="scheduled_tweet",TD.services.ChirpBase.SCHEDULED_TWEET_GROUP="scheduled_tweet_group",TD.services.ChirpBase.DATAMINR_ALERT="dataminr_alert",TD.services.ChirpBase.prototype.id="",TD.services.ChirpBase.prototype.chirpType="unknown",TD.services.ChirpBase.prototype.text="",TD.services.ChirpBase.prototype.created=null,TD.services.ChirpBase.prototype.htmlText="",TD.services.ChirpBase.prototype.creatorAccount=null,TD.services.ChirpBase.prototype.embeds=null,TD.services.ChirpBase.prototype.cursor=null,TD.services.ChirpBase.prototype.sortIndex=null,TD.services.ChirpBase.prototype._hasImage=null,TD.services.ChirpBase.prototype._hasVideo=null,TD.services.ChirpBase.prototype._hasAnimatedGif=null,TD.services.ChirpBase.prototype._hasVine=null,TD.services.ChirpBase.prototype._hasLink=null,TD.services.ChirpBase.prototype.fromJSONObject=function(){throw"fromJSONObject Not Implemented"},TD.services.ChirpBase.prototype.isOwnChirp=function(){throw"isOwnChirp Not Implemented"},TD.services.ChirpBase.prototype.destroy=function(){throw"destroy Not Implemented"},TD.services.ChirpBase.prototype.render=function(){throw"render Not Implemented"},TD.services.ChirpBase.prototype.renderNotification=function(){return null},TD.services.ChirpBase.prototype.getGrowlData=function(){return null},TD.services.ChirpBase.prototype.email=function(){throw"email Not Implemented"},TD.services.ChirpBase.prototype.postComment=function(){throw"postComment Not Implemented"},TD.services.ChirpBase.prototype.getChirpURL=function(){throw"getChirpURL Not Implemented"},TD.services.ChirpBase.prototype.isTranslatable=function(){return!1},TD.services.ChirpBase.prototype.translate=function(){throw"translate Not Implemented"},TD.services.ChirpBase.prototype.getChirpType=function(){return this.chirpType},TD.services.ChirpBase.prototype.getScribeItemData=function(){throw"getScribeItemData not implemented"},TD.services.ChirpBase.prototype._changed=function(){TD.controller.notifications.reRender(this)},TD.services.ChirpBase.prototype.getDOMChirps=function(){var e="[data-key$='"+this.id+"'][data-account-key='"+this.account.getKey()+"']";return $(e)},TD.services.ChirpBase.prototype.update=function(e){return!1},TD.services.ChirpBase.prototype.passFilters=function(e){return TD.controller.filterManager.pass(this,e)},TD.services.ChirpBase.prototype._generateHTMLText=function(){this.htmlText=TD.util.transform(this.text)},TD.services.ChirpBase.prototype.createdPretty=function(){return TD.util.prettyDate(this.created)},TD.services.ChirpBase.prototype.createdPrettyFull=function(){return TD.util.prettyTimeString(this.created)},TD.services.ChirpBase.prototype.createdPrettyTimeOrDate=function(){return TD.util.prettyTimeOrDateString(this.created)},TD.services.ChirpBase.prototype.getSinceId=function(){return this.id},TD.services.ChirpBase.prototype.getUnreadChirps=function(e){var t=!e||this.belongsAbove(e);return!this.isOwnChirp()&&t?[this]:[]},TD.services.ChirpBase.prototype.getSortIndex=function(){return this.sortIndex||(this.sortIndex={value:this.created.getTime(),type:"milliseconds"}),this.sortIndex},TD.services.ChirpBase.prototype.belongsAbove=function(e){return TD.util.chirpColumnSort(this,e)<0},TD.services.ChirpBase.prototype.belongsBelow=function(e){return TD.util.chirpColumnSort(this,e)>0},TD.services.ChirpBase.prototype.getFilterableText=function(){return this.text},TD.services.ChirpBase.prototype.getSenders=function(){return null},TD.services.ChirpBase.prototype.getSource=function(){return null},TD.services.ChirpBase.prototype.isRetweetedStatus=function(){return null},TD.services.ChirpBase.prototype.getRelatedTweet=function(){return null},TD.services.ChirpBase.prototype.getMedia=function(){return this._media?this._media:[]},TD.services.ChirpBase.prototype.getFirstMedia=function(){return this._media&&this._media[0]},TD.services.ChirpBase.prototype.getCardsForGallery=function(){return[]},TD.services.ChirpBase.prototype.hasMedia=function(){return this.getMedia().length>0},TD.services.ChirpBase.prototype.isMediaGridContent=function(){return TD.decider.get("multi_photo_media_grid")&&1<this.getMedia().length},TD.services.ChirpBase.prototype.mediaLength=function(){return this.getMedia().length},TD.services.ChirpBase.prototype.hasImage=function(){return null===this._hasImage&&(this._hasImage=this.getMedia().some(function(e){return!e.isVideo})),this._hasImage},TD.services.ChirpBase.prototype.hasVideo=function(){return null===this._hasVideo&&(this._hasVideo=this.getMedia().some(function(e){return e.isVideo})),this._hasVideo},TD.services.ChirpBase.prototype.hasVine=function(){return null===this._hasVine&&(this._hasVine=this.getMedia().some(function(e){return e.isVine})),this._hasVine},TD.services.ChirpBase.prototype.hasAnimatedGif=function(){return null===this._hasAnimatedGif&&(this._hasAnimatedGif=this.getMedia().some(function(e){return e.isAnimatedGif})),this._hasAnimatedGif},TD.services.ChirpBase.prototype.hasLink=function(){return null===this._hasLink&&(this._hasLink=twttr.txt.extractUrls(this.text).length>0),this._hasLink},TD.services.ChirpBase.prototype.isFromVerifiedUser=function(){return!1},TD.services.ChirpBase.msFudge=0,TD.services.ChirpBase.prototype.fudgeCreatedTime=function(e){var t=TD.services.ChirpBase.msFudge;e.setMilliseconds(t),t++,t%=1e3,TD.services.ChirpBase.msFudge=t},TD.services.ChirpBase.prototype.scribeMediaImpression=function(){},TD.services.Cursor=function(e){this.lowerBound=e.lowerBound,this.upperBound=e.upperBound,this.id=_.uniqueId("cursor")},TD.services.Cursor.prototype=new TD.services.ChirpBase,TD.services.Cursor.prototype.chirpType=TD.services.ChirpBase.CURSOR,TD.services.Cursor.prototype.render=function(){return TD.ui.template.render("cursor",{})},TD.services.Cursor.prototype.passFilters=function(){return!0},TD.services.Cursor.prototype.isOwnChirp=function(){return!1},TD.services.TwitterStatus=function(e){this.account=e},TD.services.TwitterStatus.prototype=new TD.services.ChirpBase,TD.services.TwitterStatus.prototype.chirpType=TD.services.ChirpBase.TWEET,TD.services.TwitterStatus.prototype.user=null,TD.services.TwitterStatus.prototype.inReplyToID="",TD.services.TwitterStatus.prototype.inReplyToUserID="",TD.services.TwitterStatus.prototype.inReplyToScreenName="",TD.services.TwitterStatus.prototype.isFavorite=!1,TD.services.TwitterStatus.prototype.isRetweeted=!1,TD.services.TwitterStatus.prototype.retweetCount=0,TD.services.TwitterStatus.prototype.retweetedStatus=null,TD.services.TwitterStatus.prototype.quotedTweet=null,TD.services.TwitterStatus.prototype.entities=null,TD.services.TwitterStatus.prototype.quotedEntities=null,TD.services.TwitterStatus.prototype.source="",TD.services.TwitterStatus.prototype.sourceNoHTML="",TD.services.TwitterStatus.prototype.cards=null,TD.services.TwitterStatus.prototype._media=null,TD.services.TwitterStatus.prototype._quotedMedia=null,TD.services.TwitterStatus.prototype._filterableText=null,TD.services.TwitterStatus.prototype.fromJSONObject=function(e){var t,i,n=this,s=!1;this.id=e.id_str||e.id,e.user&&(this.user=new TD.services.TwitterUser(this.account).fromJSONObject(e.user),this.creatorAccount=TD.storage.accountController.get(TD.storage.Account.generateKeyFor("twitter",this.user.id))),e.source&&(i=$("<div>"+e.source+"</div>"),i.find("a").attr("rel","url").attr("target","_blank"),this.source=i.html(),this.sourceNoHTML=i.text()),this.inReplyToUserID=e.in_reply_to_user_id,this.inReplyToScreenName=e.in_reply_to_screen_name,this.isFavorite=e.favorited,this.isRetweeted=e.retweeted,this.retweetCount=e.retweet_count,this.currentUserRetweet=e.current_user_retweet,this.possiblySensitive=e.possibly_sensitive,this.inReplyToID=e.in_reply_to_status_id_str||e.in_reply_to_status_id,e.retweeted_status?(this.text=e.retweeted_status.text,this.retweetedStatus=new TD.services.TwitterStatus(this.account).fromJSONObject(e.retweeted_status),this.entities=this.retweetedStatus.entities):(this.text=e.text,this.entities=this._extractEntities(e)),e.quoted_status&&TD.decider.get("quote_tweet_read")&&(this.quotedTweet=new TD.services.TwitterStatus(this.account).fromJSONObject(e.quoted_status),this.quotedEntities=this._extractEntities(e.quoted_status)),this.entities=this.entities||{},this._media=TD.services.TwitterMedia.getMediaFromEntities(this.entities),!this._media.length&&this.quotedTweet&&(this._quotedMedia=TD.services.TwitterMedia.getMediaFromEntities(this.quotedEntities||[]));var r=this.getMedia().reduce(function(e,t){return e[t.url]=(e[t.url]||0)+1,e},{});return e.cards&&(this.cards={},_.each(TD.services.TwitterCard.SUPPORTED_CARD_TYPES,function(i){if(e.cards[i])for(n.cards[i]=[],t=0;t<e.cards[i].length;t++){var a=e.cards[i][t];r[a.url]&&r[a.url]>1||(n.cards[i].push(new TD.services.TwitterCard(n.account).fromJSONObject(a)),s=!0)}}),s||(this.cards=null)),this.lang=e.lang,this.place=e.place||{},this.created=TD.util.parseDateString(e.created_at),this._generateHTMLText(),this},TD.services.TwitterStatus.prototype._generateHTMLText=function(){this.htmlText=TD.util.transform(this.text,this.entities)},TD.services.TwitterStatus.prototype._extractEntities=function(e){var t=e.entities;return e.extended_entities&&e.extended_entities.media&&e.extended_entities.media.length&&(t=t||{},t.media=e.extended_entities.media),t},TD.services.TwitterStatus.prototype.getMainUser=function(){return this.retweetedStatus?this.retweetedStatus.user:this.user},TD.services.TwitterStatus.prototype.getCreator=function(){return this.user},TD.services.TwitterStatus.prototype.getRelatedTweet=function(){return this},TD.services.TwitterStatus.prototype.getMainTweet=function(){return this.retweetedStatus?this.retweetedStatus:this},TD.services.TwitterStatus.prototype.hasLocationData=function(){var e=this.getMainTweet();return!(!e.place.full_name&&!e.place.country)},TD.services.TwitterStatus.prototype.getLocationName=function(){var e=this.getMainTweet();return e.place.name},TD.services.TwitterStatus.prototype.getLocationFullName=function(){var e=this.getMainTweet();return e.place.full_name&&e.place.country?[e.place.full_name,e.place.country].join(", "):e.place.country?e.place.country:""},TD.services.TwitterStatus.prototype.getLocationURL=function(){var e,t=this.getMainTweet();switch(t.place.place_type){case"admin":e=10;break;case"city":e=12;break;case"country":e=6;break;case"neighbourhood":e=13;break;case"poi":case"default":e=15}return"https://maps.google.com/maps?q="+encodeURIComponent(this.getLocationFullName())+"&z="+e},TD.services.TwitterStatus.prototype.getLocationSearchEncodedURL=function(){return"https://twitter.com/search?q="+encodeURIComponent('near:"'+this.getLocationFullName()+'"')},TD.services.TwitterStatus.prototype.isOwnChirp=function(){return Boolean(this.creatorAccount)},TD.services.TwitterStatus.prototype.isRetweetedStatus=function(){return Boolean(this.retweetedStatus)},TD.services.TwitterStatus.prototype.isTranslatable=function(){var e=this.getMainTweet();return TD.decider.get("machine_translated_tweets")&&e.lang&&e.lang!==TD.languages.getSystemLanguageCode(!0)&&TD.languages.isSupportedTranslationSourceLanguage(e.lang)&&TD.languages.isSystemLangSupportedDestinationLanguage()&&!e.isOwnChirp()&&!e.user.isProtected&&!e.getTranslation()},TD.services.TwitterStatus.prototype.translate=function(){var e=TD.controller.clients.getClient(this.account.getKey()),t=this.getMainTweet().lang,i=TD.languages.getSupportedDestinationSystemLanguage(),n=function(e){var t,n,s,r=this.getDOMChirps().add(this.getMainTweet().getDOMChirps()),a=r.find(".js-translate-call-to-action");r=r.filter(function(e){return 0===$(".js-tweet-translation",this).length}),this.lang=e.translated_lang||this.lang,a.remove(),e.translated_lang!==i&&(e.htmltext=TD.util.transform(e.text,e.entities),e.localizedLanguageName=this.getLocalizedLanguageName(),t=r.find(".js-tweet-text"),t.after(TD.ui.template.render("status/tweet_translation",e)),n=r.find(".js-tweet-translation"),s=n.find(".js-tweet-translation-text"),t.addClass("tweet-translation-original-text margin-bn"),s.html(e.htmltext),this.setTranslation(e))}.bind(this),s=function(e){TD.controller.progressIndicator.addMessage(TD.i("Translation failed"))}.bind(this);e.translateTweet(this.getMainTweet().id,i,n,s),TD.controller.stats.translate(this.getMainUser().id,this.id,this.account.getUserID(),i,t)},TD.services.TwitterStatus.prototype.setTranslation=function(e){this.getMainTweet().translation=e},TD.services.TwitterStatus.prototype.getTranslation=function(){return this.getMainTweet().translation},TD.services.TwitterStatus.prototype.getChirpURL=function(){var e=this.getMainTweet();return"https://twitter.com/"+e.user.screenName+"/status/"+e.id},TD.services.TwitterStatus.prototype.getLocalizedLanguageName=function(){var e=TD.languages.getLanguageFromISOCode(this.getMainTweet().lang);return e?e.localized_name:""},TD.services.TwitterStatus.prototype.destroy=function(){return this.isOwnChirp()?void this._action("delete",function(e){TD.controller.feedManager.deleteChirp(e.id)}):void TD.controller.progressIndicator.addMessage(TD.i("You don't own this account - can't delete"))},TD.services.TwitterStatus.prototype.getQuoteText=function(){var e={username:this.user.screenName,text:TD.util.removeHTMLCodes(this.text)};return TD.ui.template.toHtml("RT @{{username}}: {{{text}}}",e)},TD.services.TwitterStatus.prototype.renderMinimalist=function(e){return e.isMinimalist=!0,this.render(e)},TD.services.TwitterStatus.prototype.render=function(e){e=e||{};var t=TD.settings.getDisplaySensitiveMedia(),i={tweet:this,withMediaPreview:e.mediaPreviewSize!==TD.vo.Column.MEDIA_PREVIEW_OFF,isMediaPreviewSmall:e.mediaPreviewSize===TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL,isMediaPreviewLarge:e.mediaPreviewSize===TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE,mediaPreviewSrc:function(){return this.getMediaSrcForPreviewSize(e.mediaPreviewSize)},renderQuoted:function(){return this.renderQuotedTweet(e)},animatedGif:function(){return this.getAnimatedGifForPreview()},thumbSizeClass:TD.services.TwitterMedia.thumbSizeClasses[e.mediaPreviewSize],isPossiblySensitive:this.possiblySensitive&&!t,isMinimalist:Boolean(e.isMinimalist),withDragHandle:!1,withRemove:!1,withTweetActions:!0,withFooter:!0,withAvatar:!0,withLinebreaks:!0},n=$.extend({},i,e);return TD.ui.template.render("status/tweet_in_stream",n)},TD.services.TwitterStatus.prototype.renderInMediaGallery=function(){return TD.ui.template.render("status/tweet_in_box",{tweet:this,withTweetActions:!0,withTweetActionsVisible:!0,withFooter:!0,withAvatar:!0,actionsMenuPosition:"pos-l pos-t"})},TD.services.TwitterStatus.prototype.renderNotification=function(){return TD.ui.template.render("status/tweet_in_box",{tweet:this,withAvatar:!0})},TD.services.TwitterStatus.prototype.renderQuotedTweet=function(e){e=e||{},e.mediaPreviewSize=TD.vo.Column.MEDIA_PREVIEW_SIZE_MEDIUM;var t=TD.settings.getDisplaySensitiveMedia(),i={tweet:this,withAvatar:!1,withInlinedUsername:!0,withMediaPreview:e.mediaPreviewSize!==TD.vo.Column.MEDIA_PREVIEW_OFF,isMediaPreviewSmall:e.mediaPreviewSize===(TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL||TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE),isMediaPreviewLarge:!1,isMediaPreviewCompact:e.mediaPreviewSize!==TD.vo.Column.MEDIA_PREVIEW_OFF,mediaPreviewSrc:function(){return this.getMediaSrcForPreviewSize("small")},animatedGif:function(){return this.getAnimatedGifForPreview()},isPossiblySensitive:this.possiblySensitive&&!t},n=$.extend({},i,e);return TD.ui.template.render("status/quoted_tweet",n)},TD.services.TwitterStatus.prototype.getGrowlData=function(){var e,t=this.getMainTweet(),i={};return t.sender?(e=t.recipient?t.recipient.screenName:t.account.getUsername(),i.title=t.sender.screenName+" > "+e):t.user&&t.user.screenName&&(i.title=t.user.screenName),i.img=t.getMainUser().profileImageURL,i.text=$("<div>"+t.htmlText+"</div>").text(),i},TD.services.TwitterStatus.prototype.favorite=function(e){var t,i,n,s,r=(this.getMainUser(),this.getMainTweet(),this.isFavorite),a=TD.controller.clients.getClient(this.account.getKey());this.setFavorite(!this.isFavorite),this.animateFavorite(e.element),s=function(){TD.controller.progressIndicator.addMessage(TD.i(r?"Unfavoriting failed":"Favoriting failed"))},n=function(e){var t=TD.core.defer.fail();(403===e.status||404===e.status)&&(t=this.refreshFavorite(a)),t.addErrback(function(){this.setFavorite(r),s()}.bind(this))}.bind(this),i=function(e){e.error&&n()}.bind(this),r?(a.unfavorite(this.id,i,n),t=TD.controller.stats.unfavorite):(a.favorite(this.id,i,n),t=TD.controller.stats.favorite),t(this.getScribeItemData(),this.account.getUserID())},TD.services.TwitterStatus.prototype.refreshFavorite=function(e){var t=new TD.core.defer.Deferred;return e.show(this.id,t.callback.bind(t),t.errback.bind(t)),t.addCallback(function(e){this.setFavorite(e.isFavorite)}.bind(this)),t},TD.services.TwitterStatus.prototype.animateFavorite=function(e){var t="anim anim-slower anim-bounce-in";requestAnimationFrame(function(){e.find('a[rel="favorite"]').toggleClass(t,this.isFavorite)}.bind(this))},TD.services.TwitterStatus.prototype.email=function(){var e,t=TD.i("Tweet forwarded by @{{1}}",{1:this.account.getUsername()}),i=[];i.push(this.text),i.push(TD.i("Original Tweet: {{1}}",{1:this.getChirpURL()})),i.push(TD.i("Sent via TweetDeck")),e=i.join("\n\n"),TD.util.openEmail(null,t,e)},TD.services.TwitterStatus.prototype.retweet=function(){var e=1===TD.storage.accountController.getAccountsForService("twitter").length;if(this.isRetweeted&&e)this.setRetweeted(!1),$(document).trigger("uiUndoRetweet",{tweetId:this.getMainTweet().id,from:this.account.getKey()});else{new TD.components.ActionDialog(this)}},TD.services.TwitterStatus.prototype.referenceTo=function(){var e=this.account.getKey();$(document).trigger("uiComposeTweet",{appendText:"RE "+this.getChirpURL(),from:[e]})},TD.services.TwitterStatus.prototype.quoteTo=function(e){var t=TD.decider.get("quote_tweet_write");t&&(TD.controller.stats.quoteTweet(),$(document).trigger("uiComposeTweet",{type:"tweet",from:e,quotedTweet:this}))},TD.services.TwitterStatus.prototype.messageTo=function(){TD.controller.stats.shareTweetViaDM(),$(document).trigger("uiComposeTweet",{type:"message",from:[this.account.getKey()],text:this.getChirpURL(),tweetId:this.id})},TD.services.TwitterStatus.prototype._action=function(e,t){function i(){TD.controller.progressIndicator.taskFailed(s)}function n(e){e.error?(TD.controller.progressIndicator.changeMessage(s,r+" - "+e.error),i()):(TD.controller.progressIndicator.taskComplete(s),t&&t(a))}var s,r,a=this,o=TD.controller.clients.getClient(this.account.getKey());switch(e){case"delete":r=TD.i(this.retweetedStatus?"Undoing Retweet":"Deleting"),o=TD.controller.clients.getClient(this.creatorAccount.getKey()),o.destroy(this.id,n,i);break;case"deleteDM":r=TD.i("Deleting"),$(document).trigger("uiDeleteDm",{id:this.id,accountKey:(this.creatorAccount||this.account).getKey(),success:n,error:i})}s=TD.controller.progressIndicator.addTask(r)},TD.services.TwitterStatus.prototype._entitySort=function(e,t){return t.indices[0]-e.indices[0]},TD.services.TwitterStatus.prototype.getFilterableText=function(){var e,t="";return this._filterableText?t=this._filterableText:0===this.entities.urls.length&&0===this.entities.media.length?t=this.text:(e=[this.text],e=e.concat(_.pluck(this.entities.urls,"expanded_url")),e=e.concat(_.pluck(this.entities.media,"expanded_url")),e=_.compact(e),t=e.join(" "),this._filterableText=t),t},TD.services.TwitterStatus.prototype.getSenders=function(){var e=[this.user.screenName];return this.isRetweetedStatus()&&e.push(this.retweetedStatus.user.screenName),e},TD.services.TwitterStatus.prototype.getSource=function(){return this.sourceNoHTML},TD.services.TwitterStatus.prototype.setRetweeted=function(e){this.isRetweeted=e,this.getDOMChirps().find(".js-tweet").toggleClass(TD.services.ChirpBase.RETWEET_CLASS,e),this._changed(),this.retweetedStatus&&this.retweetedStatus.setRetweeted(e)},TD.services.TwitterStatus.prototype.setFavorite=function(e){this.isFavorite=e,this.getDOMChirps().find(".js-tweet").toggleClass(TD.services.ChirpBase.FAVORITE_CLASS,e).find('a[rel="favorite"]').attr("title",TD.ui.template.render("text/favorite_action",this)),this._changed()},TD.services.TwitterStatus.prototype.isMention=function(){for(var e,t=String(this.account.getUserID()),i=this.account.getUsername().toLowerCase(),n=this.entities.user_mentions.length,s=0;n>s;s++)if(e=this.entities.user_mentions[s],e.id_str){if(e.id_str===t)return!0}else if(e.screen_name.toLowerCase()===i)return!0;return!1},TD.services.TwitterStatus.prototype.getMedia=function(){return this.retweetedStatus?this.retweetedStatus.getMedia():this._media||[]},TD.services.TwitterStatus.prototype.getUniqueMedia=function(){var e=this.getMedia(),t={},i=[],n=this;return this.cards&&_.each(TD.services.TwitterCard.SUPPORTED_CARD_TYPES,function(e){var i=n.cards[e];i&&_.each(i,function(e){t[e.url]=!0})}),_.each(e,function(e){t[e.shortUrl]||i.push(e)}),i},TD.services.TwitterStatus.prototype.getReplyUsers=function(){var e=this.getMainTweet(),t={},i=(this.account.getUsername().toLowerCase(),[e.user.screenName]);return i=i.concat(twttr.txt.extractMentions(e.text)),this.retweetedStatus&&i.push(this.user.screenName),i=i.filter(function(e){var i=e.toLowerCase(),n=!t[i];return t[i]=!0,n}),i=i.map(TD.util.atMentionify)},TD.services.TwitterStatus.prototype.getCardsForGallery=function(){var e=this.getMedia(),t={},i=[],n=this;return _.each(e,function(e){t[e.shortUrl]=!0}),this.cards&&_.each(["photos","players"],function(e){var s=n.cards[e];s&&_.each(s,function(e){t[e.url]||i.push(e)})}),i},TD.services.TwitterStatus.prototype.hasLink=function(){var e=this.entities.media||[],t=this.entities.urls||[];return Boolean(e.length||t.length)},TD.services.TwitterStatus.prototype.isFromVerifiedUser=function(){return this.getMainTweet().user.isVerified},TD.services.TwitterStatus.prototype.hasImage=function(){return null===this._hasImage&&(this._hasImage=TD.services.ChirpBase.prototype.hasImage.call(this)||TD.services.TwitterMedia.entitiesContainImage(this.entities)),this._hasImage},TD.services.TwitterStatus.prototype.hasVideo=function(){return null===this._hasVideo&&(this._hasVideo=TD.services.ChirpBase.prototype.hasVideo.call(this)||TD.services.TwitterMedia.entitiesContainVideo(this.entities)),this._hasVideo},TD.services.TwitterStatus.prototype.getScribeItemData=function(e){var t;return this.isRetweetedStatus()?(t=this.getMainTweet().getScribeItemData(e),t.retweeting_tweet_id=this.id):(t={item_type:0,id:this.id},e&&(t.visibility_start=e.visibilityStart,t.visibility_end=e.visibilityEnd),this.cards&&(this.cards.photos?t.card_type=2:this.cards.players?t.card_type=3:this.cards.summaries&&(t.card_type=4))),t},TD.services.TwitterStatus.prototype.scribeMediaImpression=function(){TD.controller.stats.mediaImpression(this.getScribeItemData())},TD.services.TwitterCard=function(e){this.account=e},TD.services.TwitterCard.prototype={url:null,title:null,description:null,author:null,site:null,images:null,players:null},TD.services.TwitterCard.SUPPORTED_CARD_TYPES=["summaries","photos","players"],TD.services.TwitterCard.prototype.fromJSONObject=function(e){return this.url=e.url,this.title=e.title,this.description=e.description,e.author_user&&(this.author=new TD.services.TwitterUser(this.account).fromJSONObject(e.author_user)),e.site_user&&(this.site=new TD.services.TwitterUser(this.account).fromJSONObject(e.site_user)),e.images&&(this.images=e.images),e.players&&(this.players=e.players.filter(function(e){return e.aspectRatio=e.height/e.width*100,"text/html"===e.source_type})),this},TD.services.TwitterCard.prototype.renderGallery=function(){var e;return this.players?e=TD.ui.template.render("cards/media_player_gallery",this):(params={url:this.url,imageSrc:this.images.web.image_url,thumbClass:TD.services.TwitterMedia.IMAGE_CLASS},e=TD.ui.template.render("status/media_thumb",params)),e},TD.services.TwitterConversationNameUpdateEvent=function(e,t){this.sender=t,this.account=e},TD.services.TwitterConversationNameUpdateEvent.prototype=new TD.services.ChirpBase,TD.services.TwitterConversationNameUpdateEvent.prototype.chirpType=TD.services.ChirpBase.CONVERSATION_NAME_UPDATE,TD.services.TwitterConversationNameUpdateEvent.prototype.messageThreadId=null,TD.services.TwitterConversationNameUpdateEvent.prototype.previewText=null,TD.services.TwitterConversationNameUpdateEvent.prototype.getGrowlData=function(){return{img:this.sender.profileImageURL,title:this.conversationName,text:this.sender.name+" "+TD.i("has renamed the group conversation.")}},TD.services.TwitterConversationNameUpdateEvent.prototype.fromJSONObject=function(e){return this.id=e.id,this.conversationId=e.conversation_id,this.created=new Date(parseInt(e.time,10)),this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:this.conversationId}),this.conversationName=e.conversation_name,this.sanitizedConversationName=TD.util.transform(e.conversation_name||""),this.previewText=this.generatePreviewText(),this},TD.services.TwitterConversationNameUpdateEvent.prototype.generatePreviewText=function(){return TD.ui.template.render("status/conversation_name_update_preview",{chirp:this})},TD.services.TwitterConversationNameUpdateEvent.prototype.isOwnChirp=function(){return this.sender&&this.sender.id===this.account.getUserID()},TD.services.TwitterConversationNameUpdateEvent.prototype.render=function(){return TD.ui.template.render("status/conversation_name_update",{chirp:this})},TD.services.TwitterConversationMessageEvent=function(e,t){this.account=e,this.sender=t},TD.services.TwitterConversationMessageEvent.prototype=new TD.services.TwitterStatus,TD.services.TwitterConversationMessageEvent.prototype.chirpType=TD.services.ChirpBase.MESSAGE,TD.services.TwitterConversationMessageEvent.prototype.messageThreadId=null,TD.services.TwitterConversationMessageEvent.prototype.htmlText=null,TD.services.TwitterConversationMessageEvent.prototype.fromJSONObject=function(e){if(this.id=e.id_str||String(e.id),this.text=e.message_data.text,this.conversationId=e.conversation_id,this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:e.conversation_id}),this.created=new Date(parseInt(e.time,10)),this.entities=e.message_data.entities||{},this.attachment=e.message_data.attachment,this.createdDate=TD.util.prettyDate(this.created),this._media=TD.services.TwitterMedia.getMediaFromEntities(this.entities).concat(TD.services.TwitterMedia.getMediaFromAttachment(this.attachment)).map(function(e){return"twitter"===e.service&&(e.needsSecureUrl=!0),e}),this.attachment&&this.attachment.tweet&&TD.decider.get("dm_shared_tweet")){this.quotedTweet=new TD.services.TwitterStatus(this.account).fromJSONObject(this.attachment.tweet.status),this.quotedTweetEntities=this._extractEntities(this.quotedTweet);var t=this.quotedTweet.getChirpURL().slice(5);this.entities.urls.forEach(function(e){e.isUrlForAttachment=e.expanded_url.indexOf(t)>-1},this)}return this.htmlText=TD.util.transform(this.text,this.entities),this},TD.services.TwitterConversationMessageEvent.prototype.hasLocationData=function(){return!1},TD.services.TwitterConversationMessageEvent.prototype.getMainUser=function(){return this.sender},TD.services.TwitterConversationMessageEvent.prototype.isOwnChirp=function(){return this.sender.id===this.account.getUserID()},TD.services.TwitterConversationMessageEvent.prototype.dm=function(){$(document).trigger("uiComposeTweet",{type:"message",from:[this.account.getKey()],messageRecipients:[{screenName:this.sender.screenName}]})},TD.services.TwitterConversationMessageEvent.prototype.getChirpURL=function(){return""},TD.services.TwitterConversationMessageEvent.prototype.destroy=function(){var e=this;this._action("deleteDM",function(){var t=TD.controller.clients.getClient(e.account.getKey());t.deleteMessage(e.id)})},TD.services.TwitterConversationMessageEvent.prototype.render=function(){var e=TD.vo.Column.MEDIA_PREVIEW_SIZE_MEDIUM,t=this.account.getKey(),i=TD.ui.template.render("status/message_in_stream",{message:this,withFooter:!0,withAvatar:!0,withMediaPreview:!0,isMediaPreviewSmall:e===TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL,isMediaPreviewLarge:e===TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE,mediaPreviewSrc:function(){var i=this.getMediaSrcForPreviewSize(e);return this.needsSecureUrl&&_.defer(function(){
$(document).trigger("uiNeedsSecureImageUrl",{accountKey:t,url:i})}),i},renderQuoted:function(){return this.renderQuotedTweet()},thumbSizeClass:TD.services.TwitterMedia.thumbSizeClasses[e],accountKey:this.account.getKey()});return i},TD.services.TwitterConversationMessageEvent.prototype.renderInMediaGallery=function(){return TD.ui.template.render("status/message_in_box",{message:this,withFooter:!0,withAvatar:!0,withMediaPreview:!1,withTweetActions:!0,withTweetActionsVisible:!0})},TD.services.TwitterConversationMessageEvent.prototype.renderNotification=function(){return TD.ui.template.render("status/message_in_box",{message:this,withAvatar:!0})},TD.services.TwitterConversationMessageEvent.prototype.getSenders=function(){return[this.sender.screenName]},TD.services.TwitterConversationJoinEvent=function(e){this.sender=e.sender,this.account=e.account},TD.services.TwitterConversationJoinEvent.prototype=new TD.services.ChirpBase,TD.services.TwitterConversationJoinEvent.prototype.chirpType=TD.services.ChirpBase.CONVERSATION_JOIN,TD.services.TwitterConversationJoinEvent.prototype.messageThreadId=null,TD.services.TwitterConversationJoinEvent.prototype.previewText=null,TD.services.TwitterConversationJoinEvent.prototype.getGrowlData=function(){return{img:this.sender.profileImageURL,title:this.notificationTitle.withSender,text:this.sender.name+" "+TD.i("has added you to a group conversation.")}},TD.services.TwitterConversationJoinEvent.prototype.fromJSONObject=function(e){this.id=e.id,this.conversationId=e.conversation_id,this.created=new Date(parseInt(e.time,10)),this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:this.conversationId}),this.previewText=this.generatePreviewText();var t=TD.controller.clients.getClient(this.account.getKey());return this.conversation=t.conversations.getConversation(this.conversationId),this},TD.services.TwitterConversationJoinEvent.prototype.getParticipants=function(){var e=8,t=this.conversation.participants.length,i=Math.ceil(t/Math.ceil(t/e));return this.conversation.participants.map(function(e,t){return{participant:e,isEndOfRow:!((t+1)%i)}})},TD.services.TwitterConversationJoinEvent.prototype.generatePreviewText=function(){return TD.ui.template.render("status/conversation_join_preview",{chirp:this})},TD.services.TwitterConversationJoinEvent.prototype.isOwnChirp=function(){return this.sender.id===this.account.getUserID()},TD.services.TwitterConversationJoinEvent.prototype.render=function(){return TD.ui.template.render("status/conversation_join",{numberOfParticipants:this.conversation.participants.length,chirp:this})},TD.services.TwitterConversationParticipantsJoinEvent=function(e){this.sender=e.sender,this.account=e.account,this.addedParticipants=e.addedParticipants},TD.services.TwitterConversationParticipantsJoinEvent.prototype=new TD.services.ChirpBase,TD.services.TwitterConversationParticipantsJoinEvent.prototype.chirpType=TD.services.ChirpBase.CONVERSATION_PARTICIPANTS_JOIN,TD.services.TwitterConversationParticipantsJoinEvent.prototype.messageThreadId=null,TD.services.TwitterConversationParticipantsJoinEvent.prototype.previewText=null,TD.services.TwitterConversationParticipantsJoinEvent.prototype.getGrowlData=function(){var e=this.addedParticipants[this.addedParticipants.length-1];return{img:e.profileImageURL,title:this.notificationTitle.withoutSender,text:e.name+" "+TD.i("has beed added to the group conversation.")}},TD.services.TwitterConversationParticipantsJoinEvent.prototype.fromJSONObject=function(e){return this.id=e.id,this.conversationId=e.conversation_id,this.created=new Date(parseInt(e.time,10)),this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:this.conversationId}),this.previewText=this.generatePreviewText(),this},TD.services.TwitterConversationParticipantsJoinEvent.prototype.generatePreviewText=function(){return TD.ui.template.render("status/conversation_participants_join_preview",{chirp:this,numberOfOtherParticipants:this.addedParticipants.length-1})},TD.services.TwitterConversationParticipantsJoinEvent.prototype.isOwnChirp=function(){return this.sender.id===this.account.getUserID()},TD.services.TwitterConversationParticipantsJoinEvent.prototype.render=function(){return TD.ui.template.render("status/conversation_participants_join",{chirp:this})},TD.services.TwitterConversationParticipantsLeaveEvent=function(e,t){this.account=e,this.leftParticipants=t},TD.services.TwitterConversationParticipantsLeaveEvent.prototype=new TD.services.ChirpBase,TD.services.TwitterConversationParticipantsLeaveEvent.prototype.chirpType=TD.services.ChirpBase.CONVERSATION_PARTICIPANT_REMOVED,TD.services.TwitterConversationParticipantsLeaveEvent.prototype.messageThreadId=null,TD.services.TwitterConversationParticipantsLeaveEvent.prototype.previewText=null,TD.services.TwitterConversationParticipantsLeaveEvent.prototype.getGrowlData=function(){return this.leftParticipants.map(function(e){return{img:e.profileImageURL,title:this.notificationTitle.withoutSender,text:e.name+" "+TD.i("has left the group conversation.")}},this).pop()},TD.services.TwitterConversationParticipantsLeaveEvent.prototype.fromJSONObject=function(e){return this.id=e.id,this.conversationId=e.conversation_id,this.created=new Date(parseInt(e.time,10)),this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:this.conversationId}),this.previewText=this.generatePreviewText(),this},TD.services.TwitterConversationParticipantsLeaveEvent.prototype.generatePreviewText=function(){return TD.ui.template.render("status/conversation_participants_leave_preview",{chirp:this})},TD.services.TwitterConversationParticipantsLeaveEvent.prototype.isOwnChirp=function(){return!1},TD.services.TwitterConversationParticipantsLeaveEvent.prototype.render=function(){return TD.ui.template.render("status/conversation_participants_leave",{chirp:this})},TD.services.TwitterConversationFailedParticipantsEvent=function(e){this.id=_.uniqueId("failedParticipants"),this.account=e.account,this.failedParticipants=e.failedParticipants.map(function(t,i){return{participant:t,isLastItem:i===e.failedParticipants.length-1}}),this.conversationId=e.conversationId,this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:this.conversationId}),this.previewText=this.generatePreviewText(),this.created=new Date},TD.services.TwitterConversationFailedParticipantsEvent.prototype=new TD.services.ChirpBase,TD.services.TwitterConversationFailedParticipantsEvent.prototype.chirpType=TD.services.ChirpBase.CONVERSATION_PARTICIPANTS_FAILED,TD.services.TwitterConversationFailedParticipantsEvent.prototype.messageThreadId=null,TD.services.TwitterConversationFailedParticipantsEvent.prototype.previewText=null,TD.services.TwitterConversationFailedParticipantsEvent.prototype.getParticipants=function(){var e=8,t=this.failedParticipants.length,i=Math.ceil(t/Math.ceil(t/e));return this.failedParticipants.map(function(e,t){return{participant:e,isEndOfRow:!((t+1)%i)}})},TD.services.TwitterConversationFailedParticipantsEvent.prototype.generatePreviewText=function(){return TD.ui.template.render("status/conversation_failed_participants_preview")},TD.services.TwitterConversationFailedParticipantsEvent.prototype.isOwnChirp=function(){return!0},TD.services.TwitterConversationFailedParticipantsEvent.prototype.render=function(){return TD.ui.template.render("status/conversation_failed_participants",{chirp:this})},TD.services.TwitterConversationReadEvent=function(e){this.account=e},TD.services.TwitterConversationReadEvent.prototype=new TD.services.ChirpBase,TD.services.TwitterConversationReadEvent.prototype.chirpType=TD.services.ChirpBase.CONVERSATION_READ,TD.services.TwitterConversationReadEvent.prototype.messageThreadId=null,TD.services.TwitterConversationReadEvent.prototype.fromJSONObject=function(e){return this.id=e.id,this.conversationId=e.conversation_id,this.created=new Date(parseInt(e.time,10)),this.lastReadEventId=e.last_read_event_id,this.messageThreadId=TD.services.TwitterConversation.getConversationId({account:this.account,conversationId:this.conversationId}),this},TD.services.Conversations=function(e,t){this.client=t,this.account=e,this.conversationCache={},this.accessLevel={oneToOne:!1,groupRead:!1},this.currentUsers={}},TD.services.Conversations.prototype.getConversation=function(e){return this.conversationCache[e]},TD.services.Conversations.prototype.getAllConversations=function(){return Object.keys(this.conversationCache).map(function(e){return this.conversationCache[e]},this)},TD.services.Conversations.prototype.setAccessLevel=function(e){(e.oneToOne!==this.accessLevel.oneToOne||e.groupRead!==this.accessLevel.groupRead)&&(this.destroyAll(),this.accessLevel=e,TD.controller.columnManager.getColumnsByAccountKey(this.account.getKey()).filter(function(e){return e.isMessageColumn()}).forEach(function(e){var t=e.model.getFeedKeys();t.map(TD.controller.feedManager.getPoller).forEach(function(e){e.refresh({reset:!0})})}))},TD.services.Conversations.prototype.destroyAll=function(){var e=Object.keys(this.conversationCache).map(function(e){return this.conversationCache[e]},this);e.length&&this.client.publishChirpsInternal("remove","direct",e),this.conversationCache={}},TD.services.Conversations.prototype.processUserUpdates=function(e,t){var i={},n=[];if(e&&(this.conversationCache={}),t=t.user_inbox?t.user_inbox:t.user_events?t.user_events:t.conversation_timeline){if(t.users&&(this.currentUsers={},this.processUsers(t.users)),t.conversations&&(n=this.processConversations(t.conversations,t.users),this.cacheConversations(n)),t.cursor&&Object.keys(this.conversationCache).forEach(function(e){this.conversationCache[e].cursor=t.cursor},this),this.updateMinEntryIds(t),t.entries&&(i=this.processConversationEntries(t.entries,t.users)),t.failed_participants&&1===n.length){var s=n[0].conversationId,r=this.processFailedParticipants(t.failed_participants,s);i[s]=i[s]||[],i[s]=i[s].concat([r])}return this.addEventsToConversations(i).forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),t.unread_conversations&&Object.keys(t.unread_conversations).forEach(function(e){var t=this.conversationCache[e];t&&(t.unread=!0)},this),n}},TD.services.Conversations.prototype.markAllRead=function(){var e=this.getAllConversations();if(e.length){var t=e.map(function(e){return e.getMaxEntryId()}).sort(TD.util.numericStringComparator).pop();$(document).trigger("uiMarkAllDmsAsRead",{lastReadEventId:t,accountKey:this.account.getKey(),success:function(){var t=e.filter(function(e){return e.unread===!0});t.length&&(t.forEach(function(e){e.unread=!1,e.messages.forEach(function(e){e.read=!0})}),this.client.publishChirpsInternal("publish","direct",t))}.bind(this)})}},TD.services.Conversations.prototype.updateMinEntryIds=function(e){var t=Object.keys(this.conversationCache),i=t.length>0?this.conversationCache[t[0]].minEntryId:null,n=!i||e.min_entry_id&&TD.util.numericStringComparator(i,e.min_entry_id)>0;n&&Object.keys(this.conversationCache).forEach(function(t){this.conversationCache[t].minEntryId=e.min_entry_id},this)},TD.services.Conversations.prototype.processUsers=function(e){Object.keys(e).forEach(function(t){this.currentUsers[t]||(this.currentUsers[t]=e[t]?this.client.processUser(e[t]):this.client.processDeletedUser(t))}.bind(this))},TD.services.Conversations.prototype.addEventsToConversations=function(e){var t=[];return Object.keys(e).forEach(function(i){var n=this.conversationCache[i];n&&n.addMessages(e[i])&&t.push(n)},this),t},TD.services.Conversations.prototype.processStreamData=function(e,t){var i=new TD.core.defer.Deferred;if(!e.user_events)return i.fail();if(e.user_events.conversations&&!t)i.callback(this.processUserUpdates(!1,e));else{var n=e.user_events;n.users&&this.processUsers(n.users);var s=this.processConversationEntries(n.entries,n.users),r=this.addEventsToConversations(s),a=Object.keys(s).filter(function(e){return t||!r.some(function(t){return t.conversationId===e})});if(0===a.length)i.callback(r);else{var o=new TD.core.defer.DeferredList(a.map(function(e){return this.client.getDmConversation(e,{include_conversation_info:!0})},this),{consumeErrors:!0});o.addCallback(function(e){var e=e.reduce(function(e,t){return e.concat(t[1])},[]);i.callback(e)})}}return i},TD.services.Conversations.prototype.processConversations=function(e,t){return Object.keys(e).map(function(i){var n=e[i];try{var s=this.conversationCache[i];if(s){s=this.conversationCache[i].fromJSONObject(n);var r=this.inflateParticipants(n,t);s.setParticipants(r)}else s=this.processConversation(n,t);return s}catch(a){this.logProcessingError("conversation",a)}},this).filter(function(e){return e})},TD.services.Conversations.prototype.logProcessingError=function(e,t){TD.sync.util.warn("Threw on processing conversation",e,t),$(document).trigger("metric",{key:"conversation:processing-error:"+e})},TD.services.Conversations.prototype.cacheConversations=function(e){e.forEach(function(e){e instanceof TD.services.TwitterConversation&&!this.conversationCache[e.conversationId]&&(this.conversationCache[e.conversationId]=e)},this)},TD.services.Conversations.prototype.processConversationEntries=function(e,t){var i={};return e.forEach(function(e){var n;try{n=e.message&&this.processMessage(e.message,t)||e.conversation_read&&this.processConversationReadEvent(e.conversation_read)||e.participants_join&&this.processConversationParticipantsJoinEvent(e.participants_join)||e.join_conversation&&this.processConversationJoinEvent(e.join_conversation)||e.participants_leave&&this.processConversationParticipantsLeaveEvent(e.participants_leave)||e.conversation_name_update&&this.processConversationNameUpdate(e.conversation_name_update)}catch(s){this.logProcessingError("entry",s)}n&&(i[n.conversationId]=i[n.conversationId]||[],i[n.conversationId].push(n))},this),i},TD.services.Conversations.prototype.processFailedParticipants=function(e,t){var i=Object.keys(e).map(function(e){return this.currentUsers[e]},this);return new TD.services.TwitterConversationFailedParticipantsEvent({account:this.account,conversationId:t,failedParticipants:i})},TD.services.Conversations.prototype.inflateParticipants=function(e,t){var i=this.account.getUserID();return e.participants.filter(function(t){return t.user_id!==i||1===e.participants.length}).sort(function(t,i){return t.user_id===e.created_by_user_id?-1:i.user_id===e.created_by_user_id?1:TD.util.numericStringComparator(t.join_time,i.join_time)||TD.util.numericStringComparator(t.user_id,i.user_id)}).map(function(e){return this.currentUsers[e.user_id]||t[e.user_id]?this.client.processUser(t[e.user_id]):this.client.processDeletedUser(e.user_id)},this)},TD.services.Conversations.prototype.processConversation=function(e,t){var i=this.inflateParticipants(e,t);return new TD.services.TwitterConversation(this.account,i).fromJSONObject(e)},TD.services.Conversations.prototype.processConversationReadEvent=function(e){return new TD.services.TwitterConversationReadEvent(this.account).fromJSONObject(e)},TD.services.Conversations.prototype.processConversationNameUpdate=function(e){var t=this.currentUsers[e.by_user_id];return new TD.services.TwitterConversationNameUpdateEvent(this.account,t).fromJSONObject(e)},TD.services.Conversations.prototype.processConversationJoinEvent=function(e){var t=this.currentUsers[e.sender_id];return new TD.services.TwitterConversationJoinEvent({account:this.account,sender:t}).fromJSONObject(e)},TD.services.Conversations.prototype.processConversationParticipantsJoinEvent=function(e){var t=[];e.participants.forEach(function(e){t.push(this.currentUsers[e.user_id])}.bind(this));var i=this.currentUsers[e.sender_id];return new TD.services.TwitterConversationParticipantsJoinEvent({account:this.account,sender:i,addedParticipants:t}).fromJSONObject(e)},TD.services.Conversations.prototype.processConversationParticipantsLeaveEvent=function(e){var t=[];return e.participants.forEach(function(e){t.push(this.currentUsers[e.user_id])}.bind(this)),new TD.services.TwitterConversationParticipantsLeaveEvent(this.account,t).fromJSONObject(e)},TD.services.Conversations.prototype.processMessage=function(e){var t=e.message_data.sender_id,i=this.currentUsers[t];return i?new TD.services.TwitterConversationMessageEvent(this.account,i).fromJSONObject(e):void 0},TD.services.Conversations.prototype.deleteMessageByIdAndReturnChangedConversations=function(e){return Object.keys(this.conversationCache).map(function(e){return this.conversationCache[e]}.bind(this)).filter(function(t){return t.removeMessage(e)})},TD.services.Conversations.prototype.renameConversation=function(e){var t=this.getConversation(e.conversationId);t.name=e.name,this.client.publishChirpsInternal("publish","direct",[t])},TD.services.Conversations.prototype.deleteConversation=function(e){var t=this.getConversation(e);TD.controller.feedManager.deleteChirp(t.id),delete this.conversationCache[e]},TD.services.TwitterConversation=function(e,t){this.unread=!1,this.messages=[],this.messageIndex={},this.account=e,this.participants=t||[],this.hasValidParticipant=!(1===this.participants.length&&t[0].isDeleted),this.sortIndex={type:"milliseconds"}},TD.services.TwitterConversation.CONVERSATION_STATUS_AT_END="AT_END",TD.services.TwitterConversation.CONVERSATION_ENTRY_COUNT=100,TD.services.TwitterConversation.getConversationId=function(e){return TD.ui.template.toHtml("conversation-{{accountId}}-{{conversationId}}",{accountId:e.account.getUserID(),conversationId:e.conversationId})},TD.services.TwitterConversation.prototype=new TD.services.ChirpBase,TD.services.TwitterConversation.prototype.fromJSONObject=function(e){return this.type=e.type,this.conversationId=e.conversation_id,this.notificationsDisabled=!!e.notifications_disabled,this.name=e.name,this.lastReadEventId=e.last_read_event_id,this.sortTimestamp=new Date(parseInt(e.sort_timestamp,10)),this.id=TD.services.TwitterConversation.getConversationId({conversationId:this.conversationId,account:this.account}),this.calculateAttributes(),this},TD.services.TwitterConversation.prototype.chirpType=TD.services.ChirpBase.MESSAGE_THREAD,TD.services.TwitterConversation.prototype.participants=null,TD.services.TwitterConversation.prototype.unread=!1,TD.services.TwitterConversation.prototype.replied=!1,TD.services.TwitterConversation.prototype.messages=null,TD.services.TwitterConversation.prototype.messageIndex=null,TD.services.TwitterConversation.prototype.conversationId=null,TD.services.TwitterConversation.prototype.name=null,TD.services.TwitterConversation.prototype.getAUserThatIsNotMe=function(){for(var e=this.account.getUserID(),t=0;t<this.participants.length;t++)if(this.participants[t].id!==e)return this.participants[t]},TD.services.TwitterConversation.prototype.getNotificationTitle=function(e){var t=this.getConversationTitleInformation(),i=t.name;if(!i){var n=t.numberOfOtherParticipants,s=n>1?" +"+n:"",r=e||this.getAUserThatIsNotMe()||this.participants[0];i=r.name+s}return i},TD.services.TwitterConversation.prototype.isOneToOne=function(){return 1===this.participants.length},TD.services.TwitterConversation.prototype.getConversationTitleInformation=function(){var e=this.participants.length;return{name:this.name&&TD.util.transform(this.name),isOneToOne:1===e,isThreeway:2===e,isOneToMany:e>2,numberOfOtherParticipants:e-1,isDeleted:1===e&&this.participants[0].isDeleted}},TD.services.TwitterConversation.prototype.isCorrectThreadForMessage=function(e){return e.messageThreadId===this.id},TD.services.TwitterConversation.prototype.setLastReadEventId=function(e){return TD.util.numericStringComparator(e,this.lastReadEventId)>0?(this.lastReadEventId=e,this.getUnreadChirps().forEach(function(t){TD.util.numericStringComparator(t.id,e)<1&&(t.read=!0)}),!0):void 0},TD.services.TwitterConversation.prototype.addNotificationTitleInfo=function(e){e.notificationTitle||(e.notificationTitle={withSender:this.getNotificationTitle(e.sender),withoutSender:this.getNotificationTitle()})},TD.services.TwitterConversation.prototype.addMessages=function(e){var t,i,n=!1,s=(this.account.getUserID(),[]);if(e&&0!==e.length){for(t=0,i=e.length;i>t;t++){var r=e[t];if(!this.messageIndex[r.id]){if(!this.isCorrectThreadForMessage(r))throw new Error("Wrong thread!");r instanceof TD.services.TwitterConversationReadEvent?n=this.setLastReadEventId(r.lastReadEventId):(n=!0,r.messageThreadId=this.id,this.messages.push(r),this.messageIndex[r.id]=r,r.read=r.isOwnChirp()||TD.util.numericStringComparator(r.id,this.lastReadEventId)<1)}}return this.messages.sort(TD.util.chirpColumnSort),this.calculateAttributes(),s.length&&$(document).trigger("uiMessageThreadNotifications",{notifications:s}),n}},TD.services.TwitterConversation.prototype.setParticipants=function(e){this.participants=e},TD.services.TwitterConversation.prototype.removeMessage=function(e){var t=this.messageIndex[e];return t?(delete this.messageIndex[e],this.messages=this.messages.filter(function(t){return t.id!==e}),this.calculateAttributes(),$(document).trigger("uiMessageThreadRead",{}),!0):!1},TD.services.TwitterConversation.prototype.getMainUser=function(){return this.participants[0]},TD.services.TwitterConversation.prototype.isUnread=function(){return this.getUnreadChirps().length>0},TD.services.TwitterConversation.prototype.replied=function(){return this.messages[0]&&this.messages[0].isOwnChirp()},TD.services.TwitterConversation.prototype.updateSender=function(){var e=this.messages[0];!e||e.isOwnChirp()?(this.sender=null,this.showSenderName=!1):this.participants.length>1&&(this.showSenderName=e instanceof TD.services.TwitterConversationMessageEvent,this.sender=e.sender)},TD.services.TwitterConversation.prototype.updateSortIndex=function(){this.created=this.sortTimestamp,this.sortIndex.value=this.created.getTime(),this.messages.length>0&&1===TD.util.numericStringComparator(this.messages[0].created,this.sortIndex.value)&&(this.sortIndex.value=this.messages[0].created)},TD.services.TwitterConversation.prototype.updateContent=function(){var e=this.messages[0];if(this.attachmentOnly=!1,e){if(this.text=e.text,this.htmlText=e.htmlText,this.previewText=e.previewText,this._media=e._media,this._media&&this._media.length){var t=this.text,i=this._media.some(function(e){return e.entity&&e.entity.indices&&e.entity.indices[1]===this.text.length?(t=this.text.substr(0,e.entity.indices[0]),!0):void 0}.bind(this));i&&(this.text=t.trim(),this.htmlText=TD.util.transform(this.text,this.entities)),this.text.length||(this.attachmentOnly=!0)}}else this.text="",this.htmlText="",this.previewText=""},TD.services.TwitterConversation.prototype.calculateAttributes=function(){this.unread=this.isUnread(),this.updateSender(),this.updateSortIndex(),this.updateContent()},TD.services.TwitterConversation.prototype.render=function(e){var t=this.account.getKey(),i=Math.min(this.participants.length,3),n="media-grid-"+i+"-mirror",s=e.templateName||"status/conversation";return TD.ui.template.render(s,{chirp:this,mediaPreviewSrc:function(){var e=this.getMediaSrcForPreviewSize("small");return this.needsSecureUrl&&_.defer(function(){$(document).trigger("uiNeedsSecureImageUrl",{accountKey:t,url:e})}),e},withMultipleAvatars:i>1,avatars:this.participants.slice(0,3),avatarsClass:n,accountKey:t})},TD.services.TwitterConversation.prototype.renderThread=function(){var e=[];return this.messages.forEach(function(t){e.push(t.render())}),e.join("")},TD.services.TwitterConversation.prototype.setStatus=function(e){this.status=e},TD.services.TwitterConversation.prototype.isAtEnd=function(){return this.status===TD.services.TwitterConversation.CONVERSATION_STATUS_AT_END},TD.services.TwitterConversation.prototype.updateConversation=function(){var e,t=TD.controller.clients.getClient(this.account.getKey()),i={};return this.isAtEnd()?e=TD.core.defer.succeed():(i.count=TD.services.TwitterConversation.CONVERSATION_ENTRY_COUNT,this.messages.length&&(i.max_id=this.messages[this.messages.length-1].id),e=t.getDmConversation(this.conversationId,i)),e},TD.services.TwitterConversation.prototype.update=function(e){return!0},TD.services.TwitterConversation.prototype.isOwnChirp=function(){return!1},TD.services.TwitterConversation.prototype.getUnreadChirps=function(e){return e&&this.notificationsDisabled?[]:this.messages.filter(function(t){var i=!e||t.belongsAbove(e);return t.chirpType===TD.services.ChirpBase.MESSAGE&&!t.isOwnChirp()&&!t.read&&i})},TD.services.TwitterConversation.prototype.getMaxEntryId=function(){for(var e=null,t=0;!e&&this.messages[t];)this.messages[t].chirpType===TD.services.ChirpBase.MESSAGE&&(e=this.messages[t].id),t++;return e||0},TD.services.TwitterConversation.prototype.markAsRead=function(){var e=(TD.controller.clients.getClient(this.account.getKey()),this.getUnreadChirps());if(!(e.length<=0)){this.getDOMChirps().removeClass(TD.services.ChirpBase.UNREAD_CLASS),e.forEach(function(e){e.read=!0}),this.unread=!1,$(document).trigger("uiMessageThreadRead",{});var t=function(t){this.unread=!0,e&&e.forEach(function(e){e.read=!1}),TD.controller.progressIndicator.addMessage(TD.i("Failed to mark message as read.")),this.getDOMChirps().addClass(TD.services.ChirpBase.UNREAD_CLASS),this._changed()};this.conversationId?$(document).trigger("uiMarkDmAsRead",{lastReadEventId:this.getMaxEntryId(),conversationId:this.conversationId,error:t.bind(this),accountKey:this.account.getKey()}):t.call(this),this._changed()}},TD.services.TwitterConversation.prototype.getSenders=function(){return 1!==this.participants.length||this.participants[0].isDeleted?[]:[this.participants[0].screenName]},TD.services.TwitterMedia=function(){},TD.services.TwitterMedia.TWITPIC_RE=/(http:\/\/|www.)?twitpic.com\/(\w+)/,TD.services.TwitterMedia.YFROG_RE=/(http:\/\/|www.)?yfrog.com\/\w+/,TD.services.TwitterMedia.PLIXI_RE=/(http:\/\/|www.)?plixi.com\/p\/[0-9]+/,TD.services.TwitterMedia.LOCKERZ_RE=/(http:\/\/|www.)?lockerz.com\/s\/[0-9]+/,TD.services.TwitterMedia.INSTAGRAM_RE=/(http:\/\/|www.)?instagr.am\/p\/[\w-]+(\/)/,TD.services.TwitterMedia.YOUTUBE_LONG_RE=/(?:(?:https?\:\/\/)?(?:www\.)?)?youtube\.com\/watch[a-zA-Z0-9_\-\?\&\=\/]+/,TD.services.TwitterMedia.YOUTUBE_TINY_RE=/(http:\/\/|www.)?youtu\.be\/([a-zA-Z0-9_\-\?\&\=\/]+)/,TD.services.TwitterMedia.YOUTUBE_RE=new RegExp(TD.services.TwitterMedia.YOUTUBE_LONG_RE.source+"|"+TD.services.TwitterMedia.YOUTUBE_TINY_RE.source),TD.services.TwitterMedia.YOUTUBE_STARTTIME=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s?)?$/,TD.services.TwitterMedia.VIMEO_RE=/https?:\/\/(www\.|player\.)?vimeo\.com\/(.+)/i,TD.services.TwitterMedia.VINE_RE=/https?:\/\/(www\.)?vine\.co\/v\/(.+)/i,TD.services.TwitterMedia.FLICKR_RE=/https?:\/\/(www\.)?(flic.kr|flickr.com\/photos)\/(.+)/i,TD.services.TwitterMedia.IMGUR_RE=/https?:\/\/([a-z0-9]+\.)?imgur.com\/(.+)/i,TD.services.TwitterMedia.PHOTOZOU_RE=/https?:\/\/photozou\.jp\/photo\/(show|photo_only)\/(.+)/i,TD.services.TwitterMedia.FILTERABLE_VIDEO_SERVICES=[TD.services.TwitterMedia.VIMEO_RE,TD.services.TwitterMedia.VINE_RE,TD.services.TwitterMedia.YOUTUBE_TINY_RE,TD.services.TwitterMedia.YOUTUBE_RE,TD.services.TwitterMedia.YOUTUBE_LONG_RE],TD.services.TwitterMedia.FILTERABLE_IMAGE_SERVICES=[TD.services.TwitterMedia.FLICKR_RE,TD.services.TwitterMedia.IMGUR_RE,TD.services.TwitterMedia.PHOTOZOU_RE],TD.services.TwitterMedia.YOUTUBE_GALLERY_WIDTH=640,TD.services.TwitterMedia.YOUTUBE_GALLERY_HEIGHT=390,TD.services.TwitterMedia.VINE_GALLERY_WIDTH=540,TD.services.TwitterMedia.VINE_GALLERY_HEIGHT=540,TD.services.TwitterMedia.AVAILABLE_COLUMN_SPACE={narrow:250,medium:290,wide:330},TD.services.TwitterMedia.MAX_THUMB_WIDTH=90,TD.services.TwitterMedia.MAX_THUMB_HEIGHT=65,TD.services.TwitterMedia.THUMBNAIL_CONTAINER_CLASS="media-thumb-container",TD.services.TwitterMedia.THUMBNAIL_IMG_CLASS="media-thumb-img",TD.services.TwitterMedia.thumbSizeClasses={off:"",small:"media-size-small",medium:"media-size-medium",large:"media-size-large"},TD.services.TwitterMedia.IMAGE_CLASS="media-img",TD.services.TwitterMedia.SERVICES={twitpic:TD.services.TwitterMedia.TWITPIC_RE,yfrog:TD.services.TwitterMedia.YFROG_RE,lockerz:TD.services.TwitterMedia.LOCKERZ_RE,instagram:TD.services.TwitterMedia.INSTAGRAM_RE,youtube:TD.services.TwitterMedia.YOUTUBE_RE,vine:TD.services.TwitterMedia.VINE_RE},TD.services.TwitterMedia.getMediaFromAttachment=function(e){var t=[];return e&&e.photo&&t.push((new TD.services.TwitterMedia).fromPhotoAttachment(e.photo)),t},TD.services.TwitterMedia.getMediaFromEntities=function(e,t){var i=[],n={};t=t||{},_.each(e.media,function(e){i.push((new TD.services.TwitterMedia).fromMediaEntity(e))});var s=_.map(e.urls,function(e){var t=e.expanded_url||e.url;return n[t]=e.url,_.startsWith(t,"http")||(t="http://"+t),t});_.each(s,function(e){var t;for(var s in TD.services.TwitterMedia.SERVICES)t=e.match(TD.services.TwitterMedia.SERVICES[s]),t&&0===e.indexOf(t[0])&&i.push((new TD.services.TwitterMedia).fromURL(s,n[e],e,t))}),_.each(i,function(e){_.extend(e,t)});var r=TD.services.TwitterMedia._entitiesContainNativeMultiPhoto(i);if(r.length>0)return r;var a=TD.services.TwitterMedia._entitiesContainMultiPhoto(i);if(a.length>0)return a.pop();var o=TD.services.TwitterMedia._entitiesContainNativeVideo(i);if(o.length>0)return o;var c=TD.services.TwitterMedia._entitiesContainAnimatedGif(i);if(c.length>0)return c;var l=TD.services.TwitterMedia._entitiesContainVideo(i);return l.length>0?[l.pop()]:i},TD.services.TwitterMedia.entitiesContainImage=function(e){return TD.services.TwitterMedia.FILTERABLE_IMAGE_SERVICES.some(function(t){return e.urls.some(function(e){return t.test(e.expanded_url)})})},TD.services.TwitterMedia.entitiesContainVideo=function(e){return TD.services.TwitterMedia.FILTERABLE_VIDEO_SERVICES.some(function(t){return e.urls.some(function(e){return t.test(e.expanded_url)})})},TD.services.TwitterMedia._entitiesContainVideo=function(e){return _.filter(e,function(e){var t;return _.some(TD.services.TwitterMedia.FILTERABLE_VIDEO_SERVICES,function(i){i.test(e.url)&&(t=e)}),t})},TD.services.TwitterMedia._entitiesContainNativeMultiPhoto=function(e){return _.filter(e,function(e){return e.nativePhotoCapable()&&e.referenced_media===!1?e:void 0})},TD.services.TwitterMedia._entitiesContainMultiPhoto=function(e){var t=_.groupBy(e,function(e){return e.nativePhotoCapable()&&e.referenced_media===!0?e.url:"__delete"});delete t.__delete;var i=_.values(t);return i},TD.services.TwitterMedia._entitiesContainNativeVideo=function(e){return e.filter(function(e){return e.nativeVideoCapable()})},TD.services.TwitterMedia._entitiesContainAnimatedGif=function(e){return e.filter(function(e){return e.animatedGifCapable()})},TD.services.TwitterMedia.prototype={flaggedNSFW:!1,isVideo:!1,isAnimatedGif:!1,isVine:!1},TD.services.TwitterMedia.prototype.nativePhotoCapable=function(){return"twitter"===this.service&&"photo"===this.entity.type},TD.services.TwitterMedia.prototype.nativeVideoCapable=function(){return"twitter"===this.service&&"video"===this.entity.type},TD.services.TwitterMedia.prototype.animatedGifCapable=function(){return"twitter"===this.service&&"animated_gif"===this.entity.type},TD.services.TwitterMedia.prototype.fromMediaEntity=function(e){return this.entity=e,this.service="twitter",this.isVideo="video"===e.type&&TD.decider.get("native_video"),this.isAnimatedGif="animated_gif"===e.type&&TD.decider.get("native_animated_gifs"),this.url=this.shortUrl=e.url,this.sizes=e.sizes,this.needsSecureUrl=!1,this.isScheduled=!1,this.mediaId=e.id_str,this.referenced_media=e.source_status_id?!0:!1,this},TD.services.TwitterMedia.prototype.fromPhotoAttachment=function(e){return this.entity=e,this.service="twitter",this.url=e.media_url_https,this.shortUrl=e.display_url,this.sizes=e.sizes,this.needsSecureUrl=!1,this.isScheduled=!1,this.mediaId=e.id_str,this.referenced_media=!1,this},TD.services.TwitterMedia.prototype.fromURL=function(e,t,i,n){if(this.url=i,this.urlMatches=n,this.shortUrl=t,this.service=e,"instagram"===this.service&&_.endsWith(this.url,"/"))this.url=this.url.substring(0,this.url.length-1);
else if("vine"===this.service)this.isVine=!0,this.isVideo=!0,this.mediaId=this.url.split("/").pop();else if("youtube"===this.service){if(this.isVideo=!0,this.mediaId=this.url.match(TD.services.TwitterMedia.YOUTUBE_LONG_RE)?TD.net.util.decodeURL(this.url).v:this.url.split("/").pop().split("?")[0],this.startTimeInUrl=TD.net.util.decodeURL(this.url).t,!this.startTimeInUrl){var s=this.url.split("#")[1]||"";this.startTimeInUrl=TD.net.util.formDecode(s).t}if(this.startTimeInUrl){var r=this.startTimeInUrl.match(TD.services.TwitterMedia.YOUTUBE_STARTTIME),a=r[1]?parseInt(3600*r[1],10):0,o=r[2]?parseInt(60*r[2],10):0,c=r[3]?parseInt(r[3],10):0;this.startTime=a+o+c}}return this},TD.services.TwitterMedia.prototype.getTwitterPreviewUrl=function(e){return this.isScheduled?this.entity.url:this.entity.media_url_https+(e||"")},TD.services.TwitterMedia.prototype.thumb=function(){switch(this.service){case"twitter":return this.getTwitterPreviewUrl(":thumb");case"twitpic":return"https://twitpic.com/show/thumb/"+this.urlMatches[2];case"yfrog":return this.url.replace("http://","https://")+":small";case"lockerz":return"https://api.plixi.com/api/tpapi.svc/imagefromurl?size=thumbnail&url="+this.url;case"instagram":return"https://instagr.am/p/"+this.url.split("/").pop()+"/media/?size=t";case"youtube":return"https://img.youtube.com/vi/"+this.mediaId+"/default.jpg";case"vine":return this.large()}},TD.services.TwitterMedia.prototype.small=function(){switch(this.service){case"twitter":return this.getTwitterPreviewUrl(":small");case"twitpic":case"yfrog":case"lockerz":case"vine":return this.large();case"instagram":return"https://instagr.am/p/"+this.url.split("/").pop()+"/media/?size=m";case"youtube":return"https://img.youtube.com/vi/"+this.mediaId+"/mqdefault.jpg"}},TD.services.TwitterMedia.prototype.medium=function(){switch(this.service){case"twitter":return this.getTwitterPreviewUrl();case"twitpic":case"yfrog":case"lockerz":case"vine":return this.large();case"instagram":return"https://instagr.am/p/"+this.url.split("/").pop()+"/media/?size=l";case"youtube":return"https://img.youtube.com/vi/"+this.mediaId+"/mqdefault.jpg"}},TD.services.TwitterMedia.prototype.large=function(){switch(this.service){case"twitter":return this.getTwitterPreviewUrl(":large");case"twitpic":return"https://twitpic.com/show/full/"+this.urlMatches[2];case"yfrog":return this.url.replace("http://","https://")+":iphone";case"lockerz":return"https://api.plixi.com/api/tpapi.svc/imagefromurl?size=medium&url="+this.url;case"instagram":return"https://instagr.am/p/"+this.url.split("/").pop()+"/media/?size=l";case"youtube":return"https://img.youtube.com/vi/"+this.mediaId+"/hqdefault.jpg";case"vine":return"https://vine.co/v/"+this.mediaId+"/thumb"}},TD.services.TwitterMedia.prototype.chooseVideoVariant=function(){return this.entity.video_info.variants.filter(function(e){return"video/mp4"===e.content_type}).sort(function(e,t){return~~e.bitrate-~~t.bitrate}).pop()},TD.services.TwitterMedia.prototype.getMediaSrcForPreviewSize=function(e){var t=TD.util.isRetina();switch(e){case TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL:return this.small();case TD.vo.Column.MEDIA_PREVIEW_SIZE_MEDIUM:return t?this.medium():this.small();case TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE:return t?this.large():this.medium()}},TD.services.TwitterMedia.prototype.getAnimatedGifForPreview=function(){var e=this.chooseVideoVariant();return{src:e.url,contentType:e.content_type}},TD.services.TwitterMedia.prototype.renderThumb=function(e){var t;if("twitter"===this.service&&"animated_gif"===this.entity.type){var i=this.chooseVideoVariant();return t={src:i.url,contentType:i.content_type},TD.ui.template.render("media/animated_gif",t)}return t={url:this.url,imageSrc:this.thumb(),isVideo:this.isVideo,thumbSizeClass:TD.services.TwitterMedia.thumbSizeClasses[e]},TD.ui.template.render("status/media_thumb",t)},TD.services.TwitterMedia.prototype.renderGridView=function(){var e={mediaId:this.mediaId,isPossiblySensitive:this.isPossiblySensitive,url:this.url,imageSrc:this.small(),isVideo:this.isVideo,thumbClass:TD.services.TwitterMedia.IMAGE_CLASS};return TD.ui.template.render("status/media_image_container",e)},TD.services.TwitterMedia.prototype.renderDetailView=function(){var e,t="narrow"===TD.settings.getColumnWidth();if("twitter"===this.service&&this.isAnimatedGif)return e={isPossiblySensitive:this.isPossiblySensitive,isAnimatedGif:!0,animatedGif:function(){return this.getAnimatedGifForPreview()}.bind(this)},TD.ui.template.render("status/media_thumb",e);if("twitter"===this.service&&this.isVideo){var i=this.entity.video_info.aspect_ratio[0]/this.entity.video_info.aspect_ratio[1],n=TD.services.TwitterMedia.AVAILABLE_COLUMN_SPACE[TD.settings.getColumnWidth()],s=this.chooseVideoVariant();return e={imageSrc:this.entity.media_url_https,videoUrl:s.url,contentType:s.content_type,isPossiblySensitive:this.isPossiblySensitive,mediaId:this.mediaId,autoplay:1,width:n,height:n/i},TD.ui.template.render("media/native_video",e)}return"youtube"!==this.service||t?"vine"!==this.service||t?(e={mediaId:this.mediaId,isPossiblySensitive:this.isPossiblySensitive,url:this.url,imageSrc:this.small(),isVideo:this.isVideo,thumbClass:TD.services.TwitterMedia.IMAGE_CLASS},TD.ui.template.render("status/media_thumb",e)):(e={id:this.mediaId,width:"100%",height:"auto"},TD.ui.template.render("media/vine",e)):(e={id:this.mediaId,startTime:this.startTime,autoplay:0,width:"100%",height:"auto"},TD.ui.template.render("media/youtube",e))},TD.services.TwitterMedia.prototype.renderGallery=function(){var e,t;if("twitter"===this.service&&"animated_gif"===this.entity.type){e="media/animated_gif";var i=this.chooseVideoVariant();t={gifSrc:i.url,contentType:i.content_type}}else if("twitter"===this.service&&this.isVideo){e="media/native_video";var n=this.entity.video_info.aspect_ratio[0]/this.entity.video_info.aspect_ratio[1],s=410,r=s*n,i=this.chooseVideoVariant();t={imageSrc:this.entity.media_url_https,videoUrl:i.url,contentType:i.content_type,mediaId:this.mediaId,autoplay:1,height:s,width:r}}else"youtube"===this.service?(e="media/youtube",t={id:this.mediaId,startTime:this.startTime,autoplay:1,width:TD.services.TwitterMedia.YOUTUBE_GALLERY_WIDTH,height:TD.services.TwitterMedia.YOUTUBE_GALLERY_HEIGHT}):"vine"===this.service?(e="media/vine",t={id:this.mediaId,width:TD.services.TwitterMedia.VINE_GALLERY_WIDTH,height:TD.services.TwitterMedia.VINE_GALLERY_HEIGHT}):(e="status/media_thumb",t={url:this.url,imageSrc:this.large(),thumbClass:TD.services.TwitterMedia.IMAGE_CLASS,needsSecureUrl:this.needsSecureUrl,isGalleryView:!0});return TD.ui.template.render(e,t)},TD.services.TwitterUser=function(e){this.account=e},TD.services.TwitterUser.MINI_SUFFIX="_mini",TD.services.TwitterUser.NORMAL_SUFFIX="_normal",TD.services.TwitterUser.BIGGER_SUFFIX="_bigger",TD.services.TwitterUser.REASONABLY_SMALL_SUFFIX="_reasonably_small",TD.services.TwitterUser.NORMAL_SUFFIX_REGEXP=new RegExp(TD.services.TwitterUser.NORMAL_SUFFIX+"(?!.*"+TD.services.TwitterUser.NORMAL_SUFFIX+")"),TD.services.TwitterUser.BIGGER_SUFFIX_REGEXP=new RegExp(TD.services.TwitterUser.BIGGER_SUFFIX+"(?!.*"+TD.services.TwitterUser.BIGGER_SUFFIX+")"),TD.services.TwitterUser.prototype.fromJSONObject=function(e,t){return t=_.defaults(t||{},{isContributor:!1}),this.id=e.id_str,this.screenName=e.screen_name?e.screen_name.trim():"",this.profileURL="https://twitter.com/"+this.screenName,this.profileImageURL=e.profile_image_url_https,this.avatarSuffixRegex=TD.services.TwitterUser.NORMAL_SUFFIX_REGEXP,TD.util.isRetina()&&(this.profileImageURL=this.profileImageURL.replace(this.avatarSuffixRegex,TD.services.TwitterUser.BIGGER_SUFFIX),this.avatarSuffixRegex=TD.services.TwitterUser.BIGGER_SUFFIX_REGEXP),this.name=e.name?e.name.trim():"",this.location=e.location,this.description=e.description,this.entities=e.entities,this.joinedDate=TD.util.parseDateString(e.created_at),this.friendsCount=e.friends_count,this.listedCount=e.listed_count,this.followersCount=e.followers_count,this.statusesCount=e.statuses_count,this.favoritesCount=e.favourites_count,this.listedCount=e.listed_count,this.url=e.url,this.isProtected=e["protected"],this.isVerified=e.verified,this.isTranslator=e.is_translator,this.isBadged=Boolean(e.verified||e.is_translator),this.following=e.following,this.lang=e.lang,this._profileBannerURL=e.profile_banner_url?e.profile_banner_url+"/web":null,TD.util.isRetina()&&this._profileBannerURL&&(this._profileBannerURL+="_retina"),this._profileBannerURL=this._profileBannerURL?this._profileBannerURL:TD.assets.get("/web/assets/global/backgrounds/td_profile_empty"+(TD.util.isRetina()?"@2x.jpg":".jpg")),e.status&&(this.lastStatus=new TD.services.TwitterStatus(this.account).fromJSONObject(e.status),this.lastStatus.user=this),t.isContributor||TD.cache.twitterUsers.add(this),this},TD.services.TwitterUser.prototype.isSameUser=function(e){var t;return t=e instanceof TD.services.TwitterUser?e.screenName.toLowerCase():e.toLowerCase(),this.screenName.toLowerCase()===t},TD.services.TwitterUser.prototype.isMe=function(){return this.account.getUserID()==this.id},TD.services.TwitterUser.prototype.reasonablySmallProfileImageURL=function(){return this.profileImageURL.replace(this.avatarSuffixRegex,TD.services.TwitterUser.REASONABLY_SMALL_SUFFIX)},TD.services.TwitterUser.prototype.biggerProfileImageURL=function(){return TD.util.isRetina()?this.reasonablySmallProfileImageURL():this.profileImageURL.replace(this.avatarSuffixRegex,TD.services.TwitterUser.BIGGER_SUFFIX)},TD.services.TwitterUser.prototype.miniProfileImageURL=function(){return TD.util.isRetina()?this.profileImageURL.replace(this.avatarSuffixRegex,TD.services.TwitterUser.NORMAL_SUFFIX):this.profileImageURL.replace(this.avatarSuffixRegex,TD.services.TwitterUser.MINI_SUFFIX)},TD.services.TwitterUser.prototype.prettyFollowersCount=function(){return TD.util.prettyNumber(this.followersCount)},TD.services.TwitterUser.prototype.prettyFriendsCount=function(){return TD.util.prettyNumber(this.friendsCount)},TD.services.TwitterUser.prototype.prettyListedCount=function(){return TD.util.prettyNumber(this.listedCount)},TD.services.TwitterUser.prototype.prettyStatusesCount=function(){return TD.util.prettyNumber(this.statusesCount)},TD.services.TwitterUser.prototype.prettyJoinedDate=function(){return TD.util.prettyDateShortString(this.joinedDate)},TD.services.TwitterUser.prototype.prettyTimeDateJoinedDate=function(){return TD.util.prettyTimeString(this.joinedDate)},TD.services.TwitterUser.prototype.follow=function(e,t,i,n){var s,r=TD.controller.clients.getClient(e.getKey()),a=this,o=function(e){a.following=!0,n&&(s=TD.i("Successfully followed @{{screenName}}",a),TD.controller.progressIndicator.addMessage(s)),t&&t(e)},c=function(e){n&&(s=TD.i("Unable to follow @{{screenName}}",a),TD.controller.progressIndicator.addMessage(s)),i&&i()};r.followUser(this.screenName,o,c)},TD.services.TwitterUser.prototype.unfollow=function(e,t,i,n){var s,r=TD.controller.clients.getClient(e.getKey()),a=this,o=function(i){a.removeFromView(e,!0),a.following=!1,n&&(s=TD.i("Successfully unfollowed @{{screenName}}",a),TD.controller.progressIndicator.addMessage(s)),t&&t(i)},c=function(){n&&(s=TD.i("Unable to unfollow @{{screenName}}",a),TD.controller.progressIndicator.addMessage(s)),i&&i()};r.unfollowUser(this.screenName,o,c)},TD.services.TwitterUser.prototype.unblock=function(e,t,i){var n=TD.controller.clients.getClient(e.getKey());n.unblockUser(this.screenName,t,i),$.publish("/user/"+this.screenName+"/unblock",[this.account])},TD.services.TwitterUser.prototype.block=function(e,t,i,n){var s,r=this,a=TD.controller.clients.getClient(e.getKey()),o=function(t){TD.controller.progressIndicator.addMessage(s),r.following=!1,$.publish("/user/"+r.screenName+"/blocked",[r.account]),r.removeFromView(e,!1)};$.publish("/user/"+this.screenName+"/block",[this.account]),t?(a.blockAndReportUser(this.screenName,o,n),s=TD.i("Successfully blocked and reported @{{screenName}}",{screenName:this.screenName})):(a.blockUser(this.screenName,o,n),s=TD.i("Successfully blocked @{{screenName}}",{screenName:this.screenName}))},TD.services.TwitterUser.prototype.removeFromView=function(e,t){$.publish("/user/removeTweets",[this.id,e.getUserID(),t])},TD.services.TwitterUser.prototype.bio=function(){var e=this.entities&&this.entities.description||{};return TD.util.transform(this.description,e)},TD.services.TwitterUser.prototype.htmlLocation=function(){var e=this.entities&&this.entities.location||{};return TD.util.transform(this.location,e)},TD.services.TwitterUser.prototype.hasLocation=function(){return Boolean(this.htmlLocation())},TD.services.TwitterUser.prototype.getFollowerURL=function(){return this.profileURL+"/followers"},TD.services.TwitterUser.prototype.getFriendURL=function(){return this.profileURL+"/following"},TD.services.TwitterUser.prototype.getProfileURL=function(){return this.profileURL},TD.services.TwitterUser.prototype.getMediaURL=function(){return this.profileURL+"/media"},TD.services.TwitterUser.prototype.getMediaSearchQuery=function(){return TD.ui.template.toHtml("from:{{screenName}} (filter:images OR filter:videos)",{screenName:this.screenName})},TD.services.TwitterUser.prototype.getListedURL=function(){return this.profileURL+"/memberships"},TD.services.TwitterUser.prototype.getDisplayURL=function(){var e=this.entities;return e&&e.url&&e.url.urls&&e.url.urls.length&&e.url.urls[0].display_url?e.url.urls[0].display_url:this.url},TD.services.TwitterUser.prototype.profileBannerURL=function(){return this._profileBannerURL},TD.services.TwitterDeletedUser=function(e,t){return this.id=t,this.isDeleted=!0,this.screenName="",this.name=TD.i("Unknown user"),this.isProtected=!1,this.isVerified=!1,this.isTranslator=!1,this.isBadged=!1,this.followersCount=0,this.friendsCount=0,this.listedCount=0,this.statusesCount=0,this.joinedDate=new Date,this},TD.services.TwitterDeletedUser.prototype.isSameUser=function(){return!1},TD.services.TwitterDeletedUser.prototype.isMe=function(){return!1},TD.services.TwitterDeletedUser.prototype.reasonablySmallProfileImageURL=function(){return""},TD.services.TwitterDeletedUser.prototype.biggerProfileImageURL=function(){return""},TD.services.TwitterDeletedUser.prototype.miniProfileImageURL=function(){return""},TD.services.TwitterDeletedUser.prototype.follow=function(){},TD.services.TwitterDeletedUser.prototype.unfollow=function(){},TD.services.TwitterDeletedUser.prototype.unblock=function(){},TD.services.TwitterDeletedUser.prototype.block=function(e,t,i,n){},TD.services.TwitterDeletedUser.prototype.removeFromView=function(e,t){},TD.services.TwitterDeletedUser.prototype.bio=function(){return""},TD.services.TwitterDeletedUser.prototype.htmlLocation=function(){return""},TD.services.TwitterDeletedUser.prototype.hasLocation=function(){return!1},TD.services.TwitterDeletedUser.prototype.getFollowerURL=function(){return""},TD.services.TwitterDeletedUser.prototype.getFriendURL=function(){return""},TD.services.TwitterDeletedUser.prototype.getProfileURL=function(){return""},TD.services.TwitterDeletedUser.prototype.getMediaURL=function(){return""},TD.services.TwitterDeletedUser.prototype.getMediaSearchQuery=function(){return""},TD.services.TwitterDeletedUser.prototype.getListedURL=function(){return""},TD.services.TwitterDeletedUser.prototype.getDisplayURL=function(){return""},TD.services.TwitterDeletedUser.prototype.profileBannerURL=function(){return""},TD.services.TrendingTopic=function(){},TD.services.TrendingTopic.prototype.name="",TD.services.TrendingTopic.prototype.query="",TD.services.TrendingTopic.prototype.url="",TD.services.TrendingTopic.prototype.description="",TD.services.TrendingTopic.prototype.attribution="",TD.services.TrendingTopic.prototype.created=0,TD.services.TrendingTopic.prototype.promotedContent=null,TD.services.TrendingTopic.prototype.events=null,TD.services.TrendingTopic.prototype.fromJSONObject=function(e){return this.name=e.name,this.query=e.query,this.promotedContent=e.promoted_content,this.events=e.events,this.created=(new Date).getTime(),this.query=encodeURIComponent(this.name),this.url||(this.url="http://search.twitter.com/search?q="+this.query),this.promotedContent&&this.promotedContent.description&&(this.description=TD.util.escape(this.promotedContent.description)),this},TD.services.TrendLocation=function(){},TD.services.TrendLocation.prototype.PLACE_TYPE_SUPERNAME=19,TD.services.TrendLocation.prototype.PLACE_TYPE_COUNTRY=12,TD.services.TrendLocation.prototype.PLACE_TYPE_TOWN=7,TD.services.TrendLocation.prototype.placeType=null,TD.services.TrendLocation.prototype.name="",TD.services.TrendLocation.prototype.woeid=-1,TD.services.TrendLocation.prototype.url="",TD.services.TrendLocation.prototype.countryCode="",TD.services.TrendLocation.prototype.country="",TD.services.TrendLocation.prototype.label="",TD.services.TrendLocation.prototype.sortString="",TD.services.TrendLocation.prototype.isTown=!1,TD.services.TrendLocation.prototype.fromJSONObject=function(e){switch(this.name=e.name,this.woeid=e.woeid,this.url=e.url,this.countryCode=e.countryCode,this.country=e.country,this.placeType=e.placeType,this.placeType.code){case this.PLACE_TYPE_TOWN:this.label="—"+this.name,this.sortString=this.country+this.name,this.isTown=!0;break;case this.PLACE_TYPE_SUPERNAME:this.label=this.name.toUpperCase(),this.sortString="";break;default:this.label=this.name,this.sortString=this.name}return this},TD.services.TwitterList=function(e){this.account=e},TD.services.TwitterList.prototype.fromJSONObject=function(e){return this.id=e.id_str,this.name=e.name,this.description=e.description,this.slug=e.slug,this.fullName=e.full_name,this.memberCount=e.member_count,this.isPrivate="private"===e.mode,this.user=new TD.services.TwitterUser(this.account).fromJSONObject(e.user),this},TD.services.TwitterList.prototype.isOwnList=function(){var e=TD.storage.Account.generateKeyFor("twitter",this.user.id),t=TD.storage.accountController.get(e);return Boolean(t)},TD.services.CustomTimeline=function(e){this.account=e},TD.services.CustomTimeline.prototype.fromJSONObject=function(e){return this.id=e.id_str||e.id,this.name=e.name,this.description=e.description,this.url=e.url,this.user=new TD.services.TwitterUser(this.account).fromJSONObject(e.user),this},TD.services.CustomTimeline.prototype.isOwnCustomTimeline=function(){return String(this.account.getUserID())===this.user.id},TD.services.TwitterSearchParser=function(e){this.query=e,this.terms=[],this.init()},TD.services.TwitterSearchParser.PUNCT=new RegExp("["+twttr.txt.regexen.punct.source+"]","g"),TD.services.TwitterSearchParser.ALLOWED_CHARS=["@","#",'"',"-"],TD.services.TwitterSearchParser.isStreamable=function(e){var t=e.match(TD.services.TwitterSearchParser.PUNCT),i=_.difference(t,TD.services.TwitterSearchParser.ALLOWED_CHARS);return 0===i.length},TD.services.TwitterSearchParser.prototype.PHRASE="phrase",TD.services.TwitterSearchParser.prototype.NEGATIVE_PHRASE="negPhrase",TD.services.TwitterSearchParser.prototype.AND="and",TD.services.TwitterSearchParser.prototype.OR="or",TD.services.TwitterSearchParser.prototype.query="",TD.services.TwitterSearchParser.prototype.trackQuery="",TD.services.TwitterSearchParser.prototype.thePhrase="",TD.services.TwitterSearchParser.prototype.type="",TD.services.TwitterSearchParser.prototype.init=function(){if(!this.trackQuery){var e,t;if(t="string"==typeof this.query?TD.services.TwitterSearchParser.extractPhrases(this.query,!1):this.query,0===t.length);else if(1===t.length)this.thePhrase=t[0].toLowerCase(),"-"===this.thePhrase.charAt(0)&&-1===this.thePhrase.indexOf(" ")?(this.type=this.NEGATIVE_PHRASE,this.thePhrase=this.thePhrase.slice(1),this.trackQuery=""):(this.type=this.PHRASE,this.trackQuery=this.thePhrase);else{var i,n=[[]],s=!0;for(i=0;i<t.length;i++)e=t[i],"OR"!==e?"AND"!==e&&(s?_.last(n).push(e):n.push([e]),s=!1):(_.last(n).push(e),s=!0);if(n=_.reject(n,function(e){return _.isEmpty(e)}),n.length>1){for(this.type=this.AND,i=0;i<n.length;i++){var r=n[i];r.length>0&&this.terms.push(new TD.services.TwitterSearchParser(r))}this.trackQuery=this.calculateANDTrackQuery(n)}else for(this.type=this.OR,i=0;i<n[0].length;i++)e=n[0][i],"OR"!=e&&(this.terms.push(new TD.services.TwitterSearchParser([e])),"-"!=e.charAt(0)&&(this.trackQuery&&(this.trackQuery+=","),this.trackQuery+=e))}}},TD.services.TwitterSearchParser.prototype.calculateANDTrackQuery=function(e){for(var t=[""],i=0;i<e.length;i++){for(var n=e[i],s=[],r=0;r<n.length;r++){var a=n[r];if("OR"!=a)if("-"==a.charAt(0))s=t;else for(var o=0;o<t.length;o++){var c=t[o],l=c?c+" ":"";l+=a,s.push(l)}}t=s}return t.join(",")},TD.services.TwitterSearchParser.extractPhrases=function(e,t){for(var i,n=[],s=e.split('"'),r=0;r<s.length;r++)if(s[r])if(r%2==1&&r<s.length-1)i=s[r].trim(),i&&(t&&(i='"'+i+'"'),n.push(i));else for(var a=s[r].split(" "),o=0;o<a.length;o++)i=a[o],i=i.trim(),i&&n.push(i);return n},TD.services.TwitterSearchParser.prototype.match=function(e,t){var i,n,s=new RegExp("(^|[^\\w])"+_.escapeRegExp(this.thePhrase)+"($|[^\\w])");switch(t||(e=e.toLowerCase()),this.type){case this.PHRASE:return-1!==e.indexOf(this.thePhrase)&&s.test(e);case this.NEGATIVE_PHRASE:return-1===e.indexOf(this.thePhrase);case this.AND:for(i=0;i<this.terms.length;i++)if(n=this.terms[i],!n.match(e,!0))return!1;return!0;case this.OR:for(i=0;i<this.terms.length;i++)if(n=this.terms[i],n.match(e,!0))return!0;return!1;default:return!1}},TD.services.StreamEngine=klass(function(e,t){this._account=e,this._callback=t,this._url="",this._state=TD.services.StreamEngine.DISCONNECTED,this._stream=null,this._backoffLimit=0,this._backoffTimeout=null,this._keepaliveTimeout=null,this._handleData=TD.util.bind(this._handleData,this),this._handleStreamInterruption=TD.util.bind(this._handleStreamInterruption,this),this.connect=_.debounce(this._connect,50)}).statics({BACKOFF_PERIOD_MIN:2e4,BACKOFF_PERIOD_MAX:24e4,BACKOFF_PERIOD_MAX_EXTENDED:72e4,KEEPALIVE_PERIOD:9e4,XHR_BYTE_LIMIT:5e7,DISCONNECTED:"disconnected",CONNECTING:"connecting",STREAMING:"streaming",DEBUG:!1}).methods({log:function(){TD.services.StreamEngine.DEBUG&&(console.log((new Date).toUTCString(),">",this._account.getUsername(),">",arguments),TD.util.insertLogDivider())},_connect:function(e){return e===this._url?void this.log("Connect",e,"Already connecting/connected. Do nothing"):void(e?(this.log("Connect",e),this.disconnect(),this._url=e,this._startNewStream()):(this.log("Connect",e,"Nothing to stream. Disconnecting"),this.disconnect()))},disconnect:function(){this.log("Disconnect completely"),this._setState(TD.services.StreamEngine.DISCONNECTED),this._disconnectStream(),this._url="",this._backoffLimit=0},isStreaming:function(){var e=this._state===TD.services.StreamEngine.STREAMING;return this.log("isStreaming",e),e},_setState:function(e){var t=this._state===TD.services.StreamEngine.STREAMING,i=e===TD.services.StreamEngine.STREAMING;this._state=e,t!==i&&$(document).trigger("dataUserStreamStatus",{accountKey:this._account.getKey(),streaming:i})},_startNewStream:function(){this._disconnectStream(),this.log("Start stream"),this._setState(TD.services.StreamEngine.CONNECTING),this._stream=this._createStreamRequest(),this._stream.goStreaming()},_disconnectStream:function(){this._stream&&(this.log("Disconnect stream"),this._stream.onStreaming.disconnect&&(this._stream.onStreaming.disconnect(this._handleData),this._stream.onFailure.disconnect(this._handleStreamInterruption)),this._stream.deleteLater(),this._stream=null),clearTimeout(this._backoffTimeout),clearTimeout(this._keepaliveTimeout),this._backoffTimeout=null,this._keepaliveTimeout=null},_handleData:function(e){var t=this;switch(this._state){case TD.services.StreamEngine.DISCONNECTED:return;case TD.services.StreamEngine.CONNECTING:this._setState(TD.services.StreamEngine.STREAMING),this._backoffLimit=0,this.log("Stream is functioning")}this._processDataString(e),clearTimeout(this._keepaliveTimeout),this._keepaliveTimeout=setTimeout(function(){t._handleStreamInterruption("Keepalive timeout",0)},TD.services.StreamEngine.KEEPALIVE_PERIOD),this._stream.receivedChars>TD.services.StreamEngine.XHR_BYTE_LIMIT&&(this.log("Reached XHR byte limit, reconnecting"),this._startNewStream())},_processDataString:function(e){var t,i,n=0;if(e){t=e.split("\r");for(var s=0;s<t.length;s++)i=_.strip(t[s]),i.length&&(n++,this._callback(JSON.parse(i)));$(document).trigger("dataReceivedStreamData",{numStreamItems:n})}},_handleStreamInterruption:function(e,t){switch(this.log("Stream interrupted",e,t),this._state){case TD.services.StreamEngine.DISCONNECTED:break;case TD.services.StreamEngine.CONNECTING:this._disconnectStream(),this._setBackoffTimeout(t);break;case TD.services.StreamEngine.STREAMING:this._startNewStream()}},_setBackoffTimeout:function(e){var t=this;this._backoffLimit=Math.max(this._backoffLimit,TD.services.StreamEngine.BACKOFF_PERIOD_MIN),this._backoffLimit*=2,this._backoffLimit="420"===String(e)?Math.min(this._backoffLimit,TD.services.StreamEngine.BACKOFF_PERIOD_MAX_EXTENDED):Math.min(this._backoffLimit,TD.services.StreamEngine.BACKOFF_PERIOD_MAX);var i=this._backoffLimit/2,n=i+Math.ceil(Math.random()*i);this.log("Set backoff timeout",(n/1e3).toString()+"s"),this._setState(TD.services.StreamEngine.CONNECTING),this._backoffTimeout=setTimeout(function(){t.log("Backoff complete, attempting reconnect"),t._startNewStream()},n)},_createStreamRequest:function(){var e=new TD.net.StreamRequest(this._url,this._account);return e.onStreaming.connect(this._handleData),e.onFailure.connect(this._handleStreamInterruption),e}}),TD.services.TwitterAction=function(e){this.account=e},TD.services.TwitterAction.FAVORITE="favorite",TD.services.TwitterAction.RETWEET="retweet",TD.services.TwitterAction.MENTION="mention",TD.services.TwitterAction.REPLY="reply",TD.services.TwitterAction.FOLLOW="follow",TD.services.TwitterAction.LIST_MEMBER_ADDED="list_member_added",TD.services.TwitterAction.LIST_CREATED="list_created",TD.services.TwitterAction.UNFAVORITE="unfavorite",TD.services.TwitterAction.LIST_MEMBER_REMOVED="list_member_removed",TD.services.TwitterAction.LIST_DESTROYED="list_destroyed",TD.services.TwitterAction.UNFOLLOW="unfollow",TD.services.TwitterAction.processStreamAction=function(e,t){var i=TD.services.TwitterAction._getActionConstructor(e.event);return new i(t).fromJSONObject(e,null,!0)},TD.services.TwitterAction.processRESTAction=function(e,t){for(var i=TD.services.TwitterAction._getActionConstructor(e.action),n=e.sources,s=e.targets_size>0?e.targets:[void 0],r=e.target_objects_size>0?e.target_objects:[void 0],a=[],o=0;o<n.length;o++)if(e.action!==TD.services.TwitterAction.RETWEET)for(var c=0;c<s.length;c++)for(var l=0;l<r.length;l++)(e.action!==TD.services.TwitterAction.LIST_MEMBER_ADDED||n[o].id===r[l].user.id)&&a.push([e,n[o],s[c],r[l]]);else{if(r[0].user.id!=t.getUserID())continue;a.push([e,n[o],s[o],r[0]])}var u=_.map(a,function(n){return new i(t).fromJSONObject(e,n,!1)});return u},TD.services.TwitterAction._getActionConstructor=function(e){switch(e){case TD.services.TwitterAction.MENTION:case TD.services.TwitterAction.REPLY:return TD.services.TwitterActionMention;case TD.services.TwitterAction.FAVORITE:case TD.services.TwitterAction.UNFAVORITE:return TD.services.TwitterActionFavorite;case TD.services.TwitterAction.RETWEET:return TD.services.TwitterActionRetweet;case TD.services.TwitterAction.FOLLOW:case TD.services.TwitterAction.UNFOLLOW:return TD.services.TwitterActionFollow;case TD.services.TwitterAction.LIST_MEMBER_ADDED:case TD.services.TwitterAction.LIST_MEMBER_REMOVED:return TD.services.TwitterActionListMemberAdded;case TD.services.TwitterAction.LIST_CREATED:case TD.services.TwitterAction.LIST_DESTROYED:return TD.services.TwitterActionListCreated;default:return TD.services.TwitterAction}},TD.services.TwitterAction.prototype=new TD.services.ChirpBase,TD.services.TwitterAction.prototype.getChirpType=function(){return this.action},TD.services.TwitterAction.prototype.action=null,TD.services.TwitterAction.prototype.maxPosition=null,TD.services.TwitterAction.prototype.minPosition=null,TD.services.TwitterAction.msFudge=0,TD.services.TwitterAction.prototype.fromJSONObject=function(e,t,i){return i?this.fromStreamData(e):this.fromRESTData.apply(this,t),this.created=TD.util.parseDateString(e.created_at),this.maxPosition=e.max_position||this.created.getTime().toString(),this.minPosition=e.min_position||this.created.getTime().toString(),this.generateInternalID(),this.generateText(),this},TD.services.TwitterAction.prototype.fromRESTData=function(e,t,i,n){throw"TwitterAction.fromRESTData not implemented"},TD.services.TwitterAction.prototype.fromStreamData=function(e){throw"TwitterAction.fromStreamData not implemented"},TD.services.TwitterAction.prototype.generateInternalID=function(){throw"TwitterAction.generateInternalID not implemented"},TD.services.TwitterAction.prototype.generateText=function(){},TD.services.TwitterAction.prototype.render=function(){throw"TwitterAction.render not implemented"},TD.services.TwitterAction.prototype.renderNotification=function(){throw"TwitterAction.renderNotification not implemented"},TD.services.TwitterAction.prototype.isAboutYou=function(){throw"TwitterAction.isAboutYou not implemented"},TD.services.TwitterAction.prototype.isOwnChirp=function(){throw"TwitterAction.isOwnChirp not implemented"},TD.services.TwitterAction.prototype.getChirpURL=function(){return"https://twitter.com/activity"},TD.services.TwitterAction.prototype.getCreator=function(){throw"TwitterAction.getCreator not implemented"},TD.services.TwitterAction.prototype.getSenders=function(){return[this.getCreator().screenName]},TD.services.TwitterAction.prototype.isFromVerifiedUser=function(){return this.getCreator().isVerified},TD.services.TwitterAction.prototype.getTargetUsers=function(){throw"TwitterAction.getTargetUsers not implemented"},TD.services.TwitterActionOnTweet=function(e){this.account=e},TD.services.TwitterActionOnTweet.prototype=new TD.services.TwitterAction,TD.services.TwitterActionOnTweet.prototype.sourceUser=null,TD.services.TwitterActionOnTweet.prototype.targetTweet=null,TD.services.TwitterActionOnTweet.prototype.generateInternalID=function(){this.id=[this.action,this.sourceUser.id,this.targetTweet.id].join("_")},TD.services.TwitterActionOnTweet.prototype.isAboutYou=function(){return this.targetTweet.user.id==this.account.getUserID()},TD.services.TwitterActionOnTweet.prototype.isOwnChirp=function(){return this.sourceUser.id==this.account.getUserID()},TD.services.TwitterActionOnTweet.prototype.getRelatedTweet=function(){return this.targetTweet},TD.services.TwitterActionOnTweet.prototype.getCreator=function(){return this.sourceUser},TD.services.TwitterActionOnTweet.prototype.render=function(e){e=e||{};var t=TD.settings.getDisplaySensitiveMedia(),i=this.isAboutYou(),n=this.action===TD.services.TwitterAction.MENTION;return TD.ui.template.render("status/tweet_activity_in_stream",$.extend(e,{chirp:this,sourceAvatar:i?this.sourceUser.miniProfileImageURL():null,withActivityHeader:!n,withTweetActions:!0,withFooter:!0,withAvatar:!i||n,withSourceMute:!i,withContentMute:i&&!n,withMediaPreview:e.mediaPreviewSize!==TD.vo.Column.MEDIA_PREVIEW_OFF,isMediaPreviewSmall:e.mediaPreviewSize===TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL,isMediaPreviewLarge:e.mediaPreviewSize===TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE,mediaPreviewSrc:function(){return this.getMediaSrcForPreviewSize(e.mediaPreviewSize)},animatedGif:function(){return this.getAnimatedGifForPreview()},renderQuoted:function(){return this.renderQuotedTweet(e)},thumbSizeClass:TD.services.TwitterMedia.thumbSizeClasses[e.mediaPreviewSize],isPossiblySensitive:this.targetTweet.possiblySensitive&&!t,withLinebreaks:!0}))},TD.services.TwitterActionOnTweet.prototype.renderNotification=function(){var e=this.isAboutYou(),t=this.action===TD.services.TwitterAction.MENTION;return TD.ui.template.render("status/tweet_activity_in_box",{chirp:this,icon:this.iconClass,sourceAvatar:e?this.sourceUser.miniProfileImageURL():null,withAvatar:!e||t,withActivityHeader:!t,withSourceMute:!e,
withContentMute:e&&!t})},TD.services.TwitterActionOnTweet.prototype.getGrowlData=function(){return{title:this.text,img:this.targetTweet.user.profileImageURL,text:$("<div>"+this.targetTweet.htmlText+"</div>").text()}},TD.services.TwitterActionOnTweet.prototype.getMedia=function(){return this.getRelatedTweet().getMedia()},TD.services.TwitterActionOnTweet.prototype.getTargetUsers=function(){return[this.targetTweet.user]},TD.services.TwitterActionRetweet=function(e){this.account=e},TD.services.TwitterActionRetweet.prototype=new TD.services.TwitterActionOnTweet,TD.services.TwitterActionRetweet.prototype.action=TD.services.TwitterAction.RETWEET,TD.services.TwitterActionRetweet.prototype.iconClass="icon-retweet txt-r-medium-green",TD.services.TwitterActionRetweet.prototype.retweet=null,TD.services.TwitterActionRetweet.prototype.fromRESTData=function(e,t,i,n){this.sourceUser=new TD.services.TwitterUser(this.account).fromJSONObject(t),this.retweet=new TD.services.TwitterStatus(this.account).fromJSONObject(i),this.targetTweet=new TD.services.TwitterStatus(this.account).fromJSONObject(n)},TD.services.TwitterActionRetweet.prototype.fromStreamData=function(e){this.sourceUser=new TD.services.TwitterUser(this.account).fromJSONObject(e.source),this.retweet=new TD.services.TwitterStatus(this.account).fromJSONObject(e.target),this.targetTweet=this.retweet.retweetedStatus},TD.services.TwitterActionRetweet.prototype.fromRetweet=function(e){return this.sourceUser=e.user,this.retweet=e,this.targetTweet=e.retweetedStatus,this.created=new Date(e.created),this.generateInternalID(),this.generateText(),this.maxPosition=this.minPosition=this.created.getTime().toString(),this},TD.services.TwitterActionRetweet.prototype.generateText=function(){var e=TD.i("{{{user}}} retweeted",null,!0);this.text=TD.ui.template.toHtml(e,{user:this.sourceUser.name}),this.htmlText=TD.ui.template.toHtml(e,{user:TD.ui.template.render("text/user_link_fullname",{name:this.sourceUser.name,profileUrl:this.sourceUser.getProfileURL(),withBold:this.isAboutYou()})})},TD.services.TwitterActionMention=function(e){this.account=e},TD.services.TwitterActionMention.prototype=new TD.services.TwitterActionOnTweet,TD.services.TwitterActionMention.prototype.action=TD.services.TwitterAction.MENTION,TD.services.TwitterActionMention.prototype.iconClass="icon-mention icon-mention-color",TD.services.TwitterActionMention.prototype.fromRESTData=function(e,t,i,n){this.targetTweet=new TD.services.TwitterStatus(this.account).fromJSONObject("reply"===e.action?i:n),this.sourceUser=new TD.services.TwitterUser(this.account).fromJSONObject(t)},TD.services.TwitterActionMention.prototype.fromStreamData=function(e){return this.sourceUser=e.user,this.targetTweet=e,this.created=new Date(e.created),this.generateInternalID(),this.generateText(),this.maxPosition=this.minPosition=this.created.getTime().toString(),this},TD.services.TwitterActionMention.prototype.generateText=function(){var e=TD.i("{{{user}}} mentioned you",null,!0);this.text=TD.ui.template.toHtml(e,{user:this.sourceUser.name}),this.htmlText=TD.ui.template.toHtml(e,{user:TD.ui.template.render("text/user_link_fullname",{name:this.sourceUser.name,profileUrl:this.sourceUser.getProfileURL(),withBold:this.isAboutYou()})})},TD.services.TwitterActionMention.prototype.isAboutYou=function(){return!0},TD.services.TwitterActionListCreated=function(e){this.account=e},TD.services.TwitterActionListCreated.prototype=new TD.services.TwitterAction,TD.services.TwitterActionListCreated.prototype.action=TD.services.TwitterAction.LIST_CREATED,TD.services.TwitterActionListCreated.prototype.owner=null,TD.services.TwitterActionListCreated.prototype.list=null,TD.services.TwitterActionListCreated.prototype.fromRESTData=function(e,t,i){this.owner=new TD.services.TwitterUser(this.account).fromJSONObject(t),this.list=new TD.services.TwitterList(this.account).fromJSONObject(i)},TD.services.TwitterActionListCreated.prototype.fromStreamData=function(e){this.owner=new TD.services.TwitterUser(this.account).fromJSONObject(e.source),this.list=new TD.services.TwitterList(this.account).fromJSONObject(e.target_object)},TD.services.TwitterActionListCreated.prototype.generateInternalID=function(){this.id=[this.action,this.owner.id,this.list.id].join("_")},TD.services.TwitterActionListCreated.prototype.generateText=function(){var e=TD.i("{{{owner}}} created the list {{{list}}}",null,!0);this.text=TD.ui.template.toHtml(e,{owner:this.owner.name,list:this.list.fullName}),this.htmlText=TD.ui.template.toHtml(e,{owner:TD.ui.template.render("text/user_link_fullname",{name:this.owner.name,profileUrl:this.owner.getProfileURL(),withBold:!0}),list:TD.ui.template.render("text/list_link_real_name",this.list)})},TD.services.TwitterActionListCreated.prototype.isOwnChirp=function(){return this.owner.id==this.account.getUserID()},TD.services.TwitterActionListCreated.prototype.isAboutYou=function(){return!1},TD.services.TwitterActionListCreated.prototype.getCreator=function(){return this.owner},TD.services.TwitterActionListCreated.prototype.getTargetUsers=function(){return[]},TD.services.TwitterActionListCreated.prototype.render=function(){var e={chirp:this,sourceAvatar:this.owner.miniProfileImageURL()};return TD.ui.template.render("status/list_activity",e)},TD.services.TwitterActionListCreated.prototype.renderNotification=function(){return this.render(null)},TD.services.TwitterActionListCreated.prototype.getGrowlData=function(){return{title:this.text,img:null,text:this.list.description}},TD.services.TwitterActionListMemberAdded=function(e){this.account=e},TD.services.TwitterActionListMemberAdded.prototype=new TD.services.TwitterAction,TD.services.TwitterActionListMemberAdded.prototype.action=TD.services.TwitterAction.LIST_MEMBER_ADDED,TD.services.TwitterActionListMemberAdded.prototype.owner=null,TD.services.TwitterActionListMemberAdded.prototype.added=null,TD.services.TwitterActionListMemberAdded.prototype.list=null,TD.services.TwitterActionListMemberAdded.prototype.fromRESTData=function(e,t,i,n){this.owner=new TD.services.TwitterUser(this.account).fromJSONObject(t),this.added=new TD.services.TwitterUser(this.account).fromJSONObject(i),this.list=new TD.services.TwitterList(this.account).fromJSONObject(n)},TD.services.TwitterActionListMemberAdded.prototype.fromStreamData=function(e){this.owner=new TD.services.TwitterUser(this.account).fromJSONObject(e.source),this.added=new TD.services.TwitterUser(this.account).fromJSONObject(e.target),this.list=new TD.services.TwitterList(this.account).fromJSONObject(e.target_object)},TD.services.TwitterActionListMemberAdded.prototype.generateInternalID=function(){this.id=[this.action,this.owner.id,this.added.id,this.list.id].join("_")},TD.services.TwitterActionListMemberAdded.prototype.generateText=function(){var e;e=this.isAboutYou()?TD.i("{{{owner}}} added you to their list {{{list}}}",null,!0):TD.i("{{{owner}}} added {{{added}}} to their list {{{list}}}",null,!0),this.text=TD.ui.template.toHtml(e,{owner:this.owner.name,added:this.added.name,list:this.list.name}),this.htmlText=TD.ui.template.toHtml(e,{owner:TD.ui.template.render("text/user_link_fullname",{name:this.owner.name,profileUrl:this.owner.getProfileURL(),withBold:!0}),added:TD.ui.template.render("text/user_link_fullname",{name:this.added.name,profileUrl:this.added.getProfileURL(),withBold:!0}),list:TD.ui.template.render("text/list_link_real_name",this.list)})},TD.services.TwitterActionListMemberAdded.prototype.isOwnChirp=function(){return this.owner.id==this.account.getUserID()},TD.services.TwitterActionListMemberAdded.prototype.isAboutYou=function(){return this.added.id==this.account.getUserID()},TD.services.TwitterActionListMemberAdded.prototype.getCreator=function(){return this.owner},TD.services.TwitterActionListMemberAdded.prototype.getTargetUsers=function(){return[this.added]},TD.services.TwitterActionListMemberAdded.prototype.render=function(){var e={chirp:this,sourceAvatar:this.owner.miniProfileImageURL()};return TD.ui.template.render("status/list_activity",e)},TD.services.TwitterActionListMemberAdded.prototype.renderNotification=function(){return this.render(null)},TD.services.TwitterActionListMemberAdded.prototype.getGrowlData=function(){return{title:this.text,img:null,text:this.list.description}},TD.services.TwitterActionMultiListMemberAdded=function(e){this.account=e},TD.services.TwitterActionMultiListMemberAdded.prototype=new TD.services.TwitterAction,TD.services.TwitterActionMultiListMemberAdded.prototype.action="multi_list_member_added",TD.services.TwitterActionMultiListMemberAdded.prototype.owner=null,TD.services.TwitterActionMultiListMemberAdded.prototype.added=null,TD.services.TwitterActionMultiListMemberAdded.prototype.lists=null,TD.services.TwitterActionMultiListMemberAdded.prototype.fromRESTData=function(e){this.owner=new TD.services.TwitterUser(this.account).fromJSONObject(e.sources[0]),this.added=_.map(e.targets,function(e){return new TD.services.TwitterUser(this.account).fromJSONObject(e)}),this.lists=_.map(e.target_objects,function(e){return new TD.services.TwitterList(this.account).fromJSONObject(e)})},TD.services.TwitterActionMultiListMemberAdded.prototype.generateInternalID=function(){var e=_.pluck(this.added,"id").sort().join("-"),t=_.pluck(this.lists,"id").sort().join("-");this.id=[this.action,this.owner.id,e,t].join("_")},TD.services.TwitterActionMultiListMemberAdded.prototype.generateText=function(){var e=TD.i("{{{owner}}} added {{{added}}} to the lists {{{lists}}}",null,!0),t=[],i=[],n=[],s=[];_.each(this.added,function(e){t.push(e.name),i.push(TD.ui.template.render("text/user_link_fullname",{name:e.name,profileUrl:e.getProfileURL(),withBold:!0}))}),_.each(this.lists,function(e){n.push(e.fullName),s.push(TD.ui.template.render("text/list_link_real_name",e))}),this.text=TD.ui.template.toHtml(e,{owner:this.owner.name,added:t.join(", "),lists:n.join(", ")}),this.htmlText=TD.ui.template.toHtml(e,{owner:TD.ui.template.render("text/user_link_fullname",{name:this.owner.name,profileUrl:this.owner.getProfileURL(),withBold:this.isAboutYou()}),added:i.join(", "),lists:s.join(", ")})},TD.services.TwitterActionMultiListMemberAdded.prototype.isOwnChirp=function(){return!1},TD.services.TwitterActionMultiListMemberAdded.prototype.isAboutYou=function(){return!1},TD.services.TwitterActionMultiListMemberAdded.prototype.getCreator=function(){return this.owner},TD.services.TwitterActionMultiListMemberAdded.prototype.getTargetUsers=function(){return this.added},TD.services.TwitterActionMultiListMemberAdded.prototype.render=function(){var e={chirp:this,sourceAvatar:this.owner.miniProfileImageURL()};return TD.ui.template.render("status/action_list",e)},TD.services.TwitterActionMultiListMemberAdded.prototype.renderNotification=function(){return this.render(null)},TD.services.TwitterActionMultiListMemberAdded.prototype.getGrowlData=function(){return{title:null,img:null,text:this.text}},TD.services.TwitterActionFavorite=function(e){this.account=e},TD.services.TwitterActionFavorite.prototype=new TD.services.TwitterActionOnTweet,TD.services.TwitterActionFavorite.prototype.action=TD.services.TwitterAction.FAVORITE,TD.services.TwitterActionFavorite.prototype.iconClass="icon-favorite txt-r-deep-yellow txt-base-medium",TD.services.TwitterActionFavorite.prototype.fromRESTData=function(e,t,i,n){this.sourceUser=new TD.services.TwitterUser(this.account).fromJSONObject(t),this.targetTweet=new TD.services.TwitterStatus(this.account).fromJSONObject(i)},TD.services.TwitterActionFavorite.prototype.fromStreamData=function(e){this.sourceUser=new TD.services.TwitterUser(this.account).fromJSONObject(e.source),this.targetTweet=new TD.services.TwitterStatus(this.account).fromJSONObject(e.target_object)},TD.services.TwitterActionFavorite.prototype.generateText=function(){var e=TD.i("{{{user}}} favorited",null,!0);this.text=TD.ui.template.toHtml(e,{user:this.sourceUser.name}),this.htmlText=TD.ui.template.toHtml(e,{user:TD.ui.template.render("text/user_link_fullname",{name:this.sourceUser.name,profileUrl:this.sourceUser.getProfileURL(),withBold:this.isAboutYou()})})},TD.services.TwitterActionFollow=function(e){this.account=e},TD.services.TwitterActionFollow.prototype=new TD.services.TwitterAction,TD.services.TwitterActionFollow.prototype.action=TD.services.TwitterAction.FOLLOW,TD.services.TwitterActionFollow.prototype.following=null,TD.services.TwitterActionFollow.prototype.followed=null,TD.services.TwitterActionFollow.prototype.fromRESTData=function(e,t,i,n){this.following=new TD.services.TwitterUser(this.account).fromJSONObject(t),this.followed=new TD.services.TwitterUser(this.account).fromJSONObject(i)},TD.services.TwitterActionFollow.prototype.fromStreamData=function(e){this.following=new TD.services.TwitterUser(this.account).fromJSONObject(e.source),this.followed=new TD.services.TwitterUser(this.account).fromJSONObject(e.target)},TD.services.TwitterActionFollow.prototype.generateInternalID=function(){this.id=[this.action,this.following.id,this.followed.id].join("_")},TD.services.TwitterActionFollow.prototype.generateText=function(){var e;e=this.isAboutYou()?TD.i("{{{user}}} followed you",null,!0):TD.i("{{{user}}} followed",null,!0),this.text=TD.ui.template.toHtml(e,{user:this.following.name}),this.htmlText=TD.ui.template.toHtml(e,{user:TD.ui.template.render("text/user_link_fullname",{name:this.following.name,profileUrl:this.following.getProfileURL(),withBold:this.isAboutYou()})})},TD.services.TwitterActionFollow.prototype.render=function(){var e=this.isAboutYou();return TD.ui.template.render("status/follow_activity_in_stream",{data:this,iconClass:"icon-follow icon-follow-color",withoutAvatar:e,withAlignAvatarToContent:e,sourceAvatar:e?this.following.miniProfileImageURL():null,withSourceMute:!this.isAboutYou(),withContentMute:this.isAboutYou(),withActivityHeader:!0,withUserMenu:!0,withUserBio:!0})},TD.services.TwitterActionFollow.prototype.renderNotification=function(){var e=this.isAboutYou();return TD.ui.template.render("status/follow_activity_in_box",{iconClass:"icon-follow icon-follow-color",withoutAvatar:e,withAlignAvatarToContent:e,sourceAvatar:e?this.following.miniProfileImageURL():null,withSourceMute:!this.isAboutYou(),withContentMute:this.isAboutYou(),withActivityHeader:!0,data:this})},TD.services.TwitterActionFollow.prototype.isAboutYou=function(){return this.followed.id==this.account.getUserID()},TD.services.TwitterActionFollow.prototype.isOwnChirp=function(){return this.following.id==this.account.getUserID()},TD.services.TwitterActionFollow.prototype.getGrowlData=function(){var e=this.getRelatedUser();return{title:this.text,img:e.profileImageURL,text:"@"+e.screenName+"\n"+e.description}},TD.services.TwitterActionFollow.prototype.getTargetUsers=function(){return[this.followed]},TD.services.TwitterActionFollow.prototype.getRelatedUser=function(){return this.isAboutYou()?this.following:this.followed},TD.services.TwitterActionFollow.prototype.getCreator=function(){return this.following},TD.services.TwitterActionFollow.prototype.getFilterableText=function(){return this.followed.screenName},function(){"use strict";var e={AlreadyRetweeted:TD.i("Already retweeted"),InvalidUrl:TD.i("Contained an invalid URL"),UserSuspended:TD.i("User has been suspended"),Duplicate:TD.i("Status was a duplicate"),InvalidImage:TD.i("Invalid image"),RateLimitExceeded:TD.i("Rate limit exceeded"),Unknown:TD.i("Unknown error")};TD.services.ScheduledTweet=function(){},TD.services.ScheduledTweet.prototype.chirpType=TD.services.ChirpBase.SCHEDULED_TWEET,TD.services.ScheduledTweet.prototype.fromJSONObject=function(t){if(this.id=t.id_str,this.text=t.text,this.state=t.state,this.createdAt=new Date(t.created_at_ms),this.created=TD.util.iso8601(this.createdAt),this.executeAt=new Date(t.execute_at_ms),this.timestamp=TD.util.iso8601(this.executeAt),this.inReplyToStatusId=t.in_reply_to_status_id,this.retweetedStatusId=t.retweeted_status_id,this.mediaId=t.media_id,this.tweetCreateState=t.tweet_create_state,"failed"===this.state){var i=e[this.tweetCreateState]||e.Unknown;this.reasonText=TD.i("Tweet not sent")+": "+i}t.preview_images_response=t.preview_images_response||{},t.preview_images_response.variants=t.preview_images_response.variants||[];var n=t.preview_images_response.variants.filter(function(e){return e.id_str=t.media_id,e.type="photo","preview-orig"===e.name});return this._media=TD.services.TwitterMedia.getMediaFromEntities({media:n},{isScheduled:!0}),this.account=TD.storage.accountController.getAccountFromId(t.user_id_str),this.user={avatar:TD.util.transformTwitterAvatar(this.account.getProfileImageURL(),"mini"),screenName:this.account.getUsername()},this.token=TD.core.sha1([this.id].join(":")),this}}(),function(){"use strict";function e(e){this.token=e,this.id=e,this.updates=[],this.thumbSizeClass=TD.services.TwitterMedia.thumbSizeClasses.medium}TD.services.ScheduledTweetGroup=e,e.prototype=new TD.services.ChirpBase,e.prototype.chirpType=TD.services.ChirpBase.SCHEDULED_TWEET_GROUP,e.prototype.addUpdate=function(e){this.time||(this.time=TD.util.parseISO8601(e.timestamp),this.created=this.time,this.sortIndex=this.sortIndex={value:-this.created.getTime(),type:"number"}),this.text=this.text||e.text,this.state=this.state||e.state,this._media=this._media||e._media,this.htmlText=this.htmlText||TD.util.transform(this.text),this.inReplyToStatusId=this.inReplyToStatusId||e.inReplyToStatusId,this.retweetedStatusId=this.retweetedStatusId||e.retweetedStatusId,this.avatarURL=this.avatarURL||e.user.avatar,this.reasonText=this.reasonText||e.reasonText,this.updates.push(e)},e.prototype.render=function(){try{return TD.ui.template.render("status/scheduled_tweet",{chirp:this,inStream:!0})}catch(e){console.error(e)}},e.prototype.renderInMediaGallery=function(){return TD.ui.template.render("status/scheduled_tweet",{chirp:this,withTweetActionsVisible:!0,inBox:!0})},e.prototype.update=function(e){var t=!1;return Object.keys(this).forEach(function(i){"updates"!==i&&""+this[i]!=""+e[i]&&(t=!0,this[i]=e[i])}.bind(this)),t&&(this.updates=e.updates.slice()),t},e.prototype.edit=function(){$(document).trigger("uiEditScheduledTweetGroup",{scheduledTweetGroup:this})},e.prototype.destroy=function(){confirm("Are you sure you wish to delete this scheduled tweet?")&&$(document).trigger("uiDeleteScheduledTweetGroup",{scheduledTweetGroup:this})},e.prototype.prettyTime=function(){return TD.util.prettyTimeString(this.time)},e.prototype.isOwnChirp=function(){return!0},e.prototype.getSenders=function(){return _.map(this.updates,function(e){return e.user.screenName})},e.prototype.mediaPreviewSrc=function(){return this.url},e.prototype.canEdit=function(){return!this.hasMedia()&&TD.decider.hasAccessLevel("scheduler","WRITE")}}(),TD.services.TweetDeckClient=function(){var e={},t=(TD.core.defer,TD.sync.tdapi);return e.type="tweetdeck",e.statusMenuTemplate="",e.getChirpsForFeed=function(){return TD.core.defer.succeed([])},e.forgotPassword=function(e,i,n){var s={type:"DELETE",headers:{Authorization:"x-td-basic "+TD.core.base64.encode(e+":junk")}},r=t.drequest("/password",s);return r.addCallback(function(t){return{httpStatus:200,email:e}}),r.addErrback(function(t){return{httpStatus:t.number,message:t.message,data:t.req.responseJSON,email:e}}),r},e.feedIsStreaming=function(e){return!1},e},TD.services.DataminrAlert=function(e){this.account=e},TD.services.DataminrAlert.prototype=new TD.services.TwitterStatus,TD.services.DataminrAlert.prototype.chirpType=TD.services.ChirpBase.DATAMINR_ALERT,TD.services.DataminrAlert.prototype.dataminr=null,TD.services.DataminrAlert.prototype.fromJSONObject=function(e){return TD.services.TwitterStatus.prototype.fromJSONObject.call(this,e.displayTweet),this.sortIndex={value:e.eventTime,type:"milliseconds"},this.dataminr={},e.alertType&&(this.dataminr.alertType=e.alertType,this.dataminr.alertType.alertTypeSprite=this.getAlertTypeSpriteClass(e.alertType.id)),this.dataminr.created=new Date(e.eventTime),this.dataminr.createdAt=TD.util.prettyTimeOfDayString(this.dataminr.created),this.dataminr.eventVolume=e.eventVolume,this.dataminr.eventLocation=e.eventLocation,this.dataminr.publisherCategory=e.publisherCategory,this.dataminr.headerLabel=e.headerLabel,this.dataminr.expandAlertURL=e.expandAlertURL,this.dataminr.eventMapSmallImageURL=e.eventMapSmallURL,this.dataminr.eventMapLargeImageURL=e.eventMapLargeURL,this.dataminr.expandMapURL=e.expandMapURL,this.dataminr.relatedTerms=e.relatedTerms,this.dataminr.userTopHashtags=e.userTopHashtags,this.dataminr.userRecentImages=e.userRecentImages,this.dataminr.userTopHashtags.forEach(function(e){e.text=e.text.replace(/^#?/,"#")}),e.publisherCategory.shortName&&(this.dataminr.publisherCategory.shortName=e.publisherCategory.shortName.toLowerCase()),this.dataminr.relatedTerms.forEach(this.augmentWithQueryTermAndTwitterSearchUrl),this.dataminr.userTopHashtags.forEach(this.augmentWithQueryTermAndTwitterSearchUrl),this.dataminr.allRelatedTermsQuery=this.getQueryStringForAllRelatedTerms(),this.dataminr.anyRelatedTermsQuery=this.getQueryStringForAnyRelatedTerms(),this.dataminr.allRelatedTermsTwitterUrl=TD.net.util.addURLParam("https://twitter.com/search","q",this.dataminr.allRelatedTermsQuery),this.dataminr.anyRelatedTermsTwitterUrl=TD.net.util.addURLParam("https://twitter.com/search","q",this.dataminr.anyRelatedTermsQuery),this},TD.services.DataminrAlert.prototype.getAlertTypeSpriteClass=function(e){var t;switch(e){case"urgentUpdate":t="sprite-dataminr-plus";break;case"flash":t="sprite-flash";break;case"momentum":t="sprite-dataminr-momentum-dot";break;default:t="sprite-dataminr-dot"}return t},TD.services.DataminrAlert.prototype.augmentWithQueryTermAndTwitterSearchUrl=function(e){e.query=-1!==e.text.indexOf(" ")?'"'+e.text+'"':e.text,e.twitterUrl=TD.net.util.addURLParam("https://twitter.com/search","q",e.query)},TD.services.DataminrAlert.prototype.getQueryStringForAnyRelatedTerms=function(){return this.dataminr.relatedTerms.map(function(e){return e.query}).join(" OR ")},TD.services.DataminrAlert.prototype.getQueryStringForAllRelatedTerms=function(){return this.dataminr.relatedTerms.map(function(e){return e.query}).join(" ")},TD.services.DataminrAlert.prototype.render=function(e){e=e||{};var t=TD.settings.getDisplaySensitiveMedia();return TD.ui.template.render("status/dataminr_in_stream",{chirp:this,withTweetActions:!0,withFooter:!0,withAvatar:!0,withDragHandle:!0,withMediaPreview:e.mediaPreviewSize!==TD.vo.Column.MEDIA_PREVIEW_OFF,isMediaPreviewSmall:e.mediaPreviewSize===TD.vo.Column.MEDIA_PREVIEW_SIZE_SMALL,isMediaPreviewLarge:e.mediaPreviewSize===TD.vo.Column.MEDIA_PREVIEW_SIZE_LARGE,mediaPreviewSrc:function(){return this.getMediaSrcForPreviewSize(e.mediaPreviewSize)},animatedGif:function(){return this.getAnimatedGifForPreview()},thumbSizeClass:TD.services.TwitterMedia.thumbSizeClasses[e.mediaPreviewSize],isPossiblySensitive:this.getRelatedTweet().possiblySensitive&&!t,withLinebreaks:!0})},TD.services.DataminrAlert.prototype.getGrowlData=function(){var e=[TD.ui.template.toHtml("@{{username}}{{#categoryName}} ({{categoryName}}){{/categoryName}}",{username:this.user.screenName,categoryName:this.dataminr.publisherCategory&&this.dataminr.publisherCategory.name}),TD.i("{{count}} followers",{count:TD.util.prettyNumber(this.user.followersCount)}),TD.i("{{count}} Tweets",{count:TD.util.prettyNumber(this.user.statusesCount)})];return{title:this.text,text:e.join(" • "),img:TD.assets.get("/web/assets/global/backgrounds/dmr_growl_icon.png")}},TD.services.TwitterClient=function(e){var t=this;this.type="twitter",this.STREAMING_BASE_URL="https://userstream.twitter.com/1.1/user.json",this.streamEngine=new TD.services.StreamEngine(e,_.bind(this.processStreamData,this)),this.firstStreamConnect=!0,this.cachedStreamingQueries={},this.conversations=new TD.services.Conversations(e,this),this.friends={},this.blocks={},this.retweetBlocks={},this.publishQueue={},this.flushPending=!1,this.searches=[],this.customTimelines=[],this.logoutTimeout=5e3,this.cacheReloadPeriod=900,this.scheduledTasks=[],this.cachedScheduledGroups=[],this.cachedScheduledLastModifiedDate=new Date(0),this.FEED_TYPES=TD.controller.FeedPoller.FEED_TYPES,this.streamingFeeds={},this.ACTIVITY_EVENT_TYPES={favorite:!0,follow:!0,list_member_added:!0,list_created:!0,retweet:!0},this.DELETE_ACTIVITY_EVENT_TYPES={unfavorite:!0,unfollow:!0,list_member_removed:!0,list_destroyed:!0},this.STREAM_LIST_EVENTS={list_created:!0,list_updated:!0,list_destroyed:!0,list_member_added:!0,list_member_removed:!0,list_user_subscribed:!0,list_user_unsubscribed:!0},this.ERRORS={ACCESS_REVOKED:{twitterErrorCode:220,message:TD.i("Unable to access to this resource")},AUTHENTICATION_FAILED:{twitterErrorCode:32,message:TD.i("Could not authenticate you")},404:{twitterErrorCode:34,message:TD.i("We could not complete your request because the tweet may be protected or deleted")},SUSPENDED_USER:{twitterErrorCode:63,message:TD.i("This user has been suspended")},SUSPENDED_ACCOUNT:{twitterErrorCode:64,message:TD.i("Your account is suspended and is not permitted to access this feature")},RATE_LIMITED:{twitterErrorCode:88,message:TD.i("Sorry, you've made too many requests so Twitter has temporarily limited your access. Try again in a few minutes")},RATE_LIMITED_DM_SEND:{twitterErrorCode:88,message:TD.i("You hit your daily limit for sending messages")},RECIPIENT_DOES_NOT_EXIST:{twitterErrorCode:108,message:TD.i("There is no user by that name.")},OVER_CAPACITY:{twitterErrorCode:130,message:TD.i("Twitter is temporarily over capacity. Please try again later")},INTERNAL_ERROR:{twitterErrorCode:131,message:TD.i("There's something wrong. Please try again later")},USER_AUTHENTICATION_FAILED:{twitterErrorCode:135,message:TD.i("Could not authenticate you")},NOT_FOLLOWING:{twitterErrorCode:150,message:TD.i("This user doesn't follow you. You can only send messages to people who do.")},MESSAGE_SEND_ERROR:{twitterErrorCode:151,message:TD.i("Something went wrong, but don't fret, it's not your fault.")},DUPLICATE_MESSAGE:{twitterErrorCode:311,message:TD.i("You have already sent this message")},DUPLICATE_TWEET:{twitterErrorCode:187,message:TD.i("You already tweeted that")},INVALID_SEARCH_QUERY:{twitterErrorCode:195,message:TD.i("Invalid search query")},TOO_MANY_CONTRIBUTORS:{twitterErrorCode:317,message:TD.i("You cannot add any more Team members.")},TOO_MANY_CONTRIBUTEES:{twitterErrorCode:318,message:TD.i("That user cannot be added to any more Teams.")},CONTRIBUTION_DISALLOWED:{twitterErrorCode:330,message:TD.i("That user has privacy settings enabled preventing them from being added to this team.")},PROTECTED_TWEET:{message:TD.i("Sorry, we could not perform your retweet because the tweet is protected")},DUPLICATE_RETWEET:{message:TD.i("Whoops! You've already retweeted that…")},USER_DOES_NOT_EXIST:{message:TD.i("That user does not exist")},UNKNOWN:{message:TD.i("An unknown error occurred. Please try again shortly.")}},this.streamWarningCodes={FOLLOWS_OVER_LIMIT:"FOLLOWS_OVER_LIMIT"},this.getError=function(e,t,i,n){var s;if(e.code)switch(e.code){case 34:s=n.status&&0===n.status.indexOf("DM")?this.ERRORS.USER_DOES_NOT_EXIST:i.indexOf("show.json")>-1?this.ERRORS.USER_DOES_NOT_EXIST:this.ERRORS[404];break;case 32:case 89:case 220:var r=TD.storage.store.getTwitterLoginAccount(),a=r&&this.oauth.account.getUserID()===r.getUserID();a&&setTimeout(function(){TD.controller.init.signOut({allSessions:!0})},this.logoutTimeout),$(document).trigger("dataTwitterAccountAccessDenied",{account:this.oauth.account,isLoginAccount:a});break;case 64:$(document).trigger("dataTwitterAccountSuspended",{account:this.oauth.account}),s=this.ERRORS.SUSPENDED_ACCOUNT;break;case 88:s=i.indexOf("dm/new.json")>-1?this.ERRORS.RATE_LIMITED_DM_SEND:this.ERRORS.RATE_LIMITED;break;default:s=_.find(this.ERRORS,function(t){return t.twitterErrorCode===e.code}),s&&s.generateMessageFromUrl&&(s.message=s.generateMessageFromUrl(t))}else 403===t.status&&(e.indexOf("retweet")>-1?s=this.ERRORS.DUPLICATE_RETWEET:e.indexOf("Share validations failed")>-1&&(s=this.ERRORS.PROTECTED_TWEET));return s||(s=this.ERRORS.UNKNOWN),TD.controller.stats.apiErrorResponse(t.status,e.code,i),s},this.oauth=TD.controller.auth.create("twitter",e),this.loadCaches(),this.scheduledTasks.push(TD.controller.scheduler.schedulePeriodicTask(this.cacheReloadPeriod,function(){TD.decider.get("disable_twitter_cache_reload")||this.loadCaches()}.bind(this))),this.getChirpsForFeed=function(e,t){var i=new TD.core.defer.Deferred;return this.refreshFeed(e,i.callback.bind(i),i.errback.bind(i),t),i},this.refreshFeed=function(e,i,n,s){s=s||{};var r,a,o=e.lowerBound,c=e.upperBound,l=s.poller,u=l.feed,d=s.feedType,h=l.isStreamableForOauthUser(this.oauth.account.getUserID()),p=s.metadata,m=s.forceFetch,f=this.streamEngine.isStreaming(),g=TD.storage.Feed.generateKeyFor(this.oauth.account.getKey(),"home"),v=!!this.streamingFeeds[g],T=e.upperBound||!f||m;if("usertweets"===d){var b=!p.id||this.friends[p.id];if(b&&v&&!T)return n(),this}if(h&&(this.streamingFeeds[u.getKey()]=u,!T))return n(),this;switch(d){case this.FEED_TYPES.home:t.getHomeTimeline(o,c,null,i,n);break;case this.FEED_TYPES.direct:var w=1!==o&&!c;w?this.getDMUserUpdates(o,i,n):this.getDMUserInbox(o,c,i,n);break;case this.FEED_TYPES.favorites:t.getFavoritesTimeline(o,p.id,c,null,i,n);break;case this.FEED_TYPES.list:t.getListTimeline(p.listId,p.screenName,p.slug,o,c,null,i,n);break;case this.FEED_TYPES.customTimeline:t.get3NFTimeline({id:p.id,minPosition:o,maxPosition:c},i,n);break;case this.FEED_TYPES.search:p.baseQuery&&p.searchFilterData?(r=new TD.vo.SearchFilter(p.searchFilterData),a=[p.baseQuery,r.getQueryString()].join(" ")):a=p.term,TD.decider.get("universal_search_timelines")?t.getUniversalSearchTimeline(a,o,c,null,i,n):t.getSearchTimeline(a,o,c,null,i,n);break;case this.FEED_TYPES.usertweets:t.getProfileTimeline(p.id,null,o,c,i,n);break;case this.FEED_TYPES.usertimeline:t.getUserTimeline(p.id,o,c,null,i,n);break;case this.FEED_TYPES.mentions:t.getMentionsTimeline(o,c,null,i,n);break;case this.FEED_TYPES.interactions:t.getInteractionsTimeline(o,c,null,i,n);break;case this.FEED_TYPES.networkactivity:t.getNetworkActivityTimeline(o,c,null,i,n);break;case this.FEED_TYPES.scheduled:TD.decider.hasAccessLevel("scheduler","READ_BACKGROUND")&&t.getScheduledGroups({since_execute_at:c},{forceFetch:m}).addCallbacks(i,n);break;case this.FEED_TYPES.dataminr:t.getDataminrAlerts(o,c,s.metadata.watchlist.id,i,n);break;default:n()}return this},this.feedIsStreaming=function(e){return this.streamingFeeds[e]&&this.streamEngine.isStreaming()},this._checkUserStream=_.bind(this.checkUserStream,this),this.subscription=$.subscribe("/storage/client/settings/use_stream",this._checkUserStream)},TD.services.TwitterClient.prototype.API_BASE_URL=[TD.config.twitter_api_base,TD.config.twitter_api_version,""].join("/"),TD.services.TwitterClient.prototype.makeTwitterCall=function(e,t,i,n,s,r,a){s=s||function(){},r=r||function(){};var o=this.request(e,{method:i,params:t,processor:n,feedType:a});return o.addCallbacks(function(e){s(e.data)},function(e){r(e.req,"",e.msg,e.req.errors)}),o},TD.services.TwitterClient.prototype.request=function(e,t){if(!e)throw Error("Request needs a URL");if("string"!=typeof e)throw Error("Request URL must be a string");t=_.defaults(t||{},{method:"GET",handleSuccess:!0,handleError:!0});var i="DELETE"===t.method?{}:{include_entities:1,include_user_entities:1,include_cards:1,send_error_codes:1};if(t.params=_.defaults(t.params||{},i),t.headers=_.defaults(t.headers||{},{}),t.account=this.oauth.account,t.processor&&"function"!=typeof t.processor)throw new Error("Request processor must be a function");var n=TD.net.ajax.request(e,t);return n.addCallbacks(this.processSuccessResponse.bind(this,e,t),this.processErrorResponse.bind(this,e,t)),n},TD.services.TwitterClient.prototype.processSuccessResponse=function(e,t,i){if(!t.handleSuccess)return i;var n=i.data;if(t.processor)try{n=t.processor.call(this,i.data)}catch(s){throw new Error("Error processing Twitter data ("+s.message+"): "+JSON.stringify(i.data));

}return this.processRateLimitData(t.feedType,i.xhr),$(document).trigger("dataTwitterAccountAccessSuccess",{account:this.oauth.account}),{data:n,xhr:i.xhr}},TD.services.TwitterClient.prototype.processErrorResponse=function(e,t,i){if(!t.handleError)throw i;i.req=i.req||{};var n,s=[];if(i.req.responseText){try{n=JSON.parse(i.req.responseText)}catch(i){console.error("Failed to parse error responseText")}n&&n.errors&&("string"==typeof n.errors?s.push(this.getError(n.errors,i.req,e,t.params)):_.each(n.errors,function(n){s.push(this.getError(n,i.req,e,t.params))}.bind(this)))}throw i.req.errors=s,$(document).trigger("dataTwitterApiError",{request:t,response:{xhr:i.req,ts:"",error:i.msg},errors:s}),s.forEach(function(e){e.twitterErrorCode&&$(document).trigger("metric",{key:"api:error:"+e.twitterErrorCode})}),this.processRateLimitData(t.feedType,i.req),i},TD.services.TwitterClient.prototype.loadCaches=function(){this.getListOwnerships(null,function(e){_.each(e,TD.cache.lists.add)}),this.getListSubscriptions(null,function(e){_.each(e,TD.cache.lists.add)}),this.getSavedSearches(function(e){this.searches=e}.bind(this)),this.getCustomTimelineWhitelistStatus(function(e){$(document).trigger("dataCustomTimelineWhitelistItem",{accountKey:this.oauth.account.getKey(),whitelisted:e.whitelisted})}.bind(this)),this.getCustomTimelines(this.oauth.account.getUserID(),null,function(e){this.customTimelines=e}.bind(this)),this.populateBlockList(),this.populateRetweetBlockList()},TD.services.TwitterClient.prototype.processRateLimitData=function(e,t){if(e){var i={rateLimitRemaining:parseInt(t.getResponseHeader("x-rate-limit-remaining"),10),rateLimitTotal:parseInt(t.getResponseHeader("x-rate-limit-limit"),10),rateLimitReset:parseInt(t.getResponseHeader("x-rate-limit-reset"),10)};i.rateLimitTotal&&i.rateLimitReset&&$(document).trigger("dataRateLimit",{feedType:e,accountKey:this.oauth.account.getKey(),rateLimitData:i})}},TD.services.TwitterClient.prototype.processTweet=function(e){return new TD.services.TwitterStatus(this.oauth.account).fromJSONObject(e)},TD.services.TwitterClient.prototype.processDataminrAlert=function(e){return new TD.services.DataminrAlert(this.oauth.account).fromJSONObject(e)},TD.services.TwitterClient.prototype.deleteMessage=function(e){var t=this.conversations.deleteMessageByIdAndReturnChangedConversations(e);this.publishChirpsInternal("publish","direct",t)},TD.services.TwitterClient.prototype.processPlaces=function(e){return e.result.places},TD.services.TwitterClient.prototype.processTimeline=function(e){var t,i;if(!e.length)return[];for(t=e.length;t--;)i=e[t],i=i.sender?this.processDM(i):this.processTweet(i),e[t]=i;return e},TD.services.TwitterClient.prototype.process3NFTimeline=function(e){var t=e.response.timeline.map(function(t){var i=t.tweet.id_str||t.tweet.id,n=e.objects.tweets[i],s=n.user.id_str,r=e.objects.users[s];n.user=r;var a=this.processTweet(n);return t.tweet.sort_index&&(a.sortIndex={value:t.tweet.sort_index,type:"numericString"}),a}.bind(this));return t.length&&(t[0].cursor=e.response.position.max_position,t[t.length-1].cursor=e.response.position.min_position),t},TD.services.TwitterClient.prototype.processTrends=function(e){for(var t,i={locations:e[0].locations,trends:[]},n=e[0].trends,s=0;s<n.length;s++)t=(new TD.services.TrendingTopic).fromJSONObject(n[s]),i.trends.push(t);return i},TD.services.TwitterClient.prototype.processTrendLocations=function(e){function t(e,t){var i=e.sortString,n=t.sortString;return n>i?-1:i>n?1:0}var i,n,s=[];for(n=0;n<e.length;n++)i=(new TD.services.TrendLocation).fromJSONObject(e[n]),s.push(i);return s.sort(t)},TD.services.TwitterClient.prototype.processTailoredTrends=function(e){for(var t,i={trends:[]},n=e[0].trends,s=0;s<n.length;s++)t=(new TD.services.TrendingTopic).fromJSONObject(n[s]),i.trends.push(t);return i},TD.services.TwitterClient.prototype.processList=function(e){return new TD.services.TwitterList(this.oauth.account).fromJSONObject(e)},TD.services.TwitterClient.prototype.processCustomTimeline=function(e){return new TD.services.CustomTimeline(this.oauth.account).fromJSONObject(e)},TD.services.TwitterClient.prototype.process3NFCustomTimeline=function(e){var t=e.objects.timelines[e.response.timeline_id];return t.id=e.response.timeline_id,t.user=e.objects.users[t.user_id],this.processCustomTimeline(t)},TD.services.TwitterClient.prototype.process3NFCustomTimelines=function(e){return e.response.results.map(function(t){var i=e.objects.timelines[t.timeline_id];return i.id=t.timeline_id,i.user=e.objects.users[i.user_id],this.processCustomTimeline(i)}.bind(this))},TD.services.TwitterClient.prototype.processLists=function(e){return _.map(e,_.bind(this.processList,this))},TD.services.TwitterClient.prototype.processUser=function(e){return new TD.services.TwitterUser(this.oauth.account).fromJSONObject(e)},TD.services.TwitterClient.prototype.processDeletedUser=function(e){return new TD.services.TwitterDeletedUser(this.oauth.account,e)},TD.services.TwitterClient.prototype.processUsers=function(e){for(var t=[],i=0;i<e.length;i++)t.push(this.processUser(e[i]));return t},TD.services.TwitterClient.prototype.processActions=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if("list_member_added"===n.action&&n.targets_size>1&&n.target_objects_size>1){var s=new TD.services.TwitterActionMultiListMemberAdded(this.oauth.account);s.fromJSONObject(n,[n],!1),t.push(s)}else t=t.concat(TD.services.TwitterAction.processRESTAction(n,this.oauth.account))}return t},TD.services.TwitterClient.prototype.showUser=function(e,t,i,n){var s={};e?s.user_id=e:s.screen_name=t,this.makeTwitterCall(this.API_BASE_URL+"users/show.json",s,"GET",this.processUser,i,n)},TD.services.TwitterClient.prototype.getUsersByIds=function(e,t,i){var n={user_id:e.join(",")};this.makeTwitterCall(this.API_BASE_URL+"users/lookup.json",n,"POST",this.processUsers,t,i)},TD.services.TwitterClient.prototype.followUser=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"friendships/create.json",{screen_name:e},"POST",this.processUser,t,i)},TD.services.TwitterClient.prototype.unfollowUser=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"friendships/destroy.json",{screen_name:e},"POST",this.processUser,t,i)},TD.services.TwitterClient.prototype.typeaheadSearch=function(e,t,i){var n=function(i){t(i,e)};if(!e.query&&!e.prefetch)throw new Error("Typeahead API needs a query");this.makeTwitterCall(this.API_BASE_URL+"search/typeahead.json",{q:e.query,count:e.count||10,prefetch:e.prefetch?!0:!1},"GET",null,n,i)},TD.services.TwitterClient.prototype.userSearch=function(e,t,i){var n=this,s=function(t){var i,s,r=e.toLowerCase();for(t=n.processUsers(t),i=0;i<t.length;i++)if(s=t[i],s.screenName.toLowerCase()==r&&0!==i){t.splice(i,1),t=[s].concat(t);break}return t};this.makeTwitterCall(this.API_BASE_URL+"users/search.json",{q:e},"GET",s,t,i)},TD.services.TwitterClient.prototype.getRetweetedBy=function(e,t,i,n,s){var r={count:t||12,page:i||1};this.makeTwitterCall(this.API_BASE_URL+"statuses/"+e+"/retweeted_by.json",r,"GET",this.processUsers,n,s)},TD.services.TwitterClient.prototype.showFriendship=function(e,t,i,n,s){var r={source_id:e};null!==t?r.target_id=t:null!==i&&(r.target_screen_name=i),this.makeTwitterCall(this.API_BASE_URL+"friendships/show.json",r,"GET",null,n,s)},TD.services.TwitterClient.prototype.showFriendshipForScreenName=function(e,t,i,n){this.makeTwitterCall(this.API_BASE_URL+"friendships/show.json",{source_id:e,target_screen_name:t},"GET",null,i,n)},TD.services.TwitterClient.prototype.blockUser=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"blocks/create.json",{screen_name:e},"POST",this.processUser,t,i)},TD.services.TwitterClient.prototype.unblockUser=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"blocks/destroy.json",{screen_name:e},"POST",this.processUser,t,i)},TD.services.TwitterClient.prototype.blockAndReportUser=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"users/report_spam.json",{screen_name:e},"POST",this.processUser,t,i)},TD.services.TwitterClient.prototype.reportDMSpam=function(e,t,i,n,s){var r=TD.net.util.addURLParameters(this.API_BASE_URL+"direct_messages/report_spam.json",{dm_id:e,report_as:t,block_user:i});this.makeTwitterCall(r,{},"POST",null,n,s)},TD.services.TwitterClient.prototype.flagTweet=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"statuses/flag_possibly_sensitive.json",{id:e},"POST",null,t,i)},TD.services.TwitterClient.prototype.getList=function(e,t,i,n,s){var r={};e?r.list_id=e:(r.slug=i,r.owner_screen_name=t),this.makeTwitterCall(this.API_BASE_URL+"lists/show.json",r,"GET",this.processList,n,s)},TD.services.TwitterClient.prototype.createList=function(e,t,i,n,s){var r={name:e,description:t||"",mode:i?"private":"public"},a=function(e){TD.cache.lists.add(e),n(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/create.json",r,"POST",this.processList,a,s)},TD.services.TwitterClient.prototype.updateList=function(e,t,i,n,s,r){var a={list_id:e,name:t,description:i||"",mode:n?"private":"public"},o=function(e){TD.cache.lists.add(e),s(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/update.json",a,"POST",this.processList,o,r)},TD.services.TwitterClient.prototype.destroyList=function(e,t,i){var n=function(e){TD.cache.lists.purge(e.id),t(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/destroy.json",{list_id:e},"POST",this.processList,n,i)},TD.services.TwitterClient.prototype.getListMembers=function(e,t,i,n){var s=this,r=function(e){e.users=s.processUsers(e.users),i(e)};_.isUndefined(t)&&(t=-1),this.makeTwitterCall(this.API_BASE_URL+"lists/members.json",{list_id:e,skip_status:1,cursor:t},"GET",null,r,n)},TD.services.TwitterClient.prototype.subscribeToList=function(e,t,i){var n=function(e){TD.cache.lists.add(e),t(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/subscribers/create.json",{list_id:e},"POST",!0,this.processList,n,i)},TD.services.TwitterClient.prototype.addUserToList=function(e,t,i,n){var s=function(e){TD.cache.lists.add(e),i(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/members/create.json",{screen_name:t,list_id:e},"POST",this.processList,s,n)},TD.services.TwitterClient.prototype.addUsersToList=function(e,t,i,n){var s=function(e){TD.cache.lists.add(e),i(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/members/create_all.json",{screen_name:t.join(","),list_id:e},"POST",this.processList,s,n)},TD.services.TwitterClient.prototype.removeUserFromList=function(e,t,i,n){var s=function(e){TD.cache.lists.add(e),i(e)};this.makeTwitterCall(this.API_BASE_URL+"lists/members/destroy.json",{screen_name:t,list_id:e},"POST",this.processList,s,n)},TD.services.TwitterClient.prototype.getBlockIDs=function(e,t,i){var n={stringify_ids:!0,cursor:e||-1};this.makeTwitterCall(this.API_BASE_URL+"blocks/ids.json",n,"GET",null,t,i)},TD.services.TwitterClient.prototype.getNoRetweetIDs=function(e,t){this.makeTwitterCall(this.API_BASE_URL+"friendships/no_retweets/ids.json",null,"GET",null,e,t)},TD.services.TwitterClient.prototype.getTweetSummary=function(e,t,i){var n={};this.makeTwitterCall(this.API_BASE_URL+"statuses/"+e+"/activity/summary.json",n,"GET",null,t,i)},TD.services.TwitterClient.prototype.getEmbeddedTweet=function(e,t,i,n,s,r){var a;if(!e)throw new Error("getEmbeddedTweet: tweetID is a required parameter");a={id:e,partner:"tweetdeck"},t&&(a.hide_thread=t),i&&(a.hide_media=i),n&&(a.maxwidth=n),this.makeTwitterCall(this.API_BASE_URL+"statuses/oembed.json",a,"GET",null,s,r)},TD.services.TwitterClient.prototype.translateTweet=function(e,t,i,n){var s;if(!e)throw new Error("translateTweet: tweetID is a required parameter");if(!t)throw new Error("translateTweet: destLang is a required parameter");s={id:e,dest:t},this.makeTwitterCall(this.API_BASE_URL+"translations/show.json",s,"GET",null,i,n)},TD.services.TwitterClient.prototype.getFollowingFollowersOf=function(e,t,i){var n;if(!e)throw new Error("getFollowingFollowersOf: screenName is a required parameter");n={screen_name:e},this.makeTwitterCall(this.API_BASE_URL+"friends/following/list.json",n,"GET",null,t,i)},TD.services.TwitterClient.prototype.getHomeTimeline=function(e,t,i,n,s){this.getTimeline("statuses/home_timeline.json",e,t,i,n,s,{},this.FEED_TYPES.home)},TD.services.TwitterClient.prototype.getUserTimeline=function(e,t,i,n,s,r){var a={user_id:e};this.getTimeline("statuses/following_timeline.json",t,i,n,s,r,a,this.FEED_TYPES.usertimeline)},TD.services.TwitterClient.prototype.getMentionsTimeline=function(e,t,i,n,s){this.getTimeline("statuses/mentions_timeline.json",e,t,i,n,s,{},this.FEED_TYPES.mentions)},TD.services.TwitterClient.prototype.getInteractionsTimeline=function(e,t,i,n,s){this.getActivityTimeline("activity/about_me.json",e,t,i,n,s,{},this.FEED_TYPES.interactions)},TD.services.TwitterClient.prototype.getNetworkActivityTimeline=function(e,t,i,n,s){this.getActivityTimeline("activity/by_friends.json",e,t,i,n,s,{},this.FEED_TYPES.networkactivity)},TD.services.TwitterClient.prototype.getActivityTimeline=function(e,t,i,n,s,r,a){a=a||{},i&&(a.max_id=i),Number(t)>1&&(a.since_id=t),a.count=n||170,a.skip_aggregation=!0,this.makeTwitterCall(this.API_BASE_URL+e,a,"GET",this.processActions,s,r)},TD.services.TwitterClient.prototype.getDMUserInbox=function(e,t,i,n){var s={min_id:e,max_id:t,max_conv_count:20,include_groups:!0},r=1===e;this.makeTwitterCall(this.API_BASE_URL+"dm/user_inbox.json",s,"GET",this.conversations.processUserUpdates.bind(this.conversations,r),i,n,this.FEED_TYPES.direct)},TD.services.TwitterClient.prototype.getDMUserUpdates=function(e,t,i){var n={cursor:e,include_groups:!0};this.makeTwitterCall(this.API_BASE_URL+"dm/user_updates.json",n,"GET",this.conversations.processUserUpdates.bind(this.conversations,!1),t,i,this.FEED_TYPES.direct)},TD.services.TwitterClient.prototype.getDmConversation=function(e,t){var i=this.request(this.API_BASE_URL+"dm/conversation/"+e+".json",{params:t});return i.addCallback(this.getDataFromDeferred),i.addCallback(this.conversations.processUserUpdates.bind(this.conversations,!1)),i},TD.services.TwitterClient.prototype.getFavoritesTimeline=function(e,t,i,n,s,r){var a={};t&&(a.user_id=t),this.getTimeline("favorites/list.json",e,i,n,s,r,a,this.FEED_TYPES.favorites)},TD.services.TwitterClient.prototype.getListTimeline=function(e,t,i,n,s,r,a,o){var c="lists/statuses.json",l={include_rts:1};e?l.list_id=e:(l.owner_screen_name=t,l.slug=i),this.getTimeline(c,n,s,r,a,o,l,this.FEED_TYPES.list)},TD.services.TwitterClient.prototype.getProfileTimeline=function(e,t,i,n,s,r){var a="statuses/user_timeline.json",o={include_rts:1};e&&e!==this.oauth.account.getUserID()&&(o.user_id=e),this.getTimeline(a,i,n,t,s,r,o,this.FEED_TYPES.usertweets)},TD.services.TwitterClient.prototype.getSearchTimeline=function(e,t,i,n,s,r){var a,o={count:n||200,q:e,result_type:"recent"},c=this;a=c.API_BASE_URL+"search/tweets.json";var l=function(e){return c.processTimeline(e.statuses)},u=function(e,t,i){e&&e.errors&&e.errors[0]===this.ERRORS.INVALID_SEARCH_QUERY?s([]):r.apply(null,arguments)}.bind(this);i&&(o.max_id=i),t&&1!=t&&(o.since_id=t),this.makeTwitterCall(a,o,"GET",l,s,u,this.FEED_TYPES.search)},TD.services.TwitterClient.prototype.getUniversalSearchTimeline=function(e,t,i,n,s,r){var a,o={q:e,count:n||200,modules:"status",result_type:"recent",pc:!1,ui_lang:TD.languages.getSystemLanguageCode()},c=this;a=c.API_BASE_URL+"search/universal.json";var l=function(e){var t=[];return e.modules.forEach(function(e){e.status&&t.push(e.status.data)}),c.processTimeline(t)},u=function(e,t,i){e&&e.errors&&e.errors[0]===this.ERRORS.INVALID_SEARCH_QUERY?s([]):r.apply(null,arguments)}.bind(this);i&&(TD.decider.get("universal_search_timelines_by_id")?o.q+=" max_id:"+i:o.until_time=i),t&&1!=t&&(TD.decider.get("universal_search_timelines_by_id")?o.q+=" since_id:"+t:o.since_time=t),this.makeTwitterCall(a,o,"GET",l,s,u,this.FEED_TYPES.search)},TD.services.TwitterClient.prototype.getDataminrAlerts=function(e,t,i,n,s){$(document).trigger("uiNeedsDataminrAlerts",{params:{start_time:e,end_time:t,lists:[i]},success:function(e){this.inflateDataminrAlerts(e,n,s)}.bind(this),error:s})},TD.services.TwitterClient.prototype.inflateDataminrAlerts=function(e,t,i){var n=e.map(function(e){return e.displayTweet.id_str});this.lookupTweets(n,function(i){var n=i.reduce(function(e,t){return e[t.id_str]=t,e},{}),s=e.filter(function(e){return!!n[e.displayTweet.id_str]}).map(function(e){return e.displayTweet=n[e.displayTweet.id_str],this.processDataminrAlert(e)}.bind(this));t(s)}.bind(this),i,null)},TD.services.TwitterClient.prototype.getTimeline=function(e,t,i,n,s,r,a,o){var c={since_id:t||1,count:n||200,include_my_retweet:1},l="";l=_.startsWith(e,"https://")?e:this.API_BASE_URL+e,i&&(c.max_id=i),a&&_.extend(c,a),this.makeTwitterCall(l,c,"GET",this.processTimeline,s,r,o)},TD.services.TwitterClient.prototype.pendingConversation={},TD.services.TwitterClient.prototype.getConversation=function(e){var t=this;if(!this.pendingConversation[e]){var i=function(i){delete t.pendingConversation[e];var n={ancestors:[],descendants:[]},s=!1;i.forEach(function(t){s?n.descendants.push(t):t.id===e?s=!0:n.ancestors.push(t)}),$.publish("/tweets/conversation/"+e,[n])},n=function(){delete t.pendingConversation[e];var i={ancestors:[],descendants:[]};$.publish("/tweets/conversation/"+e,[i])};this.pendingConversation[e]=!0,this.makeTwitterCall(this.API_BASE_URL+"conversation/show.json",{id:e},"GET",this.processTimeline,i,n)}},TD.services.TwitterClient.prototype.destroy=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"statuses/destroy/:id.json".replace(":id",e),{},"POST",this.processTweet,t,i)},TD.services.TwitterClient.prototype.show=function(e,t,i){this.makeTwitterCall(this.API_BASE_URL+"statuses/show.json",{id:e},"GET",this.processTweet,t,i)},TD.services.TwitterClient.prototype.lookupTweets=function(e,t,i,n){this.makeTwitterCall(this.API_BASE_URL+"statuses/lookup.json",{id:e.join(",")},"GET",void 0!==n?n:this.processTimeline,t,i)},TD.services.TwitterClient.prototype.getCustomTimelineWhitelistStatus=function(e,t){this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/whitelisted.json",null,"GET",null,e,t)},TD.services.TwitterClient.prototype.createCustomTimeline=function(e,t,i){e=e||{};var n={name:e.name||"New Collection",description:e.description||"",url:e.url||""},s=function(e){this.customTimelines.push(e),t(e),$(document).trigger("dataCustomTimelineCreateSuccess")}.bind(this);this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/create.json",n,"POST",this.process3NFCustomTimeline,s,i)},TD.services.TwitterClient.prototype.updateCustomTimeline=function(e,t,i,n){t=t||{};var s={id:e};"string"==typeof t.name&&(s.name=t.name||"New Collection"),"string"==typeof t.description&&(s.description=t.description||""),"string"==typeof t.url&&(s.url=t.url||"");var r=function(t){TD.cache.names.updateCustomTimelineName(t.id,t.name),this.customTimelines=this.customTimelines.filter(function(t){return t.id!==e}),this.customTimelines.push(t),i(t),$(document).trigger("dataCustomTimelineUpdateSuccess")}.bind(this);this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/update.json",s,"POST",this.process3NFCustomTimeline,r,n)},TD.services.TwitterClient.prototype.deleteCustomTimeline=function(e,t,i){var n={id:e},s=function(i){this.customTimelines=this.customTimelines.filter(function(t){return t.id!==e}),t(i),$(document).trigger("dataCustomTimelineDeleteSuccess")}.bind(this);this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/destroy.json",n,"POST",null,s,i)},TD.services.TwitterClient.prototype.getCustomTimelines=function(e,t,i,n){var s={count:200};e&&(s.user_id=e),t&&(s.tweet_id=t),this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/list.json",s,"GET",this.process3NFCustomTimelines,i,n)},TD.services.TwitterClient.prototype.getCustomTimeline=function(e,t,i){var n={id:e};this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/show.json",n,"GET",this.process3NFCustomTimeline,t,i)},TD.services.TwitterClient.prototype.addTweetToCustomTimeline=function(e,t,i,n){i=i||function(){},n=n||function(){};var s={id:e,tweet_id:t};this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/add.json",s,"POST",null,i,n)},TD.services.TwitterClient.prototype.removeTweetFromCustomTimeline=function(e,t,i,n){i=i||function(){},n=n||function(){};var s={id:e,tweet_id:t};this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/remove.json",s,"POST",null,i,n)},TD.services.TwitterClient.prototype.bulkAddRemoveFromCustomTimeline=function(e,t,i,n,s){var r={id:e,changes:[]};i.forEach(function(e){r.changes.push({op:"remove",tweet_id:e})}),t.forEach(function(e){r.changes.push({op:"add",tweet_id:e})}),this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/custom/remove.json",r,"POST",null,n,s)},TD.services.TwitterClient.prototype.get3NFTimeline=function(e,t,i){e=e||{};var n={id:e.id};e.maxCount&&(n.max_count=e.maxCount),e.minPosition&&(n.min_position=e.minPosition),e.maxPosition&&(n.max_position=e.maxPosition),this.makeTwitterCall(this.API_BASE_URL+"beta/timelines/timeline.json",n,"GET",this.process3NFTimeline,t,i)},TD.services.TwitterClient.prototype.getScheduledTweets=function(e,t){if(e=e||{},_.defaults(e,{count:200,state:"scheduled,failed",since_execute_at:void 0,ascending:1}),t=t||{},_.defaults(t,{isPoll:!1,forceFetch:!1}),t.forceFetch&&(this.cachedScheduledLastModifiedDate=new Date(0)),!e.since_execute_at){var i=new Date;i.setMonth(i.getMonth()-1),e.since_execute_at=~~(i.getTime()/1e3)}e=Object.keys(e).reduce(function(t,i){return"undefined"!=typeof e[i]&&null!==e[i]&&(t[i]=e[i]),t},{});var n={};t.isPoll&&(n["if-modified-since"]=this.cachedScheduledLastModifiedDate.toUTCString());var s=this.request(this.API_BASE_URL+"schedule/status/list.json",{method:"GET",params:e,processor:this.processScheduledTweets,headers:n});return t.isPoll&&s.addCallback(this.cacheScheduledLastModifiedDate.bind(this)),s.addCallback(this.getResultsFromDeferred.bind(this)),s},TD.services.TwitterClient.prototype.getScheduledGroups=function(e,t){e=e||{},t=t||{},_.defaults(t,{forceFetch:!1,isPoll:!e.since_execute_at});var i=this.getScheduledTweets(e,t);return i.addCallbackWith(this,this.groupScheduledTweets),i.addCallbackWith(this,function(e){var t=0===e.length;return $(document).trigger("dataThrottleFeed",{feedType:"scheduled",accountKey:this.oauth.account.getKey(),doThrottle:t}),TD.decider.hasAccessLevel("scheduler","READ_VISIBLE")?e:(e.forEach(function(e){TD.controller.feedManager.deleteChirp(e.token)}),[])}),i},TD.services.TwitterClient.prototype.cacheScheduledLastModifiedDate=function(e){var t=e.xhr.getResponseHeader("last-modified");return t&&(this.cachedScheduledLastModifiedDate=new Date(t)),e},TD.services.TwitterClient.prototype.processScheduledTweets=function(e){return e=e||{},e.results=e.results||[],{results:e.results.map(this.processScheduledTweet,this)}},TD.services.TwitterClient.prototype.processScheduledTweet=function(e){return(new TD.services.ScheduledTweet).fromJSONObject(e)},TD.services.TwitterClient.prototype.groupScheduledTweets=function(e){if(!e)return[];var t=Date.now(),i=function(e){return e instanceof TD.services.ScheduledTweetGroup&&"scheduled"===e.state&&e.time<t};TD.storage.feedController.getAll().filter(function(e){return"twitter"===e.getService()&&"scheduled"===e.getType()}).forEach(function(e){var t=TD.controller.feedManager.getPoller(e.getKey());t.removeWhere(i)});var n={canceled:!0,completed:!0,dismissed:!0},s=e.reduce(function(e,t){if(t.retweetedStatusId)return e;try{e[t.token]||(e[t.token]=new TD.services.ScheduledTweetGroup(t.token)),e[t.token].addUpdate(t)}catch(i){console.log("Error processing scheduled update",t,i)}return e},{});return _.values(s).filter(function(e){var t=!n[e.state];return t||TD.controller.feedManager.deleteChirp(e.token),t})},TD.services.TwitterClient.prototype.update=function(e,t,i,n,s,r,a){var o={status:e};o.in_reply_to_status_id=t,o.lat=i,o["long"]=n,o.place_id=s,this.makeTwitterCall(this.API_BASE_URL+"statuses/update.json",o,"POST",this.processTweet,r,a)},TD.services.TwitterClient.prototype.getLists=function(e,t,i){var n={reverse:!0};e&&(n.screen_name=e),this.makeTwitterCall(this.API_BASE_URL+"lists/list.json",n,"GET",this.processLists,t,i)},TD.services.TwitterClient.prototype.getListMemberships=function(e,t,i,n){var s={},r=this;e&&(s.screen_name=e),t&&(s.filter_to_owned_lists=1);var a=function(e){return r.processLists(e.lists)};this.makeTwitterCall(this.API_BASE_URL+"lists/memberships.json",s,"GET",a,i,n)},TD.services.TwitterClient.prototype.getListOwnerships=function(e,t,i){var n={count:1e3},s=this,r=function(e){return s.processLists(e.lists)};e&&(n.screen_name=e),this.makeTwitterCall(this.API_BASE_URL+"lists/ownerships.json",n,"GET",r,t,i)},TD.services.TwitterClient.prototype.getListSubscriptions=function(e,t,i){var n={count:1e3},s=this,r=function(e){return s.processLists(e.lists)};e&&(n.screen_name=e),this.makeTwitterCall(this.API_BASE_URL+"lists/subscriptions.json",n,"GET",r,t,i)},TD.services.TwitterClient.prototype.getSavedSearches=function(e,t){var i={};this.makeTwitterCall(this.API_BASE_URL+"saved_searches/list.json",i,"GET",null,e,t)},TD.services.TwitterClient.prototype.favorite=function(e,t,i){var n=this,s=function(e){n.updateFavoriteInternal(e,!0),t(e)};this.makeTwitterCall(this.API_BASE_URL+"favorites/create.json",{id:e},"POST",this.processTweet,s,i)},TD.services.TwitterClient.prototype.unfavorite=function(e,t,i){var n=this,s=function(e){n.updateFavoriteInternal(e,!1),t(e)};this.makeTwitterCall(this.API_BASE_URL+"favorites/destroy.json",{id:e},"POST",this.processTweet,s,i)},TD.services.TwitterClient.prototype.destroyDM=function(e,t,i){$(document).trigger("uiDeleteDm",{id:e,accountKey:this.oauth.account.getKey(),success:t,error:i})},TD.services.TwitterClient.prototype.markMessagesAsRead=function(e,t,i,n){var s={last_message_id:e};t&&(s.sender_id=t),this.makeTwitterCall(this.API_BASE_URL+"direct_messages/read.json",s,"POST",null,i,n)},TD.services.TwitterClient.prototype.geoSearch=function(e,t,i,n,s,r,a){var o={};t&&(o.lat=t),i&&(o["long"]=i),n&&(o.accuracy=n),e&&(o.query=e),o.granularity=s||"neighborhood",this.makeTwitterCall(this.API_BASE_URL+"geo/search.json",o,"GET",this.processPlaces,r,a)},TD.services.TwitterClient.prototype.getTrends=function(e,t,i){e=e||1,this.makeTwitterCall(this.API_BASE_URL+"trends/place.json",{id:e},"GET",this.processTrends,t,i)},TD.services.TwitterClient.prototype.getTrendLocations=function(e,t){this.makeTwitterCall(this.API_BASE_URL+"trends/available.json",null,"GET",this.processTrendLocations,e,t)},TD.services.TwitterClient.prototype.getTailoredTrends=function(e,t){this.makeTwitterCall(this.API_BASE_URL+"trends/personalized.json",null,"GET",this.processTailoredTrends,e,t)},TD.services.TwitterClient.prototype.updateFavoriteInternal=function(e,t){e=e.retweetedStatus?e.retweetedStatus:e,e.setFavorite(t);var i=t?"publish":"remove";this.publishChirpsInternal(i,"favorites",[e])},TD.services.TwitterClient.prototype.removeAction=function(e){var t=TD.services.TwitterAction.processStreamAction(e,this.oauth.account);return t.isAboutYou()?this.publishChirpsInternal("remove","interactions",[t]):t.isOwnChirp()||this.publishChirpsInternal("remove","networkactivity",[t]),t},TD.services.TwitterClient.prototype.publishStreamAction=function(e){var t=TD.services.TwitterAction.processStreamAction(e,this.oauth.account),i=function(e){return this.blocks[e.id]};t.fudgeCreatedTime(t.created),this.blocks[t.getCreator().id]||_.some(t.getTargetUsers(),i,this)||(t.isAboutYou()?this.publishChirpsInternal("publish","interactions",[t]):t.isOwnChirp()||this.publishChirpsInternal("publish","networkactivity",[t]))},TD.services.TwitterClient.prototype.queueChirpsForDispatch=function(e,t){this.publishQueue[e]=(this.publishQueue[e]||[]).concat(t),this.flushPending||(this.flushPending=!0,_.defer(function(){this.flushPending=!1,Object.keys(this.publishQueue).forEach(function(e){try{var t=this.publishQueue[e],i=TD.controller.feedManager.getPoller(e);i&&i.acceptChirps(t)}catch(n){var s=i?i.feed.getType():"unknown_feed_type",r=_.uniq(t.map(function(e){return e.getChirpType()})),a=1===r.length?r[0]:"unknown_chirp_type";$(document).trigger("metric",{key:"client:publish:error:"+s+":"+a})}finally{delete this.publishQueue[e]}}.bind(this))}.bind(this)))},TD.services.TwitterClient.prototype.publishChirpsInternal=function(e,t,i,n){var s,r;s=TD.storage.Feed.generateKeyFor(this.oauth.account.getKey(),t,n),"publish"==e?this.queueChirpsForDispatch(s,i):"remove"==e&&(r=TD.controller.feedManager.getPoller(s),r&&_.each(i,function(e){r.removeChirp(e.id)}))},TD.services.TwitterClient.prototype.addIdToBlockList=function(e){this.blocks[e]||(this.blocks[e]=!0,$.publish("/user/removeTweets",[e,this.oauth.account.getUserID(),!1]))},TD.services.TwitterClient.prototype.blockListNextCursor=-1,TD.services.TwitterClient.prototype.populateBlockList=function(){var e=function(t){var i,n=t.ids;for(-1===this.blockListNextCursor&&(this.blocks={}),i=0;i<n.length;i++)this.addIdToBlockList(n[i]);this.blockListNextCursor=t.next_cursor_str&&"0"!==t.next_cursor_str?t.next_cursor_str:-1,TD.decider.get("fetch_entire_blocklist")&&-1!==this.blockListNextCursor&&this.getBlockIDs(this.blockListNextCursor,e)}.bind(this);this.getBlockIDs(this.blockListNextCursor,e)},TD.services.TwitterClient.prototype.populateRetweetBlockList=function(){this.getNoRetweetIDs(function(e){var t;for(this.retweetBlocks={},t=0;t<e.length;t++)this.retweetBlocks[e[t]]=!0}.bind(this))},TD.services.TwitterClient.prototype.constructStreamingUrl=function(){var e=this,t={},i=!1,n=!0;_.each(this.streamingFeeds,function(s,r){var a=s.getMetadata(),o=TD.controller.feedManager.getPoller(r);if(o)if(n=!1,s.managed&&"search"==s.getType()){var c=a.term,l=c.toLowerCase(),u=new TD.services.TwitterSearchParser(c);t[l]=u}else"home"===s.getType()&&(i=!0);else delete e.streamingFeeds[r]});var s=[];for(var r in t)s.push(t[r].trackQuery);s=_.uniq(s.join(",").split(","));var a=s.join(","),o={};a&&(o.track=a),i||(o["with"]="user");var c=!1;return _.each(TD.storage.feedController.getAll(),function(t){"networkactivity"===t.getType()&&"twitter"===t.getService()&&e.oauth.account.getKey()===t.getAccountKey()&&(c=!0)}),c&&(o.include_followings_activity=!0),n?null:TD.net.util.addURLParameters(this.STREAMING_BASE_URL,o)},TD.services.TwitterClient.prototype.checkUserStream=function(){TD.util.shouldStream()?this.streamEngine.connect(this.constructStreamingUrl()):this.streamEngine.disconnect()},TD.services.TwitterClient.prototype.processDeleteChirpEvent=function(e){e.status?TD.controller.feedManager.deleteChirp(e.status.id_str):e.direct_message?this.deleteMessage(e.direct_message.id_str):e.conversationId&&this.conversations.deleteConversation(e.conversationId)},TD.services.TwitterClient.prototype.processStreamData=function(e){if(e.friends){for(var t=0;t<e.friends.length;t++)this.friends[e.friends[t]]=!0;try{this.firstStreamConnect||TD.controller.feedScheduler.refreshAccountFeeds(this.oauth.account.getKey(),!0)}finally{this.firstStreamConnect=!1}}else if(e.warning)switch(e.warning.code){case this.streamWarningCodes.FOLLOWS_OVER_LIMIT:}else if(e.event)this.processStreamEvent(e);else if(e.limit);else if(e["delete"])this.processDeleteChirpEvent(e["delete"]);else if(e.user_events){var i=this.conversations.processStreamData(e);i.addCallbackWith(this,function(e){this.publishChirpsInternal("publish","direct",e)})}else if(e.id_str&&e.text){var n=this.processTweet(e);n.fudgeCreatedTime(n.created),this.processMiscTweet(n)}else if(e.conversationRenamed)this.conversations.renameConversation(e.conversationRenamed);else if(e.participantAdded){var i=this.conversations.processStreamData(e.participantAdded,!0);i.addCallbackWith(this,function(e){e.forEach(function(e){$(document).trigger("dataConversationParticipants",{conversationId:e.conversationId,participants:e.participants})}),this.publishChirpsInternal("publish","direct",e)})}else TD.controller.stats.unknownStreamData(e)},TD.services.TwitterClient.prototype.processMiscTweet=function(e){var t,i,n,s,r,a=this,o=Boolean(this.friends[e.user.id]),c=e.user.id==this.oauth.account.getUserID(),l=e.isMention(),u=Boolean(e.inReplyToID),d=Boolean(e.retweetedStatus),h=d&&e.retweetedStatus.user.id==this.oauth.account.getUserID(),p=d&&(e.retweetedStatus.user.following||this.friends[e.retweetedStatus.user.id]);

if(n=e.entities&&e.entities.user_mentions&&e.entities.user_mentions.some(function(e){return e.indices&&0===e.indices[0]?(r=e.id,!0):void 0}),s=n&&Boolean(this.friends[r]),!(this.blocks[e.user.id]||d&&this.blocks[e.retweetedStatus.user.id]||d&&this.retweetBlocks[e.user.id]&&!h||(c&&d&&(e.setRetweeted(!0),e.retweetedStatus.setRetweeted(!0)),(c||o&&(!n||s||l))&&(h||p||this.publishChirpsInternal("publish","home",[e])),h?(i=new TD.services.TwitterActionRetweet(this.oauth.account).fromRetweet(e),this.publishChirpsInternal("publish","interactions",[i])):l&&!d&&(this.publishChirpsInternal("publish","mentions",[e]),c||(t=new TD.services.TwitterActionMention(this.oauth.account).fromStreamData(e),this.publishChirpsInternal("publish","interactions",[t]))),_.each(this.streamingFeeds,function(t,i){var n=t.getMetadata();if(t.managed&&"search"==t.getType()){var s=n.term,r=a.cachedStreamingQueries[s];r||(r=a.cachedStreamingQueries[s]=new TD.services.TwitterSearchParser(s)),r.match(e.getFilterableText())&&a.queueChirpsForDispatch(i,[e])}}),o&&this.publishChirpsInternal("publish","usertweets",[e],{id:parseInt(e.user.id,10)}),c&&this.publishChirpsInternal("publish","usertweets",[e],{}),!u))){var m={ancestors:[],descendants:[e]};$.publish("/tweets/conversation/"+e.inReplyToID,[m])}},TD.services.TwitterClient.prototype.processStreamEvent=function(e){var t,i,n=!1;if(this.STREAM_LIST_EVENTS[e.event]&&(t=new TD.services.TwitterList(this.oauth.account).fromJSONObject(e.target_object)),e.source.id==this.oauth.account.getUserID())switch(e.event){case"favorite":n=e.source.id===e.target_object.user.id,i=this.processTweet(e.target_object),this.updateFavoriteInternal(i,!0);break;case"unfavorite":i=this.processTweet(e.target_object),this.updateFavoriteInternal(i,!1);break;case"follow":this.friends[e.target.id]=!0;break;case"unfollow":delete this.friends[e.target.id];break;case"block":this.addIdToBlockList(e.target.id),delete this.friends[e.target.id];break;case"unblock":delete this.blocks[e.target.id];break;case"list_created":case"list_updated":case"list_member_added":case"list_member_removed":case"list_user_subscribed":TD.cache.lists.add(t);break;case"list_destroyed":TD.cache.lists.purge(t.id);break;case"list_user_unsubscribed":TD.cache.lists.unsubscribe(t)}else"favorite"===e.event&&(e.target_object.favorited=!1,e.target_object.retweeted=!1);this.ACTIVITY_EVENT_TYPES[e.event]&&!n?this.publishStreamAction(e):this.DELETE_ACTIVITY_EVENT_TYPES[e.event]&&this.removeAction(e)},TD.services.TwitterClient.prototype.getResultsFromDeferred=function(e){var t=this.getDataFromDeferred(e);return t&&"undefined"!=typeof t.results?t.results:void 0},TD.services.TwitterClient.prototype.getDataFromDeferred=function(e){if(e&&"undefined"!=typeof e.data)return e.data;throw TypeError("deferred result is missing data")},TD.services.TwitterClient.prototype.cleanUp=function(){$.unsubscribe(this.subscription),this.streamEngine.disconnect(),this.scheduledTasks.forEach(function(e){TD.controller.scheduler.removePeriodicTask(e)})},TD.ui.main=function(){var e={},t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};e.TRANSITION_END_EVENTS=t[Modernizr.prefixed("transition")];var i={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"};e.ANIMATION_END_EVENTS=i[Modernizr.prefixed("animation")];var n=function(e,t){$(".js-app-add-column").removeClass("is-hidden")},s=function(e,t){$(".js-app-add-column").addClass("is-hidden")};return e.init=function(){var t=$("body"),i=$(TD.ui.template.render("topbar/app_header",{searchInputClassName:"js-app-search-input app-search-input",searchInputPlaceholder:TD.i("Search")})),r=$(TD.ui.template.render("app_container",{isMac:"osx"===TD.util.getOSName()}));$(".js-app").append(i),$(".js-app").append(r),TD.util.isTouchDevice()&&TD.decider.get("touchdeck_sidebar_v2")&&($(".js-app").addClass("with-touch-sidebar"),$(".js-app-header").addClass("is-touch-sidebar")),TD.util.isTouchDevice()&&window.navigator.standalone&&i.on("touchmove",function(e){var t=$(e.target);0===t.closest(".js-column-nav-scroller").length&&e.preventDefault()}),TD.util.isWrapperApp()&&deck.closeLoadingScreen&&deck.closeLoadingScreen(),t.on("click","a",function(e){TD.util.maybeOpenClickExternally(e)}),TD.ui.columns.init(),TD.ui.updates.init(),TD.ui.openColumn.init(),TD.util.isTouchDevice()||t.tooltip({selector:".js-show-tip",container:"body",delay:{show:500},suppressFadeOut:!0}),t.on("click","a",function(e){var t=$(e.currentTarget),i=t.attr("rel"),n=!1;switch(i){case"tweets":TD.storage.notification.notify(TD.components.OpenColumn.GO_EVENT,{data:TD.components.OpenColumnHome.URL_BASE+"/"+i+"?screenName="+t.attr("data-screen-name")}),n=!0;break;case"user":var s=t.data("user-name")||_.last(t.attr("href").split("/"));s=""+s,$(document).trigger("uiShowProfile",{id:s}),n=!0;break;case"hashtag":$(document).trigger("uiPerformSearch",{query:t.text()}),n=!0;break;case"search":$(document).trigger("uiPerformSearch",{query:t.attr("data-search-term")}),n=!0}n&&e.preventDefault(),e.isDefaultPrevented()===!1&&(TD.util.openURL(t.attr("href")),e.preventDefault())}),t.on("click","button",function(e){e.preventDefault()}),t.on("submit",function(e){e.preventDefault()}),$.subscribe("/storage/client/settings/column_width",e.updateColumnSize),e.updateColumnSize(),$.subscribe("/storage/client/settings/font_size",e.updateFontSize),e.updateFontSize();var a=_.debounce(function(e){$(document).trigger("uiMainWindowResized")},50);$(window).on("resize",a),$(document).on("uiColumnNavSizeOverflow",n.bind(this)),$(document).on("uiColumnNavSizeNormal",s.bind(this))},e.updateColumnSize=function(){var e=TD.settings.getColumnWidth(),t=$("html");switch(t.removeClass("is-narrow-columns is-medium-columns is-wide-columns"),e){case"narrow":t.addClass("is-narrow-columns");break;case"medium":t.addClass("is-medium-columns");break;case"wide":t.addClass("is-wide-columns")}$(document).trigger("uiColumnWidthChange",{columnWidth:e})},e.updateFontSize=function(){var e=TD.settings.getFontSize(),t=$("html");switch(t.removeClass("txt-base-smallest txt-base-small txt-base-medium txt-base-large txt-base-largest"),e){case"smallest":t.addClass("txt-base-smallest");break;case"small":t.addClass("txt-base-small");break;case"medium":t.addClass("txt-base-medium");break;case"large":t.addClass("txt-base-large");break;case"largest":t.addClass("txt-base-largest")}},e}(),TD.ui.openColumn=function(){function e(e,i){var n=e.split("?"),s=n[0].split("/").slice(1),r=n[1]||"",a=TD.net.util.formDecode(r),o=s.shift();switch(o){case"add":if("search"!==s[0]){var c=TD.components.OpenColumn.instance;c&&!c.canGo(o,s)&&(c.destroy(),c=null),c||(c=new TD.components.OpenColumn),c.go(o,s,a,i),c.setAndShowContainer(t,!1)}else $(document).trigger("uiAppSearchFocus")}}var t,i={};return i.init=function(){t=$("#open-modal"),$.subscribe(TD.components.OpenColumn.GO_EVENT,function(t){e(t.data,t.history)})},i.showOpenColumn=function(){e("/add/home")},i.showTwitterProfile=function(t){e("/profile/twitter/"+t)},i.showLists=function(){e("/add/lists")},i.showSearch=function(t){e("/search?q="+t)},i.showCustomTimelines=function(t,i){e(2===arguments.length?"/add/customtimelines?screenName="+TD.util.deMentionify(t)+"&slug="+i:"/add/customtimelines")},i.showImportSharedColumn=function(t){TD.decider.get("sac_enable_import")&&e("/add/sharedcolumn?state="+encodeURIComponent(t))},i.showList=function(t,i){e("/add/lists?screenName="+TD.util.deMentionify(t)+"&slug="+i)},i}(),TD.ui.updates=function(){function e(e,s,r,a){var o,c,l,u,d,h,p=$(e.target),m=!1;if(!($(".js-stream-item",e.target).length>0)&&(p.attr("rel")||(p=p.closest("a,button,[data-tweet-id]")),o=n.findParentArticle(p),s||(r||(r=TD.controller.columnManager.get(o.column)),r&&(a=r.findChirp(o.statusKey),s=r.findMostInterestingChirp(o.statusKey),(TD.decider.get("quote_tweet_read")||TD.decider.get("dm_shared_tweet"))&&(d=p.closest(".js-quote-detail"),d.length&&(h=d.attr("data-tweet-id"),s.quotedTweet&&s.quotedTweet.id===h&&(s=s.quotedTweet))))),s)){switch(c=p.attr("rel")){case"skipToReplies":$(document).trigger("uiSkipToReplies",{columnKey:r.model.getKey()});break;case"viewCustomTimeline":TD.ui.openColumn.showCustomTimelines(p.attr("data-screen-name"),p.attr("data-slug"));break;case"importSerializedColumn":$(document).trigger("uiShowImportColumnDialog",{columnState:p.attr("data-serialized-column")});break;case"list":TD.ui.openColumn.showList(p.attr("data-screen-name"),p.attr("data-slug"));break;case"actionsMenu":p.trigger("uiShowActionsMenu");break;case"mediaPreview":m=t(s,p.attr("href"),p.attr("data-media-entity-id"),r);break;case"retweet":case"like":case"favorite":case"destroy":case"edit":case"reply":case"viewDetails":case"followStatus":case"dm":case"showSensitiveMedia":case"alwaysShowSensitiveMedia":case"customTimeline":case"removeFromCustomTimeline":i(c,s,a,r,o);break;case"globalSettings":$(document).trigger("uiShowGlobalSettings");break;case"tweet":l=p.attr("data-tweet-id"),u=TD.controller.clients.getClient(s.account.getKey()),u.show(l,function(e){i("viewDetails",e,a,r,o)},function(){TD.util.openURL(p.attr("href"))});break;case"viewConversationParticipants":$(document).trigger("uiShowDmParticipants",{columnKey:r.model.getKey(),conversationId:s.conversationId,accountKey:s.account.getKey()});default:m=!0}return m||(e.preventDefault(),e.stopPropagation()),!1}}function t(e,t,i,n){return n.temporary?(TD.util.openURL(t),!0):(new TD.components.MediaGallery(e,t,i,n),!1)}function i(e,t,i,s,r){var a,o;switch(e){case"retweet":case"like":case"favorite":case"destroy":case"edit":e in t&&t[e](r);break;case"reply":a=t.getMainTweet(),$(document).trigger("uiComposeTweet",{type:"reply",from:[t.account.getKey()],inReplyTo:{id:a.id,htmlText:a.htmlText,user:{screenName:a.user.screenName,name:a.user.name,profileImageURL:a.user.profileImageURL}},mentions:t.getReplyUsers(),element:r&&r.element});break;case"viewDetails":n.showDetailView(s,t,i);break;case"followStatus":$(document).trigger("uiShowFollowFromOptions",{userToFollow:t});break;case"dm":o=t.getMainUser(),$(document).trigger("uiComposeTweet",{type:"message",from:[o.account.getKey()],messageRecipients:[{screenName:o.screenName,avatar:o.profileImageURL}]});break;case"showSensitiveMedia":n.showSensitiveMedia(t);break;case"alwaysShowSensitiveMedia":n.alwaysShowSensitiveMedia(t);break;case"customTimeline":new TD.components.AddToCustomTimelineDialog(t.getMainTweet());break;case"removeFromCustomTimeline":var c=r.element;if(!c)break;$(c).trigger("uiRemoveTweetFromCustomTimeline",{tweetId:t.getMainTweet().id})}}var n={currentlyDisplayedProfile:null};return n.init=function(){$(document).on("click",".js-show-detail",function(e){var t,i,s,r,a=window.getSelection(),o=0===a.rangeCount?!1:a.getRangeAt(0);return o&&o.endOffset!==o.startOffset||(t=n.findParentArticle($(this)),i=TD.controller.columnManager.get(t.column),i&&(s=i.findMostInterestingChirp(t.statusKey),r=i.findChirp(t.statusKey),n.showDetailView(i,s,r))),!1}),$("body").delegate(".js-stream-item a, .js-stream-item button, .js-detail-view-inline, .js-quote-detail","click",e),$.subscribe("chirp/click",function(t,i,n){e(t,i,n)}),$.subscribe("chirp/action",i),TD.controller.scheduler.schedulePeriodicTask(30,TD.ui.updates.refreshTimestamps)},n.refreshTimestamps=function(){var e=TD.util.prettyDate;$(".js-timestamp").each(function(t,i){var n,s,r,a=$(this);n=a.attr("data-time"),r=new Date(Number(n)),s=e(r),$("a,span",a).text(s)})},n.findParentArticle=function(e){var t=e.closest(".js-stream-item,.js-tweet-box");return{element:t,statusKey:t.attr("data-key"),column:t.closest(".js-chirp-container, .js-column").data("column")}},n.showDetailView=function(e,t,i){var n=e.model.getKey(),s=TD.ui.columns.getColumnElementByKey(n);TD.ui.columns.exitEditMode(n),e.detailViewComponent&&e.detailViewComponent.destroy(),i instanceof TD.services.TwitterConversationMessageEvent&&t.quotedTweet?TD.controller.stats.sharedTweetDM():t instanceof TD.services.DataminrAlert?e.detailViewComponent=new TD.components.DataminrDetailView(e,s):t instanceof TD.services.TwitterStatus?e.detailViewComponent=new TD.components.TweetDetailView(e,s):t instanceof TD.services.TwitterConversation&&($(document).trigger("metric",{key:"dm:ui:conversation:view"}),$(document).trigger("scribeEvent",{terms:{page:"main",component:"conversations",section:"detail",action:"impression"}}),e.detailViewComponent=new TD.components.ConversationDetailView(e,s)),e.detailViewComponent.showChirp(t,i)},n.showSensitiveMedia=function(e){var t=e.getDOMChirps();t.find(".js-media-sensitive-overlay").addClass("is-hidden"),t.find(".js-media-preview-container").removeClass("media-size-medium media-sensitive-detail"),t.find(".js-media-image-link, .js-media-native-video, .js-media-gif").removeClass("is-invisible"),e.possiblySensitive=!1},n.alwaysShowSensitiveMedia=function(e){TD.settings.setDisplaySensitiveMedia(!0)},n}(),TD.globalRenderOptions={styledScrollbar:TD.util.hasFixedScrollBars(),isTouchDevice:TD.util.isTouchDevice(),asset:function(){return function(e){return TD.assets.get(e)}}},TD.ui.Column=function(e){this.chirpContainerSelector='.js-chirp-container[data-column="'+e+'"]',this.infiniteSpinnerSelector=".js-infinitespinner",this.globalTpmAnimationLimit=2e3,this.columnTpmAnimationLimit=120,this.chirpStaggeringInterval=400,this.fadeInClass="column-opacity-transition",this.state={columnKey:e,$noResults:null,animating:!1,animationQueue:[]}},TD.ui.Column.identifyInlinedLinks=function(e){e.find(".is-quote-tweet a.url-ext[rel=tweet]:last-child").each(function(e,t){null==t.nextSibling&&$(t).addClass("is-vishidden")})},TD.ui.Column.prototype.getChirpContainer=function(){return this._$chirpContainer&&0!==this._$chirpContainer.length||(this._$chirpContainer=$(this.chirpContainerSelector)),this._$chirpContainer},TD.ui.Column.prototype.removeChirp=function(e,t){var i=this.getChirpContainer().find('[data-key="'+e+'"]');TD.ui.columns.alterColumnContents(this.state.columnKey,i,function(e){e.remove()},t)},TD.ui.Column.prototype.slideInChirps=function(e,t,i,n,s){var r=[],a=TD.controller.columnManager.isStreaming(this.state.columnKey),o=TD.ui.columns.isScrolledToTop(this.state.columnKey),c=t&&this.getChirpContainer().closest(".is-hidden").length,l=!c&&i<this.globalTpmAnimationLimit&&n<this.columnTpmAnimationLimit;if(e&&!s.insertAtBottom){e.each(function(){r.push($(this).toggleClass("is-animating"))}),r.reverse();var u=!o||TD.ui.columns.columnIsLockedToElement(this.state.columnKey);s&&s.insertAtTop&&u?(r.forEach(function(e){this.shortcircuitChirpSlide(e,!0)},this),this.getChirpContainer().trigger("uiReadStateChange",{read:!1})):this.state.animationQueue=this.state.animationQueue.concat(r),r=[]}if(!this.state.animating){o||(this.state.animationQueue=this.processOffScreenAnimationQueue(this.state.animationQueue)),this.state.animationQueue=this.state.animationQueue.filter(function(e){var t=s&&!s.insertAtTop,i=a||t;return i&&this.slideInChirp(e,l),!i},this);var d=this.state.animationQueue.shift();d&&(this.state.animating=!0,this.slideInChirp(d,l),setTimeout(function(){this.state.animating=!1,this.slideInChirps(null,t,i,n)}.bind(this),this.chirpStaggeringInterval))}},TD.ui.Column.prototype.processOffScreenAnimationQueue=function(e){var t=e.filter(function(e){var t=e.position().top<0;return t&&this.shortcircuitChirpSlide(e,t),!t}.bind(this));return t.length<e.length&&this.getChirpContainer().trigger("uiReadStateChange",{read:!1}),t},TD.ui.Column.prototype.shortcircuitChirpSlide=function(e,t){TD.ui.columns.alterColumnContents(this.state.columnKey,e,function(e){e.removeClass("is-animating")},{willBreakScrollPosition:t})},TD.ui.Column.prototype.slideInChirp=function(e,t){var i,n=function(){e.removeClass("is-animating"),e.removeAttr("style"),$(document).trigger("uiColumnChirpsChanged",{id:this.state.columnKey})}.bind(this);t&&TD.ui.main.TRANSITION_END_EVENTS?(i=e.find(".js-stream-item-content").outerHeight(),e.css({opacity:1,height:i+"px"}),e.one(TD.ui.main.TRANSITION_END_EVENTS,n)):n()},TD.ui.Column.prototype.renderChirps=function(e,t){var i,n,s,r,a=[];for(n=0;n<e.length;n++)s=e[n],r=s.getMainUser&&s.getMainUser().isProtected,i=e[n].render({isTemporaryColumn:t.isTemporaryColumn,mediaPreviewSize:t.mediaPreviewSize,isMinimalist:t.doRenderMinimalist,withShowVerified:t.showVerifiedBadge,withRemove:t.isOwnCustomTimeline,withDragHandle:!t.isTemporaryColumn&&!r&&!t.isOwnCustomTimeline}),a.push(i);return a.join("")},TD.ui.Column.prototype.hideChirpContainer=function(){var e=this.getChirpContainer();e.css("opacity",0),_.defer(function(){e.addClass(this.fadeInClass)}.bind(this))},TD.ui.Column.prototype.fadeInChirpContainer=function(){var e=this.getChirpContainer(),t=function(){e.removeClass(this.fadeInClass).removeAttr("style"),$(document).trigger("uiColumnChirpsChanged",{id:this.state.columnKey})}.bind(this);_.defer(function(){e.css("opacity",1),TD.ui.main.TRANSITION_END_EVENTS?e.one(TD.ui.main.TRANSITION_END_EVENTS,t):t()})},TD.ui.Column.prototype.addInfiniteScrollSpinner=function(){this.getChirpContainer().append(TD.ui.template.render("spinner_large"))},TD.ui.Column.prototype.removeInfiniteScrollSpinner=function(){$(this.infiniteSpinnerSelector,this.getChirpContainer()).remove()},TD.ui.Column.prototype.showIsUpdatingMessage=function(){var e=$(TD.ui.template.render("column_loading_placeholder",{isUpdating:!0}));this.getChirpContainer().html(e)},TD.ui.Column.prototype.hideIsUpdatingMessage=function(){this.getChirpContainer().find(".js-column-loading-placeholder").remove()},TD.ui.Column.prototype.showNoResultsMessage=function(e,t){var i=this.getChirpContainer();i.css("opacity",1).removeClass(this.fadeInClass),this.state.$noResults=$(TD.ui.template.render("search_no_tweets_placeholder",{isDropTarget:!e&&t,withAddByUrl:!e&&t})),i.html(this.state.$noResults)},TD.ui.Column.prototype.hideNoResultsMessage=function(){this.state.$noResults&&this.state.$noResults.remove()};var TD,jQuery;TD.net.ajax=function(){var e={},t=function(e,t,i){var n=TD.config.api_root+"/oauth/"+t;return n+="/"+i.getType()+"/",n+=encodeURIComponent(e)},i=function(e,t){t.isContributor()&&(e["X-Contribute-To-User-Id"]=t.getUserID(),t=TD.storage.store.getTwitterLoginAccount()),e["x-td-oauth-key"]=t.getOAuthToken(),e["x-td-oauth-secret"]=t.getTokenSecret(),e["x-td-oauth-service"]=t.getType()},n=function(e){return""===e?null:jQuery.parseJSON(e)};return e.sendRequest=function(e,t,i,s,r){var a,o,c=!1,l=new TD.core.defer.Deferred(function(){c=!0,a.abort()}),u={url:t,global:!1,type:e,dataType:"text json",converters:{"text json":n}};return r&&_.extend(u,r),i=_.defaults(i||{},{"X-Twitter-Client-Version":TD.util.getTweetDeckUserAgentString()}),("LOCAL"===TD.buildID||TD.config.internal_build||TD.decider.get("force_zipkin_header"))&&t.indexOf("twitter.com")>-1&&(i["X-B3-Flags"]=1),u.beforeSend=function(e){_.each(i,function(t,i){"content-type"!==i.toLowerCase()&&e.setRequestHeader(i,t)})},s&&(u.data=s),o=i["Content-Type"]||i["content-type"],o&&(u.contentType=o,"application/json"===o&&(u.data=JSON.stringify(u.data))),a=jQuery.ajax(u),a.done(function(e,t,i){l.callback({data:e,xhr:i})}),a.fail(function(e,t,i){l.errback(c?new TD.core.defer.CancelledError(e,"abort"):new TD.core.defer.XMLHttpRequestError(e,i))}),l},e.jsonp=function(t,i){var n=e.sendRequest("GET",t,{},i,{dataType:"jsonp",timeout:1e4});return n},e.upload=function(t,n,s){var r,a={};return i(a,s),r=e.sendRequest("POST",t,a,n,{timeout:12e4,processData:!1,contentType:!1})},e.signRequest=function(n,s,r,a,o){var c,l,u;return o=o||{},i(o,n),u="GET"===r?"echo":"sign",l=t(s,u,n),c=e.sendRequest(r,l,o,a)},e.getSignedUrl=function(n,s){var r,a,o={};i(o,n),a=t(s,"sign",n),a=TD.net.util.addURLParameters(a,o);var c={"x-td-oauth-no-redirect":!0};return r=e.sendRequest("GET",a,c)},e.request=function(n,s){s=s||{};var r,a,o=s.headers||{},c=s.method||"GET",l=s.account,u=s.params||null;return"POST"===c&&-1!==n.indexOf("curation")&&(o["Content-Type"]="application/json"),("GET"===c||"DELETE"===c)&&s.params&&(n=TD.net.util.addURLParameters(n,u),u={}),!TD.util.isChromeApp()||TD.decider.get("proxy_all_traffic")?(i(o,l),r=t(n,"proxy",l),a=e.sendRequest(c,r,o,u)):"GET"===c?(i(o,l),r=t(n,"sign",l),a=e.sendRequest(c,r,o)):(a=e.signRequest(l,n,c,u,{}),a.addCallback(function(t){var i=t.data,n=_.defaults(o,i.headers);l.isContributor()&&(n["X-Contribute-To-User-Id"]=l.getUserID());var s=i.body;return"application/json"===n["Content-Type"]&&(s=u),e.sendRequest(c,i.url,n,s)})),a},e}(),function(e){function t(e,t){return 32-new Date(e,t,32).getDate()}function i(e,t){for(e=""+e,t=t||2;e.length<t;)e="0"+e;return e}function n(e,t,n){var s=e.getDate(),r=e.getDay(),a=e.getMonth(),o=e.getFullYear(),c={d:s,dd:i(s),ddd:d[n].shortDays[r],dddd:d[n].days[r],m:a+1,mm:i(a+1),mmm:d[n].shortMonths[a],mmmm:d[n].months[a],yy:String(o).slice(2),yyyy:o},l=t.replace(h,function(e){return e in c?c[e]:e.slice(1,e.length-1)});return p.html(l).html()}function s(e){return parseInt(e,10)}function r(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function a(e){if(e){if(e.constructor==Date)return e;if("string"==typeof e){var t=e.split("-");if(3==t.length)return new Date(s(t[0]),s(t[1])-1,s(t[2]));if(!/^-?\d+$/.test(e))return;e=s(e)}var i=new Date;return i.setDate(i.getDate()+e),i}}function o(i,o){function c(t,s,r){S=t,f=t.getFullYear(),g=t.getMonth(),v=t.getDate(),r=r||e.Event("api"),r.type="change",A.trigger(r,[t]),r.isDefaultPrevented()||(i.val(n(t,s.format,s.lang)),i.data("date",t),b.hide(r))}function h(e){e.type="onShow",A.trigger(e)}var p,m,f,g,v,T,b=this,w=new Date,y=o.css,_=d[o.lang],D=e("#"+y.root),C=D.find("#"+y.title),S=i.attr("data-value")||o.value||i.val(),E=i.attr("min")||o.min,x=i.attr("max")||o.max;if(0===E&&(E="0"),S=a(S)||w,E=a(E||365*o.yearRange[0]),x=a(x||365*o.yearRange[1]),!_)throw"Dateinput: invalid language: "+o.lang;if("date"==i.attr("type")){var k=e("<input/>");e.each("class,disabled,id,maxlength,name,readonly,required,size,style,tabindex,title,value".split(","),function(e,t){k.attr(t,i.attr(t))}),i.replaceWith(k),i=k}i.addClass(y.input);var A=i.add(b);if(!D.length){if(D=e("<div><div><div/></div><div><div/><div/></div></div>").hide().css({position:"relative"}).attr("id",y.root),D.children().eq(0).attr("id",y.head).end().eq(1).attr("id",y.body).children().eq(0).attr("id",y.days).end().eq(1).attr("id",y.weeks).end().end().end(),C=D.find("#"+y.head).find("div").attr("id",y.title),o.selectors){var I=e("<select/>").attr("id",y.month),M=e("<select/>").attr("id",y.year);C.html(I.add(M))}for(var R=D.find("#"+y.days),L=0;7>L;L++)R.append(e("<span/>").text(_.shortDays[(L+o.firstDay)%7]));e("#calendar").append(D)}var N=D.find("#"+y.weeks);M=D.find("#"+y.year),I=D.find("#"+y.month),e.extend(b,{show:function(t){if(!(i.attr("readonly")||i.attr("disabled")||T||(t=t||e.Event(),t.type="onBeforeShow",A.trigger(t),t.isDefaultPrevented()))){e.each(l,function(){this.hide()}),T=!0,I.unbind("change").change(function(){b.setValue(M.val(),e(this).val())}),M.unbind("change").change(function(){b.setValue(e(this).val(),I.val())}),p=D.find("#"+y.prev).unbind("click").click(function(e){return p.hasClass(y.disabled)||b.addMonth(-1),!1}),m=D.find("#"+y.next).unbind("click").click(function(e){return m.hasClass(y.disabled)||b.addMonth(),!1}),b.setValue(S);var n=i.offset();return/iPad/i.test(navigator.userAgent)&&(n.top-=e(window).scrollTop()),o.speed?D.show(o.speed,function(){h(t)}):(D.show(),h(t)),b}},setValue:function(i,n,a){var l=s(n)>=-1?new Date(s(i),s(n),s(a||1)):i||S;if(E>l?l=E:l>x&&(l=x),i=l.getFullYear(),n=l.getMonth(),a=l.getDate(),-1==n?(n=11,i--):12==n&&(n=0,i++),!T)return c(l,o),b;g=n,f=i,v=a;var u,d=new Date(i,n,1-o.firstDay),h=d.getDay(),D=t(i,n),k=t(i,n-1);if(o.selectors){I.empty(),e.each(_.months,function(t,n){E<new Date(i,t+1,-1)&&x>new Date(i,t,0)&&I.append(e("<option/>").html(n).attr("value",t))}),M.empty();for(var A=w.getFullYear(),R=A+o.yearRange[0];R<A+o.yearRange[1];R++)E<=new Date(R+1,-1,1)&&x>new Date(R,0,0)&&M.append(e("<option/>").text(R));I.val(n),M.val(i)}else C.html(_.months[n]+" "+i);N.empty(),p.add(m).removeClass(y.disabled);for(var L,O,U=h?0:-7;(h?42:35)>U;U++)L=e("<a/>"),U%7===0&&(u=e("<div/>").addClass(y.week),N.append(u)),h>U?(L.addClass(y.off),O=k-h+U+1,l=new Date(i,n-1,O)):U>=h+D?(L.addClass(y.off),O=U-D-h+1,l=new Date(i,n+1,O)):(O=U-h+1,l=new Date(i,n,O),r(S,l)?L.attr("id",y.current).addClass(y.focus):r(w,l)&&L.attr("id",y.today)),E&&E>l&&L.add(p).addClass(y.disabled),x&&l>x&&L.add(m).addClass(y.disabled),L.attr("href","#"+O).text(O).data("date",l),u.append(L);return N.find("a").click(function(t){var i=e(this);return i.hasClass(y.disabled)||(e("#"+y.current).removeAttr("id"),i.attr("id",y.current),c(i.data("date"),o,t)),!1}),y.sunday&&N.find(y.week).each(function(){var t=o.firstDay?7-o.firstDay:0;e(this).children().slice(t,t+1).addClass(y.sunday)}),b},setMin:function(e,t){return E=a(e),t&&E>S&&b.setValue(E),b},setMax:function(e,t){return x=a(e),t&&S>x&&b.setValue(x),b},today:function(){return b.setValue(w)},addDay:function(e){return this.setValue(f,g,v+(e||1))},addMonth:function(e){return this.setValue(f,g+(e||1),v)},addYear:function(e){return this.setValue(f+(e||1),g,v)},hide:function(t){if(T){if(t=e.Event(),t.type="onHide",A.trigger(t),e(document).unbind("click.d").unbind("keydown.d"),t.isDefaultPrevented())return;D.hide(),T=!1}return b},getConf:function(){return o},getInput:function(){return i},getCalendar:function(){return D},getValue:function(e){return e?n(S,e,o.lang):S},isOpen:function(){return T}}),e.each(["onBeforeShow","onShow","change","onHide"],function(t,i){e.isFunction(o[i])&&e(b).bind(i,o[i]),b[i]=function(t){return t&&e(b).bind(i,t),b}}),i.bind("focus click",b.show).keydown(function(t){var i=t.keyCode;return!T&&e(u).index(i)>=0?(b.show(t),t.preventDefault()):t.shiftKey||t.ctrlKey||t.altKey||9==i?!0:t.preventDefault()}),a(i.val())&&c(S,o)}e.tools=e.tools||{version:"1.2.5"};var c,l=[],u=[75,76,38,39,74,72,40,37],d={};c=e.tools.dateinput={conf:{format:"mm/dd/yy",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:void 0,max:void 0,trigger:!1,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},localize:function(t,i){e.each(i,function(e,t){i[e]=t.split(",")}),d[t]=i}},c.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"S,M,T,W,T,F,S"});var h=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,p=e("<a/>");e.expr[":"].date=function(t){var i=t.getAttribute("type");return i&&"date"==i||!!e(t).data("dateinput")},e.fn.dateinput=function(t){if(this.data("dateinput"))return this;t=e.extend(!0,{},c.conf,t),e.each(t.css,function(e,i){i||"prefix"==e||(t.css[e]=(t.css.prefix||"")+(i||e))});var i;return this.each(function(){var n=new o(e(this),t);l.push(n);var s=n.getInput().data("dateinput",n);i=i?i.add(s):s}),i?i:this}}(jQuery),function(e){e.createElement=function(t){return e(document.createElement(t))}}(jQuery),!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e,t=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in i)if(void 0!==t.style[e])return i[e]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,i,n){var s,r,a,o,c;for(this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.enabled=!0,a=this.options.trigger.split(" "),c=a.length;c--;)o=a[c],"click"==o?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):"manual"!=o&&(s="hover"==o?"mouseenter":"focus",r="hover"==o?"mouseleave":"blur",this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var i=e(t.currentTarget)[this.type](this._options).data(this.type);return i.options.delay&&i.options.delay.show?(clearTimeout(this.timeout),i.hoverState="in",void(this.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show))):i.show()},leave:function(t){var i=e(t.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),i.options.delay&&i.options.delay.hide?(i.hoverState="out",void(this.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide))):i.hide()},show:function(){var t,i,n,s,r,a,o=e.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(o),o.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),t.detach(),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),r=this.getPlacement(),t.css({top:"object"==typeof r?r.top:0,left:"object"==typeof r?r.left:0,display:"block"}),i=this.getPosition(),n=t[0].offsetWidth,s=t[0].offsetHeight,this.elementOffset=this.$element.offset(),this.interval=setInterval(function(){var e=this.$element.closest("body").length>0,t=this.$element.offset(),i=this.elementOffset&&(this.elementOffset.top!=t.top||this.elementOffset.left!=t.left);(!e||i)&&this.hide()}.bind(this),500),r){case"bottom":a={top:i.top+i.height,left:i.left+i.width/2-n/2};break;case"top":a={top:i.top-s,left:i.left+i.width/2-n/2};break;case"left":a={top:i.top+i.height/2-s/2,left:i.left-n};break;case"right":a={top:i.top+i.height/2-s/2,left:i.left+i.width}}this.applyPlacement(a,r.className||r),this.$element.trigger("shown")}},applyPlacement:function(e,t){var i,n,s,r,a=this.tip(),o=a[0].offsetWidth,c=a[0].offsetHeight;a.offset(e).addClass("string"==typeof t?t:t.placement).addClass("in"),i=a[0].offsetWidth,n=a[0].offsetHeight,"top"==t&&n!=c&&(e.top=e.top+c-n,r=!0),"bottom"==t||"top"==t?(s=0,e.left<0&&(s=-2*e.left,e.left=0,a.offset(e),i=a[0].offsetWidth,n=a[0].offsetHeight),this.replaceArrow(s-o+i,i,"left")):this.replaceArrow(n-c,n,"top"),r&&a.offset(e)},replaceArrow:function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){i.off(e.support.transition.end).detach()},500);i.one(e.support.transition.end,function(){clearTimeout(t),i.detach()})}var i=this.tip(),n=e.Event("hide");return this.$element.trigger(n),n.isDefaultPrevented()?void 0:(i.removeClass("in"),!this.options.suppressFadeOut&&e.support.transition&&this.$tip.hasClass("fade")?t():i.detach(),this.elementOffset=null,clearInterval(this.interval),this.$element.trigger("hidden"),this)},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPlacement:function(){var e=this.$element,t=e.attr("data-tooltip-position");return t||(t="function"==typeof this.options.placement?this.options.placement.call(this,this.$tip[0],this.$element[0]):this.options.placement),t},getPosition:function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset());

},getTitle:function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var i=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;i.tip().hasClass("in")?i.hide():i.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),s=n.data("tooltip"),r="object"==typeof i&&i;s||n.data("tooltip",s=new t(this,r)),"string"==typeof i&&s[i]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(window.jQuery),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,i,n,s){return jQuery.easing[jQuery.easing.def](e,t,i,n,s)},easeInQuad:function(e,t,i,n,s){return n*(t/=s)*t+i},easeOutQuad:function(e,t,i,n,s){return-n*(t/=s)*(t-2)+i},easeInOutQuad:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,s){return n*(t/=s)*t*t+i},easeOutCubic:function(e,t,i,n,s){return n*((t=t/s-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,s){return n*(t/=s)*t*t*t+i},easeOutQuart:function(e,t,i,n,s){return-n*((t=t/s-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,s){return n*(t/=s)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,s){return n*((t=t/s-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,s){return-n*Math.cos(t/s*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,s){return n*Math.sin(t/s*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,s){return-n/2*(Math.cos(Math.PI*t/s)-1)+i},easeInExpo:function(e,t,i,n,s){return 0==t?i:n*Math.pow(2,10*(t/s-1))+i},easeOutExpo:function(e,t,i,n,s){return t==s?i+n:n*(-Math.pow(2,-10*t/s)+1)+i},easeInOutExpo:function(e,t,i,n,s){return 0==t?i:t==s?i+n:(t/=s/2)<1?n/2*Math.pow(2,10*(t-1))+i:n/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,n,s){return-n*(Math.sqrt(1-(t/=s)*t)-1)+i},easeOutCirc:function(e,t,i,n,s){return n*Math.sqrt(1-(t=t/s-1)*t)+i},easeInOutCirc:function(e,t,i,n,s){return(t/=s/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,s){var r=1.70158,a=0,o=n;if(0==t)return i;if(1==(t/=s))return i+n;if(a||(a=.3*s),o<Math.abs(n)){o=n;var r=a/4}else var r=a/(2*Math.PI)*Math.asin(n/o);return-(o*Math.pow(2,10*(t-=1))*Math.sin(2*(t*s-r)*Math.PI/a))+i},easeOutElastic:function(e,t,i,n,s){var r=1.70158,a=0,o=n;if(0==t)return i;if(1==(t/=s))return i+n;if(a||(a=.3*s),o<Math.abs(n)){o=n;var r=a/4}else var r=a/(2*Math.PI)*Math.asin(n/o);return o*Math.pow(2,-10*t)*Math.sin(2*(t*s-r)*Math.PI/a)+n+i},easeInOutElastic:function(e,t,i,n,s){var r=1.70158,a=0,o=n;if(0==t)return i;if(2==(t/=s/2))return i+n;if(a||(a=.3*s*1.5),o<Math.abs(n)){o=n;var r=a/4}else var r=a/(2*Math.PI)*Math.asin(n/o);return 1>t?-.5*o*Math.pow(2,10*(t-=1))*Math.sin(2*(t*s-r)*Math.PI/a)+i:o*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*s-r)*Math.PI/a)*.5+n+i},easeInBack:function(e,t,i,n,s,r){return void 0==r&&(r=1.70158),n*(t/=s)*t*((r+1)*t-r)+i},easeOutBack:function(e,t,i,n,s,r){return void 0==r&&(r=1.70158),n*((t=t/s-1)*t*((r+1)*t+r)+1)+i},easeInOutBack:function(e,t,i,n,s,r){return void 0==r&&(r=1.70158),(t/=s/2)<1?n/2*t*t*(((r*=1.525)+1)*t-r)+i:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+i},easeInBounce:function(e,t,i,n,s){return n-jQuery.easing.easeOutBounce(e,s-t,0,n,s)+i},easeOutBounce:function(e,t,i,n,s){return(t/=s)<1/2.75?7.5625*n*t*t+i:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(e,t,i,n,s){return s/2>t?.5*jQuery.easing.easeInBounce(e,2*t,0,n,s)+i:.5*jQuery.easing.easeOutBounce(e,2*t-s,0,n,s)+.5*n+i}}),function(e){e.fn.draggable=function(t){var i={translateY:!0,translateX:!0,boundary:"body"};return e(this).each(function(){function n(){h&&0!==h.length||(h="function"==typeof d.boundary?d.boundary():e(d.boundary))}function s(){return h[0].scrollHeight}function r(){return h[0].scrollWidth}function a(e,t,i){var n,a,o,c,l,u,d,p,m,f,g,T,b,w,y;"x"===i?(t=t.x,c=v.outerWidth(),n=v.offset().left,l=h.offset().left,u=h.outerWidth(),p=e.pageX<n,m=e.pageX>n+c,w="left",y=r()):(t=t.y,c=v.outerHeight(),n=v.offset().top,l=h.offset().top,u=h.outerHeight(),p=e.pageY<n,m=e.pageY>n+c,w="top",y=s()),T=t>0,b=0>t,a=parseInt(v.css(w),10),f=l>n,o=a+c,g=n+c>l+u,p&&T||m&&b||f&&b||g&&T||(d=b?0>a+t?0:a+t:o+t>y?y-c-1:a+t,v.css(w,d))}function o(e){var t={y:e.pageY-f,x:e.pageX-g},i=!1;f=e.pageY,g=e.pageX,e.preventDefault(),d.translateY&&(a(e,t,"y"),i=!0),d.translateX&&(a(e,t,"x"),i=!0),i&&v.trigger("drag.draggable",[t,{y:e.pageY,x:e.pageX}])}function c(){e(document).unbind("mousemove",l).unbind("mousemove",o).unbind("mouseup",c),T&&v.trigger("drop.draggable").removeClass("draggable-dragging"),T=!1}function l(t){T=!0,e(document).unbind("mousemove",l).bind("mousemove",o),f=t.pageY,g=t.pageX,n(),p=s(),m=r(),v.trigger("start.draggable",[t.offsetY,t.offsetX]).addClass("draggable-dragging")}function u(t){t.preventDefault(),e(document).bind("mousemove",l).bind("mouseup",c)}var d,h,p,m,f,g,v=e(this),T=!1;d=v.data("draggable")?e.extend({},v.data("draggable").settings,t):e.extend({},i,t),void 0===d.handle&&(d.handle=v),"string"==typeof d.handle?v.off("mousedown",d.handle,u).on("mousedown",d.handle,u):d.handle.unbind("mousedown",u).bind("mousedown",u),v.data("draggable",{settings:d})}),this}}(jQuery),function(e){var t=function(t){function i(){var t=e(this).position().top+T.scrollTop(),i=e(this).position().left+T.scrollLeft(),n=e(this).innerWidth();p.top.unshift(t),p.left.unshift(i),e(this).css({position:"absolute",top:t,left:i,width:n})}function n(n){p={top:[],left:[]},e.fn.reverse=[].reverse,g=function(){var i=0;return T.find(t.contentSelector).each(function(){i+=e(this).outerHeight()}),i}(),v=function(){var i=0;return T.find(t.contentSelector).each(function(){i+=e(this).outerWidth()}),i}(),e(this).append(e("<"+t.tagName+"/>",{"class":"placeholder",height:e(this).height(),width:e(this).width()})),T.css("z-index",2).find(t.selector).each(function(t){e(this).data("draggable-index",t)}).reverse().each(i),h=e(n.target),h.css({"z-index":10})}function s(e,i){var n,s,r=h.data("draggable-index"),a=e.data("draggable-index"),o=e.outerHeight()-h.outerHeight(),c=e.outerWidth()-h.outerWidth(),l=parseInt(h.css("margin-left"),10),u=parseInt(h.css("margin-top"),10),d=parseInt(e.css("margin-right"),10),m=parseInt(e.css("margin-bottom"),10);switch(i){case b:n=p.top[r]-o;break;case w:n=p.top[r],p.top[a]=n+e.outerHeight()+m+u;break;case y:s=p.left[r]-c;break;case D:s=p.left[r],p.left[a]=s+e.outerWidth()+d+l}"vertical"===t.orientation?e.stop().animate({top:n},"fast"):e.stop().animate({left:s},"fast"),h.data("draggable-index",a),e.data("draggable-index",r)}function r(e){var i,n,r,a,o,c=h.position().top,l=h.outerHeight(),u=h.position().left,d=h.outerWidth();if(i=e===b||e===y?h.prev(t.selector):h.next(t.selector),i.length)switch(n=i.position().top,r=i.outerHeight(),a=i.position().left,o=i.outerWidth(),e){case b:n+r/2>c&&(h.insertBefore(i),s(i,e));break;case w:c+l>n+r/2&&(h.insertAfter(i),s(i,e));break;case y:a+o/2>u&&(h.insertBefore(i),s(i,e));break;case D:u+d>a+o/2&&(h.insertAfter(i),s(i,e))}}function a(e){var i=(new Date).getTime()-f,n=T.scrollTop(),s=parseInt(h.css("top"),10),a=s+h.outerHeight(),o=T.scrollLeft(),l=parseInt(h.css("left"),10),u=l+h.outerWidth(),d=1+i/1e3,p=Math.min(d*t.scroll_speed,3*t.scroll_speed);p=e===w||e===D?p:-p,"vertical"===t.orientation?0>n+p?c():n+p>g-T.innerHeight()?c():(T.scrollTop(T.scrollTop()+p),s+p>0&&g>a+p&&h.css({top:s+p}),r(e)):0>o+p?c():o+p>v-T.innerWidth()?c():(T.scrollLeft(T.scrollLeft()+p),l+p>0&&v>u+p&&h.css({left:l+p}),r(e))}function o(e){f=(new Date).getTime(),c(),m=setInterval(_.bind(a,this,e),C)}function c(){clearInterval(m),m=null}function l(e,i,n){if(h){var s,a,l,u=parseInt(h.css("top"),10),d=u+h.outerHeight(),p=parseInt(h.css("left"),10),f=p+h.outerWidth(),g=T.scrollTop()+T.innerHeight(),v=T.scrollLeft()+T.innerWidth();if(i)if("vertical"===t.orientation){for(s=i.y<0?b:w,a=i.y;0>a;)r(s),a+=h.outerHeight();for(a=i.y;a>0;)r(s),a-=h.outerHeight()}else{for(s=i.x<0?y:D,l=i.x;0>l;)r(s),l+=h.outerWidth();for(l=i.x;l>0;)r(s),l-=h.outerWidth()}n?(n.y>T.offset().top||n.y<T.offset().top+T.outerHeight())&&c():c(),m||("vertical"===t.orientation?d>g?o(w):u<T.scrollTop()?o(b):c():f>v?o(D):p<T.scrollLeft()?o(y):c())}}function u(){e(this).find(".placeholder").remove(),T.css("height","").find(t.selector).attr("style",""),h.trigger("dropped.dragdroplist")}function d(){p&&(c(),"vertical"===t.orientation?h.animate({top:p.top[h.data("draggable-index")]},"fast",u.bind(this)):h.animate({left:p.left[h.data("draggable-index")]},"fast",u.bind(this)),h.trigger("drop.dragdroplist"))}var h,p,m,f,g,v,T=t.$boundary,b="up",w="down",y="left",D="right",C=30;return{handleDragStart:n,handleDrop:d,handleDrag:l}};e.fn.dragdroplist=function(i){var n={orientation:"vertical",tagName:"li",selector:".draggable",contentSelector:"> *",scroll_speed:8};return e(this).each(function(){var s,r,a=function(e){e.draggable({translateX:"horizontal"===r.orientation,translateY:"vertical"===r.orientation,handle:r.handle?r.handle:r.tagName,boundary:r.$boundary})};e(this).data("dragdroplist")||(r=e.extend({},n,i),r.$boundary=r.$boundary||e(this),e(this).data("dragdroplist",{settings:r}),s=new t(r),e(this).find(r.tagName).each(function(){a(e(this))}),e(this).bind("start.draggable",s.handleDragStart).bind("drop.draggable",s.handleDrop).bind("drag.draggable",s.handleDrag)),e(this).on("itemadded.dragdroplist",function(t){a(e(t.target))})}),e(this)}}(jQuery),function(e){function t(t,i){this.el=e(t),this.options=i||{},this.x=!1!==this.options.x||this.options.forceHorizontal,this.y=!1!==this.options.y||this.options.forceVertical,this.autoHide=!1!==this.options.autoHide,this.padding=void 0==this.options.padding?2:this.options.padding,this.position=this.options.position,this.showOnMouseOver=!1!==this.options.showOnMouseOver,this.inner=this.el.find(".antiscroll-inner"),this.inner.css({right:this.y?-s()+"px":0,bottom:this.x?-s()+"px":0}),this.refresh()}function i(t){this.pane=t,this.pane.el.append(this.el),this.innerEl=this.pane.inner.get(0),this.dragging=!1,this.enter=!1,this.shown=!1,this.pane.el.mouseenter(e.proxy(this,"mouseenter")),this.pane.el.mouseleave(e.proxy(this,"mouseleave")),this.el.mousedown(e.proxy(this,"mousedown")),this.innerPaneScrollListener=e.proxy(this,"scroll"),this.pane.inner.scroll(this.innerPaneScrollListener),this.innerPaneMouseWheelListener=e.proxy(this,"mousewheel"),this.pane.inner.bind("mousewheel",this.innerPaneMouseWheelListener);var i=this.pane.options.initialDisplay;i!==!1&&(this.show(),this.pane.autoHide&&(this.hiding=setTimeout(e.proxy(this,"hide"),parseInt(i,10)||3e3)))}function n(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i}function s(){if(void 0===r){var t=e('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>');e("body").append(t);var i=e(t).innerWidth(),n=e("div",t).innerWidth();e(t).remove(),r=i-n}return r}e.fn.antiscroll=function(t){return this.each(function(){e(this).data("antiscroll")&&e(this).data("antiscroll").destroy(),e(this).data("antiscroll",new e.Antiscroll(this,t))})},e.Antiscroll=t,t.prototype.refresh=function(){var e=this.inner.get(0).scrollWidth>this.el.width()+(this.y?s():0),t=this.inner.get(0).scrollHeight>this.el.height()+(this.x?s():0);this.x&&(!this.horizontal&&e?this.horizontal=new i.Horizontal(this):this.horizontal&&!e?(this.horizontal.destroy(),this.horizontal=null):this.horizontal&&this.horizontal.update()),this.y&&(!this.vertical&&t?this.vertical=new i.Vertical(this):this.vertical&&!t?(this.vertical.destroy(),this.vertical=null):this.vertical&&this.vertical.update())},t.prototype.destroy=function(){return this.horizontal&&(this.horizontal.destroy(),this.horizontal=null),this.vertical&&(this.vertical.destroy(),this.vertical=null),this},t.prototype.rebuild=function(){return this.destroy(),this.inner.attr("style",""),t.call(this,this.el,this.options),this},i.prototype.destroy=function(){return this.el.remove(),this.pane.inner.unbind("scroll",this.innerPaneScrollListener),this.pane.inner.unbind("mousewheel",this.innerPaneMouseWheelListener),this},i.prototype.mouseenter=function(){this.enter=!0,this.pane.showOnMouseOver&&this.show()},i.prototype.mouseleave=function(){this.enter=!1,this.dragging||this.pane.autoHide&&this.hide()},i.prototype.scroll=function(){this.shown||(this.show(),!this.dragging&&this.pane.autoHide&&(this.hiding=setTimeout(e.proxy(this,"hide"),1e3))),this.update()},i.prototype.mousedown=function(t){t.preventDefault(),this.dragging=!0,this.startPageY=t.pageY-parseInt(this.el.css("top"),10),this.startPageX=t.pageX-parseInt(this.el.css("left"),10),this.el[0].ownerDocument.onselectstart=function(){return!1};var i=(this.pane,e.proxy(this,"mousemove")),n=this;e(this.el[0].ownerDocument).mousemove(i).mouseup(function(){n.dragging=!1,this.onselectstart=null,e(this).unbind("mousemove",i),n.enter||n.hide()})},i.prototype.show=function(e){this.hiding&&(clearTimeout(this.hiding),this.hiding=null),!this.shown&&this.update()&&(this.el.addClass("antiscroll-scrollbar-shown"),this.shown=!0)},i.prototype.hide=function(){this.pane.autoHide!==!1&&this.shown&&(this.el.removeClass("antiscroll-scrollbar-shown"),this.shown=!1)},i.Horizontal=function(t){var n=document;t.el.length>0&&(n=t.el[0].ownerDocument),this.el=e('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">',n),i.call(this,t)},n(i.Horizontal,i),i.Horizontal.prototype.update=function(){var e=this.pane.el.width(),t=e-2*this.pane.padding,i=this.pane.inner.get(0);return this.el.css("width",t*e/i.scrollWidth).css("left",t*i.scrollLeft/i.scrollWidth),e<i.scrollWidth},i.Horizontal.prototype.mousemove=function(e){var t=this.pane.el.width()-2*this.pane.padding,i=e.pageX-this.startPageX,n=this.el.width(),s=this.pane.inner.get(0),r=Math.min(Math.max(i,0),t-n);s.scrollLeft=(s.scrollWidth-this.pane.el.width())*r/(t-n)},i.Horizontal.prototype.mousewheel=function(e,t,i,n){return 0>i&&0==this.pane.inner.get(0).scrollLeft||i>0&&this.innerEl.scrollLeft+Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth?(e.preventDefault(),!1):void 0},i.Vertical=function(t){var n=document;t.el.length>0&&(n=t.el[0].ownerDocument),this.el=e('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">',n),this.el.addClass("left"===t.position?"antiscroll-scrollbar-position-left":"antiscroll-scrollbar-position-right"),i.call(this,t)},n(i.Vertical,i),i.Vertical.prototype.update=function(){var e=this.pane.el.height(),t=e-2*this.pane.padding,i=this.innerEl,n=t*e/i.scrollHeight;n=20>n?20:n;var s=t*i.scrollTop/i.scrollHeight;if(s+n>t){var r=s+n-t;s=s-r-3}return this.el.css("height",n).css("top",s),e<i.scrollHeight},i.Vertical.prototype.mousemove=function(e){var t=this.pane.el.height(),i=t-2*this.pane.padding,n=e.pageY-this.startPageY,s=this.el.height(),r=this.innerEl,a=Math.min(Math.max(n,0),i-s);r.scrollTop=(r.scrollHeight-t)*a/(i-s)},i.Vertical.prototype.mousewheel=function(e,t,i,n){return n>0&&0==this.innerEl.scrollTop||0>n&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight?(e.preventDefault(),!1):void 0};var r}(jQuery),TD.debug=function(){var e={};return e.spoof_data=null,e}(),TD.minWrapperVersionMac="2.8.0",TD.minWrapperVersionWin="2.8.0";var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-4790629-1"]),_gaq.push(["_setCustomVar",1,"Env",TD.util.getAppEnv(),2]),_gaq.push(["_setCustomVar",2,"Version",TD.version,2]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.src="https://ssl.google-analytics.com/ga.js",e.setAttribute("async","true");var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();var require={baseUrl:"/web",paths:{flight:"scripts/lib/bower_components/flight",data:"scripts/swift/app/data",ui:"scripts/swift/app/ui",page:"scripts/swift/app/page",util:"scripts/swift/app/util",tracking:"scripts/swift/app/tracking",td:"scripts",jjv:"scripts/lib/bower_components/jjv/lib/jjv",text:"scripts/lib/bower_components/requirejs-text/text","with-child-components":"scripts/lib/bower_components/flight-with-child-components/lib/flight-with-child-components","with-resources":"scripts/lib/bower_components/flight-with-resources/lib/with-resources","with-state":"scripts/lib/bower_components/flight-with-state/lib/with-state","es6-promise":"scripts/lib/bower_components/es6-promise/promise",rxjs:"scripts/lib/bower_components/rxjs/dist/rx.lite.min","array.prototype.find":"scripts/lib/bower_components/Array.prototype.find/index"}};